!function(t){function __webpack_require__(a){if(e[a])return e[a].exports;var i=e[a]={i:a,l:!1,exports:{}};return t[a].call(i.exports,i,i.exports,__webpack_require__),i.l=!0,i.exports}var e={};__webpack_require__.m=t,__webpack_require__.c=e,__webpack_require__.d=function(t,e,a){__webpack_require__.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},__webpack_require__.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},__webpack_require__.t=function(t,e){if(1&e&&(t=__webpack_require__(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(__webpack_require__.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)__webpack_require__.d(a,i,function(e){return t[e]}.bind(null,i));return a},__webpack_require__.n=function(t){var e=t&&t.__esModule?function getDefault(){return t.default}:function getModuleExports(){return t};return __webpack_require__.d(e,"a",e),e},__webpack_require__.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=1)}({"./node_modules/axios/index.js":function(t,e,a){t.exports=a("./node_modules/axios/lib/axios.js")},"./node_modules/axios/lib/adapters/xhr.js":function(t,e,a){"use strict";var i=a("./node_modules/axios/lib/utils.js"),s=a("./node_modules/axios/lib/core/settle.js"),r=a("./node_modules/axios/lib/helpers/buildURL.js"),n=a("./node_modules/axios/lib/helpers/parseHeaders.js"),o=a("./node_modules/axios/lib/helpers/isURLSameOrigin.js"),h=a("./node_modules/axios/lib/core/createError.js"),c="undefined"!==typeof window&&window.btoa&&window.btoa.bind(window)||a("./node_modules/axios/lib/helpers/btoa.js");t.exports=function xhrAdapter(t){return new Promise(function dispatchXhrRequest(e,l){var d=t.data,p=t.headers;i.isFormData(d)&&delete p["Content-Type"];var u=new XMLHttpRequest,g="onreadystatechange",v=!1;if("undefined"===typeof window||!window.XDomainRequest||"withCredentials"in u||o(t.url)||(u=new window.XDomainRequest,g="onload",v=!0,u.onprogress=function handleProgress(){},u.ontimeout=function handleTimeout(){}),t.auth){var f=t.auth.username||"",y=t.auth.password||"";p.Authorization="Basic "+c(f+":"+y)}if(u.open(t.method.toUpperCase(),r(t.url,t.params,t.paramsSerializer),!0),u.timeout=t.timeout,u[g]=function handleLoad(){if(u&&(4===u.readyState||v)&&(0!==u.status||u.responseURL&&0===u.responseURL.indexOf("file:"))){var a="getAllResponseHeaders"in u?n(u.getAllResponseHeaders()):null,i={data:t.responseType&&"text"!==t.responseType?u.response:u.responseText,status:1223===u.status?204:u.status,statusText:1223===u.status?"No Content":u.statusText,headers:a,config:t,request:u};s(e,l,i),u=null}},u.onerror=function handleError(){l(h("Network Error",t,null,u)),u=null},u.ontimeout=function handleTimeout(){l(h("timeout of "+t.timeout+"ms exceeded",t,"ECONNABORTED",u)),u=null},i.isStandardBrowserEnv()){var D=a("./node_modules/axios/lib/helpers/cookies.js"),w=(t.withCredentials||o(t.url))&&t.xsrfCookieName?D.read(t.xsrfCookieName):void 0;w&&(p[t.xsrfHeaderName]=w)}if("setRequestHeader"in u&&i.forEach(p,function setRequestHeader(t,e){"undefined"===typeof d&&"content-type"===e.toLowerCase()?delete p[e]:u.setRequestHeader(e,t)}),t.withCredentials&&(u.withCredentials=!0),t.responseType)try{u.responseType=t.responseType}catch(m){if("json"!==t.responseType)throw m}"function"===typeof t.onDownloadProgress&&u.addEventListener("progress",t.onDownloadProgress),"function"===typeof t.onUploadProgress&&u.upload&&u.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then(function onCanceled(t){u&&(u.abort(),l(t),u=null)}),void 0===d&&(d=null),u.send(d)})}},"./node_modules/axios/lib/axios.js":function(t,e,a){"use strict";function createInstance(t){var e=new r(t),a=s(r.prototype.request,e);return i.extend(a,r.prototype,e),i.extend(a,e),a}var i=a("./node_modules/axios/lib/utils.js"),s=a("./node_modules/axios/lib/helpers/bind.js"),r=a("./node_modules/axios/lib/core/Axios.js"),n=a("./node_modules/axios/lib/defaults.js"),o=createInstance(n);o.Axios=r,o.create=function create(t){return createInstance(i.merge(n,t))},o.Cancel=a("./node_modules/axios/lib/cancel/Cancel.js"),o.CancelToken=a("./node_modules/axios/lib/cancel/CancelToken.js"),o.isCancel=a("./node_modules/axios/lib/cancel/isCancel.js"),o.all=function all(t){return Promise.all(t)},o.spread=a("./node_modules/axios/lib/helpers/spread.js"),t.exports=o,t.exports.default=o},"./node_modules/axios/lib/cancel/Cancel.js":function(t){"use strict";function Cancel(t){this.message=t}Cancel.prototype.toString=function toString(){return"Cancel"+(this.message?": "+this.message:"")},Cancel.prototype.__CANCEL__=!0,t.exports=Cancel},"./node_modules/axios/lib/cancel/CancelToken.js":function(t,e,a){"use strict";function CancelToken(t){if("function"!==typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise(function promiseExecutor(t){e=t});var a=this;t(function cancel(t){a.reason||(a.reason=new i(t),e(a.reason))})}var i=a("./node_modules/axios/lib/cancel/Cancel.js");CancelToken.prototype.throwIfRequested=function throwIfRequested(){if(this.reason)throw this.reason},CancelToken.source=function source(){var t;return{token:new CancelToken(function executor(e){t=e}),cancel:t}},t.exports=CancelToken},"./node_modules/axios/lib/cancel/isCancel.js":function(t){"use strict";t.exports=function isCancel(t){return!(!t||!t.__CANCEL__)}},"./node_modules/axios/lib/core/Axios.js":function(t,e,a){"use strict";function Axios(t){this.defaults=t,this.interceptors={request:new r,response:new r}}var i=a("./node_modules/axios/lib/defaults.js"),s=a("./node_modules/axios/lib/utils.js"),r=a("./node_modules/axios/lib/core/InterceptorManager.js"),n=a("./node_modules/axios/lib/core/dispatchRequest.js");Axios.prototype.request=function request(t){"string"===typeof t&&(t=s.merge({url:arguments[0]},arguments[1])),(t=s.merge(i,{method:"get"},this.defaults,t)).method=t.method.toLowerCase();var e=[n,void 0],a=Promise.resolve(t);for(this.interceptors.request.forEach(function unshiftRequestInterceptors(t){e.unshift(t.fulfilled,t.rejected)}),this.interceptors.response.forEach(function pushResponseInterceptors(t){e.push(t.fulfilled,t.rejected)});e.length;)a=a.then(e.shift(),e.shift());return a},s.forEach(["delete","get","head","options"],function forEachMethodNoData(t){Axios.prototype[t]=function(e,a){return this.request(s.merge(a||{},{method:t,url:e}))}}),s.forEach(["post","put","patch"],function forEachMethodWithData(t){Axios.prototype[t]=function(e,a,i){return this.request(s.merge(i||{},{method:t,url:e,data:a}))}}),t.exports=Axios},"./node_modules/axios/lib/core/InterceptorManager.js":function(t,e,a){"use strict";function InterceptorManager(){this.handlers=[]}var i=a("./node_modules/axios/lib/utils.js");InterceptorManager.prototype.use=function use(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},InterceptorManager.prototype.eject=function eject(t){this.handlers[t]&&(this.handlers[t]=null)},InterceptorManager.prototype.forEach=function forEach(t){i.forEach(this.handlers,function forEachHandler(e){null!==e&&t(e)})},t.exports=InterceptorManager},"./node_modules/axios/lib/core/createError.js":function(t,e,a){"use strict";var i=a("./node_modules/axios/lib/core/enhanceError.js");t.exports=function createError(t,e,a,s,r){var n=new Error(t);return i(n,e,a,s,r)}},"./node_modules/axios/lib/core/dispatchRequest.js":function(t,e,a){"use strict";function throwIfCancellationRequested(t){t.cancelToken&&t.cancelToken.throwIfRequested()}var i=a("./node_modules/axios/lib/utils.js"),s=a("./node_modules/axios/lib/core/transformData.js"),r=a("./node_modules/axios/lib/cancel/isCancel.js"),n=a("./node_modules/axios/lib/defaults.js"),o=a("./node_modules/axios/lib/helpers/isAbsoluteURL.js"),h=a("./node_modules/axios/lib/helpers/combineURLs.js");t.exports=function dispatchRequest(t){return throwIfCancellationRequested(t),t.baseURL&&!o(t.url)&&(t.url=h(t.baseURL,t.url)),t.headers=t.headers||{},t.data=s(t.data,t.headers,t.transformRequest),t.headers=i.merge(t.headers.common||{},t.headers[t.method]||{},t.headers||{}),i.forEach(["delete","get","head","post","put","patch","common"],function cleanHeaderConfig(e){delete t.headers[e]}),(t.adapter||n.adapter)(t).then(function onAdapterResolution(e){return throwIfCancellationRequested(t),e.data=s(e.data,e.headers,t.transformResponse),e},function onAdapterRejection(e){return r(e)||(throwIfCancellationRequested(t),e&&e.response&&(e.response.data=s(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)})}},"./node_modules/axios/lib/core/enhanceError.js":function(t){"use strict";t.exports=function enhanceError(t,e,a,i,s){return t.config=e,a&&(t.code=a),t.request=i,t.response=s,t}},"./node_modules/axios/lib/core/settle.js":function(t,e,a){"use strict";var i=a("./node_modules/axios/lib/core/createError.js");t.exports=function settle(t,e,a){var s=a.config.validateStatus;a.status&&s&&!s(a.status)?e(i("Request failed with status code "+a.status,a.config,null,a.request,a)):t(a)}},"./node_modules/axios/lib/core/transformData.js":function(t,e,a){"use strict";var i=a("./node_modules/axios/lib/utils.js");t.exports=function transformData(t,e,a){return i.forEach(a,function transform(a){t=a(t,e)}),t}},"./node_modules/axios/lib/defaults.js":function(t,e,a){"use strict";(function(e){function setContentTypeIfUnset(t,e){!i.isUndefined(t)&&i.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var i=a("./node_modules/axios/lib/utils.js"),s=a("./node_modules/axios/lib/helpers/normalizeHeaderName.js"),r={"Content-Type":"application/x-www-form-urlencoded"},n={adapter:function getDefaultAdapter(){var t;return"undefined"!==typeof XMLHttpRequest?t=a("./node_modules/axios/lib/adapters/xhr.js"):"undefined"!==typeof e&&(t=a("./node_modules/axios/lib/adapters/xhr.js")),t}(),transformRequest:[function transformRequest(t,e){return s(e,"Content-Type"),i.isFormData(t)||i.isArrayBuffer(t)||i.isBuffer(t)||i.isStream(t)||i.isFile(t)||i.isBlob(t)?t:i.isArrayBufferView(t)?t.buffer:i.isURLSearchParams(t)?(setContentTypeIfUnset(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):i.isObject(t)?(setContentTypeIfUnset(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function transformResponse(t){if("string"===typeof t)try{t=JSON.parse(t)}catch(e){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function validateStatus(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};i.forEach(["delete","get","head"],function forEachMethodNoData(t){n.headers[t]={}}),i.forEach(["post","put","patch"],function forEachMethodWithData(t){n.headers[t]=i.merge(r)}),t.exports=n}).call(this,a("./node_modules/process/browser.js"))},"./node_modules/axios/lib/helpers/bind.js":function(t){"use strict";t.exports=function bind(t,e){return function wrap(){for(var a=new Array(arguments.length),i=0;i<a.length;i++)a[i]=arguments[i];return t.apply(e,a)}}},"./node_modules/axios/lib/helpers/btoa.js":function(t){"use strict";function E(){this.message="String contains an invalid character"}E.prototype=new Error,E.prototype.code=5,E.prototype.name="InvalidCharacterError",t.exports=function btoa(t){for(var e,a,i=String(t),s="",r=0,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.charAt(0|r)||(n="=",r%1);s+=n.charAt(63&e>>8-r%1*8)){if((a=i.charCodeAt(r+=.75))>255)throw new E;e=e<<8|a}return s}},"./node_modules/axios/lib/helpers/buildURL.js":function(t,e,a){"use strict";function encode(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var i=a("./node_modules/axios/lib/utils.js");t.exports=function buildURL(t,e,a){if(!e)return t;var s;if(a)s=a(e);else if(i.isURLSearchParams(e))s=e.toString();else{var r=[];i.forEach(e,function serialize(t,e){null!==t&&"undefined"!==typeof t&&(i.isArray(t)?e+="[]":t=[t],i.forEach(t,function parseValue(t){i.isDate(t)?t=t.toISOString():i.isObject(t)&&(t=JSON.stringify(t)),r.push(encode(e)+"="+encode(t))}))}),s=r.join("&")}return s&&(t+=(-1===t.indexOf("?")?"?":"&")+s),t}},"./node_modules/axios/lib/helpers/combineURLs.js":function(t){"use strict";t.exports=function combineURLs(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},"./node_modules/axios/lib/helpers/cookies.js":function(t,e,a){"use strict";var i=a("./node_modules/axios/lib/utils.js");t.exports=i.isStandardBrowserEnv()?function standardBrowserEnv(){return{write:function write(t,e,a,s,r,n){var o=[];o.push(t+"="+encodeURIComponent(e)),i.isNumber(a)&&o.push("expires="+new Date(a).toGMTString()),i.isString(s)&&o.push("path="+s),i.isString(r)&&o.push("domain="+r),!0===n&&o.push("secure"),document.cookie=o.join("; ")},read:function read(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function remove(t){this.write(t,"",Date.now()-864e5)}}}():{write:function write(){},read:function read(){return null},remove:function remove(){}}},"./node_modules/axios/lib/helpers/isAbsoluteURL.js":function(t){"use strict";t.exports=function isAbsoluteURL(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},"./node_modules/axios/lib/helpers/isURLSameOrigin.js":function(t,e,a){"use strict";var i=a("./node_modules/axios/lib/utils.js");t.exports=i.isStandardBrowserEnv()?function standardBrowserEnv(){function resolveURL(t){var i=t;return e&&(a.setAttribute("href",i),i=a.href),a.setAttribute("href",i),{href:a.href,protocol:a.protocol?a.protocol.replace(/:$/,""):"",host:a.host,search:a.search?a.search.replace(/^\?/,""):"",hash:a.hash?a.hash.replace(/^#/,""):"",hostname:a.hostname,port:a.port,pathname:"/"===a.pathname.charAt(0)?a.pathname:"/"+a.pathname}}var t,e=/(msie|trident)/i.test(navigator.userAgent),a=document.createElement("a");return t=resolveURL(window.location.href),function isURLSameOrigin(e){var a=i.isString(e)?resolveURL(e):e;return a.protocol===t.protocol&&a.host===t.host}}():function isURLSameOrigin(){return!0}},"./node_modules/axios/lib/helpers/normalizeHeaderName.js":function(t,e,a){"use strict";var i=a("./node_modules/axios/lib/utils.js");t.exports=function normalizeHeaderName(t,e){i.forEach(t,function processHeader(a,i){i!==e&&i.toUpperCase()===e.toUpperCase()&&(t[e]=a,delete t[i])})}},"./node_modules/axios/lib/helpers/parseHeaders.js":function(t,e,a){"use strict";var i=a("./node_modules/axios/lib/utils.js"),s=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function parseHeaders(t){var e,a,r,n={};return t?(i.forEach(t.split("\n"),function parser(t){if(r=t.indexOf(":"),e=i.trim(t.substr(0,r)).toLowerCase(),a=i.trim(t.substr(r+1)),e){if(n[e]&&s.indexOf(e)>=0)return;n[e]="set-cookie"===e?(n[e]?n[e]:[]).concat([a]):n[e]?n[e]+", "+a:a}}),n):n}},"./node_modules/axios/lib/helpers/spread.js":function(t){"use strict";t.exports=function spread(t){return function wrap(e){return t.apply(null,e)}}},"./node_modules/axios/lib/utils.js":function(t,e,a){"use strict";function isArray(t){return"[object Array]"===r.call(t)}function isObject(t){return null!==t&&"object"===typeof t}function isFunction(t){return"[object Function]"===r.call(t)}function forEach(t,e){if(null!==t&&"undefined"!==typeof t)if("object"!==typeof t&&(t=[t]),isArray(t))for(var a=0,i=t.length;a<i;a++)e.call(null,t[a],a,t);else for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.call(null,t[s],s,t)}var i=a("./node_modules/axios/lib/helpers/bind.js"),s=a("./node_modules/is-buffer/index.js"),r=Object.prototype.toString;t.exports={isArray:isArray,isArrayBuffer:function isArrayBuffer(t){return"[object ArrayBuffer]"===r.call(t)},isBuffer:s,isFormData:function isFormData(t){return"undefined"!==typeof FormData&&t instanceof FormData},isArrayBufferView:function isArrayBufferView(t){return"undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function isString(t){return"string"===typeof t},isNumber:function isNumber(t){return"number"===typeof t},isObject:isObject,isUndefined:function isUndefined(t){return"undefined"===typeof t},isDate:function isDate(t){return"[object Date]"===r.call(t)},isFile:function isFile(t){return"[object File]"===r.call(t)},isBlob:function isBlob(t){return"[object Blob]"===r.call(t)},isFunction:isFunction,isStream:function isStream(t){return isObject(t)&&isFunction(t.pipe)},isURLSearchParams:function isURLSearchParams(t){return"undefined"!==typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function isStandardBrowserEnv(){return("undefined"===typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!==typeof window&&"undefined"!==typeof document},forEach:forEach,merge:function merge(){function assignValue(e,a){"object"===typeof t[a]&&"object"===typeof e?t[a]=merge(t[a],e):t[a]=e}for(var t={},e=0,a=arguments.length;e<a;e++)forEach(arguments[e],assignValue);return t},extend:function extend(t,e,a){return forEach(e,function assignValue(e,s){t[s]=a&&"function"===typeof e?i(e,a):e}),t},trim:function trim(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")}}},"./node_modules/is-buffer/index.js":function(t){function isBuffer(t){return!!t.constructor&&"function"===typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}t.exports=function(t){return null!=t&&(isBuffer(t)||function isSlowBuffer(t){return"function"===typeof t.readFloatLE&&"function"===typeof t.slice&&isBuffer(t.slice(0,0))}(t)||!!t._isBuffer)}},"./node_modules/process/browser.js":function(t){function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(t){if(e===setTimeout)return setTimeout(t,0);if((e===defaultSetTimout||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(a){try{return e.call(null,t,0)}catch(a){return e.call(this,t,0)}}}function cleanUpNextTick(){n&&s&&(n=!1,s.length?r=s.concat(r):o=-1,r.length&&drainQueue())}function drainQueue(){if(!n){var t=runTimeout(cleanUpNextTick);n=!0;for(var e=r.length;e;){for(s=r,r=[];++o<e;)s&&s[o].run();o=-1,e=r.length}s=null,n=!1,function runClearTimeout(t){if(a===clearTimeout)return clearTimeout(t);if((a===defaultClearTimeout||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(t);try{a(t)}catch(e){try{return a.call(null,t)}catch(e){return a.call(this,t)}}}(t)}}function Item(t,e){this.fun=t,this.array=e}function noop(){}var e,a,i=t.exports={};!function(){try{e="function"===typeof setTimeout?setTimeout:defaultSetTimout}catch(t){e=defaultSetTimout}try{a="function"===typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(t){a=defaultClearTimeout}}();var s,r=[],n=!1,o=-1;i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var a=1;a<arguments.length;a++)e[a-1]=arguments[a];r.push(new Item(t,e)),1!==r.length||n||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=noop,i.addListener=noop,i.once=noop,i.off=noop,i.removeListener=noop,i.removeAllListeners=noop,i.emit=noop,i.prependListener=noop,i.prependOnceListener=noop,i.listeners=function(){return[]},i.binding=function(){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},"./src/scripts/Config/config.js":function(t,e){"use strict";e.a=function(){return{pair:{ID:23,Name:"EURUSD",FullName:"EUR/USD",Category:"Currency"},period:"1",timeMode:"local",chartType:"candle",state:"default",indicators:[],currentValue:{ask:"0.00000",bid:"0.00000",mid:"0.00000"},connectorOptions:{url:"//192.168.1.222/wss/api/quotation/",wsUrl:"//192.168.1.222/wss/Server.ashx",authData:{sid:null,sockUser:null,sockPassword:null,um_session:null},source:"integration",type:"widgets"},links:{quotationCountriesUrl:"//192.168.1.222/wss/quotation/getsettingsFromFile/quotation_countries?json",settingsUrl:"//192.168.1.222/wss/quotation/getsettings?tch=true",newsSourceUrl:"//192.168.1.222/adminapi/settings/getnewssource/",eventsSourceUrl:"//192.168.1.222/adminapi/settings/geteventssource/"},quotationCountries:!1,lang:"ru",isHeaderHidden:!1,isSidebarHidden:!1,isFullScreen:!1,isDataPanel:!1,isAutoRestore:!0,isMagnetMode:!1,isStayDrawingMode:!1,isShowDrawingObjects:!0,isDrawingObjectsLocked:!1,isPipsShow:!1,rowsid:[],defaultId:23,typeThemes:"default",isConfigpage:!1,typeData:"bid",tabsQuantity:5,timeframesForEvents:["minute","minute5","minute15","minute30","hour"],timeframesForNews:["minute","minute5","minute15","minute30","hour"],offsetChart:.2,defaultParams:{activeSpliter:0,activeChartIndex:0,cursorType:"arrow",setTimeoutforSave:750,paramsPanels:{isHeaderHidden:!1,isSidebarHidden:!0,isFullScreen:!0,isDataPanel:!0},version:"1.0"},modules:{isSideBarCreate:!0,isHeaderCreate:!0,headerButtons:{searchQuotationButton:!0,createTabButton:!0,fullScreenButton:!0,chartTypeButton:!0,periodsButton:!0,indicatorButton:!0,splitterButton:!0,createTypeDataButton:!0,settingsButton:!0,createPipsButton:!1},sideBarButtons:{cursorTypeButton:!0,drawingObjectsButton:!0,brushTypeButton:!0,zoomButton:!0,lockButton:!0,basketButton:!0,saveRestoreButtons:!0,stayDrawingModeButton:!0,hideDrowingObjectButton:!0,magnetModeButton:!0,rouleteButton:!0,textTypeButton:!0},chartElements:{hiddenDataPanel:!0,isDataPanelCreate:!0,isShowPriceLineOfLastBar:!0},isShowNews:!1,isShowEvents:!1,signals:!1,trading:!1},dropDown:{periods:["minute","minute5","minute15","minute30","hour","hour4","hour8","day","week","month"],chartTypes:["candle","area","line","bar","hollow"],typeDatas:["bid","ask","mid"],indicators:["Bears","Bulls","SO","ATR","RSI","WILLIAMSR","ADX","MACD","SMA","EMA","BB","Fractal","Ichimoku","Env","DEMA","Sar","STD","Keltner","Donchian","AO","AC"]},quotationName:" ",images:{},rightPadding:8,candleWidth:6,dataOffset:0,precission:5,marginTop:50,marginBottom:20,scaleParams:{},numb:500,fallBack:500,zoomView:1,drawingObjects:[],startY:0,defaultTopPositionDataWindowOnChart:46}}},"./src/scripts/index.js":function(t,e,a){"use strict";a.r(e);var i=a("./src/scripts/preBuild/TechnicalChart.js");!function init(){window.TechnicalChart=i.a}()},"./src/scripts/preBuild/TechnicalChart.js":function(t,e,i){"use strict";function _defineProperty(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function LibCanvas(){}function toFixed(t){return parseFloat(t.toString().slice(0,15))}function sortTimeAscending(t,e){return t.T>e.T?1:t.T<e.T?-1:0}function sortTimeDescending(t,e){return t.T>e.T?-1:t.T<e.T?1:0}function getValuesFromDictionary(t){return Object.values(t).sort(sortTimeDescending)}function libIndicatorsUtils_clone(t){return JSON.parse(JSON.stringify(t))}function LibIndicators(){}function Indicator(t,e){this.id=Indicator.getNextId(),this.name=e.name,this.fullName=e.fullName,this.params=Object.assign({},e.params),this.colors=Object.assign({},e.colors),this.opacity=Object.assign({},e.opacity),this.lineWidth=Object.assign({},e.lineWidth),this.oldParams={period:{},lineWidth:{}},this.type=e.type,this.data=[],this.showData=[],this.chartData=t,this.hidden=!!e.hidden&&e.hidden,this.h=e.h,this.top=e.top,this.oscillatorPrecission=6,this.oscillatorPrecissionFlag=!0}function DragObject(t){var e;t.dragObject=this,this.parent=t,this.forTrget=t.classList.contains("tch-move-tools"),this.maxLeft,this.maxTop,this.minLeft,this.minTop,this.fixPos={top:!1,right:!1,bottom:!1,left:!1},this.fixMinMax={top:!1,right:!1,bottom:!1,left:!1},this.geom={},this.reCalculationSize(),this.bodyTop=document.body.getBoundingClientRect().top,this.bord={},this.s=t.style,d.makeDraggable(t);var a,i={opacity:".3",boxShadow:""},s={};this.onDragStart=function(t){e={top:this.s.top,left:this.s.left,position:this.s.position},this.s.position="absolute",this.upStyle(),this.minLeft=parseFloat(getComputedStyle(this.parent).left)-this.parent.getBoundingClientRect().left,this.minTop=parseFloat(getComputedStyle(this.parent).top)-this.parent.getBoundingClientRect().top-window.scrollY,this.maxLeft=document.documentElement.clientWidth-(this.geom.borderLeftWidth+this.geom.borderRightWidth)+this.minLeft-this.geom.width,this.maxTop=document.documentElement.clientHeight-(this.geom.borderTopWidth+this.geom.borderBottomWidth)+this.minTop-this.geom.height,a=t},this.hide=function(){t.style.display="none"},this.show=function(){t.style.display=""},this.onDragMove=function(e,i,s){var r={};parseFloat(t.style.left),i=e.pageX-a.x,s=e.pageY-a.y,this.minLeft>=i?(r.left=r.right=this.minLeft,this.fixMinMax.left=!0):this.maxLeft<=i?(r.left=r.right=this.maxLeft,this.fixMinMax.right=!0):(r.left=r.right=i,this.fixMinMax.left=!1,this.fixMinMax.right=!1),this.minTop>=s?(r.top=r.bottom=this.minTop,this.fixMinMax.top=!0):this.maxTop<=e.pageY+this.minTop?(r.top=r.bottom=this.maxTop,this.fixMinMax.bottom=!0):(r.top=r.bottom=s-window.scrollY,this.fixMinMax.top=!1,this.fixMinMax.bottom=!1),t.style.top=r.top+"px",t.style.left=r.left+"px";var n=this.lipnetOF(r);0!=Object.keys(n).length?this.lipShow(n,t):(t.style.boxShadow="",t.classList.toggle("tch-border",!1))},this.onDragSuccess=function(){},this.onDragFail=function(){this.s.top=e.top,this.s.left=e.left,this.s.position=e.position},this.toString=function(){return t.id},this.lipnetOF=function(t){var e={};return this.bord.bottom+this.deltaLip>t.top&&this.bord.top-this.deltaLip<t.top&&(this.bord.left-this.deltaLip<t.left&&this.bord.left+this.deltaLip>t.left&&(e.left=this.bord.left-t.left),this.bord.right-this.deltaLip<t.right&&this.bord.right+this.deltaLip>t.right&&(e.right=this.bord.right-t.right)),this.bord.right+this.deltaLip>t.left&&this.bord.left-this.deltaLip<t.left&&(this.bord.top-this.deltaLip<t.top&&this.bord.top+this.deltaLip>t.top&&(e.top=this.bord.top-t.top),this.bord.bottom-this.deltaLip<t.bottom&&this.bord.bottom+this.deltaLip>t.bottom&&(e.bottom=this.bord.bottom-t.bottom)),e},this.lipShow=function(t,e){var a=t.hasOwnProperty("top")?t.top:0+t.hasOwnProperty("bottom")?t.bottom:0,i=t.hasOwnProperty("left")?t.left:0+t.hasOwnProperty("right")?t.right:0;e.style.boxShadow="rgba(0, 0, 0, .35) 0px 0px 10px 5px, "+i+"px "+a+"px 0px -1px rgba(200, 200, 200, .8), "+i+"px "+a+"px 5px 5px red",e.classList.toggle("tch-border",!0)},this.upStyle=function(){for(var t in i)i.hasOwnProperty(t)&&(s[t]=this.s[t],this.s[t]=i[t])},this.downStyle=function(){for(var t in i)i.hasOwnProperty(t)&&(this.s[t]=s[t]);this.s.opacity=1,this.boxShadow="",this.parent.classList.toggle("tch-border",!1),this.rememberStyle={}},this.downLip=function(){var t=parseFloat(""===this.s.left?getComputedStyle(this.parent).left:this.s.left),e=parseFloat(""===this.s.top?getComputedStyle(this.parent).top:this.s.top);for(var a in this.fixPos)this.fixPos.hasOwnProperty(a)&&(this.fixPos[a]=!1);this.bord.bottom+this.deltaLip>e&&this.bord.top-this.deltaLip<e&&(Math.abs(this.bord.left-t)<this.deltaLip&&(this.s.left=this.bord.left+"px",this.fixPos.left=!0),Math.abs(this.bord.right-t)<this.deltaLip&&(this.s.left=this.bord.right+"px",this.fixPos.right=!0)),this.bord.right+this.deltaLip>t&&this.bord.left-this.deltaLip<t&&(Math.abs(this.bord.top-e)<this.deltaLip&&(this.s.top=this.bord.top+"px",this.fixPos.top=!0),Math.abs(this.bord.bottom-e)<this.deltaLip&&(this.s.top=this.bord.bottom+"px",this.fixPos.bottom=!0))},this.changeContainer=function(){}}function DropTarget(t,e){t.dropTarget=this,this.classNameBar=e+"OK",this.canAccept=function(){return!0},this.accept=function(t,e){this.onLeave(e,!0)},this.onLeave=function(e,a){t.classList.toggle(this.classOK,!1),e.classList.toggle(this.classNameBar,!1),a&&this.stuck(t,e)},this.stuck=function(t,e){var a=t.getBoundingClientRect().top,i=t.getBoundingClientRect().left;e.classList.toggle(this.classNameBar,!0),e.style.top=a,e.style.left=i},this.onEnter=function(e){e.classList.toggle(this.classNameBar,!0),t.classList.toggle(this.classOK,!0)},this.toString=function(){return t.id}}function fixEvent(t){var e=t||window.event;if(null===e.pageX&&null!==e.clientX){var a=document.documentElement,i=document.body;e.pageX=e.clientX+(a&&a.scrollLeft||i&&i.scrollLeft||0)-(a.clientLeft||0),e.pageY=e.clientY+(a&&a.scrollTop||i&&i.scrollTop||0)-(a.clientTop||0)}return!e.which&&e.button&&(e.which=1&e.button?1:2&e.button?3:4&e.button?2:0),e}function Picker(t,e){this.techChart=e,this.parent=t,this.rgba=[0,0,0,1],this.init()}function Line_Line(t){arguments&&arguments.length&&DrawingObject.apply(this,arguments),this.chartData=t,this.color="#0000FF",this.isChanged=!1,this.circles=[],this.width=1,this.state="edit",this.periods=[],this.lineType="normal",this.fillSettingsPanel=function(t){t.innerHTML=this.htmlSettingsPanel(),this.addSettingsLineEvent(t)},this.convertToDTO=function(){var t=DrawingObject.prototype.convertToDTO.apply(this,arguments);return t.circles=this.cloneCircles(this.circles),this.updateCustomPropsByObj(t,this),t},this.applyRestoredParams=function(t){DrawingObject.prototype.applyRestoredParams.apply(this,arguments),t.type||(t.type=t.constructor.name),this.circles=this.restoreCircles(t),this.updateCustomPropsByObj(this,t)}}function Text(t){arguments&&arguments.length&&Line_Line.apply(this,arguments),this.chartData=t,this.color="rgba(101,101,101,1)",this.fontFamily="Arial",this.fontSize=40,this.textArea="Text",this.fill=!1,this.fillColor="rgba(255,0,0,1)",this.border=!1,this.borderColor="rgba(0,255,0,1)",this.bold="off",this.italic="off",this.textSpan=null,this.rect={},this.draw=function(){this.chartData&&this.chartData.chart&&(this.textSpan||(this.textSpan=document.createElement("span"),this.textSpan.setAttribute("id",this.id),this.textSpan.style.position="absolute",this.textSpan.style.display="block",this.textSpan.style.padding="3px",this.textSpan.style.whiteSpace="nowrap"),this.chartData.chart.drawingTextContainer&&!this.chartData.chart.drawingTextContainer.querySelector("span#"+this.id)&&this.chartData.chart.drawingTextContainer.appendChild(this.textSpan),this.applyTextParams())},this.isFocused=function(t,e){var a=parseFloat(this.points[0].x),i=parseFloat(this.points[0].y),s={x1:a,x2:a+this.rect.width,y1:i,y2:i+this.rect.height};return this.isObjectEdit=LibDrawing_LibDrawing.isPointInRect(s,{x:t,y:e},5),this.isObjectEdit},this.shiftTo=function(t,e,a,i,s){if(0!==e||0!==t)for(var r=0;r<this.points.length;r++)this.points[r].y-=e,this.points[r].x-=t,this.data[r].d-=i,this.data[r].v-=s},this.removeDrawingObject=this.remove,this.remove=function(){this.removeDrawingObject(),this.chartData.chart.drawingTextContainer.removeChild(this.textSpan)},this.applyValue=function(t,e){this[e]=t,this.draw(),this.chartData.chart.updateDrawingObjectsOtherChart(this),this.chartData.chart.drawActiveDrawingObjectsOtherCharts(this.id)},this.getStyleRows=function(){return[this.getTextStyleRow(),this.getTextAreaRow(),this.getBackgroundRow(),this.getBorderRow()]},this.createLineSettingsPanel=function(t){this.createSettingsPanel(t),this.fillSettingsPanelFull(t),t.isSettingsPanelOpen=!0,this.addPanelLineSettingEvent(t),this.setCoordinateSettingsPanel(t)},this.setCoordinateSettingsPanel=function(t){var e=parseFloat(this.points[0].y),a=t.parentElement.getClientRects(),i=t.getClientRects();e+this.rect.height+i[0].height<a[0].height?t.style.top=e+this.rect.height+"px":t.style.top=e-i[0].height+"px",this.points[0].x+i[0].width<a[0].width?t.style.left=this.points[0].x+"px":t.style.left=this.points[0].x-i[0].width+"px"},this.fillSettingsPanelFull=function(t){t.innerHTML=this.htmlFullSettingsPanel(),t.removeAttribute("tch-line-type"),t.setAttribute("tch-text-type",this.constructor.name),this.fillLineStyle(t)},this.fillLineStyle=function(t){var e=t.querySelector(".tch-line-settings-style");e.innerHTML="";var a=this.getStyleRows();this.fillDivWithRows(e,a)},this.cancelPanelSettingLine=function(t,e){for(var a=this.getStylePropsNames(),i=0;i<a.length;i++){var s=e.querySelector("#tch-settingsStyle-input-"+a[i]).oldValue;void 0!==s&&(this[a[i]]=s)}this.draw(),this.chartData.chart.updateDrawingObjectsOtherChart(this),this.chartData.chart.drawActiveDrawingObjectsOtherCharts(this.id),e.classList.toggle("tch-hidden"),t.preventDefault(),t.stopPropagation()},this.updateCustomPropsByObj=function(t,e){t.periods=e.periods.slice(0);for(var a=this.getStylePropsNames(),i=0;i<a.length;i++)t[a[i]]=e[a[i]];this.draw()},this.convertToDTO=function(){var t=DrawingObject.prototype.convertToDTO.apply(this,arguments);return this.updateCustomPropsByObj(t,this),t},this.applyRestoredParams=function(t){DrawingObject.prototype.applyRestoredParams.apply(this,arguments),t.type||(t.type=t.constructor.name),this.updateCustomPropsByObj(this,t)}}function Circle(){arguments&&arguments.length&&DrawingObject.apply(this,arguments),this.radius=5,this.lineWidth=1,this.convertToDTO=function(){var t=DrawingObject.prototype.convertToDTO.apply(this,arguments);return this.updateCustomPropsByObj(t,this),t},this.applyRestoredParams=function(t){DrawingObject.prototype.applyRestoredParams.apply(this,arguments),this.updateCustomPropsByObj(this,t)}}function ArrowMark(t){arguments&&arguments.length&&(Text.apply(this,arguments),this.chartData=t,this.chartData.chart&&(this.circles=[],this.points=[{x:this.points[0].x,y:this.points[0].y,active:!0}],this.circles.push(new Circle(this.chartData,{data:[this.data[0]],points:[{x:this.points[0].x,y:this.points[0].y}]})),this.circles[0].radius=4),this.size=25,this.fontSize=20,this.textArea="",this.colorMark="rgba(38,176,197,1)",this.icon=null,this.centeringSvg={x:0,y:0},this.viewbox={x:0,y:0,width:300,height:300}),this.isFocused=function(t,e){if(this.isObjectEdit=!1,this.isObjectEdit=this.isFocusedCircle(t,e),!this.isObjectEdit){var a=this.getRect();this.isObjectEdit=LibDrawing_LibDrawing.isPointInRect(a,{x:t,y:e},5)}return this.isObjectEdit},this.isFocusedCircle=function(t,e){if(this.periods.length&&-1!==this.periods.indexOf(this.chartData.period))return!1;for(var a=!1,i=0,s=0;s<this.circles.length;s++){if(i++,LibDrawing_LibDrawing.isPointOnCircle(this.circles[s],{x:t,y:e})){this.circles[s].points[0].active=!0,this.points[s].active=!0,a=!0;break}this.circles[s].points[0].active=!1,this.points[s].active=!1}for(;i<this.circles.length;)this.circles[i].points[0].active=!1,this.points[i].active=!1,i++;return!!a||void 0},this.textCreateTextSpan=this.draw,this.draw=function(t){this.createArrowMarkIcon(t),this.textCreateTextSpan()},this.updatePixels=function(){this.isPressed||(this.points[0].x=this.chartData.chart.toXPixels(this.data[0].d),this.points[0].y=this.chartData.chart.toYPixels(this.data[0].v),this.circles[0].points=[this.points[0]],this.circles[0].data=[this.data[0]])},this.shiftTo=function(t,e,a,i,s){0===e&&0===t||(this.points[0].y-=e,this.points[0].x-=t,this.data[0].d-=i,this.data[0].v-=s,this.circles[0].points=[this.points[0]],this.circles[0].data=[this.data[0]])},this.removeDrawingObject=DrawingObject.prototype.remove,this.remove=function(){this.removeDrawingObject(),this.chartData.chart.drawingTextContainer.removeChild(this.textSpan),this.chartData.chart.drawingTextContainer.removeChild(this.icon)},this.getStyleRows=function(){return[this.getTextStyleRow(),this.getTextAreaRow(),this.getArrowMarkRow()]},this.convertToDTO=function(){var t=DrawingObject.prototype.convertToDTO.apply(this,arguments);return t.circles=this.cloneCircles(this.circles),this.updateCustomPropsByObj(t,this),t},this.applyRestoredParams=function(t){DrawingObject.prototype.applyRestoredParams.apply(this,arguments),t.type||(t.type=t.constructor.name),this.circles=this.restoreCircles(t),this.updateCustomPropsByObj(this,t)}}function ArrowMarkLeft(){arguments&&arguments.length&&(ArrowMark.apply(this,arguments),this.viewbox={x:0,y:50,width:300,height:300})}function ArrowMarkRight(){arguments&&arguments.length&&(ArrowMark.apply(this,arguments),this.viewbox={x:100,y:50,width:300,height:300},this.centeringSvg={x:-this.size,y:0}),this.applyTextPosition=function(){var t=this.getPoint();this.textSpan.style.left=t.x-this.size-this.rect.width+"px",this.textSpan.style.top=t.y-this.size/2+"px"},this.getRect=function(){var t=this.getPoint();return{x1:this.rect.width<=6?t.x-this.size:t.x-this.rect.width-this.size,y1:t.y-this.size/2,x2:t.x,y2:t.y+this.size/2}}}function ArrowMarkUp(){arguments&&arguments.length&&(ArrowMark.apply(this,arguments),this.viewbox={x:30,y:0,width:275,height:275},this.centeringSvg={x:-this.size/2,y:-this.size/2}),this.isFocused=function(t,e){if(this.isObjectEdit=!1,this.isObjectEdit=this.isFocusedCircle(t,e),!this.isObjectEdit){var a=this.getRectSvg(),i=this.getRectSpan();(LibDrawing_LibDrawing.isPointInRect(a,{x:t,y:e},5)||LibDrawing_LibDrawing.isPointInRect(i,{x:t,y:e},5))&&(this.isObjectEdit=!0)}return this.isObjectEdit},this.applyTextPosition=function(){var t=this.getPoint();this.textSpan.style.left=t.x-this.rect.width/2+"px",this.textSpan.style.top=t.y+this.size+"px"},this.getRectSvg=function(){var t=this.getPoint();return{x1:t.x-this.size/2,y1:t.y,x2:t.x+this.size/2,y2:t.y+this.size}},this.getRectSpan=function(){var t=this.getPoint();return{x1:t.x-this.rect.width/2,y1:t.y+this.size,x2:t.x+this.rect.width/2,y2:this.rect.height<=6?t.y+this.size:t.y+this.size+this.rect.height}}}function ArrowMarkDown(){arguments&&arguments.length&&(ArrowMark.apply(this,arguments),this.viewbox={x:25,y:70,width:250,height:250},this.centeringSvg={x:-this.size/2,y:this.size/2}),this.isFocused=function(t,e){if(this.isObjectEdit=!1,this.isObjectEdit=this.isFocusedCircle(t,e),!this.isObjectEdit){var a=this.getRectSvg(),i=this.getRectSpan();(LibDrawing_LibDrawing.isPointInRect(a,{x:t,y:e},5)||LibDrawing_LibDrawing.isPointInRect(i,{x:t,y:e},5))&&(this.isObjectEdit=!0)}return this.isObjectEdit},this.applyTextPosition=function(){var t=this.getPoint();this.textSpan.style.left=t.x-this.rect.width/2+"px",this.textSpan.style.top=t.y-2*this.size+"px"},this.getRectSvg=function(){var t=this.getPoint();return{x1:t.x-this.size/2,y1:t.y-this.size,x2:t.x+this.size/2,y2:t.y}},this.getRectSpan=function(){var t=this.getPoint();return{x1:t.x-this.rect.width/2,y1:this.rect.height<=6?t.y-this.size:t.y-this.size-this.rect.height,x2:t.x+this.rect.width/2,y2:t.y-this.size}}}function TrendLine(){arguments&&arguments.length&&(Line_Line.apply(this,arguments),this.circles.push(new Circle(this.chartData,{data:[this.data[0]],points:[this.points[0]]})),this.circles.push(new Circle(this.chartData,{data:[this.data[1]],points:[this.points[1]]})),this.drawingStage={current:0,max:1},this.leftEnd=!1,this.rightEnd=!1,this.leftEndType="normal",this.rightEndType="normal",this.wingsLength=20,this.wingsAngle=15,this.rightEndPoint=null,this.leftEndPoint=null,this.statsTextColor="#00ff00",this.showPriceRange=!1,this.showBarsRange=!1,this.showDateRange=!1,this.showDistance=!1,this.showAngle=!1,this.alwaysShowStats=!1),this.isFocused=function(t,e){if(this.periods.length&&-1!==this.periods.indexOf(this.chartData.period))return!1;this.isObjectEdit=!1,this.isChanged=!1;for(var a=!1,i=0,s=0;s<this.circles.length;s++){if(i++,LibDrawing_LibDrawing.isPointOnCircle(this.circles[s],{x:t,y:e})){this.circles[s].points[0].active=!0,this.points[s].active=!0,this.isChanged=!0,a=!0;break}this.circles[s].points[0].active=!1,this.points[s].active=!1}for(;i<this.circles.length;)this.circles[i].points[0].active=!1,this.points[i].active=!1,i++;if(a)return!0;var r=this.points[0].x,n=this.points[1].x,o=this.points[0].y,h=this.points[1].y;if(this.leftEnd&&(r=this.leftEndPoint.x,o=this.leftEndPoint.y),this.rightEnd&&(n=this.rightEndPoint.x,h=this.rightEndPoint.y),LibDrawing_LibDrawing.isPointOnLine({x1:r,x2:n,y1:o,y2:h},{x:t,y:e})){for(var c=0;c<this.points.length;c++)this.points[c].active=!0,this.circles&&this.circles[c]&&(this.circles[c].points[0].active=!0);this.isObjectEdit=!0,a=!0}return a},this.updateLastPoint=function(t,e){var a=this.data.length-1;this.data[a]=t,this.points[a]=e,this.circles[a].points[0]=this.points[a]},this.appendPoint=function(t,e){this.data.push(t),this.points.push(e),this.circles.push(new Circle(this.chartData,{data:[this.data[this.data.length-1]],points:[this.points[this.points.length-1]]}))},this.updateValues=function(){for(var t=0;t<this.points.length;t++)this.data[t].d=this.chartData.chart.toXValue(this.points[t].x),this.data[t].v=this.chartData.chart.toYValue(this.points[t].y)},this.shiftTo=function(t,e,a,i,s){if(0!==e||0!==t)for(var r=0;r<this.points.length;r++)this.points[r].active&&(this.points[r].y-=e,this.points[r].x-=t,this.data[r].d-=i,this.data[r].v-=s),this.circles[r].points=[this.points[r]],this.circles[r].data=[this.data[r]]},this.moveTo=function(t,e,a){for(var i=0;i<this.points.length;i++)this.points[i].active&&(this.points[i].x=a.x,this.points[i].y=a.y,this.data[i].d=a.dateSeconds,this.data[i].v=a.value),i<this.circles.length&&(this.circles[i].points=[this.points[i]],this.circles[i].data=[this.data[i]])},this.updatePixels=function(){for(var t=0;t<this.points.length;t++){if(this.isPressed)return;this.points[t].x=this.chartData.chart.toXPixels(this.data[t].d),this.points[t].y=this.chartData.chart.toYPixels(this.data[t].v),this.circles[t].points[0]=this.points[t],this.circles[t].data[0]=this.data[t]}},this.draw=function(t){if(this.periods.length&&-1!==this.periods.indexOf(this.chartData.period))return!1;var e,a,i=this.points[0].x,s=this.points[1].x,r=this.points[0].y,n=this.points[1].y,o=i,h=s,c=r,l=n,d=null;if(("arrow"===this.leftEndType||"arrow"===this.rightEndType||this.leftEnd||this.rightEnd)&&(d=LibDrawing_LibDrawing.findLineAngleDeg({x1:i,y1:r,x2:s,y2:n})),"arrow"===this.leftEndType&&(e=LibCanvas.getPosition(this.points[0].x,this.width),a=LibCanvas.getPosition(this.points[0].y,this.width),this.drawArrow(t,{x:e,y:a},d,this.wingsLength,this.wingsAngle,"down")),"arrow"===this.rightEndType&&(e=LibCanvas.getPosition(this.points[1].x,this.width),a=LibCanvas.getPosition(this.points[1].y,this.width),this.drawArrow(t,{x:e,y:a},d,this.wingsLength,this.wingsAngle,"up")),this.leftEnd&&(this.leftEndPoint=this.getLeftEndPoint({x1:i,y1:r,x2:s,y2:n},this.chartData.chart.w,this.chartData.chart.h,d),o=this.leftEndPoint.x,c=this.leftEndPoint.y),this.rightEnd&&(this.rightEndPoint=this.getRightEndPoint({x1:i,y1:r,x2:s,y2:n},this.chartData.chart.w,this.chartData.chart.h,d),h=this.rightEndPoint.x,l=this.rightEndPoint.y),o=LibCanvas.getPosition(o,this.width),c=LibCanvas.getPosition(c,this.width),h=LibCanvas.getPosition(h,this.width),l=LibCanvas.getPosition(l,this.width),LibCanvas.drawLine(null,t,o,c,h,l,this.color,this.getLineTypeArray(this.lineType,this.width),this.width,1),"edit"!==this.state&&"active"!==this.state||LibCanvas.drawLine(null,t,o,c,h,l,this.color,[],parseFloat(this.width)+10,.1),"edit"===this.state||"active"===this.state){for(var p=0;p<this.circles.length;p++)this.circles[p].points[0].active||this.circles[p].drawWithShadow(t,"white",this.color,.1);for(var u=0;u<this.circles.length;u++)this.circles[u].points[0].active&&this.circles[u].drawWithShadow(t,"red",this.color,.1)}return!0},this.lineGetStyleRows=this.getStyleRows,this.getStyleRows=function(){var t=this.lineGetStyleRows(),e=[this.getLeftEndRow(),this.getRightEndRow(),this.getStatsTextColorRow(),this.getShowPriceRangeRow(),this.getShowBarsRangeRow(),this.getShowDateTimeRangeRow(),this.getShowDistance(),this.getShowAngleRow(),this.getAlwaysShowStatsRow()];return t.concat(e)},this.remove=function(){TrendLine.prototype.remove.apply(this,arguments)},this.lineConvertToDTO=this.convertToDTO,this.convertToDTO=function(){var t=this.lineConvertToDTO();return this.updateCustomPropsByObj(t,this),t},this.lineApplyRestoredParams=this.applyRestoredParams,this.applyRestoredParams=function(t){this.lineApplyRestoredParams(t),this.updateCustomPropsByObj(this,t)},this.updateCustomPropsByObj=function(t,e){Line_Line.prototype.updateCustomPropsByObj.apply(this,arguments),t.leftEnd=e.leftEnd,t.rightEnd=e.rightEnd,t.leftEndType=e.leftEndType,t.rightEndType=e.rightEndType,t.wingsLength=e.wingsLength,t.wingsAngle=e.wingsAngle,t.rightEndPoint=DrawingObject.cloneObject(e.rightEndPoint),t.leftEndPoint=DrawingObject.cloneObject(e.leftEndPoint),t.statsTextColor=e.statsTextColor,t.showPriceRange=e.showPriceRange,t.showBarsRange=e.showBarsRange,t.showDateRange=e.showDateRange,t.showDistance=e.showDistance,t.showAngle=e.showAngle,t.alwaysShowStats=e.alwaysShowStats}}function HorizontalLine(){arguments&&arguments.length&&(Line_Line.apply(this,arguments),this.chartData.chart?this.circles.push(new Circle(this.chartData,{data:[this.data[0]],points:[{x:this.chartData.chart.w/2,y:this.points[0].y}]})):this.circles.push(new Circle(this.chartData,{data:[this.data[0]],points:[{x:this.points[0].x,y:this.points[0].y}]})),this.showText=!1,this.showPrice=!1,this.textColor="#0000FF",this.textFamily="veranda",this.textSize="10",this.textAlignHorizontal="center",this.textAlignVertical="top",this.textArea="HelloWorld"),this.isFocused=function(t,e){if(this.periods.length&&-1!==this.periods.indexOf(this.chartData.period))return!1;this.isChanged=!1,this.isObjectEdit=!1;var a=!1;if(LibDrawing_LibDrawing.isPointOnCircle(this.circles[0],{x:t,y:e})&&(this.isChanged=!0,a=!0),a||LibDrawing_LibDrawing.isPointOnLine({x1:this.points[0].x,x2:this.points[1].x,y1:this.points[0].y,y2:this.points[1].y},{x:t,y:e})&&(this.isObjectEdit=!0,a=!0),a){this.circles[0].points[0].active=!0;for(var i=0;i<this.points.length;i++)this.points[i].active=!0}else{this.circles[0].points[0].active=!1;for(var s=0;s<this.points.length;s++)this.points[s].active=!1}return a},this.updateValues=function(){},this.draw=function(t){this.points[0].x=0,this.points[1].x=this.chartData.chart.w;var e=LibCanvas.getPosition(this.points[0].x,this.width),a=LibCanvas.getPosition(this.points[1].x,this.width),i=LibCanvas.getPosition(this.points[0].y,this.width),s=LibCanvas.getPosition(this.points[1].y,this.width);return Line_Line.prototype.draw.apply(this,[t,e,a,i,s])},this.updatePixels=function(){this.points[0].y=this.chartData.chart.toYPixels(this.data[0].v),this.points[1].y=this.points[0].y,this.circles[0].points[0].y=this.points[0].y,this.circles[0].points[0].x=this.chartData.chart.w/2},this.shiftTo=function(t,e,a){if(0!==e){for(var i=0;i<this.points.length;i++)this.points[i].active&&(this.points[i].y=a.y,this.circles[0].points[0].y=a.y,this.circles[0].points[0].x=this.chartData.chart.w/2);this.data[0].v=a.value}},this.moveTo=function(t,e,a){for(var i=0;i<this.points.length;i++)this.points[i].active&&(this.points[i].y=a.y,this.circles[0].points[0].y=a.y,this.circles[0].points[0].x=this.chartData.chart.w/2);this.data[0].v=a.value},this.lineGetStyleRows=this.getStyleRows,this.getStyleRows=function(){var t=this.lineGetStyleRows(),e=[this.getShowPriceRow(),this.getShowTextRow(),this.getTextStyleRow(),this.getTextAlignRow(),this.getTextAreaRow()];return t.concat(e)},this.lineApplyRestoredParams=this.applyRestoredParams,this.applyRestoredParams=function(t){this.lineApplyRestoredParams(t),this.updateCustomPropsByObj(this,t)},this.lineUpdateCustomPropsByObj=this.updateCustomPropsByObj,this.updateCustomPropsByObj=function(t,e){this.lineUpdateCustomPropsByObj(t,e),t.showText=e.showText,t.showPrice=e.showPrice,t.textColor=e.textColor,t.textFamily=e.textFamily,t.textSize=e.textSize,t.textAlignHorizontal=e.textAlignHorizontal,t.textAlignVertical=e.textAlignVertical,t.textArea=e.textArea},this.updateByObject=function(t){DrawingObject.prototype.updateByObject.apply(this,arguments),this.circles[0].points[0]={x:this.chartData.chart.w/2,y:this.circles[0].points[0].y}}}function VerticalLine(){arguments&&arguments.length&&(Line_Line.apply(this,arguments),this.chartData.chart?this.circles.push(new Circle(this.chartData,{data:[this.data[0]],points:[{x:this.points[0].x,y:this.chartData.chart.h/2}]})):this.circles.push(new Circle(this.chartData,{data:[this.data[0]],points:[{x:this.points[0].x,y:this.points[0].y}]}))),this.isFocused=function(t,e){if(this.periods.length&&-1!==this.periods.indexOf(this.chartData.period))return!1;this.isChanged=!1;var a=!1;if(LibDrawing_LibDrawing.isPointOnCircle(this.circles[0],{x:t,y:e})&&(this.isChanged=!0,a=!0),a||LibDrawing_LibDrawing.isPointOnLine({x1:this.points[0].x,x2:this.points[1].x,y1:this.points[0].y,y2:this.points[1].y},{x:t,y:e})&&(this.isObjectEdit=!0,a=!0),a){this.circles[0].points[0].active=!0;for(var i=0;i<this.points.length;i++)this.points[i].active=!0}else{this.circles[0].points[0].active=!1;for(var s=0;s<this.points.length;s++)this.points[s].active=!1}return a},this.draw=function(t){if(this.periods.length&&-1!==this.periods.indexOf(this.chartData.period))return!1;this.points[0].y=0,this.points[1].y=this.chartData.chart.h;var e=LibCanvas.getPosition(this.points[0].x,this.width),a=LibCanvas.getPosition(this.points[1].x,this.width),i=LibCanvas.getPosition(this.points[0].y,this.width),s=LibCanvas.getPosition(this.points[1].y,this.width);return Line_Line.prototype.draw.apply(this,[t,e,a,i,s])},this.updatePixels=function(){this.points[0].x=this.chartData.chart.toXPixels(this.data[0].d),this.points[1].x=this.points[0].x,this.circles[0].points[0].x=this.points[0].x,this.circles[0].points[0].y=this.chartData.chart.h/2},this.updateValues=function(){this.data[0].d=this.chartData.chart.toXValue(this.points[0].x)},this.shiftTo=function(t,e,a){if(0!==t){for(var i=0;i<this.points.length;i++)this.points[i].active&&(this.points[i].x=a.x,this.circles[0].points[0].x=a.x);this.data[0].d=a.dateSeconds}},this.moveTo=function(t,e,a){for(var i=0;i<this.points.length;i++)this.points[i].active&&(this.points[i].x=a.x);this.data[0].d=a.dateSeconds,this.circles[0].points[0].x=a.x},this.lineGetStyleRows=this.getStyleRows,this.getStyleRows=function(){var t=this.lineGetStyleRows(),e=[this.getShowDateRow()];return t.concat(e)},this.updateByObject=function(t){DrawingObject.prototype.updateByObject.apply(this,arguments),this.circles[0].points[0]={x:this.circles[0].points[0].x,y:this.chartData.chart.h/2}}}function Arrow(){TrendLine.apply(this,arguments),this.color="#1E90FF",this.rightEndType="arrow"}function Ray(){TrendLine.apply(this,arguments),this.color="#008000",this.rightEnd=!0,this.leftEnd=!1}function HorizontalRay(){arguments&&arguments.length&&(HorizontalLine.apply(this,arguments),this.color="#FF1493",this.circles[0]=new Circle(this.chartData,{data:[this.data[0]],points:[this.points[0]]})),this.draw=function(t){this.points[1].x=this.chartData.chart.w;var e=LibCanvas.getPosition(this.points[0].x,this.width),a=LibCanvas.getPosition(this.points[1].x,this.width),i=LibCanvas.getPosition(this.points[0].y,this.width),s=LibCanvas.getPosition(this.points[1].y,this.width);return Line_Line.prototype.draw.apply(this,[t,e,a,i,s])},this.updatePixels=function(){this.points[0].y=this.chartData.chart.toYPixels(this.data[0].v),this.points[0].x=this.chartData.chart.toXPixels(this.data[0].d),this.points[1].y=this.points[0].y,this.circles[0].points[0].y=this.points[0].y,this.circles[0].points[0].x=this.points[0].x},this.shiftTo=function(t,e,a,i,s){if(0!==e||0!==t){for(var r=0;r<this.points.length;r++)this.points[r].active&&(this.points[r].y-=e,this.points[r].x-=t,this.data[r].d-=i,this.data[r].v-=s);this.circles[0].points[0].y=this.points[0].y,this.circles[0].points[0].x=this.points[0].x}},this.moveTo=function(t,e,a){for(var i=0;i<this.points.length;i++)this.points[i].active&&(this.points[i].x=a.x,this.points[i].y=a.y,this.data[i].d=a.dateSeconds,this.data[i].v=a.value);this.circles[0].points[0].y=this.points[0].y,this.circles[0].points[0].x=this.points[0].x},this.updateValues=function(){for(var t=0;t<this.points.length;t++)this.data[t].d=this.chartData.chart.toXValue(this.points[t].x),this.data[t].v=this.chartData.chart.toYValue(this.points[t].y)},this.updateByObject=function(t){DrawingObject.prototype.updateByObject.apply(this,arguments)}}function TrendAngle(){arguments&&arguments.length&&(TrendLine.apply(this,arguments),this.rightEnd=!1,this.angleSpan=null,this.color="#0000FF",this.textColor="#0000FF",this.textFamily="veranda",this.textSize="10",this.textBold=!1,this.textItalic=!1,this.dx=0,this.dy=0),this.trendLineGetStyleRows=this.getStyleRows,this.getStyleRows=function(){var t=this.trendLineGetStyleRows();return(t=this.removeStyleMenuElementByNames(t,["rightEndType","leftEndType","showDateRange","showDistance","showAngle"])).splice(1,0,this.getTextStyleRow()),t},this.updatePixels=function(){this.isPressed||(this.dy=this.points[1].y-this.points[0].y,this.dx=this.points[1].x-this.points[0].x,this.points[0].x=this.chartData.chart.toXPixels(this.data[0].d),this.points[0].y=this.chartData.chart.toYPixels(this.data[0].v),this.points[1].x=this.points[0].x+this.dx,this.points[1].y=this.points[0].y+this.dy,this.data[1].d=this.chartData.chart.toXValue(this.points[1].x),this.data[1].v=this.chartData.chart.toYValue(this.points[1].y),this.circles[0].points=[this.points[0]],this.circles[0].data=[this.data[0]],this.circles[1].points=[this.points[1]],this.circles[1].data=[this.data[1]])},this.isFocused=function(t,e){if(this.periods.length&&-1!==this.periods.indexOf(this.chartData.period))return!1;this.isChanged=!1,this.isObjectEdit=!1;var a,i=!1;for(a=0;a<this.circles.length;a++){if(LibDrawing_LibDrawing.isPointOnCircle(this.circles[a],{x:t,y:e})){0===a&&(this.isObjectEdit=!0),i=!0,this.isChanged=!0;break}this.circles[a].points[0].active=!1}if(i){for(var s=0;s<this.points.length;s++)this.isObjectEdit?(this.points[s].active=!0,this.circles[s].points[0].active=!0):this.points[s].active=!1;return this.circles[a].points[0].active=!0,!0}var r=this.points[0].x,n=this.points[1].x,o=this.points[0].y,h=this.points[1].y;if(this.leftEnd&&(r=this.leftEndPoint.x,o=this.leftEndPoint.y),this.rightEnd&&(n=this.rightEndPoint.x,h=this.rightEndPoint.y),LibDrawing_LibDrawing.isPointOnLine({x1:r,x2:n,y1:o,y2:h},{x:t,y:e})){for(var c=0;c<this.points.length;c++)this.points[c].active=!0,this.circles&&this.circles[c]&&(this.circles[c].points[0].active=!0);this.isObjectEdit=!0,i=!0}return i},this.moveTo=function(t,e,a){for(var i=0;i<this.points.length;i++)this.points[i].active&&0!==i&&(this.points[i].x=a.x,this.points[i].y=a.y,this.data[i].d=a.dateSeconds,this.data[i].v=a.value,this.dx=this.points[i].x-this.points[0].x,this.dy=this.points[i].y-this.points[0].y,this.circles[i].points=[this.points[i]],this.circles[i].data=[this.data[i]])},this.draw=function(t){if(this.periods.length&&-1!==this.periods.indexOf(this.chartData.period))return this.angleSpan.remove(),!1;this.angleSpan||this.createAngleBlock();var e,a=this.points[0].x,i=this.points[1].x,s=this.points[0].y,r=this.points[1].y,n=a,o=i,h=s,c=r,l=LibDrawing_LibDrawing.findLineAngleDeg({x1:a,y1:s,x2:i,y2:r});e=!(Math.round(l)<0);var d=Math.round(l)+"°",p=l>=0?1:-1;if(Array.prototype.indexOf.call(this.chartData.chart.drawingTextContainer.children,this.angleSpan)<0&&this.chartData.chart.drawingTextContainer.appendChild(this.angleSpan),this.angleSpan.innerText=d,this.angleSpan.style.left=(parseFloat(n)+this.removalLength).toFixed(1)+"px",this.angleSpan.style.top=(parseFloat(h)-this.angleSpan.height/2+p*this.angleSpan.height/2).toFixed(1)+"px",this.angleSpan.style.color=this.textColor,this.leftEnd&&(this.leftEndPoint=this.getLeftEndPoint({x1:a,y1:s,x2:i,y2:r},this.chartData.chart.w,this.chartData.chart.h,l),n=this.leftEndPoint.x,h=this.leftEndPoint.y),this.rightEnd&&(this.rightEndPoint=this.getRightEndPoint({x1:a,y1:s,x2:i,y2:r},this.chartData.chart.w,this.chartData.chart.h,l),o=this.rightEndPoint.x,c=this.rightEndPoint.y),n=LibCanvas.getPosition(n,this.width),h=LibCanvas.getPosition(h,this.width),o=LibCanvas.getPosition(o,this.width),c=LibCanvas.getPosition(c,this.width),LibCanvas.drawLine(null,t,n,h,o,c,this.color,this.getLineTypeArray(this.lineType,this.width),this.width,1),LibCanvas.drawLine(null,t,a,s,parseFloat(a)+this.removalLength,s,this.color,[2],1,1),LibCanvas.drawArc(null,t,a,s,0,Math.round(l),this.removalLength,this.color,[3],1,1,e),"edit"!==this.state&&"active"!==this.state||LibCanvas.drawLine(null,t,n,h,o,c,this.color,[],parseFloat(this.width)+10,.1),"edit"===this.state||"active"===this.state){for(var u=0;u<this.circles.length;u++)this.circles[u].points[0].active||this.circles[u].drawWithShadow(t,"white",this.color,.1);for(var g=0;g<this.circles.length;g++)this.circles[g].points[0].active&&this.circles[g].drawWithShadow(t,"red",this.color,.1)}return!0},this.remove=function(){this.angleSpan&&this.chartData.chart.drawingTextContainer.removeChild(this.angleSpan),TrendLine.prototype.remove.apply(this,arguments)},this.createAngleBlock=function(){var t=this.chartData.chart.parent.querySelector(".tch-drawing-text");this.angleSpan=document.createElement("span"),this.angleSpan.classList.toggle("tch-chart-angle-text",!0),this.angleSpan.innerText="0",t.appendChild(this.angleSpan),this.angleSpan.height=parseFloat(this.angleSpan.getBoundingClientRect().height)},this.trendLineConvertToDTO=this.convertToDTO,this.convertToDTO=function(){var t=this.trendLineConvertToDTO();return this.updateCustomPropsByObj(t,this),t},this.trendLineUpdateCustomPropsByObj=this.updateCustomPropsByObj,this.updateCustomPropsByObj=function(t,e){this.trendLineUpdateCustomPropsByObj(t,e),t.dx=e.dx,t.dy=e.dy,t.textColor=e.textColor,t.textFamily=e.textFamily,t.textSize=e.textSize,t.textBold=e.textBold,t.textItalic=e.textItalic}}function ParallelChannel(){arguments&&arguments.length&&TrendLine.apply(this,arguments),this.drawingStage={current:0,max:2},this.heightData={v:0,y:0},this.fill=!0,this.fillColor="#0000ff",this.opacity=.1,this.drawMiddle=!0,this.middleColor="#00ff00",this.middleWidth=1,this.middleType="dash",this.rightEnd=!1,this.leftEnd=!1,this.trendLineIsFocused=this.isFocused,this.isFocused=function(t,e){if(this.trendLineIsFocused(t,e))return!0;if(LibDrawing_LibDrawing.isPointOnLine({x1:this.rightEndPoint.x,x2:this.leftEndPoint.x,y1:LibCanvas.getPosition(parseFloat(this.rightEndPoint.y)-parseFloat(this.heightData.y),this.width),y2:LibCanvas.getPosition(parseFloat(this.leftEndPoint.y)-parseFloat(this.heightData.y),this.width)},{x:t,y:e})){for(var a=0;a<this.points.length;a++)this.points[a].active=!0,this.circles&&this.circles[a]&&(this.circles[a].points[0].active=!0);return this.isObjectEdit=!0,!0}return!1},this.draw=function(t){if(this.periods.length&&-1!==this.periods.indexOf(this.chartData.period))return!1;var e,a,i,s,r,n,o=this.points[0].x,h=this.points[1].x,c=this.points[0].y,l=this.points[1].y;if(this.chartData.techChart.charts.length>1)for(var d=0;d<this.chartData.techChart.charts.length;d++)this.points[1].y>this.chartData.techChart.charts[d].canvasDrawingActive.clientHeight&&(this.points[1].y=0);var p=LibDrawing_LibDrawing.findLineAngleDeg({x1:o,y1:c,x2:h,y2:l});if(r=this.getEndPoints(o,c,h,l,p),this.leftEndPoint=r.lep,this.rightEndPoint=r.rep,this.drawingStage.current>1){if(i=LibCanvas.getPosition(parseFloat(c)-parseFloat(this.heightData.y),this.width),s=LibCanvas.getPosition(parseFloat(l)-parseFloat(this.heightData.y),this.width),n=this.getEndPoints(o,i,h,s,p),this.fill){var u=[];u.push([r.lep.x,r.lep.y]),u.push([r.rep.x,r.rep.y]),u.push([n.rep.x,n.rep.y]),u.push([n.lep.x,n.lep.y]),LibCanvas.drawPolygon(null,t,u,this.fillColor,!1,!0,0,4,this.opacity)}if(e=LibCanvas.getPosition(r.lep.x,this.width),a=LibCanvas.getPosition(r.rep.x,this.width),i=LibCanvas.getPosition(r.lep.y,this.width),s=LibCanvas.getPosition(r.rep.y,this.width),Line_Line.prototype.draw.apply(this,[t,e,a,i,s]),e=LibCanvas.getPosition(n.lep.x,this.width),a=LibCanvas.getPosition(n.rep.x,this.width),i=LibCanvas.getPosition(n.lep.y,this.width),s=LibCanvas.getPosition(n.rep.y,this.width),Line_Line.prototype.draw.apply(this,[t,e,a,i,s]),this.drawMiddle){i=parseFloat(c)-parseFloat(this.heightData.y)/2,s=parseFloat(l)-parseFloat(this.heightData.y)/2;var g=this.getEndPoints(o,i,h,s,p);e=LibCanvas.getPosition(g.lep.x,this.width),a=LibCanvas.getPosition(g.rep.x,this.width),i=LibCanvas.getPosition(g.lep.y,this.width),s=LibCanvas.getPosition(g.rep.y,this.width),LibCanvas.drawLine(null,t,e,i,a,s,this.middleColor,this.getLineTypeArray(this.middleType,this.middleWidth),this.middleWidth,1)}}else e=LibCanvas.getPosition(this.points[0].x,this.width),a=LibCanvas.getPosition(this.points[1].x,this.width),i=LibCanvas.getPosition(this.points[0].y,this.width),s=LibCanvas.getPosition(this.points[1].y,this.width),Line_Line.prototype.draw.apply(this,[t,e,a,i,s]);return!0},this.updatePixels=function(){if(!this.isPressed){for(var t=0;t<this.points.length;t++)2!==t&&(this.points[t].x=this.chartData.chart.toXPixels(this.data[t].d),this.points[t].y=this.chartData.chart.toYPixels(this.data[t].v),this.circles[t].points=[this.points[t]],this.circles[t].data=[this.data[t]]);if(this.heightData.y=this.heightData.v/this.chartData.scaleParams.deltaY,this.points[2]){var e=this.getMiddleData(this.data[0],this.data[1]),a=this.getMiddlePoint(this.points[0],this.points[1]);this.points[2].x=a.x,this.points[2].y=parseFloat(a.y)-parseFloat(this.heightData.y),this.data[2].d=e.d,this.data[2].v=e.v+this.heightData.v,this.circles[2].points=[this.points[2]],this.circles[2].data=[this.data[2]]}}},this.appendPoint=function(t,e){this.data.push(t),this.points.push(e),this.circles.push(new Circle(this.chartData,{data:[this.data[this.data.length-1]],points:[this.points[this.points.length-1]]}))},this.updateLastPoint=function(t,e){var a=this.data.length-1;a<2&&(this.data[a]=t,this.points[a]=e,this.circles[a].points=[this.points[a]]),this.completeFigure(t,e)},this.moveTo=function(t,e,a){for(var i,s,r=0;r<this.points.length;r++)this.points[r].active&&(this.points.length<3?(this.points[r].x=a.x,this.points[r].y=a.y,this.data[r].d=a.dateSeconds,this.data[r].v=a.value,this.circles[r].points=[this.points[r]],this.circles[r].data=[this.data[r]]):2===r?this.drawingStage.current<3?(this.points[r].x=this.points[1].x,this.points[r].y=a.y,this.data[r].d=this.data[1].d,this.data[r].v=a.value,this.heightData={v:a.value-this.data[1].v,y:this.points[1].y-a.y},this.circles[r].points=[this.points[r]],this.circles[r].data=[this.data[r]]):(i=this.getMiddleData(this.data[0],this.data[1]),s=this.getMiddlePoint(this.points[0],this.points[1]),this.points[r].x=s.x,this.points[r].y=a.y,this.data[r].d=i.d,this.data[r].v=a.value,this.heightData={v:a.value-i.v,y:s.y-a.y},this.circles[r].points=[this.points[r]],this.circles[r].data=[this.data[r]]):(this.points[r].x=a.x,this.points[r].y=a.y,this.data[r].d=a.dateSeconds,this.data[r].v=a.value,i=this.getMiddleData(this.data[0],this.data[1]),s=this.getMiddlePoint(this.points[0],this.points[1]),this.points[2].x=s.x,this.points[2].y=parseFloat(s.y)-parseFloat(this.heightData.y),this.data[2].d=i.d,this.data[2].v=i.v+this.heightData.v,this.circles[r].points=[this.points[r]],this.circles[r].data=[this.data[r]],this.circles[2].points=[this.points[2]],this.circles[2].data=[this.data[2]]))},this.getStyleRows=function(){var t=Line_Line.prototype.getStyleRows.apply(this,arguments),e=[this.getMiddleSettingsRow(),this.getBackgroundRow(),this.getRightEndRow(),this.getLeftEndRow()];return t.concat(e)},this.trendLineConvertToDTO=this.convertToDTO,this.convertToDTO=function(){var t=this.trendLineConvertToDTO();return this.updateCustomPropsByObj(t,this),t},this.trendLineApplyRestoredParams=this.applyRestoredParams,this.applyRestoredParams=function(t){this.trendLineApplyRestoredParams(t),this.updateCustomPropsByObj(this,t)},this.trendLineUpdateCustomPropsByObj=this.updateCustomPropsByObj,this.updateCustomPropsByObj=function(t,e){this.trendLineUpdateCustomPropsByObj(t,e),t.heightData=DrawingObject.cloneObject(e.heightData),t.fill=e.fill,t.fillColor=e.fillColor,t.opacity=e.opacity,t.drawMiddle=e.drawMiddle,t.middleColor=e.middleColor,t.middleWidth=e.middleWidth,t.middleType=e.middleType}}function DisjointAngle(){arguments&&arguments.length&&ParallelChannel.apply(this,arguments),this.color="#00ff00",this.fillColor="#00ff00",this.opacity=.3,this.textColor="#0000FF",this.textFamily="veranda",this.textSize="10",this.textBold=!1,this.textItalic=!1,this.isFocused=function(t,e){if(this.trendLineIsFocused(t,e))return!0;if(3===this.points.length&&LibDrawing_LibDrawing.isPointOnLine({x1:this.points[2].x,x2:this.points[3].x,y1:this.points[2].y,y2:this.points[3].y},{x:t,y:e})){for(var a=0;a<this.points.length;a++)this.points[a].active=!0,this.circles&&this.circles[a]&&(this.circles[a].points[0].active=!0);return this.isObjectEdit=!0,!0}return!1},this.getStyleRows=function(){var t=Line_Line.prototype.getStyleRows.apply(this,arguments),e=[this.getTextStyleRow(),this.getBackgroundRow(),this.getLeftEndRow(),this.getRightEndRow(),this.getShowPriceRow(),this.getBackgroundRow()];return t.concat(e)},this.parallelChannelApplyRestoredParams=this.applyRestoredParams,this.applyRestoredParams=function(t){this.parallelChannelApplyRestoredParams(t),this.updateCustomPropsByObj(this,t)},this.draw=function(t){if(this.chartData.techChart.charts.length>1)for(var e=0;e<this.chartData.techChart.charts.length;e++)this.points[1].y>this.chartData.techChart.charts[e].canvasDrawingActive.clientHeight&&(this.points[1].y=0,Line_Line.prototype.draw.apply(this,[t,this.points[0].x,this.points[1].x,this.points[0].y,this.points[1].y]));if(this.periods.length&&-1!==this.periods.indexOf(this.chartData.period))return!1;var a,i,s,r,n,o,h,c,l,d,p,u,g,v,f,y,D=this.points[0].x,w=this.points[1].x,m=this.points[0].y,b=this.points[1].y;if(f=LibDrawing_LibDrawing.findLineAngleDeg({x1:D,y1:m,x2:w,y2:b}),g=this.getEndPoints(D,m,w,b,f),this.leftEndPoint=g.lep,this.rightEndPoint=g.rep,a=LibCanvas.getPosition(g.lep.x,this.width),i=LibCanvas.getPosition(g.rep.x,this.width),n=LibCanvas.getPosition(g.lep.y,this.width),o=LibCanvas.getPosition(g.rep.y,this.width),this.points.length<3)Line_Line.prototype.draw.apply(this,[t,a,i,n,o]);else if(3===this.points.length){var C=this.points[1].y-this.points[0].y,x=this.points[2].y-this.points[1].y;p=w,l=D,d=LibCanvas.getPosition(parseFloat(this.points[0].y)+2*C+x,this.width),u=LibCanvas.getPosition(parseFloat(this.points[1].y)+x,this.width),y=LibDrawing_LibDrawing.findLineAngleDeg({x1:l,y1:d,x2:p,y2:u}),v=this.getEndPoints(l,d,p,u,y),s=LibCanvas.getPosition(v.lep.x,this.width),r=LibCanvas.getPosition(v.rep.x,this.width),h=LibCanvas.getPosition(v.lep.y,this.width),c=LibCanvas.getPosition(v.rep.y,this.width),this.fill&&this.fillFigure(t,a,n,i,o,s,h,r,c),Line_Line.prototype.draw.apply(this,[t,a,i,n,o]),Line_Line.prototype.draw.apply(this,[t,s,r,h,c])}else p=LibCanvas.getPosition(this.points[2].x,this.width),l=LibCanvas.getPosition(this.points[3].x,this.width),u=LibCanvas.getPosition(this.points[2].y,this.width),d=LibCanvas.getPosition(this.points[3].y,this.width),y=LibDrawing_LibDrawing.findLineAngleDeg({x1:l,y1:d,x2:p,y2:u}),v=this.getEndPoints(l,d,p,u,y),s=LibCanvas.getPosition(v.lep.x,this.width),r=LibCanvas.getPosition(v.rep.x,this.width),h=LibCanvas.getPosition(v.lep.y,this.width),c=LibCanvas.getPosition(v.rep.y,this.width),this.fill&&this.fillFigure(t,a,n,i,o,s,h,r,c),Line_Line.prototype.draw.apply(this,[t,a,i,n,o]),Line_Line.prototype.draw.apply(this,[t,s,r,h,c]);return!0},this.updatePixels=function(){if(!this.isPressed)for(var t=0;t<this.points.length;t++)this.points[t].x=this.chartData.chart.toXPixels(this.data[t].d),this.points[t].y=this.chartData.chart.toYPixels(this.data[t].v),this.circles[t].points=[this.points[t]],this.circles[t].data=[this.data[t]]},this.updateLastPoint=function(t,e){var a=this.data.length-1;a<2&&(this.data[a]=t,this.points[a]=e,this.circles[a].points=[this.points[a]]),this.completeFigure(t,e)},this.moveTo=function(t,e,a){for(var i,s,r,n,o=0;o<this.points.length;o++)this.points[o].active&&(this.points.length<3?(this.points[o].x=a.x,this.points[o].y=a.y,this.data[o].d=a.dateSeconds,this.data[o].v=a.value):2===o?(s=this.points[o].y,i=this.data[o].v,this.points[o].x=this.points[1].x,this.points[o].y=a.y,this.data[o].d=this.data[1].d,this.data[o].v=a.value,this.points.length>3&&(s-=this.points[o].y,i-=this.data[o].v,this.points[3].y-=s,this.data[3].v-=i,this.circles[3].points=[this.points[3]],this.circles[3].data=[this.data[3]])):(this.points[o].x=a.x,this.points[o].y=a.y,this.data[o].d=a.dateSeconds,this.data[o].v=a.value,0===o?(r=this.points[1].y-this.points[0].y,n=this.data[1].v-this.data[0].v,this.points[3].y=parseFloat(this.points[2].y)+r,this.points[3].x=this.points[0].x,this.data[3].v=parseFloat(this.data[2].v)+n,this.data[3].d=this.data[0].d,this.circles[3].points=[this.points[3]],this.circles[3].data=[this.data[3]]):1===o?(r=this.points[1].y-this.points[0].y,n=this.data[1].v-this.data[0].v,this.points[2].y=parseFloat(this.points[3].y)-r,this.points[2].x=this.points[1].x,this.data[2].v=parseFloat(this.data[3].v)-n,this.data[2].d=this.data[1].d,this.circles[2].points=[this.points[2]],this.circles[2].data=[this.data[2]]):3===o&&(r=this.points[3].y-this.points[2].y,n=this.data[3].v-this.data[2].v,this.points[0].y=parseFloat(this.points[1].y)-r,this.points[0].x=this.points[3].x,this.data[0].v=parseFloat(this.data[1].v)-n,this.data[0].d=this.data[3].d,this.circles[0].points=[this.points[0]],this.circles[0].data=[this.data[0]])),this.circles[o].points=[this.points[o]],this.circles[o].data=[this.data[o]])},this.completeFigure=function(){if(!(this.points.length<3)){var t=this.points[1].y-this.points[0].y,e=this.points[2].y-this.points[1].y,a=this.points[0].x,i=this.points[1].x,s=parseFloat(this.points[0].y)+2*t+e,r=parseFloat(this.points[1].y)+e;this.points[2].x=i,this.points[2].y=r,this.data[2].d=this.data[1].d,this.data[2].v=this.chartData.chart.toYValue(r),this.points.push({x:a,y:s}),this.data.push({d:this.data[0].d,v:this.chartData.chart.toYValue(s)}),this.circles[2].data=[this.data[2]],this.circles[2].points=[this.points[2]],this.circles.push(new Circle(this.chartData,{data:[this.data[3]],points:[this.points[3]]})),this.draw(this.chartData.chart.canvasDrawingContext)}},this.parallelChannelUpdateCustomPropsByObj=this.updateCustomPropsByObj,this.updateCustomPropsByObj=function(t,e){this.parallelChannelUpdateCustomPropsByObj(t,e),t.textColor=e.textColor,t.textFamily=e.textFamily,t.textSize=e.textSize,t.textBold=e.textBold,t.textItalic=e.textItalic}}function FlatTopBottom(){arguments&&arguments.length&&DisjointAngle.apply(this,arguments),this.color="#800080",this.fillColor="#800080",this.opacity=.3,this.draw=function(t){if(this.chartData.techChart.charts.length>1)for(var e=0;e<this.chartData.techChart.charts.length;e++)this.points[1].y>this.chartData.techChart.charts[e].canvasDrawingActive.clientHeight&&(this.points[1].y=0,Line_Line.prototype.draw.apply(this,[t,this.points[0].x,this.points[1].x,this.points[0].y,this.points[1].y]));if(this.periods.length&&-1!==this.periods.indexOf(this.chartData.period))return!1;var a,i,s,r,n,o,h,c,l,d,p=this.points[0].x,u=this.points[1].x,g=this.points[0].y,v=this.points[1].y,f=LibDrawing_LibDrawing.findLineAngleDeg({x1:p,y1:g,x2:u,y2:v});if(l=this.getEndPoints(p,g,u,v,f),this.leftEndPoint=l.lep,this.rightEndPoint=l.rep,a=LibCanvas.getPosition(l.lep.x,this.width),i=LibCanvas.getPosition(l.rep.x,this.width),n=LibCanvas.getPosition(l.lep.y,this.width),o=LibCanvas.getPosition(l.rep.y,this.width),this.points.length<3)Line_Line.prototype.draw.apply(this,[t,a,i,n,o]);else if(3===this.points.length){var y=this.points[2].y-this.points[1].y;s=LibCanvas.getPosition(l.lep.x,this.width),r=LibCanvas.getPosition(l.rep.x,this.width),h=c=LibCanvas.getPosition(parseFloat(this.points[1].y)+y,this.width),s=(d=this.fixFlatLineEnds(s,r)).x2,r=d.x3,this.fill&&this.fillFigure(t,a,n,i,o,s,h,r,c),Line_Line.prototype.draw.apply(this,[t,a,i,n,o]),Line_Line.prototype.draw.apply(this,[t,s,r,h,c])}else s=LibCanvas.getPosition(l.rep.x,this.width),r=a,h=LibCanvas.getPosition(this.points[2].y,this.width),c=LibCanvas.getPosition(this.points[3].y,this.width),s=(d=this.fixFlatLineEnds(s,r)).x2,r=d.x3,this.fill&&this.fillFigure(t,a,n,i,o,r,c,s,h),Line_Line.prototype.draw.apply(this,[t,a,i,n,o]),Line_Line.prototype.draw.apply(this,[t,s,r,h,c]);return!0},this.moveTo=function(t,e,a){for(var i=0;i<this.points.length;i++)this.points[i].active&&(this.points.length<3?(this.points[i].x=a.x,this.points[i].y=a.y,this.data[i].d=a.dateSeconds,this.data[i].v=a.value):2===i?(this.points[i].x=this.points[1].x,this.points[i].y=a.y,this.data[i].d=this.data[1].d,this.data[i].v=a.value,this.points.length>3&&(this.points[3].y=this.points[i].y,this.data[3].v=this.data[i].v,this.circles[3].points=[this.points[3]],this.circles[3].data=[this.data[3]])):(this.points[i].x=a.x,this.data[i].d=a.dateSeconds,0===i?(this.points[i].y=a.y,this.data[i].v=a.value,this.points[3].y=this.points[2].y,this.points[3].x=this.points[0].x,this.data[3].v=this.data[2].v,this.data[3].d=this.data[2].d,this.circles[3].points=[this.points[3]],this.circles[3].data=[this.data[3]]):1===i?(this.points[i].y=a.y,this.data[i].v=a.value,this.points[2].x=this.points[1].x,this.data[2].d=this.data[1].d,this.circles[2].points=[this.points[2]],this.circles[2].data=[this.data[2]]):3===i&&(this.points[0].x=this.points[3].x,this.data[0].d=this.data[3].d,this.circles[0].points=[this.points[0]],this.circles[0].data=[this.data[0]])),this.circles[i].points=[this.points[i]],this.circles[i].data=[this.data[i]])},this.completeFigure=function(){if(!(this.points.length<3)){var t=this.points[2].y-this.points[1].y,e=this.points[0].x,a=this.points[1].x,i=parseFloat(this.points[1].y)+t,s=i;this.points[2].x=a,this.points[2].y=i,this.data[2].d=this.data[1].d,this.data[2].v=this.chartData.chart.toYValue(i),this.points.push({x:e,y:s}),this.data.push({d:this.data[0].d,v:this.data[2].v}),this.circles[2].data=[this.data[2]],this.circles[2].points=[this.points[2]],this.circles.push(new Circle(this.chartData,{data:[this.data[3]],points:[this.points[3]]})),this.draw(this.chartData.chart.canvasDrawingContext)}},this.disjointAngleUpdateByObject=this.updateByObject,this.updateByObject=function(t){this.disjointAngleUpdateByObject(t)}}function Polyline(){TrendLine.apply(this,arguments),this.color="#008000",this.fill=!0,this.fillColor="#e89a66",this.opacity=.3,this.rightEnd=!1,this.leftEnd=!1,this.drawingStage={current:0,max:100},this.isClosed=!1,this.draw=function(t){if(this.periods.length&&-1!==this.periods.indexOf(this.chartData.period))return!1;if(this.chartData.techChart.charts.length>1)for(var e=0;e<this.chartData.techChart.charts.length;e++)this.points[1].y>this.chartData.techChart.charts[e].canvasDrawingActive.clientHeight&&(this.points[1].y=0,Line_Line.prototype.draw.apply(this,[t,this.points[0].x,this.points[1].x,this.points[0].y,this.points[1].y]));if(this.isClosed){for(var a=[],i=0;i<this.points.length;i++)a.push([this.points[i].x,this.points[i].y]);this.fill?LibCanvas.drawPolygon(null,t,a,this.fillColor,this.color,!0,this.width,a.length,this.opacity,this.getLineTypeArray(this.lineType,this.width)):LibCanvas.drawPolygon(null,t,a,null,this.color,!0,this.width,a.length,this.opacity,this.getLineTypeArray(this.lineType,this.width))}else for(var s=0;s<this.points.length-1;s++){var r=this.points[s].x,n=this.points[s+1].x,o=this.points[s].y,h=this.points[s+1].y;r=LibCanvas.getPosition(r,this.width),o=LibCanvas.getPosition(o,this.width),n=LibCanvas.getPosition(n,this.width),h=LibCanvas.getPosition(h,this.width),LibCanvas.drawLine(null,t,r,o,n,h,this.color,this.getLineTypeArray(this.lineType,this.width),this.width,1),"edit"!==this.state&&"active"!==this.state||LibCanvas.drawLine(null,t,r,o,n,h,this.color,[],parseFloat(this.width)+10,.1)}if("edit"===this.state||"active"===this.state){for(var c=0;c<this.circles.length;c++)this.circles[c].points[0].active||this.circles[c].drawWithShadow(t,"white",this.color,.1);for(c=0;c<this.circles.length;c++)this.circles[c].points[0].active&&this.circles[c].drawWithShadow(t,"red",this.color,.1)}return!0},this.getStyleRows=function(){var t=Line_Line.prototype.getStyleRows.apply(this,arguments),e=[this.getBackgroundRow()];return t.concat(e)},this.updateLastPoint=function(t,e){this.isClosed=this.checkClosed(t,e),this.isClosed&&(this.drawingStage.current=100,t=DrawingObject.cloneObject(this.data[0]),e=DrawingObject.cloneObject(this.points[0]));var a=this.data.length-1;this.data[a]=t,this.points[a]=e,this.circles[a].points[0]=this.points[a]},this.updateLastPointForBreak=function(){this.drawingStage.current=100;var t=DrawingObject.cloneObject(this.data[0]),e=DrawingObject.cloneObject(this.points[0]),a=this.data.length-1;this.data[a]=t,this.points[a]=e,this.circles[a].points[0]=this.points[a],this.isClosed=!0},this.isFocused=function(t,e){if(this.periods.length&&-1!==this.periods.indexOf(this.chartData.period))return!1;this.isObjectEdit=!1,this.isChanged=!1;for(var a=!1,i=0,s=0;s<this.circles.length;s++){if(i++,LibDrawing_LibDrawing.isPointOnCircle(this.circles[s],{x:t,y:e})){this.circles[s].points[0].active=!0,this.points[s].active=!0,a=!0,this.isChanged=!0;break}this.circles[s].points[0].active=!1,this.points[s].active=!1}for(;i<this.circles.length;)this.circles[i].points[0].active=!1,this.points[i].active=!1,i++;if(this.circles[0].points[0].active&&this.isClosed&&(this.circles[this.circles.length-1].points[0].active=!0,this.points[this.circles.length-1].active=!0),a)return!0;for(var r=0;r<this.points.length-1;r++){var n=this.points[r].x,o=this.points[r+1].x,h=this.points[r].y,c=this.points[r+1].y;if(LibDrawing_LibDrawing.isPointOnLine({x1:n,x2:o,y1:h,y2:c},{x:t,y:e})){for(var l=0;l<this.points.length;l++)this.points[l].active=!0,this.circles&&this.circles[l]&&(this.circles[l].points[0].active=!0);this.isObjectEdit=!0,a=!0}}return a},this.trendLineUpdateCustomPropsByObj=this.updateCustomPropsByObj,this.updateCustomPropsByObj=function(t,e){this.trendLineUpdateCustomPropsByObj(t,e),t.isClosed=e.isClosed,t.fill=e.fill,t.fillColor=e.fillColor}}function Rectangle(){TrendLine.apply(this,arguments),this.circles=[],this.circles.push(new Circle(this.chartData,{data:[this.data[0]],points:[this.points[0]]})),this.circles.push(new Circle(this.chartData,{data:[this.data[1]],points:[this.points[1]]})),this.color="#008000",this.rightEnd=!1,this.leftEnd=!1,this.heightData={v:0,y:0},this.fill=!0,this.fillColor="#0000ff",this.opacity=.1,this.trendLineIsFocused=this.isFocused,this.isFocused=function(t,e){if(this.trendLineIsFocused(t,e))return!0;this.isObjectEdit=!1;var a=this.getPosition(),i=LibDrawing_LibDrawing.isPointOnLine({x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2},{x:t,y:e}),s=LibDrawing_LibDrawing.isPointOnLine({x1:a.x2,x2:a.x3,y1:a.y2,y2:a.y3},{x:t,y:e}),r=LibDrawing_LibDrawing.isPointOnLine({x1:a.x3,x2:a.x0,y1:a.y3,y2:a.y0},{x:t,y:e});if(i||s||r){for(var n=0;n<this.points.length;n++)this.points[n].active=!0,this.circles&&this.circles[n]&&(this.circles[n].points[0].active=!0);return this.isObjectEdit=!0,!0}return!1},this.draw=function(t){if(this.periods.length&&-1!==this.periods.indexOf(this.chartData.period))return!1;2===this.circles.length&&this.addPoints();var e=this.getPosition();if(this.fill){var a=[];a.push([e.x0,e.y0]),a.push([e.x1,e.y1]),a.push([e.x2,e.y2]),a.push([e.x3,e.y3]),LibCanvas.drawPolygon(null,t,a,this.fillColor,!1,!0,0,4,this.opacity)}return t.lineCap="round",Line_Line.prototype.draw.apply(this,[t,e.x0,e.x1,e.y0,e.y1]),Line_Line.prototype.draw.apply(this,[t,e.x1,e.x2,e.y1,e.y2]),Line_Line.prototype.draw.apply(this,[t,e.x2,e.x3,e.y2,e.y3]),Line_Line.prototype.draw.apply(this,[t,e.x3,e.x0,e.y3,e.y0]),t.lineCap="butt",!0},this.moveTo=function(t,e,a){for(var i=0;i<this.points.length;i++)this.points[i].active&&(this.points[i].x=a.x,this.points[i].y=a.y,this.data[i].d=a.dateSeconds,this.data[i].v=a.value,this.circles[i].points=[this.points[i]],this.circles[i].data=[this.data[i]],0!==i&&2!==i||!this.points[2]?this.points[2]&&(this.recountPoint(2,3,1),this.recountPoint(0,1,3)):(this.recountPoint(1,0,2),this.recountPoint(3,2,0)))},this.recountPoint=function(t,e,a){this.points[t].x=this.points[e].x,this.points[t].y=this.points[a].y,this.data[t].d=this.data[e].d,this.data[t].v=this.data[a].v,this.circles[t].points=[this.points[t]],this.circles[t].data=[this.data[t]]},this.updateLastPoint=function(){},this.addPoints=function(){var t,e,a,i,s,r;t=this.points[0],a=this.points[1],e={x:t.x,y:a.y},i={x:a.x,y:t.y},s={d:this.chartData.chart.toXValue(e.x),v:this.chartData.chart.toYValue(e.y)},r={d:this.chartData.chart.toXValue(i.x),v:this.chartData.chart.toYValue(i.y)},this.data[2]=this.data[1],this.points[2]=this.points[1],this.data[1]=s,this.points[1]=e,this.data.push(r),this.points.push(i),this.circles.push(new Circle(this.chartData,{data:[this.data[2]],points:[this.points[2]]})),this.circles.push(new Circle(this.chartData,{data:[this.data[3]],points:[this.points[3]]}))},this.getStyleRows=function(){var t=Line_Line.prototype.getStyleRows.apply(this,arguments),e=[this.getBackgroundRow()];return t.concat(e)},this.trendLineUpdateCustomPropsByObj=this.updateCustomPropsByObj,this.updateCustomPropsByObj=function(t,e){this.trendLineUpdateCustomPropsByObj(t,e),t.fill=e.fill,t.fillColor=e.fillColor},this.getPosition=function(){return{x0:LibCanvas.getPosition(this.points[0].x,this.width),x1:LibCanvas.getPosition(this.points[1].x,this.width),x2:LibCanvas.getPosition(this.points[2].x,this.width),x3:LibCanvas.getPosition(this.points[3].x,this.width),y0:LibCanvas.getPosition(this.points[0].y,this.width),y1:LibCanvas.getPosition(this.points[1].y,this.width),y2:LibCanvas.getPosition(this.points[2].y,this.width),y3:LibCanvas.getPosition(this.points[3].y,this.width)}}}function Curve(){arguments&&arguments.length&&TrendLine.apply(this,arguments),this.drawingStage={current:0,max:1},this.color="#0000FF",this.width=1,this.state="edit",this.height=50,this.t=.5,this.lineType="normal",this.name="curve",this.trendLineIsFocused=this.isFocused,this.isFocused=function(t,e){if(this.isChanged=!1,this.isFocusedOnCircles(t,e))return this.isChanged=!0,!0;if(this.drawingStage.current>0){var a=this.getPosition(),i={x:a.x0,y:a.y0},s={x:a.x2,y:a.y2},r={x:a.x1,y:a.y1},n=LibDrawing_LibDrawing.getControlPoint(.5,i,s,r),o={x:[a.x0,n.x,a.x1],y:[a.y0,n.y,a.y1]};if(LibDrawing_LibDrawing.isPointInPolygon(t,e,o)&&this.arePointsOnCurve(i,n,r,.1,t,e)){for(var h=0;h<this.points.length;h++)this.points[h].active=!0,this.circles&&this.circles[h]&&(this.circles[h].points[0].active=!0);return this.isObjectEdit=!0,!0}return!1}},this.draw=function(t){if(this.periods.length&&-1!==this.periods.indexOf(this.chartData.period))return!1;var e,a,i;a=LibCanvas.getPosition(this.points[0].x,this.width),i=LibCanvas.getPosition(this.points[1].x,this.width);var s={x:a,y:LibCanvas.getPosition(this.points[0].y,this.width)},r={x:i,y:LibCanvas.getPosition(this.points[1].y,this.width)};e=this.points.length<3?this.getPeekPoint():{x:this.points[2].x,y:this.points[2].y};var n=LibDrawing_LibDrawing.getControlPoint(this.t,s,e,r);if(this.chartData.techChart.charts.length>1)for(var o=0;o<this.chartData.techChart.charts.length;o++)r.y>this.chartData.techChart.charts[o].canvasDrawingActive.clientHeight&&(r.y=0,LibCanvas.drawQuadraticCurve(null,t,s,n,r,this.t,"transparent",this.color,this.width,1,this.getLineTypeArray(this.lineType,this.width)));if(LibCanvas.drawQuadraticCurve(null,t,s,n,r,this.t,"transparent",this.color,this.width,1,this.getLineTypeArray(this.lineType,this.width)),"edit"===this.state||"active"===this.state){for(var h=0;h<this.circles.length;h++)this.circles[h].points[0].active||this.circles[h].drawWithShadow(t,"white",this.color,.1);for(h=0;h<this.circles.length;h++)this.circles[h].points[0].active&&this.circles[h].drawWithShadow(t,"red",this.color,.1)}},this.updateLastPoint=function(t,e){var a=this.data.length-1;this.data[a]=t,this.points[a]=e,this.circles[a].points[0]=this.points[a];var i=this.getPeekPoint();this.points[2]=i,this.data[2]={},this.data[2].d=this.chartData.chart.toXValue(this.points[2].x),this.data[2].v=this.chartData.chart.toYValue(this.points[2].y),this.circles.push(new Circle(this.chartData,{data:[this.data[2]],points:[this.points[2]]}))},this.lineGetStyleRows=this.getStyleRows,this.getStyleRows=function(){return TrendLine.prototype.getStyleRows.apply(this,arguments).concat([])}}function Triangle(){arguments&&arguments.length&&TrendLine.apply(this,arguments),this.color="#008000",this.drawingStage={current:0,max:2},this.heightData={v:0,y:0},this.fill=!0,this.fillColor="#0000ff",this.rightEnd=!1,this.leftEnd=!1,this.opacity=.1,this.trendLineIsFocused=this.isFocused,this.lineType="normal",this.isFocused=function(t,e){if(this.trendLineIsFocused(t,e))return!0;this.isChanged=!1;var a=this.getPosition(),i=LibDrawing_LibDrawing.isPointOnLine({x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2},{x:t,y:e}),s=LibDrawing_LibDrawing.isPointOnLine({x1:a.x0,x2:a.x2,y1:a.y0,y2:a.y2},{x:t,y:e});if(i||s){for(var r=0;r<this.points.length;r++)this.points[r].active=!0;return this.isObjectEdit=!0,this.isChanged=!0,!0}return!1},this.draw=function(t){if(this.periods.length&&-1!==this.periods.indexOf(this.chartData.period))return!1;var e=this.getPosition();if(this.drawingStage.current>1){e=this.getPosition();var a=[];if(a.push([e.x0,e.y0]),a.push([e.x1,e.y1]),a.push([e.x2,e.y2]),this.fill?LibCanvas.drawPolygon(null,t,a,this.fillColor,this.color,!0,this.width,3,this.opacity,this.getLineTypeArray(this.lineType,this.width)):LibCanvas.drawPolygon(null,t,a,null,this.color,!0,this.width,3,this.opacity,this.getLineTypeArray(this.lineType,this.width)),"edit"===this.state||"active"===this.state)for(var i=0;i<this.circles.length;i++){var s=this.circles[i].points[0].active?"red":"white";this.circles[i].drawWithShadow(t,s,this.color,.1)}}else{if(this.chartData.techChart.charts.length>1)for(var r=0;r<this.chartData.techChart.charts.length;r++)e.y1>this.chartData.techChart.charts[r].canvasDrawingActive.clientHeight&&(e.y1=0);Line_Line.prototype.draw.apply(this,[t,e.x0,e.x1,e.y0,e.y1])}return!0},this.getStyleRows=function(){var t=Line_Line.prototype.getStyleRows.apply(this,arguments),e=[this.getBackgroundRow()];return t.concat(e)},this.trendLineUpdateCustomPropsByObj=this.updateCustomPropsByObj,this.updateCustomPropsByObj=function(t,e){this.trendLineUpdateCustomPropsByObj(t,e),t.fill=e.fill,t.fillColor=e.fillColor},this.getPosition=function(){var t=LibCanvas.getPosition(this.points[0].x,this.width),e=LibCanvas.getPosition(this.points[1].x,this.width),a=LibCanvas.getPosition(this.points[0].y,this.width),i=LibCanvas.getPosition(this.points[1].y,this.width);if(this.points[2])var s=LibCanvas.getPosition(this.points[2].x,this.width),r=LibCanvas.getPosition(this.points[2].y,this.width);return{x0:t,x1:e,x2:s,y0:a,y1:i,y2:r}}}function RotatedRect(){arguments&&arguments.length&&TrendLine.apply(this,arguments),this.drawingStage={current:0,max:2},this.color="#5c126d",this.fill=!0,this.fillColor="#c842f4",this.opacity=.3,this.height=0,this.lineType="normal",this.width=6,this.isFocused=function(t,e){if(this.periods.length&&-1!==this.periods.indexOf(this.chartData.period))return!1;this.isObjectEdit=!1,this.isChanged=!1;for(var a=!1,i=0,s=0;s<this.circles.length;s++){if(i++,LibDrawing_LibDrawing.isPointOnCircle(this.circles[s],{x:t,y:e})){this.circles[s].points[0].active=!0,this.points[s].active=!0,a=!0,this.isChanged=!0;break}this.circles[s].points[0].active=!1,this.points[s].active=!1}for(;i<this.circles.length;)this.circles[i].points[0].active=!1,this.points[i].active=!1,i++;if(a)return!0;if(this.drawingStage.current>2){var r=this.getPositions(),n=LibDrawing_LibDrawing.isPointOnLine({x1:r.x2,y1:r.y2,x2:r.x3,y2:r.y3},{x:t,y:e}),o=LibDrawing_LibDrawing.isPointOnLine({x1:r.x3,y1:r.y3,x2:r.x5,y2:r.y5},{x:t,y:e}),h=LibDrawing_LibDrawing.isPointOnLine({x1:r.x5,y1:r.y5,x2:r.x4,y2:r.y4},{x:t,y:e}),c=LibDrawing_LibDrawing.isPointOnLine({x1:r.x4,y1:r.y4,x2:r.x2,y2:r.y2},{x:t,y:e});if(n||o||h||c){for(var l=0;l<this.points.length;l++)this.points[l].active=!0,this.circles&&this.circles[l]&&(this.circles[l].points[0].active=!0);return this.isObjectEdit=!0,!0}return!1}},this.moveTo=function(t,e,a){for(var i=0;i<this.points.length;i++)if(this.points[i].active)if(this.points.length<3)this.points[i].x=a.x,this.points[i].y=a.y,this.data[i].d=a.dateSeconds,this.data[i].v=a.value,this.circles[i].points=[this.points[i]],this.circles[i].data=[this.data[i]];else if(2===i||3===i||4===i||5===i)this.movePoints(a);else{this.points[i].x=a.x,this.points[i].y=a.y,this.data[i].d=a.dateSeconds,this.data[i].v=a.value,this.circles[i].points=[this.points[i]],this.circles[i].data=[this.data[i]];var s={x1:this.points[0].x,y1:this.points[0].y,x2:this.points[1].x,y2:this.points[1].y},r=this.getTopLeftData(s,this.height,null,!0);this.points[2].x=r.x,this.points[2].y=r.y,this.data[2].d=this.chartData.chart.toXValue(this.points[2].x),this.data[2].v=this.chartData.chart.toYValue(this.points[2].y),this.circles[2].points=[this.points[2]],this.circles[2].data=[this.data[2]];var n=this.getTopRightData(s,this.height,null,!0);this.points[3].x=n.x,this.points[3].y=n.y,this.data[3].d=this.chartData.chart.toXValue(this.points[3].x),this.data[3].v=this.chartData.chart.toYValue(this.points[3].y),this.circles[3].points=[this.points[3]],this.circles[3].data=[this.data[3]];var o=this.getTopLeftData(s,this.height,null,!1);this.points[4].x=o.x,this.points[4].y=o.y,this.data[4].d=this.chartData.chart.toXValue(this.points[4].x),this.data[4].v=this.chartData.chart.toYValue(this.points[4].y),this.circles[4].points=[this.points[4]],this.circles[4].data=[this.data[4]];var h=this.getTopRightData(s,this.height,null,!1);this.points[5].x=h.x,this.points[5].y=h.y,this.data[5].d=this.chartData.chart.toXValue(this.points[5].x),this.data[5].v=this.chartData.chart.toYValue(this.points[5].y),this.circles[5].points=[this.points[5]],this.circles[5].data=[this.data[5]]}},this.updatePixels=function(){if(!this.isPressed)for(var t=0;t<this.points.length;t++)if(0===t||1===t)this.points[t].x=this.chartData.chart.toXPixels(this.data[t].d),this.points[t].y=this.chartData.chart.toYPixels(this.data[t].v),this.circles[t].points=[this.points[t]],this.circles[t].data=[this.data[t]];else if(this.points.length>2){var e={x1:this.points[0].x,y1:this.points[0].y,x2:this.points[1].x,y2:this.points[1].y},a={};if(2===t){a.x=this.chartData.chart.toXPixels(this.data[t].d),a.y=this.chartData.chart.toYPixels(this.data[t].v);var i=this.getTopLeftData(e,this.height,!1,!0);this.points[t].x=i.x,this.points[t].y=i.y,this.data[t].d=this.chartData.chart.toXValue(this.points[t].x),this.data[t].v=this.chartData.chart.toYValue(this.points[t].y),this.circles[t].points=[this.points[t]],this.circles[t].data=[this.data[t]]}else if(3===t){a.x=this.chartData.chart.toXPixels(this.data[t].d),a.y=this.chartData.chart.toYPixels(this.data[t].v);var s=this.getTopRightData(e,this.height,!1,!0);this.points[t].x=s.x,this.points[t].y=s.y,this.data[t].d=this.chartData.chart.toXValue(this.points[t].x),this.data[t].v=this.chartData.chart.toYValue(this.points[t].y),this.circles[t].points=[this.points[t]],this.circles[t].data=[this.data[t]]}else if(4===t){a.x=this.chartData.chart.toXPixels(this.data[t].d),a.y=this.chartData.chart.toYPixels(this.data[t].v);var r=this.getTopLeftData(e,this.height,!1,!1);this.points[t].x=r.x,this.points[t].y=r.y,this.data[t].d=this.chartData.chart.toXValue(this.points[t].x),this.data[t].v=this.chartData.chart.toYValue(this.points[t].y),this.circles[t].points=[this.points[t]],this.circles[t].data=[this.data[t]]}else if(5===t){a.x=this.chartData.chart.toXPixels(this.data[t].d),a.y=this.chartData.chart.toYPixels(this.data[t].v);var n=this.getTopRightData(e,this.height,!1,!1);this.points[t].x=n.x,this.points[t].y=n.y,this.data[t].d=this.chartData.chart.toXValue(this.points[t].x),this.data[t].v=this.chartData.chart.toYValue(this.points[t].y),this.circles[t].points=[this.points[t]],this.circles[t].data=[this.data[t]]}}},this.appendPoint=function(){this.points.push({x:parseFloat(this.points[0].x),y:parseFloat(this.points[0].y),active:!0}),this.data.push({d:this.data[0].d,v:this.data[0].v}),this.circles.push(new Circle(this.chartData,{data:[this.data[2]],points:[this.points[2]]})),this.points.push({x:parseFloat(this.points[1].x),y:parseFloat(this.points[1].y),active:!0}),this.data.push({d:this.data[1].d,v:this.data[1].v}),this.circles.push(new Circle(this.chartData,{data:[this.data[3]],points:[this.points[3]]})),this.points.push({x:parseFloat(this.points[0].x),y:parseFloat(this.points[0].y),active:!0}),this.data.push({d:this.data[0].d,v:this.data[0].v}),this.circles.push(new Circle(this.chartData,{data:[this.data[4]],points:[this.points[4]]})),this.points.push({x:parseFloat(this.points[1].x),y:parseFloat(this.points[1].y),active:!0}),this.data.push({d:this.data[1].d,v:this.data[1].v}),this.circles.push(new Circle(this.chartData,{data:[this.data[5]],points:[this.points[5]]}))},this.updateLastPoint=function(t,e){var a=this.data.length-1;a<2&&(this.data[a]=t,this.points[a]=e,this.circles[a].points=[this.points[a]])},this.draw=function(t){if(this.periods.length&&-1!==this.periods.indexOf(this.chartData.period))return!1;var e={};if(this.drawingStage.current<2){if(e=this.getPositions(),this.chartData.techChart.charts.length>1)for(var a=0;a<this.chartData.techChart.charts.length;a++)e.y1>this.chartData.techChart.charts[a].canvasDrawingActive.clientHeight&&(e.y1=0);LibCanvas.drawLine(null,t,e.x0,e.y0,e.x1,e.y1,this.color,this.getLineTypeArray(this.lineType,this.width),this.width,this.opacity)}if(this.drawingStage.current>=2){if(e=this.getPositions(),this.fill){var i=[];i.push([e.x2,e.y2]),i.push([e.x3,e.y3]),i.push([e.x5,e.y5]),i.push([e.x4,e.y4]),LibCanvas.drawPolygon(null,t,i,this.fillColor,!1,!0,0,4,this.opacity,null)}t.lineCap="round",LibCanvas.drawLine(null,t,e.x4,e.y4,e.x2,e.y2,this.color,this.getLineTypeArray(this.lineType,this.width),this.width,this.opacity),LibCanvas.drawLine(null,t,e.x2,e.y2,e.x3,e.y3,this.color,this.getLineTypeArray(this.lineType,this.width),this.width,this.opacity),LibCanvas.drawLine(null,t,e.x3,e.y3,e.x5,e.y5,this.color,this.getLineTypeArray(this.lineType,this.width),this.width,this.opacity),LibCanvas.drawLine(null,t,e.x5,e.y5,e.x4,e.y4,this.color,this.getLineTypeArray(this.lineType,this.width),this.width,this.opacity),t.lineCap="butt"}if("edit"===this.state||"active"===this.state){for(var s=0;s<this.circles.length;s++)this.circles[s].points[0].active||this.circles[s].drawWithShadow(t,"white",this.color,.1);for(var r=0;r<this.circles.length;r++)this.circles[r].points[0].active&&this.circles[r].drawWithShadow(t,"red",this.color,.1)}return!0},this.getStyleRows=function(){var t=Line_Line.prototype.getStyleRows.apply(this,arguments),e=[this.getBackgroundRow()];return t.concat(e)},this.trendLineConvertToDTO=this.convertToDTO,this.convertToDTO=function(){var t=this.trendLineConvertToDTO();return this.updateCustomPropsByObj(t,this),t},this.trendLineApplyRestoredParams=this.applyRestoredParams,this.applyRestoredParams=function(t){this.trendLineApplyRestoredParams(t),this.updateCustomPropsByObj(this,t)},this.trendLineUpdateCustomPropsByObj=this.updateCustomPropsByObj,this.updateCustomPropsByObj=function(t,e){this.trendLineUpdateCustomPropsByObj(t,e),t.height=DrawingObject.cloneObject(e.height),t.fill=e.fill,t.fillColor=e.fillColor,t.opacity=e.opacity,t.lineType=e.lineType,t.width=e.width}}function Arc(){arguments&&arguments.length&&TrendLine.apply(this,arguments),this.drawingStage={current:0,max:2},this.color="#ef680e",this.fill=!0,this.fillColor="#e89a66",this.width=1,this.opacity=.3,this.height=0,this.lineType="normal",this.isFocused=function(t,e){if(this.periods.length&&-1!==this.periods.indexOf(this.chartData.period))return!1;this.isObjectEdit=!1,this.isChanged=!1;for(var a=!1,i=0,s=0;s<this.circles.length;s++){if(i++,LibDrawing_LibDrawing.isPointOnCircle(this.circles[s],{x:t,y:e})){this.circles[s].points[0].active=!0,this.points[s].active=!0,this.opacity=.6,a=!0,this.isChanged=!0;break}this.circles[s].points[0].active=!1,this.points[s].active=!1,this.opacity=.3}for(;i<this.circles.length;)this.circles[i].points[0].active=!1,this.points[i].active=!1,i++;if(a)return!0;if(this.drawingStage.current>2){var r=this.getPositions(),n=this.getPoints(),o=LibDrawing_LibDrawing.getControlPoint(.5,n.p0,n.middlePoint,n.p2),h={x:[r.x0,n.p4.x,n.p5.x,r.x1],y:[r.y0,n.p4.y,n.p5.y,r.y1]};if(LibDrawing_LibDrawing.isPointInPolygon(t,e,h)&&LibDrawing_LibDrawing.arePointsOnBezier(n.p0,o,n.p2,.1,t,e)){for(var c=0;c<this.points.length;c++)this.points[c].active=!0,this.circles&&this.circles[c]&&(this.circles[c].points[0].active=!0),this.opacity=.6;this.isObjectEdit=!0,a=!0}return a}},this.moveTo=function(t,e,a){for(var i,s,r,n=0;n<this.points.length;n++)this.points[n].active&&(this.points.length<3?(this.points[n].x=a.x,this.points[n].y=a.y,this.data[n].d=a.dateSeconds,this.data[n].v=a.value,this.circles[n].points=[this.points[n]],this.circles[n].data=[this.data[n]]):2===n?(i={x1:this.points[0].x,y1:this.points[0].y,x2:this.points[1].x,y2:this.points[1].y},s={x:a.x,y:a.y},r=this.getTopData(i,!1,s),this.height=r.h,this.points[n].x=r.x,this.points[n].y=r.y,this.data[n].d=this.chartData.chart.toXValue(this.points[n].x),this.data[n].v=this.chartData.chart.toYValue(this.points[n].y),this.circles[n].points=[this.points[n]],this.circles[n].data=[this.data[n]]):(this.points[n].x=a.x,this.points[n].y=a.y,this.data[n].d=a.dateSeconds,this.data[n].v=a.value,this.circles[n].points=[this.points[n]],this.circles[n].data=[this.data[n]],i={x1:this.points[0].x,y1:this.points[0].y,x2:this.points[1].x,y2:this.points[1].y},s={x:a.x,y:a.y},r=this.getTopData(i,this.height),this.points[2].x=r.x,this.points[2].y=r.y,this.circles[2].points=[this.points[2]],this.data[2].d=this.chartData.chart.toXValue(this.points[2].x),this.data[2].v=this.chartData.chart.toYValue(this.points[2].y),this.circles[2].data=[this.data[2]]))},this.updatePixels=function(){if(!this.isPressed)for(var t=0;t<this.points.length;t++)if(2!==t)this.points[t].x=this.chartData.chart.toXPixels(this.data[t].d),this.points[t].y=this.chartData.chart.toYPixels(this.data[t].v),this.circles[t].points=[this.points[t]],this.circles[t].data=[this.data[t]];else if(this.points.length>2){var e={x1:this.points[0].x,y1:this.points[0].y,x2:this.points[1].x,y2:this.points[1].y},a={};a.x=this.chartData.chart.toXPixels(this.data[2].d),a.y=this.chartData.chart.toYPixels(this.data[2].v);var i=this.getTopData(e,!1,a);this.height=i.h,this.points[t].x=i.x,this.points[t].y=i.y,this.data[t].d=this.chartData.chart.toXValue(this.points[t].x),this.data[t].v=this.chartData.chart.toYValue(this.points[t].y),this.circles[t].points=[this.points[t]],this.circles[t].data=[this.data[t]]}},this.appendPoint=function(t,e){var a={v:t.v-this.data[1].v,y:this.points[1].y-e.y},i=this.getMiddleData(this.data[0],this.data[1]),s=this.getMiddlePoint(this.points[0],this.points[1]),r=s.x,n=parseFloat(s.y)-parseFloat(a.y),o=i.d,h=parseFloat(i.v)+parseFloat(a.v);this.points.push({x:r,y:n,active:!0}),this.data.push({d:o,v:h}),this.circles.push(new Circle(this.chartData,{data:[this.data[2]],points:[this.points[2]]}))},this.updateLastPoint=function(t,e){var a=this.data.length-1;a<2&&(this.data[a]=t,this.points[a]=e,this.circles[a].points=[this.points[a]])},this.draw=function(t){if(this.periods.length&&-1!==this.periods.indexOf(this.chartData.period))return!1;if(this.drawingStage.current<2){var e=this.getPositions();if(this.chartData.techChart.charts.length>1)for(var a=0;a<this.chartData.techChart.charts.length;a++)e.y1>this.chartData.techChart.charts[a].canvasDrawingActive.clientHeight&&(e.y1=0);LibCanvas.drawLine(null,t,e.x0,e.y0,e.x1,e.y1,this.color,this.getLineTypeArray(this.lineType,this.width),this.width,this.opacity)}var i=this.getPoints(),s=LibDrawing_LibDrawing.getControlPoint(.5,i.p0,i.middlePoint,i.p2);if(this.drawingStage.current>=2&&(this.fill?LibCanvas.drawQuadraticCurve(null,t,i.p0,s,i.p2,.5,this.fillColor,this.color,this.width,this.opacity,this.getLineTypeArray(this.lineType,this.width)):LibCanvas.drawQuadraticCurve(null,t,i.p0,s,i.p2,.5,"transparent",this.color,this.width,this.opacity,this.getLineTypeArray(this.lineType,this.width))),"edit"===this.state||"active"===this.state){for(var r=0;r<this.circles.length;r++)this.circles[r].points[0].active||this.circles[r].drawWithShadow(t,"white",this.color,.1);for(var n=0;n<this.circles.length;n++)this.circles[n].points[0].active&&this.circles[n].drawWithShadow(t,"red",this.color,.1)}return!0},this.getStyleRows=function(){var t=Line_Line.prototype.getStyleRows.apply(this,arguments),e=[this.getBackgroundRow()];return t.concat(e)},this.trendLineConvertToDTO=this.convertToDTO,this.convertToDTO=function(){var t=this.trendLineConvertToDTO();return this.updateCustomPropsByObj(t,this),t},this.trendLineApplyRestoredParams=this.applyRestoredParams,this.applyRestoredParams=function(t){this.trendLineApplyRestoredParams(t),this.updateCustomPropsByObj(this,t)},this.trendLineUpdateCustomPropsByObj=this.updateCustomPropsByObj,this.updateCustomPropsByObj=function(t,e){this.trendLineUpdateCustomPropsByObj(t,e),t.color=e.color,t.fill=e.fill,t.fillColor=e.fillColor,t.width=e.width,t.opacity=e.opacity,t.height=DrawingObject.cloneObject(e.height),t.lineType=e.lineType}}function Axis(t,e,a,i,s,r,n,o,h,c,l){this.value=t,this.x1=e,this.y1=a,this.x2=i,this.y2=s,this.lineClass=r,this.textX=parseFloat(n).toFixed(1),this.textY=parseFloat(o).toFixed(1),this.textClass=h,this.date=c,this.Mmmdd=l}function Brush(t,e){arguments&&arguments.length&&Line_Line.apply(this,arguments),this.points=[e.points[0]],this.data=[e.data[0]],this.drawingStage={current:0,max:1},this.circles=[],this.color="#2c2d2d",this.tmpPoint=null,this.controlPoints=[],this.width=2,this.t=.5,this.radius=7,this.lineType="normal",this.extremePoints={},this.extremeData={},this.isFocused=function(t,e){if(this.periods.length&&-1!==this.periods.indexOf(this.chartData.period))return!1;var a=!1;if(this.isObjectEdit=!1,this.isChanged=!1,this.isFocusedOnCircles(t,e)&&(a=!0,this.isChanged=!0),a||this.isPointInsideExtremePoints(t,e)&&this.isPointOnBrush(t,e)){for(var i=0;i<this.points.length;i++)this.points[i].active=!0;return this.circles[0].points[0].active=!0,this.circles[1].points[0].active=!0,this.isObjectEdit=!0,!0}for(i=0;i<this.points.length;i++)this.points[i].active=!0;return this.circles[0].points[0].active=!1,this.circles[1].points[0].active=!1,this.isObjectEdit=!1,!1},this.twoPointsDistance=function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},this.twoPointsVector=function(t,e){return[e.x-t.x,e.y-t.y]},this.calculateControlPoints=function(t,e,a){var i=this.twoPointsVector(t,a),s=this.twoPointsDistance(t,e),r=this.twoPointsDistance(e,a),n=s+r;return[{x:e.x-i[0]*this.t*s/n,y:e.y-i[1]*this.t*s/n},{x:e.x+i[0]*this.t*r/n,y:e.y+i[1]*this.t*r/n}]},this.updateControlPoints=function(){var t=this.points.slice();this.tmpPoint&&t.push(this.tmpPoint),this.controlPoints=[];for(var e=0;e<t.length-2;e+=1){var a=t[e]?t[e]:NaN,i=t[e+1]?t[e+1]:NaN,s=t[e+2]?t[e+2]:NaN;this.controlPoints=this.controlPoints.concat(this.calculateControlPoints(a,i,s))}},this.shiftTo=function(t,e,a,i,s){if(0!==e||0!==t){for(var r=0;r<this.points.length;r++)this.points[r].y-=e,this.points[r].x-=t,this.data[r].d-=i,this.data[r].v-=s;this.updateControlPoints(),this.circles[0].points[0]=this.points[0],this.circles[1].points[0]=this.points[this.points.length-1],this.extremePoints.bottom-=e,this.extremeData.bottom-=s,this.extremePoints.top-=e,this.extremeData.top-=s,this.extremePoints.left-=t,this.extremeData.left-=i,this.extremePoints.rigth-=t,this.extremeData.rigth-=i}},this.moveTo=function(t,e,a){if(!(this.drawingStage.current>1)){var i=this.points[this.points.length-1];Math.abs(i.x-t)>this.radius||Math.abs(i.y-a.y)>this.radius?(this.points.push({x:t,y:e}),this.data.push({d:a.dateSeconds,v:a.value}),this.tmpPoint=null):this.tmpPoint={x:t,y:e},this.updateControlPoints()}},this.updatePixels=function(){if(!this.isPressed){for(var t=0;t<this.points.length;t++)this.points[t].x=this.chartData.chart.toXPixels(this.data[t].d),this.points[t].y=this.chartData.chart.toYPixels(this.data[t].v);this.circles.length&&(this.circles[0].points[0]=this.points[0],this.circles[1].points[0]=this.points[this.points.length-1],this.restoreExtremePoints()),this.updateControlPoints()}},this.draw=function(t){if(this.periods.length&&-1!==this.periods.indexOf(this.chartData.period))return!1;var e=this.points.slice();if(this.tmpPoint&&e.push(this.tmpPoint),e.length<2)return!1;if(2===e.length)t.beginPath(),t.moveTo(e[0].x,e[0].y),t.lineTo(e[1].x,e[1].y),t.stroke();else{t.beginPath(),t.moveTo(e[0].x,e[0].y),t.quadraticCurveTo(this.controlPoints[0].x,this.controlPoints[0].y,e[1].x,e[1].y);for(var a=2;a<e.length-1;a+=1)t.bezierCurveTo(this.controlPoints[2*(a-1)-1].x,this.controlPoints[2*(a-1)-1].y,this.controlPoints[2*(a-1)].x,this.controlPoints[2*(a-1)].y,e[a].x,e[a].y);t.quadraticCurveTo(this.controlPoints[2*(a-1)-1].x,this.controlPoints[2*(a-1)-1].y,e[a].x,e[a].y),t.strokeStyle=this.color,t.lineWidth=this.width,t.setLineDash(this.getLineTypeArray(this.lineType,this.width)),t.stroke()}if("edit"===this.state||"active"===this.state)for(a=0;a<this.circles.length;a++)this.circles[a].points[0].active?this.circles[a].drawWithShadow(t,"red",this.color,.1):this.circles[a].drawWithShadow(t,"white",this.color,.1);return!0},this.findExtremePoints=function(){var t={x:parseInt(this.points[0].x),y:parseInt(this.points[0].y)},e=this.data[0];this.extremePoints={top:t.y,bottom:t.y,left:t.x,rigth:t.x},this.extremeData={top:e.v,bottom:e.v,left:e.d,rigth:e.d};for(var a=0;a<this.points.length;a++)this.extremePoints.bottom<this.points[a].y&&(this.extremePoints.bottom=this.points[a].y,this.extremeData.bottom=this.data[a].v),this.extremePoints.top>this.points[a].y&&(this.extremePoints.top=this.points[a].y,this.extremeData.top=this.data[a].v),this.extremePoints.left>this.points[a].x&&(this.extremePoints.left=this.points[a].x,this.extremeData.left=this.data[a].d),this.extremePoints.rigth<this.points[a].x&&(this.extremePoints.rigth=this.points[a].x,this.extremeData.rigth=this.data[a].d)},this.restoreExtremePoints=function(){this.extremePoints.bottom=this.chartData.chart.toYPixels(this.extremeData.bottom),this.extremePoints.top=this.chartData.chart.toYPixels(this.extremeData.top),this.extremePoints.left=this.chartData.chart.toXPixels(this.extremeData.left),this.extremePoints.rigth=this.chartData.chart.toXPixels(this.extremeData.rigth)},this.completeFigure=function(){if(!this.circles.length){if(this.drawingStage.current+=1,this.tmpPoint){this.points.push(this.tmpPoint);var t=this.chartData.chart.toXValue(this.tmpPoint.x),e=this.chartData.chart.toYValue(this.tmpPoint.y);this.data.push({d:t,v:e}),this.tmpPoint=null}if(1==this.points.length){var a={x:this.points[0].x,y:this.points[0].y},i={d:this.data[0].d,v:this.data[0].v};this.points.push(a),this.data.push(i)}this.findExtremePoints(),this.updateControlPoints(),this.circles.push(new Circle(this.chartData,{data:[this.data[0]],points:[this.points[0]]})),this.circles.push(new Circle(this.chartData,{data:[this.data[this.data.length-1]],points:[this.points[this.points.length-1]]}))}},this.getLineTypeArray=function(t,e){switch(t){case"normal":return[];case"dash":return[3*e,2*e];case"points":return[e,e];default:return[]}},this.isFocusedOnCircles=function(t,e){for(var a=0;a<this.circles.length;a++)if(LibDrawing_LibDrawing.isPointOnCircle(this.circles[a],{x:t,y:e}))return!0;return!1},this.isPointInsideExtremePoints=function(t,e){var a=this.extremePoints,i={x:[a.left-4,a.left-4,a.rigth+4,a.rigth+4],y:[a.bottom+4,a.top-4,a.top-4,a.bottom+4]};return!!LibDrawing_LibDrawing.isPointInPolygon(t,e,i)},this.isPointOnBrush=function(t,e){for(var a=this.points,i=1;i<this.points.length;i++)if(LibDrawing_LibDrawing.isPointOnLine({x1:a[i-1].x,x2:a[i].x,y1:a[i-1].y,y2:a[i].y},{x:t,y:e}))return!0;return!1},this.updateCustomPropsByObj=function(t,e){Line_Line.prototype.updateCustomPropsByObj.apply(this,arguments),t.extremeData=DrawingObject.cloneObject(e.extremeData)},this.lineConvertToDTO=this.convertToDTO,this.convertToDTO=function(){var t=this.lineConvertToDTO();return this.updateCustomPropsByObj(t,this),t}}function OscillatorChart(t,e,a){this.id=t,this.iniStr="<div class='tch-oscillator-data-panel'></div><canvas class='tch-chart-data-normal'></canvas><canvas class='tch-chart-data-pixelated'></canvas><div class='tch-chart-oscillator-rate-text-container'></div>",this.marginTop=20,this.marginBottom=20,this.dataPanelContainer,this.canvasDataNormal,this.canvasDataNormalContext,this.canvasDataPixelated,this.canvasDataPixelatedContext,this.scaleParams,this.chartData=e,this.w=a.w,this.h=a.h,this.top=a.top,this.name=a.name}function NewsBubble(){arguments&&arguments.length&&Bubble.apply(this,arguments),this.text="N",this.type="NewsBubble",this.showBubble=this.show,this.show=function(t){this.showBubble(t),this.divBubble.classList.toggle("tch-news-bubbles",!0)},this.getMaxItemsDate=function(){return Bubble.getDateNewsBubble(this.items[0])},this.getMinItemsDate=function(){return Bubble.getDateNewsBubble(this.items[this.items.length-1])}}function EventsBubble(){arguments&&arguments.length&&Bubble.apply(this,arguments),this.text="E",this.type="EventsBubble",this.showBubble=this.show,this.show=function(t){this.showBubble(t),this.divBubble.classList.toggle("tch-events-bubbles",!0)},this.getPositionTop=function(){return parseFloat(this.point.y)-4.5*this.radius-this.cY},this.getMaxItemsDate=function(){return Bubble.getDateEventsBubble(this.items[0])},this.getMinItemsDate=function(){return Bubble.getDateEventsBubble(this.items[this.items.length-1])}}function Bubble(t,e){this.chartData=t,this.items=e.items,this.id=e.id,this.parent=null,this.divBubble=null,this.date=e.date,this.value=e.value,this.point=e.point,this.cY=15,this.radius=8,this.fontSize=14,this.currentPageIndex=0,this.currentPage=1,this.candleWidth=this.chartData.candleWidth,this.tooltip=null}function Tooltip(t,e){this.chartData=t,this.bubble=e.bubble,this.bubble.tooltip=this}function TooltipEvents(){Tooltip.apply(this,arguments),this.getParentDiv=function(){return this.chartData.chart.parent.querySelector(".tch-events-tooltip-container")},this.reAppend=function(){this.parentDiv.appendChild(this.headerDiv),this.headerDiv.appendChild(this.dateDiv),1!==this.data.length&&(this.spansDiv||(this.createSpansDiv(),this.createSpans(),this.setSpansClasses()),this.headerDiv.appendChild(this.spansDiv),this.spansDiv.appendChild(this.leftArrowSpan),this.spansDiv.appendChild(this.pagesSpan),this.spansDiv.appendChild(this.rightArrowSpan)),this.parentDiv.appendChild(this.bodyDiv)},this.createBodyDiv=function(){this.bodyDiv=document.createElement("div"),this.parentDiv.appendChild(this.bodyDiv),this.bodyDiv.classList.toggle("tch-tooltip-body",!0),this.bodyDiv.appendChild(this.createTitle()),this.infoEventsDiv=this.createInfoEventsDiv(),this.bodyDiv.appendChild(this.infoEventsDiv)},this.createTitle=function(){return this.titleDiv=document.createElement("div"),this.titleDiv.classList.toggle("tch-events-tooltip-title",!0),this.titleDiv.innerHTML=this.getTitleText(this.data[this.bubble.currentPageIndex]),this.titleDiv},this.getTitleText=function(){var t=this.data[this.bubble.currentPageIndex],e=t.name;return t.link?"<a href='"+t.link+"' target='_blank'>"+e+"</a>":e},this.createInfoEventsDiv=function(){return this.infoEventDiv=document.createElement("div"),this.infoEventDiv.classList.toggle("tch-events-tooltip-infoEventDiv",!0),this.data[this.bubble.currentPageIndex].actual?this.infoEventDiv.classList.toggle("tch-hidden",!1):this.infoEventDiv.classList.toggle("tch-hidden",!0),this.infoEventDiv.appendChild(this.createNameEventDiv()),this.infoEventDiv.appendChild(this.createDataEventDiv()),this.imgEventParentDiv=document.createElement("div"),this.imgEventParentDiv.classList.toggle("tch-events-tooltip-imgEventParentDiv"),this.imgEventParentDiv.appendChild(this.createImgEventDiv()),this.infoEventDiv.appendChild(this.imgEventParentDiv),this.infoEventDiv},this.createNameEventDiv=function(){return this.nameEventDiv=document.createElement("div"),this.nameEventDiv.classList.toggle("tch-events-tooltip-nameEventDiv",!0),this.nameEventSpanActual=this.nameEventSpan("actual"),this.nameEventSpanPrevious=this.nameEventSpan("previous"),this.nameEventSpanConsensus=this.nameEventSpan("consensus"),this.nameEventDiv.appendChild(this.nameEventSpanActual),this.nameEventDiv.appendChild(this.nameEventSpanPrevious),this.nameEventDiv.appendChild(this.nameEventSpanConsensus),this.nameEventDiv},this.createImgEventDiv=function(){return this.imgEventDiv=document.createElement("div"),this.imgEventDiv.classList.toggle("tch-events-tooltip-imgEventDiv",!0),this.updateImgEventDiv(this.data[this.bubble.currentPageIndex]),this.imgEventDiv},this.createDataEventDiv=function(){return this.dataEventDiv=document.createElement("div"),this.dataEventDiv.classList.toggle("tch-events-tooltip-dataEventDiv",!0),this.dataEventSpanActual=this.dataEventSpan("actual"),this.dataEventSpanPrevious=this.dataEventSpan("previous"),this.dataEventSpanConsensus=this.dataEventSpan("consensus"),this.dataEventDiv.appendChild(this.dataEventSpanActual),this.dataEventDiv.appendChild(this.dataEventSpanPrevious),this.dataEventDiv.appendChild(this.dataEventSpanConsensus),this.dataEventDiv},this.dataEventSpan=function(t){return this.secondSpan=document.createElement("span"),this.secondSpan.innerHTML=this.data[this.bubble.currentPageIndex][t],this.secondSpan.classList.toggle("tch-events-tooltip-span-events",!0),this.secondSpan},this.nameEventSpan=function(t){return this.firstSpan=document.createElement("span"),this.firstSpan.innerHTML=t,this.firstSpan.classList.toggle("tch-events-tooltip-span-name",!0),this.firstSpan},this.updateImgEventDiv=function(){var t=this.data[this.bubble.currentPageIndex];this.imgEventDiv.classList.toggle("tch-events-tooltip-up-arrow",t.better),this.imgEventDiv.classList.toggle("tch-events-tooltip-down-arrow",t.worst)},this.updateInfo=function(){this.dataEventDiv.children[0].textContent=this.data[this.bubble.currentPageIndex].actual,this.dataEventDiv.children[1].textContent=this.data[this.bubble.currentPageIndex].previous,this.dataEventDiv.children[2].textContent=this.data[this.bubble.currentPageIndex].consensus,this.data[this.bubble.currentPageIndex].actual?this.infoEventDiv.classList.toggle("tch-hidden",!1):this.infoEventDiv.classList.toggle("tch-hidden",!0),this.titleDiv.innerHTML=this.getTitleText(),this.updateImgEventDiv()},this.processData=function(t){for(var e=[],a=0;a<t.length;a++){var i=this.getLinkHref(t[a]),s=TooltipEvents.processEventItem(t[a]);s.link=i,s.name=t[a].Name,s.date=new Date(t[a].DateTime.Date).toGMTString(),e.push(s)}return e}}function TooltipNews(){Tooltip.apply(this,arguments),this.getParentDiv=function(){return this.chartData.chart.parent.querySelector(".tch-news-tooltip-container")},this.reAppend=function(){this.parentDiv.appendChild(this.headerDiv),this.headerDiv.appendChild(this.dateDiv),1!==this.data.length&&(this.headerDiv.appendChild(this.spansDiv),this.spansDiv.appendChild(this.leftArrowSpan),this.spansDiv.appendChild(this.pagesSpan),this.spansDiv.appendChild(this.rightArrowSpan)),this.parentDiv.appendChild(this.bodyDiv),this.bodyDiv.appendChild(this.img),this.bodyDiv.appendChild(this.titleDiv),this.titleDiv.appendChild(this.link)},this.createBodyDiv=function(){this.bodyDiv=document.createElement("div"),this.parentDiv.appendChild(this.bodyDiv),this.bodyDiv.classList.toggle("tch-tooltip-body",!0),this.img=document.createElement("img"),this.bodyDiv.appendChild(this.img),this.img.classList.toggle("tch-news-tooltip-img",!0),this.img.src=this.data[this.bubble.currentPageIndex].img+"?size=tiny",this.img.align="left",this.titleDiv=document.createElement("div"),this.bodyDiv.appendChild(this.titleDiv),this.titleDiv.classList.toggle("tch-news-tooltip-title",!0),this.link=document.createElement("a"),this.titleDiv.appendChild(this.link),this.link.classList.toggle("tch-news-tooltip-link",!0),this.link.href=this.data[this.bubble.currentPageIndex].link,this.link.innerHTML=this.data[this.bubble.currentPageIndex].title,this.link.target="_blank"},this.updateInfo=function(){this.img.src=this.data[this.bubble.currentPageIndex].img+"?size=tiny",this.link.href=this.data[this.bubble.currentPageIndex].link,this.link.innerHTML=this.data[this.bubble.currentPageIndex].title},this.processData=function(t){for(var e=[],a=0;a<t.length;a++)e.push({id:t[a].ID,img:t[a].Image,link:t[a].Link,date:this.convertDateToGMT(t[a].PublishDate),title:t[a].Title});return e},this.convertDateToGMT=function(t){return new Date(1e3*t).toGMTString()}}function Signal(t,e){this.id=e.signal.id,this.chartData=t,this.data=e.signal,this.width=1,this.dirArrow={},this.predictionLines={color:"#4672aa"},this.patternEndTime,this.predictionArea={color:"rgba(50, 50, 50, 0.3)"},this.supportLine={start:{},end:{},color:"#4672aa"},this.resistanceLine={start:{},end:{},color:"#63b089"},this.moveX=function(t){this.predictionLines.start.x+=t,this.predictionLines.end.x+=t,this.supportLine.start.x+=t,this.supportLine.end.x+=t,this.dirArrow.start.x+=t,this.dirArrow.end.x+=t,this.predictionArea.x?this.predictionArea.x+=t:(this.predictionLines.support.start.x+=t,this.predictionLines.support.end.x+=t,this.predictionLines.resistance.start.x+=t,this.predictionLines.resistance.end.x+=t),this.patternEndTime+=t},this.shiftTo=function(t,e){this.moveX(t),this.predictionLines.start.y+=t,this.predictionLines.end.y+=t,this.supportLine.start.y+=t,this.supportLine.end.y+=t,this.dirArrow.start.y+=t,this.dirArrow.end.y+=t,this.predictionArea.y?this.predictionArea.y+=t:(this.predictionLines.support.start.y+=e,this.predictionLines.support.end.y+=e,this.predictionLines.resistance.start.y+=e,this.predictionLines.resistance.end.y+=e)}}function Roulete(t,e){Rectangle.apply(this,arguments),this.angleSpan=null,this.datadiv=null,this.datafordiv=null,this.drawingStage={current:0,max:2};var a=t.techChart.translation["bars-roulete"],i=t.techChart.translation["day-roulete"],s=t.techChart.translation["hour-roulete"],r=t.techChart.translation["minute-roulete"];this.draw=function(t){this.datadiv&&this.datadiv.remove();var e=this.getPosition();if(this.fill){var a=[];a.push([e.x0,e.y0]),a.push([e.x1,e.y1]),a.push([e.x2,e.y2]),a.push([e.x3,e.y3]),LibCanvas.drawPolygon(null,t,a,this.fillColor,!1,!0,0,4,this.opacity)}var i,s,r=(this.points[1].x-this.points[0].x)/2+parseFloat(this.points[0].x),n=(this.points[1].y-this.points[0].y)/2+parseFloat(this.points[0].y),o=LibCanvas.getPosition(r,this.width),h=LibCanvas.getPosition(n,this.width),c=LibCanvas.getPosition(e.x0,this.width),l=LibCanvas.getPosition(e.x2,this.width),d=LibCanvas.getPosition(e.y0,this.width),p=LibCanvas.getPosition(e.y1,this.width);return LibCanvas.drawLine(null,t,o,d,o,p,"#000000",[7,8],1,1),LibCanvas.drawLine(null,t,c,h,l,h,"#000000",[7,8],1,1),i=parseFloat(this.points[1].x)<parseFloat(this.points[0].x)?"down":"up",parseFloat(this.points[1].y)<parseFloat(this.points[0].y)?(s="up",parseFloat(this.points[1].y-50)):(s="down",parseFloat(this.points[1].y)),this.drawArrow(t,{x:e.x2,y:n},0,7,30,i),this.drawArrow(t,{x:r,y:this.points[1].y},90,7,30,s),this.datafordiv=this.dataCalculate(),this.createDiv(),parseFloat(this.points[1].y)<parseFloat(this.points[0].y)?this.datadiv.style.top=this.points[1].y-50+"px":this.datadiv.style.top=this.points[1].y+"px",this.datadiv.style.left=r-this.datadiv.getBoundingClientRect().width/2+"px",!0},this.dataCalculate=function(){this.result=[];var t=this.chartData.chart.toYValue(this.points[0].y),a=this.chartData.chart.toYValue(this.points[1].y),n=this.chartData.chart.toXValue(this.points[1].x),o=u.binaryIndexOfCandleByTime(e.data[0].d,this.chartData.data[this.chartData.typeData]),h=u.binaryIndexOfCandleByTime(n,this.chartData.data[this.chartData.typeData]);"undefined"!==h&&null!==h||(h=0),"undefined"!==o&&null!==o||(o=this.chartData.data[this.chartData.typeData].length-1-h),this.result[0]=a-t;var c=this.CountOfFixed(this.result[0]);this.result[0]=this.result[0].toFixed(c);var l=this.chartData.data[this.chartData.typeData][h].date-this.chartData.data[this.chartData.typeData][o].date;this.result[3]=function convertTimestamp(t){var e="";if(t>=86e3){var a=t/86e3;t%=86e3,e+=a.toFixed(0)+i}if(t>=3600){var n=t/3600;t%=3600,e+=n.toFixed(0)+s}return t>60&&(e+=(t/60).toFixed(0)+r),e}(Math.abs(l)),l<0&&(this.result[3]="-"+this.result[3]);var d=this.result[0]/t*100;return c=this.CountOfFixed(d),this.result[1]="("+d.toFixed(c)+"%), ",this.result[2]=a-t,c=this.CountOfFixed(this.result[2]),this.result[2]=this.result[2].toFixed(c),this.result[4]=o-h,this.result},this.createDiv=function(){this.datadiv=document.createElement("div"),this.datadiv.classList.toggle("tch-roulete-data-container",!0),this.datadivFirstLine=document.createElement("div"),this.datadivFirstLine.classList.toggle("tch-roulete-inside-data-container",!0),this.datadivSecondLine=document.createElement("div"),this.datadivSecondLine.classList.toggle("tch-roulete-inside-data-container",!0),this.datadiv.appendChild(this.datadivFirstLine),this.datadiv.appendChild(this.datadivSecondLine),this.fromX0BartoX1Bar=document.createElement("span"),this.fromX0BartoX1Bar.classList.toggle("tch-chart-data-text",!0),this.fromX0BartoX1Bar.innerText=this.datafordiv[0].toString(),this.fromY0toY1change=document.createElement("span"),this.fromY0toY1change.classList.toggle("tch-chart-data-text",!0),this.fromY0toY1change.innerText=(this.datafordiv[2]*Math.pow(10,parseFloat(this.chartData.precission))).toFixed(0),this.percenChange=document.createElement("span"),this.percenChange.classList.toggle("tch-chart-data-text",!0),this.percenChange.innerText=this.datafordiv[1],this.timeChange=document.createElement("span"),this.timeChange.classList.toggle("tch-chart-data-text",!0),this.timeChange.innerText=this.datafordiv[3],this.barsCount=document.createElement("span"),this.barsCount.classList.toggle("tch-chart-data-text",!0),this.barsCount.innerText=this.datafordiv[4]+a,this.datadivFirstLine.appendChild(this.fromX0BartoX1Bar),this.datadivFirstLine.appendChild(this.percenChange),this.datadivFirstLine.appendChild(this.fromY0toY1change),this.datadivSecondLine.appendChild(this.barsCount),this.datadivSecondLine.appendChild(this.timeChange),this.chartData.chart.drawingText.appendChild(this.datadiv)},this.remove=function(){this.datadiv&&this.datadiv.remove(),Roulete.prototype.remove.apply(this,arguments)},this.CountOfFixed=function(t){for(var e=String(t).split(""),a=0;a<e.length;a++)if("."!==e[a]&&"0"!==e[a]&&"-"!==e[a])return a},this.appendPoint=function(t,e){this.data.push(t),this.points.push(e),this.circles.push(new Circle(this.chartData,{data:[this.data[this.data.length-1]],points:[this.points[this.points.length-1]]}))},this.updateLastPoint=function(t,e){2===this.drawingStage.current&&(this.remove(),this.chartData.techChart.setState("default"),this.chartData.techChart.setRouleteBtn("Off")),1===this.drawingStage.current&&this.chartData.techChart.setRouleteBtn("Off");var a=this.data.length-1;a<2&&(this.data[a]=t,this.points[a]=e)},this.moveTo=function(t,e,a){for(var i=0;i<this.points.length;i++)this.points[i].active&&(this.points[i].x=a.x,this.points[i].y=a.y,this.data[i].d=a.dateSeconds,this.data[i].v=a.value)},this.getStyleRows=function(){},this.isFocused=function(){},this.applyValue=function(t,e){this[e]=t,this.chartData.chart.redrawInfo(),this.chartData.chart.updateDrawingObjectsOtherChart(this),this.chartData.chart.drawActiveDrawingObjectsOtherCharts(this.id)},this.getPosition=function(){return{x0:this.points[0].x,x1:this.points[0].x,x2:this.points[1].x,x3:this.points[1].x,y0:this.points[0].y,y1:this.points[1].y,y2:this.points[1].y,y3:this.points[0].y}}}function Ellipse(){arguments&&arguments.length&&TrendLine.apply(this,arguments),this.drawingStage={current:0,max:2},this.color="#ef680e",this.fill=!0,this.fillColor="#e89a66",this.opacity=.3,this.height=0,this.lineType="normal",this.width=1,this.isFocused=function(t,e){if(this.periods.length&&-1!==this.periods.indexOf(this.chartData.period))return!1;this.isChanged=!1,this.isObjectEdit=!1;for(var a=!1,i=0,s=0;s<this.circles.length;s++){if(i++,LibDrawing_LibDrawing.isPointOnCircle(this.circles[s],{x:t,y:e})){this.circles[s].points[0].active=!0,this.points[s].active=!0,a=!0,this.isChanged=!0;break}this.circles[s].points[0].active=!1,this.points[s].active=!1}for(;i<this.circles.length;)this.circles[i].points[0].active=!1,this.points[i].active=!1,i++;if(a)return!0;if(this.drawingStage.current>=2){var r=this.getPositions(),n={x1:r.x0,y1:r.y0,x2:r.x1,y2:r.y1},o=LibDrawing_LibDrawing.findLineAngleDeg(n),h=-LibDrawing_LibDrawing.degToRad(o),c={x:t,y:e},l={x:r.x0,y:r.y0},d={x:r.x1,y:r.y1},p=this.getMiddlePoint(l,d),u={h:p.x,k:p.y,rx:Math.sqrt((r.x1-r.x0)*(r.x1-r.x0)+(r.y1-r.y0)*(r.y1-r.y0))/2,ry:Math.sqrt((r.x3-r.x2)*(r.x3-r.x2)+(r.y3-r.y2)*(r.y3-r.y2))/2};if(LibDrawing_LibDrawing.isPointOnEllipse(u,c,h,.1)){for(var g=0;g<this.points.length;g++)this.points[g].active=!0,this.circles&&this.circles[g]&&(this.circles[g].points[0].active=!0);this.isObjectEdit=!0,a=!0}return a}},this.moveTo=function(t,e,a){for(var i,s,r,n,o=0;o<this.points.length;o++)this.points[o].active&&(this.points.length<3?(this.points[o].x=a.x,this.points[o].y=a.y,this.data[o].d=a.dateSeconds,this.data[o].v=a.value,this.circles[o].points=[this.points[o]],this.circles[o].data=[this.data[o]]):2===o?(i={x1:this.points[0].x,y1:this.points[0].y,x2:this.points[1].x,y2:this.points[1].y},s={x:a.x,y:a.y},r=this.getTopData(i,!1,s,!0),this.height=r.h,this.points[o].x=r.x,this.points[o].y=r.y,this.data[o].d=this.chartData.chart.toXValue(this.points[o].x),this.data[o].v=this.chartData.chart.toYValue(this.points[o].y),this.circles[o].points=[this.points[o]],this.circles[o].data=[this.data[o]],n=this.getTopData(i,!1,s,!1),this.height=n.h,this.points[3].x=n.x,this.points[3].y=n.y,this.data[3].d=this.chartData.chart.toXValue(this.points[3].x),this.data[3].v=this.chartData.chart.toYValue(this.points[3].y),this.circles[3].points=[this.points[3]],this.circles[3].data=[this.data[3]],this.circles[3].points[0].active=!0,this.points[3].active=!0):3===o?(i={x1:this.points[0].x,y1:this.points[0].y,x2:this.points[1].x,y2:this.points[1].y},s={x:a.x,y:a.y},n=this.getTopData(i,!1,s,!1),this.height=n.h,this.points[o].x=n.x,this.points[o].y=n.y,this.data[o].d=this.chartData.chart.toXValue(this.points[o].x),this.data[o].v=this.chartData.chart.toYValue(this.points[o].y),this.circles[o].points=[this.points[o]],this.circles[o].data=[this.data[o]],r=this.getTopData(i,!1,s,!0),this.height=r.h,this.points[2].x=r.x,this.points[2].y=r.y,this.data[2].d=this.chartData.chart.toXValue(this.points[2].x),this.data[2].v=this.chartData.chart.toYValue(this.points[2].y),this.circles[2].points=[this.points[2]],this.circles[2].data=[this.data[2]],this.circles[2].points[0].active=!0,this.points[2].active=!0):(this.points[o].x=a.x,this.points[o].y=a.y,this.data[o].d=a.dateSeconds,this.data[o].v=a.value,this.circles[o].points=[this.points[o]],this.circles[o].data=[this.data[o]],i={x1:this.points[0].x,y1:this.points[0].y,x2:this.points[1].x,y2:this.points[1].y},s={x:a.x,y:a.y},r=this.getTopData(i,this.height,null,!0),this.points[2].x=r.x,this.points[2].y=r.y,this.data[2].d=this.chartData.chart.toXValue(this.points[2].x),this.data[2].v=this.chartData.chart.toYValue(this.points[2].y),this.circles[2].points=[this.points[2]],this.circles[2].data=[this.data[2]],n=this.getTopData(i,this.height,null,!1),this.points[3].x=n.x,this.points[3].y=n.y,this.data[3].d=this.chartData.chart.toXValue(this.points[3].x),this.data[3].v=this.chartData.chart.toYValue(this.points[3].y),this.circles[3].points=[this.points[3]],this.circles[3].data=[this.data[3]]))},this.updatePixels=function(){if(!this.isPressed)for(var t=0;t<this.points.length;t++)if(0===t||1===t)this.points[t].x=this.chartData.chart.toXPixels(this.data[t].d),this.points[t].y=this.chartData.chart.toYPixels(this.data[t].v),this.circles[t].points=[this.points[t]],this.circles[t].data=[this.data[t]];else if(this.points.length>2){var e={x1:this.points[0].x,y1:this.points[0].y,x2:this.points[1].x,y2:this.points[1].y},a={};if(2===t){a.x=this.chartData.chart.toXPixels(this.data[2].d),a.y=this.chartData.chart.toYPixels(this.data[2].v);var i=this.getTopData(e,!1,a);this.height=i.h,this.points[t].x=i.x,this.points[t].y=i.y,this.data[t].d=this.chartData.chart.toXValue(this.points[t].x),this.data[t].v=this.chartData.chart.toYValue(this.points[t].y),this.circles[t].points=[this.points[t]],this.circles[t].data=[this.data[t]]}else{a.x=this.chartData.chart.toXPixels(this.data[3].d),a.y=this.chartData.chart.toYPixels(this.data[3].v);var s=this.getTopData(e,!1,a);this.height=s.h,this.points[t].x=s.x,this.points[t].y=s.y,this.data[t].d=this.chartData.chart.toXValue(this.points[t].x),this.data[t].v=this.chartData.chart.toYValue(this.points[t].y),this.circles[t].points=[this.points[t]],this.circles[t].data=[this.data[t]]}}},this.appendPoint=function(t,e){var a={v:t.v-this.data[1].v,y:this.points[1].y-e.y},i=this.getMiddleData(this.data[0],this.data[1]),s=this.getMiddlePoint(this.points[0],this.points[1]),r=s.x,n=parseFloat(s.y)-parseFloat(a.y),o=i.d,h=parseFloat(i.v)+parseFloat(a.v);this.points.push({x:r,y:n,active:!0}),this.data.push({d:o,v:h}),this.circles.push(new Circle(this.chartData,{data:[this.data[2]],points:[this.points[2]]})),this.points.push({x:r,y:n,active:!0}),this.data.push({d:o,v:h}),this.circles.push(new Circle(this.chartData,{data:[this.data[3]],points:[this.points[3]]}))},this.updateLastPoint=function(t,e){var a=this.data.length-1;a<2&&(this.data[a]=t,this.points[a]=e,this.circles[a].points=[this.points[a]])},this.draw=function(t){if(this.periods.length&&-1!==this.periods.indexOf(this.chartData.period))return!1;var e=this.getPositions();if(this.drawingStage.current<2){if(this.chartData.techChart.charts.length>1)for(var a=0;a<this.chartData.techChart.charts.length;a++)e.y1>this.chartData.techChart.charts[a].canvasDrawingActive.clientHeight&&(e.y1=0);LibCanvas.drawLine(null,t,e.x0,e.y0,e.x1,e.y1,this.color,this.getLineTypeArray(this.lineType,this.width),this.width,this.opacity)}if(this.drawingStage.current>=2){var i={x1:e.x0,y1:e.y0,x2:e.x1,y2:e.y1},s=LibDrawing_LibDrawing.findLineAngleDeg(i),r={x:e.x0,y:e.y0},n={x:e.x1,y:e.y1},o=this.getMiddlePoint(r,n),h=o.x,c=o.y,l=Math.sqrt((e.x1-e.x0)*(e.x1-e.x0)+(e.y1-e.y0)*(e.y1-e.y0))/2,d=Math.sqrt((e.x3-e.x2)*(e.x3-e.x2)+(e.y3-e.y2)*(e.y3-e.y2))/2,p=-LibDrawing_LibDrawing.degToRad(s),u=2*Math.PI;this.fill?LibCanvas.drawEllipse(null,t,h,c,l,d,p,0,u,!1,this.fillColor,this.width,this.color,this.opacity,this.getLineTypeArray(this.lineType,this.width)):LibCanvas.drawEllipse(null,t,h,c,l,d,p,0,u,!1,"transparent",this.width,this.color,this.opacity,this.getLineTypeArray(this.lineType,this.width))}if("edit"===this.state||"active"===this.state){for(var g=0;g<this.circles.length;g++)this.circles[g].points[0].active||this.circles[g].drawWithShadow(t,"white",this.color,.1);for(var v=0;v<this.circles.length;v++)this.circles[v].points[0].active&&this.circles[v].drawWithShadow(t,"red",this.color,.1)}return!0},this.getStyleRows=function(){var t=Line_Line.prototype.getStyleRows.apply(this,arguments),e=[this.getBackgroundRow()];return t.concat(e)},this.trendLineConvertToDTO=this.convertToDTO,this.convertToDTO=function(){var t=this.trendLineConvertToDTO();return this.updateCustomPropsByObj(t,this),t},this.trendLineApplyRestoredParams=this.applyRestoredParams,this.applyRestoredParams=function(t){this.trendLineApplyRestoredParams(t),this.updateCustomPropsByObj(this,t)},this.trendLineUpdateCustomPropsByObj=this.updateCustomPropsByObj,this.updateCustomPropsByObj=function(t,e){this.trendLineUpdateCustomPropsByObj(t,e),t.height=DrawingObject.cloneObject(e.height),t.fill=e.fill,t.fillColor=e.fillColor,t.opacity=e.opacity,t.lineType=e.lineType,t.width=e.width}}function Note(t){arguments&&arguments.length&&Text.apply(this,arguments),this.chartData=t,this.note=null,this.textSpanBackground=null,this.textSpanBackgroundHeight=20,this.textSpanBackgroundWidth=250,this.color="rgba(0,0,255,1)",this.fill=!0,this.fillColor="rgba(164,194,244,1)",this.label=!1,this.colorLabel="rgba(0,0,255,1)",this.size=30,this.fontSize=28,this.rect={},this.divText=null,this.pText=null,this.note=null,this.state="edit",this.draw=function(){if(this.chartData&&this.chartData.chart){if(this.divText=this.chartData.chart.drawingTextContainer.querySelector("#"+this.id),this.divText||(this.divText=document.createElement("div"),this.divText.classList.toggle("tch-divText",!0),this.divText.setAttribute("id",this.id),this.divText.style.width=this.textSpanBackgroundWidth+"px",this.chartData.chart.drawingTextContainer.appendChild(this.divText)),this.pText=this.chartData.chart.drawingTextContainer.querySelector("#"+this.id+"-note-text"),this.textSpanBackground=this.chartData.chart.drawingTextContainer.querySelector("#"+this.id+"-note-out"),this.note=this.chartData.chart.drawingTextContainer.querySelector("#"+this.id+"-note-simbol"),null===this.pText&&null===this.textSpanBackground&&null===this.note){this.pText=document.createElement("p"),this.pText.setAttribute("id",this.id+"-note-text"),this.pText.classList.toggle("tch-note-text",!0),this.divText.appendChild(this.pText),this.pText.style.borderColor=this.colorLabel,this.textSpanBackground=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.textSpanBackground.setAttribute("id",this.id+"-note-out"),this.textSpanBackground.classList.toggle("tch-note-out",!0);var t=document.createElementNS("http://www.w3.org/2000/svg","polyline");this.textSpanBackground.appendChild(t),this.textSpanBackground.setAttribute("viewBox","0 0 "+this.textSpanBackgroundWidth+" "+this.textSpanBackgroundHeight),this.textSpanBackground.setAttribute("heigth",this.textSpanBackgroundHeight+"px"),this.textSpanBackground.setAttribute("width",this.textSpanBackgroundWidth+"px"),this.textSpanBackground.style.display="block",this.divText.appendChild(this.textSpanBackground),this.note=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.note.setAttribute("id",this.id+"-note-simbol"),this.note.classList.toggle("tch-note-simbol",!0),this.note.setAttribute("viewBox","0 0 1024 1024"),this.note.setAttribute("heigth",this.size+"px"),this.note.setAttribute("width",this.size+"px"),this.note.style.display="block",this.divText.appendChild(this.note)}this.note.innerHTML=this.getPathString(this.colorLabel.replace(/ /g,"")),this.applyTextParams(),this.applyNoteParams(),"normal"!==this.state?(this.pText.classList.toggle("tch-hidden",!1),this.textSpanBackground.classList.toggle("tch-hidden",!1)):(this.pText.classList.toggle("tch-hidden",!0),this.textSpanBackground.classList.toggle("tch-hidden",!0)),this.applyPosition()}},this.isFocused=function(t,e){var a=parseFloat(this.points[0].x),i=parseFloat(this.points[0].y),s={x1:a-this.size/2,x2:a+this.size/2,y1:i,y2:i-this.size};return this.isObjectEdit=LibDrawing_LibDrawing.isPointInRect(s,{x:t,y:e},5),this.isObjectEdit},this.removeDrawingObject=DrawingObject.prototype.remove,this.remove=function(){this.removeDrawingObject(),this.chartData.chart.drawingTextContainer.removeChild(this.divText)},this.getStyleRows=function(){return[this.getTextStyleRow(),this.getTextAreaRow(),this.getBackgroundRow(),this.getLabelRow()]},this.applyValue=function(t,e){this[e]=t,this.draw(),this.chartData.chart.updateDrawingObjectsOtherChart(this),this.chartData.chart.drawActiveDrawingObjectsOtherCharts(this.id)},this.convertToDTO=function(){var t=DrawingObject.prototype.convertToDTO.apply(this,arguments);return this.updateCustomPropsByObj(t,this),t}}function AnchoredNote(){arguments&&arguments.length&&Note.apply(this,arguments),this.updatePixels=function(){},this.convertToDTO=function(){var t=DrawingObject.prototype.convertToDTO.apply(this,arguments);return this.updateCustomPropsByObj(t,this),t}}function AnchoredText(){arguments&&arguments.length&&Text.apply(this,arguments),this.updatePixels=function(){}}function Flag(t){this.chartData=t,arguments&&arguments.length&&(Line_Line.apply(this,arguments),this.circles.push(new Circle(this.chartData,{data:[this.data[0]],points:[this.points[0]]})),this.circles[0].radius=4),this.icon=null,this.size=30,this.flagColor="rgba(0, 255, 0, 1)",this.centring={x:1,y:0},this.price=this.data[0].v,this.barNumber=-1,this.applyRestoredParams=function(t){DrawingObject.prototype.applyRestoredParams.apply(this,arguments),this.updateCustomPropsByObj(this,t)},this.draw=function(t){this.chartData&&this.chartData.chart&&(this.icon||(this.icon=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.icon.setAttribute("id",this.id),this.createFlagIcon(this.icon)),this.chartData.chart.drawingTextContainer&&!this.chartData.chart.drawingTextContainer.querySelector("#"+this.id)&&this.chartData.chart.drawingTextContainer.appendChild(this.icon),this.applyFlagParams(),"edit"!==this.state&&"active"!==this.state||(this.circles[0].points[0].active?(this.circles[0].drawShadow(t,"white",this.flagColor,.1),this.circles[0].draw(t,"red","black")):(this.circles[0].drawShadow(t,"white",this.flagColor,.1),this.circles[0].draw(t,"white","black"))))},this.shiftTo=function(t,e,a,i,s){if(0!==e||0!==t){for(var r=0;r<this.points.length;r++)this.points[r].y-=e,this.points[r].x-=t,this.data[r].d-=i,this.data[r].v-=s;this.circles[0].points=[this.points[0]],this.circles[0].data=[this.data[0]]}},this.isFocused=function(t,e){if(this.periods.length&&-1!==this.periods.indexOf(this.chartData.period))return!1;this.isChanged=!1,this.isObjectEdit=!1;var a=!1;return LibDrawing_LibDrawing.isPointOnCircle(this.circles[0],{x:t,y:e})&&(this.isChanged=!0,a=!0),this.isPointOnFlag(t,e)&&(a=!0),a?(this.circles[0].points[0].active=!0,this.points[0].active=!0,this.isObjectEdit=!0):(this.circles[0].points[0].active=!1,this.points[0].active=!1),a},this.removeDrawingObject=this.remove,this.remove=function(){this.removeDrawingObject(),this.chartData.chart.drawingTextContainer.removeChild(this.icon)},this.getStyleRows=function(){return[[{className:"tch-ss-basic"},{text:this.chartData.techChart.translation.flagcolor,options:{line:this,id:"tch-settingsStyle-input-color",name:"flagColor",type:"colorpicker",value:this.color,onchange:this.changeValueInput}}]]},this.applyValueBase=this.applyValue,this.applyValue=function(t,e){if("flagColor"===e)for(var a=this.icon.querySelectorAll("rect"),i=0;i<a.length;i++)a[i].style.fill=t;if("barNumber"===e&&this.chartData.data[this.chartData.techChart.configuration.typeData][t]){var s=this.chartData.data[this.chartData.techChart.configuration.typeData][t].date;this.data[0].d=s,this.chartData.chart&&this.chartData.chart.canvasDrawingContext&&this.updatePixels()}if("price"===e){var r=t.replace(",",".");if(isNaN(r))return void(this.chartData.chart.parent.querySelector("#tch-settingsCoordinates-input-text").value=this.price);this.data[0].v=t,this.price=t,this.updatePixels()}this.applyValueBase(t,e)},this.updateCustomPropsByObj=function(t,e){t.flagColor=e.flagColor,t.periods=e.periods.slice(0),t.barNumber=e.barNumber,t.price=e.price;var a=this.data[0].v;this.price="string"===typeof a?a:a.toFixed(this.chartData.precission)},this.getCoordinatesRows=function(){return[[{className:"tch-ss-basic"},{text:this.chartData.techChart.translation.price,options:{line:this,className:"input-styled",id:"tch-settingsCoordinates-input-text",name:"price",type:"text",value:this.price,onchange:this.changeValueInput}},{text:this.chartData.techChart.translation.barNumber,options:{line:this,className:"input-styled",id:"tch-settingsStyle-input-barNumber",name:"barNumber",type:"number",value:this.barNumber,oninput:this.changeValueInput}}]]},this.getStylePropsNames=function(){return["size","flagColor","price","barNumber"]},this.fillLineCoordinatesBase=this.fillLineCoordinates,this.fillLineCoordinates=function(t){this.barNumber=this.getBarNumber(),this.fillLineCoordinatesBase(t)}}function LibDrawing_LibDrawing(){}function DrawingObject(t,e){this.id=this.getNextId(),this.chartData=t,this.data=DrawingObject.cloneObject(e.data),this.points=DrawingObject.cloneObject(e.points),this.isObjectEdit=!1,this.drawingStage={current:1,max:0},this.periods=[]}function _defineProperties(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Helper(){}function Candle(t,e,a,i,s,r,n,o,h){this.low=t,this.high=e,this.open=a,this.close=i,this.date=s,this.x=r,this.y=n,this.scale=o,this.line,this.body,this.crossPosition={x:"0.0",y:"0.0"},this.isCurrentData,this.width,this.useCanvas=h}function _typeof(t){return(_typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,e){return t.__proto__=e,t})(t,e)}function Point(t,e,a,i,s){this.value=t,this.date=e,this.x=a,this.y=i,s&&(this.low=s.low,this.high=s.high,this.open=s.open,this.close=s.close)}function LineChart_typeof(t){return(LineChart_typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function LineChart_getPrototypeOf(t){return(LineChart_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function LineChart_setPrototypeOf(t,e){return(LineChart_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,e){return t.__proto__=e,t})(t,e)}function LineChart_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function AreaChart_typeof(t){return(AreaChart_typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function AreaChart_getPrototypeOf(t){return(AreaChart_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function AreaChart_setPrototypeOf(t,e){return(AreaChart_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,e){return t.__proto__=e,t})(t,e)}function Bar(t,e,a,i,s,r,n,o,h){this.low=t,this.high=e,this.open=a,this.close=i,this.date=s,this.x=r,this.y=n,this.scale=o,this.line,this.body,this.crossPosition={x:"0.0",y:"0.0"},this.isCurrentData,this.lineWidth=2,this.useCanvas=h}function BarChart_typeof(t){return(BarChart_typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function BarChart_getPrototypeOf(t){return(BarChart_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function BarChart_setPrototypeOf(t,e){return(BarChart_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,e){return t.__proto__=e,t})(t,e)}function HollowCandle(t,e,a,i,s,r,n,o,h){this.low=t,this.high=e,this.open=a,this.close=i,this.date=s,this.x=r,this.y=n,this.scale=o,this.line,this.body,this.crossPosition={x:"0.0",y:"0.0"},this.isCurrentData,this.width,this.useCanvas=h,this.hollowCandlePriceLine}function HollowCandleChart_typeof(t){return(HollowCandleChart_typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function HollowCandleChart_getPrototypeOf(t){return(HollowCandleChart_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function HollowCandleChart_setPrototypeOf(t,e){return(HollowCandleChart_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,e){return t.__proto__=e,t})(t,e)}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},i=Object.keys(a);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(a).filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),i.forEach(function(e){TechnicalChart_defineProperty(t,e,a[e])})}return t}function TechnicalChart_defineProperty(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function TechnicalChart_defineProperties(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var s=i("./src/scripts/Config/config.js"),r={colors:{Chart:{backgroundColor:"#ffffff",vertGridLines:"#CCCCCC",horzGridLines:"#CCCCCC",scalesText:"#8C8C8C",colorScalesLines:"#8C8C8C",colorCrossHair:"#005C86",watermarkColor:"rgba(207,226,243,0.5)",labelCall:"rgba(27, 224, 106,1)",labelPut:"rgba(255,31,75,1)"},CandleChart:{priceText:"#FFFFFF",axisText:"#484848",candleBear:"#CD2F47",candleBool:"#8CC63F",candleLine:"#898989",activeCandle:"blue",crossTextRects:"#014EC2",crossText:"#FFFFFF",candleBearBorder:"#550000",candleBoolBorder:"#004600",candleLineBear:"#898989",candleLineBool:"#898989"},HollowChart:{priceText:"#FFFFFF",axisText:"#484848",candleBear:"#CD2F47",candleBool:"#8CC63F",candleLine:"#898989",activeCandle:"blue",crossTextRects:"#014EC2",crossText:"#FFFFFF",candleBearBorder:"#550000",candleBoolBorder:"#004600",candleLineBear:"#898989",candleLineBool:"#898989"},LineChart:{priceText:"#FFFFFF",axisText:"#484848",candleBear:"#CD2F47",candleBool:"#8CC63F",crossLine:"#014EC2",crossTextRects:"#014EC2",crossText:"#FFFFFF",colorLine:"#005C86",priceLine:"#EE8926"},AreaChart:{priceText:"#FFFFFF",axisText:"#484848",candleBear:"#CD2F47",candleBool:"#8CC63F",crossLine:"#014EC2",crossTextRects:"#014EC2",crossText:"#FFFFFF",colorLine:"#4BCEA9",colorStop:"#4BCEA9",colorStopEnd:"#ffffff",priceLine:"#EE8926"},BarChart:{priceText:"#FFFFFF",axisText:"#484848",candleBear:"#CD2F47",candleBool:"#8CC63F",candleLine:"#898989",crossLine:"#014EC2",activeCandle:"blue",chartBorder:"#8C8C8C",crossTextRects:"#014EC2",crossText:"#FFFFFF"}},options:{Chart:{autoScale:!0,scaleSeriesOnly:!0,needPriceLine:!0,widthPriceLine:1,typeTick:"Default",typeChart:"candle",typeVertGridLines:"normal",typeHorzGridLines:"normal",typeCrossHair:"points",widthCrossHair:1,scalesFontSize:10,symbolDescription:!0,ohlcValues:!0,indicatorTitles:!0,indicatorArguments:!0,indicatorValues:!0,typeThemes:"defaultThema",needPriceOscillators:!0},CandleChart:{needWick:!0,needBorder:!0,colorPrevious:!1,widthBorderLine:1,widthWickLine:1},HollowChart:{needWick:!0,needBorder:!0,colorPrevious:!1,widthBorderLine:1,widthWickLine:1},LineChart:{widthLine:1,priceSource:"Close",typeLine:"Simple"},AreaChart:{widthLine:1,priceSource:"Close"},BarChart:{needOpen:!1}},themes:{blackthema:{Chart:{backgroundColor:"#080808",vertGridLines:"#CCCCCC",horzGridLines:"#CCCCCC",scalesText:"#8C8C8C",colorScalesLines:"#8C8C8C",colorCrossHair:"#014EC2",watermarkColor:"rgba(207,226,243,0.5)"},CandleChart:{priceText:"#FFFFFF",axisText:"#484848",candleBear:"#F54337",candleBool:"#66CC69",candleLine:"#898989",activeCandle:"blue",crossTextRects:"#014EC2",crossText:"#FFFFFF",candleBearBorder:"#550000",candleBoolBorder:"#004600",candleLineBear:"#898989",candleLineBool:"#898989"},HollowChart:{priceText:"#FFFFFF",axisText:"#484848",candleBear:"#F54337",candleBool:"#008000",candleLine:"#898989",activeCandle:"blue",crossTextRects:"#014EC2",crossText:"#FFFFFF",candleBearBorder:"#550000",candleBoolBorder:"#004600",candleLineBear:"#898989",candleLineBool:"#898989"},LineChart:{priceText:"#FFFFFF",axisText:"#484848",candleBear:"#F54337",candleBool:"#66CC69",crossLine:"#014EC2",crossTextRects:"#014EC2",crossText:"#FFFFFF",colorLine:"#3395d7",priceLine:"#EE8926"},AreaChart:{priceText:"#FFFFFF",axisText:"#484848",candleBear:"#F54337",candleBool:"#66CC69",crossLine:"#014EC2",crossTextRects:"#014EC2",crossText:"#FFFFFF",colorLine:"#3395d7",colorStop:"#7ab1e7",colorStopEnd:"#ffffff",priceLine:"#EE8926"},BarChart:{priceText:"#FFFFFF",axisText:"#484848",candleBear:"#F54337",candleBool:"#66CC69",candleLine:"#898989",crossLine:"#014EC2",activeCandle:"blue",chartBorder:"#8C8C8C",crossTextRects:"#014EC2",crossText:"#FFFFFF"}},bluethema:{Chart:{backgroundColor:"#acf7f7",vertGridLines:"#CCCCCC",horzGridLines:"#CCCCCC",scalesText:"#8C8C8C",colorScalesLines:"#8C8C8C",colorCrossHair:"#014EC2",watermarkColor:"rgba(207,226,243,0.5)"},CandleChart:{priceText:"#FFFFFF",axisText:"#484848",candleBear:"#F54337",candleBool:"#0909ff",candleLine:"#898989",activeCandle:"blue",crossTextRects:"#014EC2",crossText:"#FFFFFF",candleBearBorder:"#550000",candleBoolBorder:"#004600",candleLineBear:"#898989",candleLineBool:"#898989"},HollowChart:{priceText:"#FFFFFF",axisText:"#484848",candleBear:"#F54337",candleBool:"#008000",candleLine:"#898989",activeCandle:"blue",crossTextRects:"#014EC2",crossText:"#FFFFFF",candleBearBorder:"#550000",candleBoolBorder:"#004600",candleLineBear:"#898989",candleLineBool:"#898989"},LineChart:{priceText:"#FFFFFF",axisText:"#484848",candleBear:"#F54337",candleBool:"#0909ff",crossLine:"#014EC2",crossTextRects:"#014EC2",crossText:"#FFFFFF",colorLine:"#3395d7",priceLine:"#EE8926"},AreaChart:{priceText:"#FFFFFF",axisText:"#484848",candleBear:"#F54337",candleBool:"#0909ff",crossLine:"#014EC2",crossTextRects:"#014EC2",crossText:"#FFFFFF",colorLine:"#3395d7",colorStop:"#7ab1e7",colorStopEnd:"#ffffff",priceLine:"#EE8926"},BarChart:{priceText:"#FFFFFF",axisText:"#484848",candleBear:"#F54337",candleBool:"#66CC69",candleLine:"#898989",crossLine:"#014EC2",activeCandle:"blue",chartBorder:"#8C8C8C",crossTextRects:"#014EC2",crossText:"#FFFFFF"}},greythema:{Chart:{backgroundColor:"#d8d8d8",vertGridLines:"#CCCCCC",horzGridLines:"#CCCCCC",scalesText:"#8C8C8C",colorScalesLines:"#8C8C8C",colorCrossHair:"#014EC2",watermarkColor:"rgba(207,226,243,0.5)"},CandleChart:{priceText:"#FFFFFF",axisText:"#484848",candleBear:"#F54337",candleBool:"#66CC69",candleLine:"#898989",activeCandle:"blue",crossTextRects:"#014EC2",crossText:"#FFFFFF",candleBearBorder:"#550000",candleBoolBorder:"#004600",candleLineBear:"#898989",candleLineBool:"#898989"},HollowChart:{priceText:"#FFFFFF",axisText:"#484848",candleBear:"#F54337",candleBool:"#008000",candleLine:"#898989",activeCandle:"blue",crossTextRects:"#014EC2",crossText:"#FFFFFF",candleBearBorder:"#550000",candleBoolBorder:"#004600",candleLineBear:"#898989",candleLineBool:"#898989"},LineChart:{priceText:"#FFFFFF",axisText:"#484848",candleBear:"#F54337",candleBool:"#66CC69",crossLine:"#014EC2",crossTextRects:"#014EC2",crossText:"#FFFFFF",colorLine:"#3395d7",priceLine:"#EE8926"},AreaChart:{priceText:"#FFFFFF",axisText:"#484848",candleBear:"#F54337",candleBool:"#66CC69",crossLine:"#014EC2",crossTextRects:"#014EC2",crossText:"#FFFFFF",colorLine:"#3395d7",colorStop:"#7ab1e7",colorStopEnd:"#ffffff",priceLine:"#EE8926"},BarChart:{priceText:"#FFFFFF",axisText:"#484848",candleBear:"#F54337",candleBool:"#66CC69",candleLine:"#898989",crossLine:"#014EC2",activeCandle:"blue",chartBorder:"#8C8C8C",crossTextRects:"#014EC2",crossText:"#FFFFFF"}},defaultthema:{Chart:{backgroundColor:"#ffffff",vertGridLines:"#CCCCCC",horzGridLines:"#CCCCCC",scalesText:"#8C8C8C",colorScalesLines:"#8C8C8C",colorCrossHair:"#005C86",watermarkColor:"rgba(207,226,243,0.5)"},CandleChart:{priceText:"#FFFFFF",axisText:"#484848",candleBear:"#CD2F47",candleBool:"#8CC63F",candleLine:"#898989",activeCandle:"blue",crossTextRects:"#014EC2",crossText:"#FFFFFF",candleBearBorder:"#550000",candleBoolBorder:"#004600",candleLineBear:"#898989",candleLineBool:"#898989"},HollowChart:{priceText:"#FFFFFF",axisText:"#484848",candleBear:"#CD2F47",candleBool:"#8CC63F",candleLine:"#898989",activeCandle:"blue",crossTextRects:"#014EC2",crossText:"#FFFFFF",candleBearBorder:"#550000",candleBoolBorder:"#004600",candleLineBear:"#898989",candleLineBool:"#898989"},LineChart:{priceText:"#FFFFFF",axisText:"#484848",candleBear:"#CD2F47",candleBool:"#8CC63F",crossLine:"#014EC2",crossTextRects:"#014EC2",crossText:"#FFFFFF",colorLine:"#005C86",priceLine:"#EE8926"},AreaChart:{priceText:"#FFFFFF",axisText:"#484848",candleBear:"#CD2F47",candleBool:"#8CC63F",crossLine:"#014EC2",crossTextRects:"#014EC2",crossText:"#FFFFFF",colorLine:"#4BCEA9",colorStop:"#4BCEA9",colorStopEnd:"#ffffff",priceLine:"#EE8926"},BarChart:{priceText:"#FFFFFF",axisText:"#484848",candleBear:"#CD2F47",candleBool:"#8CC63F",candleLine:"#898989",crossLine:"#014EC2",activeCandle:"blue",chartBorder:"#8C8C8C",crossTextRects:"#014EC2",crossText:"#FFFFFF"}}}},n={ru:{"1-minute":"1 минута","5-minutes":"5 минут","15-minutes":"15 минут","30-minutes":"30 минут","1-hour":"1 час","4-hours":"4 часа","8-hours":"8 часов","1-day":"1 день","1-week":"1 неделя","1-month":"1 месяц","1m":"1мин","5m":"5мин","15m":"15мин","30m":"30мин","1h":"1ч","4h":"4ч","8h":"8ч","1D":"1д","1W":"1н","1M":"1мес","link-symbol-to":"Применить инструмент на всех графиках","link-interval-to":"Применить интервал на всех графиках","link-crosshair-on":"Синхронное перекрестье на всех графиках","track-time-on":"Отслеживать время на всех графиках","color-bars-based":"Цвет основан на предыдущей цене закрытия",borders:"Обводка свечи",border:"Обводка",wick:"Фитиль","price-line":"Линия цены",scale:"Шкала",scales:"Шкалы","override-min":"Минимальное изменение цены","price-source":"Источник цены",line:"Линия",fill:"Цвет заполнения",type:"Тип","hlc-bars":"HLC - бары","up-color":"Растущий цвет","down-color":"Падающий цвет",default:"По умолчанию","default-tch":"Стандарт",ok:"Применить",cancel:"Отмена",closeBtn:"Закрыть",style:"Стиль",inputs:"Данные",period:"Период",K:"K",D:"D",KLine:"KLine",DLine:"DLine",ADX:"ADX",DIM:"DIM",DIP:"DIP",fastLength:"Быстрая линия",slowLength:"Запаздывающая линия",signalLength:"Сигнальная линия",histogram:"Гистограмма",signal:"Сигнал",U:"Верхняя линия",M:"Средняя линия",L:"Нижняя линия",cloud:"Облако",smallPeriod:"Минимальный период",middlePeriod:"Средний период",largePeriod:"Максимальный период",TenkanSen:"разворотная линия ",KijunSen:"основная линия ",ChinkouSpan:"запаздывающая линия ",SenkouSpanA:"опережающая линия А ",SenkouSpanB:"опережающая линия Б ",A:"A ",B:"B ",lenght:"Ширина",percent:"Процент",avarage:"Среднее",startAf:"Начальное значение",stepAf:"Шаг",maxAf:"Количество переходов",multi:"Шаг",lineUp:"Линия вверх",lineDown:"Линия вниз",background:"Заливка",timezone:"Часовой пояс",right:"Правая",left:"Левая","auto-scale":"Автоматический масштаб",percentage:"Проценты","log-scale":"Логарифмическая шкала","scale-series":"Игнорировать шкалу индикаторов","lock-scale":"Зафиксировать шкалу","track-time":"Отслеживать время","top-margin":"Отступ сверху","bottom-margin":"Отступ снизу","right-margin":"Отступ справа","left-axis":"Левая шкала","right-axis":"Правая шкала",countdown:"Отображать обратный отсчет","symbol-last":"Маркер последнего значения инструмента","indicator-last":"Маркер последнего значения индикатора","symbol-labels":"Отображать инструмент на шкале","indicator-labels":"Отображать имя индикатора на шкале","precise-labels":"Выравнивать ценовые отметки",label:"Метка",notecolor:"Цвет метки","vert-grid-lines":"Верт. линии сетки","horz-grid-lines":"Гор. линии сетки","scales-text":"Текст на шкалах","scales-lines":"Линии шкал",watermark:"Водяной знак",crosshair:"Перекрестие","navigation-buttons":"Навигационные кнопки","symbol-description":"Описание инструмента","ohlc-values":"Значениe ОТКР-МАКС-МИН-ЗАКР","indicator-titles":"Названия индикаторов","indicator-arguments":"Параметры индикатора","indicator-values":"Значения индикатора","visible-onmouse":"Отображать при наведении курсора","always-visible":"Отображать всегда","always-invisible":"Никогда не отоброжать",themes:"Темы",blue:"Голубая",black:"Черная",grey:"Серая",indicators:"Индикаторы","type-indicator":"Введите название индикатора","bulls-power":"Сила быков","bears-power":"Сила медведей",stochastic:"Стохастический осциллятор","simple-moving":"Скользящее среднее","exponential-moving":"Экспоненциальная скользящая средняя","bollinger-bands":"Полосы Боллинджера","williams-fractal":"Фрактал Вильямса","ichimoku-cloud":"Ишимоку Кинко Хайо","double-exponential":"Двойная скользящая средняя","parabolic-sar":"Параболический индикатор SAR","standard-deviation":"Стандартное отклонение",envelope:"Огибающая  (Envelope)","williams-%r":"Процент Вильямса",atr:"Средний истинный диапазон",rsi:"Индекс относительной силы",adx:"Индикатор среднего направленного движения","awesome-oscillator":"Осциллятор Билла Вильямса","acceleration/deceleration":"Ускорение/Замедление","keltner-channels":"Канал Кельтнера","donchian-channel":"Канал Дончиана",macd:"Схождение расхождение скользящих средних","zoom-in":"Увеличить масштаб","zoom-out":"Уменьшить масштаб",lock:"Зафиксировать все отрисованные объекты",clear:"Удалить все отрисованные объекты",save:"Сохранить",restore:"Восстановить","stay-in-drawing":"Оставаться в режиме рисования","show-hide":"Скрыть все отрисованные объекты","magnet-mode":"Магнит","roulette-mode":"Рулетка",more:"Другое","vertical-line":"Вертикальная линия","horizontal-line":"Горизонтальная линия","trend-line":"Трендовая линия","trend-angle":"Угол тренда","horizontal-ray":"Горизонтальный луч",arrow:"Стрелка",ray:"Луч","parallel-channel":"Канал","disjoint-angle":"Расходящийся угол","flat-top/bottom":"Плоский верх/низ",dot:"Точка",cross:"Перекрестие",brush:"Кисть",rectangle:"Прямоугольник","rotated-rectangle":"Вращ. прямоугольник",ellipse:"Эллипс",triangle:"Треугольник",polyline:"Ломаная линия",curve:"Кривая","double-curve":"Двойная кривая",arc:"Дуга",text:"Текст","anchored-text":"Текст на экране",note:"Заметка","anchored-note":"Заметка на экране","arrow-mark":"Стрелка","arrow-mark-left":"Стрелка влево","arrow-mark-right":"Стрелка вправо","arrow-mark-up":"Стрелка вверх","arrow-mark-down":"Стрелка вниз",flag:"Флаг",flagcolor:"Цвет флага",all:"Все",commodity:"Товары",currency:"Валюта",index:"Индексы",stock:"Акции",crypto:"Крипто","no-financial":"Подходящих финансовых инструментов не найдено","indicator-not-found":"Нет индикаторов, соответствующим критериям поиска",candle:"Японские свечи",area:"Область",bar:"Бары",hollow:"Пустые свечи",bid:"Bid",ask:"Ask",mid:"Mid",open:"ОТКР.",high:"МАКС.",low:"МИН.",close:"ЗАКР.",value:"Значение",delete:"Удалить",params:"Свойства",coordinates:"Координаты",visibility:"Видимость",normal:"Обычная",dash:"Пунктир",point:"Точка",points:"Точка","show-price":"Отображать цену","show-price-range":"Отображать цену",price:"Цена",barNumber:"Бар №","show-text":"Отображать текст","show-time":"Отображать время","text-color":"Цвет текста","text-alignment":"Выравнивание текста","left-end":"Левый край","right-end":"Правый край","show-bars":"Отображать диапазон в барах","show-bars-range":"Отображать диапазон в барах","show-date":"Отображать временной диапазон","show-date-time-range":"Отображать временной диапазон","show-distance":"Отображать растояние","show-angle":"Отображать угол","always-show-stats":"Всегда отображать текст",middle:"Центр",signals:"Сигналы",simple:"Простая","with-markers":"Точки",step:"Ступени","custom-color":"Настройка цвета","buy-time":"Buy Time(RU)","purchase-time":"Время покупки",optionResult:"РЕЗУЛЬТАТ:","bars-roulete":" баров, ","day-roulete":" д, ","hour-roulete":" ч, ","minute-roulete":" м ","open-prise-source":"ОТКР.","high-prise-source":"МАКС.","low-prise-source":"МИН.","close-prise-source":"ЗАКР.","hl2-prise-source":"(М+М)/2","hlc3-prise-source":"(М+М+З)/3","ohlc4-prise-source":"(О+М+М+З)/4"},en:{"1-minute":"1 minute","5-minutes":"5 minutes","15-minutes":"15 minutes","30-minutes":"30 minutes","1-hour":"1 hour","4-hours":"4 hours","8-hours":"8 hours","1-day":"1 day","1-week":"1 week","1-month":"1 month","1m":"1m","5m":"5m","15m":"15m","30m":"30m","1h":"1h","4h":"4h","8h":"8h","1D":"1D","1W":"1W","1M":"1M","link-symbol-to":"Link symbol to all charts","link-interval-to":"Link interval to all charts","link-crosshair-on":"Sync crosshair on all charts","track-time-on":"Track time on all charts","color-bars-based":"Color bars based on previous close",borders:"Border",border:"Border",wick:"Wick","price-line":"Price Line",scale:"Scale",scales:"Scales","override-min":"Override Min Tick","price-source":"Price Source",price:"Price",barNumber:"Bar #",line:"Line",fill:"Fill",type:"Type","hlc-bars":"HLC Bars","up-color":"Up Color","down-color":"Down Color",default:"Defaults","default-tch":"Defaults",ok:"Ok",cancel:"Cancel",closeBtn:"Close",style:"Style",inputs:"Inputs",period:"Period",K:"K",D:"D",KLine:"KLine",DLine:"DLine",ADX:"ADX",DIM:"DIM",DIP:"DIP",fastLength:"fastLength",slowLength:"slowLength",signalLength:"signalLength",histogram:"histogram",signal:"signal",U:"U",M:"M",L:"L",cloud:"cloud",smallPeriod:"smallPeriod",middlePeriod:"middlePeriod",largePeriod:"largePeriod",TenkanSen:"TenkanSen",KijunSen:"KijunSen",ChinkouSpan:"ChinkouSpan",SenkouSpanA:"SenkouSpanA",SenkouSpanB:"SenkouSpanB",A:"A",B:"B",lenght:"lenght",percent:"percent",avarage:"average",startAf:"startAf",stepAf:"stepAf",maxAf:"maxAf",multi:"multi",lineUp:"lineUp",lineDown:"lineDown",background:"Background",timezone:"Timezone",right:"Right",left:"Left","auto-scale":"Auto Scale",percentage:"Percentage","log-scale":"Log Scale","scale-series":"Scale Series Only","lock-scale":"Lock scale","track-time":"Track time","top-margin":"Top Margin","bottom-margin":"Bottom Margin","right-margin":"Right Margin","left-axis":"Left Axis","right-axis":"Right Axis",countdown:"Countdown","symbol-last":"Symbol Last Value","indicator-last":"Indicator Last Value","symbol-labels":"Symbol Labels","indicator-labels":"Indicator Labels","precise-labels":"Precise Labels",label:"Label",notecolor:"Note color","vert-grid-lines":"Vert Grid Lines","horz-grid-lines":"Horz Grid Lines","scales-text":"Scales Text","scales-lines":"Scales Lines",watermark:"Watermark",crosshair:"Crosshair","navigation-buttons":"Navigation Buttons","symbol-description":"Symbol Description","ohlc-values":"OHLC Values","indicator-titles":"Indicator Titles","indicator-arguments":"Indicator Arguments","indicator-values":"Indicator Values","visible-on mouse":"Visible on Mouse Over","always-visible":"Always Visible","always-invisible":"Always Invisible",themes:"Themes",blue:"Blue",black:"Black",grey:"Gray",indicators:"Indicators","type-indicator":"Type indicator name","bears-power":"Bears power","bulls-power":"Bulls power ",stochastic:"Stochastic","simple-moving":"Simple Moving Average","exponential-moving":"Exponential Moving Average","bollinger-bands":"Bollinger Bands","williams-fractal":"Williams Fractal","ichimoku-cloud":"Ichimoku Cloud","double-exponential":"Double Exponential Moving Average","parabolic-sar":"Parabolic Sar","standard-deviation":"Standard Deviation",envelope:"Envelope","williams-%r":"Williams %R",atr:"ATR",rsi:"RSI",adx:"ADX","awesome-oscillator":"Awesome Oscillator","acceleration/deceleration":"Acceleration/Deceleration","keltner-channels":"Keltner channel","donchian-channel":"Donchian channel",macd:"MACD","zoom-in":"Zoom In","zoom-out":"Zoom Out",lock:"Lock All Drawing Tools",clear:"Remove All Drawing Tools",save:"Save",restore:"Restore","stay-in-drawing":"Stay in Drawing Mode","show-hide":"Hide All Drawing Tools","magnet-mode":"Magnet Mode","roulette-mode":"Roulette Mode",more:"More","vertical-line":"Vertical Line","horizontal-line":"Horizontal Line","trend-line":"Trend Line","trend-angle":"Trend Angle","horizontal-ray":"Horizontal Ray",arrow:"Arrow",ray:"Ray","parallel-channel":"Parallel Channel","disjoint-angle":"Disjoint Angle","flat-top/bottom":"Flat Top/Bottom",dot:"Dot",cross:"Cross",brush:"Brush",rectangle:"Rectangle","rotated-rectangle":"Rotated Rectangle",ellipse:"Ellipse",triangle:"Triangle",polyline:"Polyline",curve:"Curve","double-curve":"Double Curve",arc:"Arc",text:"Text","anchored-text":"Anchored Text","arrow-mark":"Arrow Mark","arrow-mark-left":"Arrow Mark Left","arrow-mark-right":"Arrow Mark Right","arrow-mark-up":"Arrow Mark Up","arrow-mark-down":"Arrow Mark Down",flag:"Flag",flagcolor:"FlagColor",note:"Note","anchored-note":"AnchoredNote",all:"All",commodity:"Commodities",currency:"Currency",index:"Indices",stock:"Stocks",crypto:"Crypto","no-financial":"No financial instrument matched your criteria","indicator-not-found":"No indicators matched your criteria",candle:"Candles",area:"Area",bar:"Bars",hollow:"Hollow Candles",bid:"Bid",ask:"Ask",mid:"Mid",open:"Open",high:"High",low:"Low",close:"Close",value:"Value",delete:"Delete",params:"  Parameters",coordinates:"Coordinates",visibility:"Visibility",normal:"Normal",dash:"Dash",point:"Points",points:"Points","show-price":"Show Price","show-price-range":"Show Price Range","show-text":"Show Text","show-time":"Show Time Range","text-color":"Stats Text Color","text-alignment":"Text Alignment","left-end":"Left End","right-end":"Right End","show-bars":"Show Bars Range","show-bars-range":"Show Bars Range","show-date":"Show Date Range","show-date-time-range":"Show date time range","show-distance":"Show Distance","show-angle":"Show Angle","always-show-stats":"Always Show Stats",middle:"Middle",signals:"Signals",simple:"Simple","with-markers":"With Markers",step:"Step","custom-color":"Custom color",optionResult:"RESULT:","buy-time":"Buy Time","purchase-time":"Purchase Time","bars-roulete":" bars, ","day-roulete":" d, ","hour-roulete":" h, ","minute-roulete":" m ","open-prise-source":"Open","high-prise-source":"Hight","low-prise-source":"Low","close-prise-source":"Close","hl2-prise-source":"(H+L)/2","hlc3-prise-source":"(H+L+C)/3","ohlc4-prise-source":"(O+H+L+C)/4"},es:{"1-minute":"1 minuto","5-minutes":"5 minutos","15-minutes":"15 minutos","30-minutes":"30 minutos","1-hour":"1 hora","4-hours":"4 horas","8-hours":"8 horas","1-day":"1 día","1-week":"1 semana","1-month":"1 mes","1m":"1min","5m":"5min","15m":"15min","30m":"30min","1h":"1h","4h":"4h","8h":"8h","1D":"1d","1W":"1sem","1M":"1mes","link-symbol-to":"Simbolo del enlace a todos los graficos","link-interval-to":"Intervalo de enlace para todos los graficos","link-crosshair-on":"Sincronizar la cruz en todos los graficos","track-time-on":"Seguimiento del tiempo en todos los graficos","color-bars-based":"Barras de color basadas en el anterior cierre",borders:"Borde",border:"Borde",wick:"Mecha de la vela","price-line":"Línea de precios",scale:"Escala",scales:"Escalas","override-min":"Anule la marca de un minuto","price-source":"Fuente del precio",line:"Linea",fill:"Llenar",type:"Tipo","hlc-bars":"Barras HLC","up-color":"Color arriba","down-color":"Color abajo",default:"Por defecto","default-tch":"Por defecto",ok:"Ok",cancel:"Cancelar",style:"Estilo",inputs:"Entrada",K:"K",D:"D",KLine:"Linea K",DLine:"Linea D",ADX:"ADX",DIM:"DI-",DIP:"DI+",fastLength:"Longuitud Rapida",slowLength:"Longuitud Lenta",signalLength:"Allanamiento de la Señal",histogram:"Histograma",signal:"Señal",U:"Superior",M:"Medio",L:"Inferior",cloud:"Nube",smallPeriod:"Periodo Pequeño",middlePeriod:"Periodo Medio",largePeriod:"Periodo Grande",TenkanSen:"TenkanSen",KijunSen:"KijunSen",ChinkouSpan:"ChinkouSpan",SenkouSpanA:"SenkouSpanA",SenkouSpanB:"SenkouSpanB",A:"A",B:"B",lenght:"Longuitud",percent:"Por ciento",avarage:"Promedio",startAf:"Comienzo",stepAf:"Paso",maxAf:"Max",multi:"Multi",lineUp:"Linea hacia arriba",lineDown:"Linea hacia abajo",period:"Periodo",background:"Fondo",timezone:"Zona Horaria",right:"Derecha",left:"Izquierda","auto-scale":"Escala automática",percentage:"Porcentaje","log-scale":"Escala Logaritmica","scale-series":"Serie de la escala sólo","lock-scale":"Bloquear la Escala","track-time":"Tiempo de Seguimiento","top-margin":"Margen Superior","bottom-margin":"Margen Inferior","right-margin":"Margen Derecho","left-axis":"Eje Izquierdo","right-axis":"Eje Derecho",countdown:"Cuenta Regresiva","symbol-last":"Simbolo del Ultimo Valor","indicator-last":"Indicador del Ultimo Valor","symbol-labels":"Etiquetas de Simbolo","indicator-labels":"Etiquetas del Indicador","precise-labels":"Etiquetas Precisas",label:"Etiqueta","vert-grid-lines":"Línea de la rejilla vertical","horz-grid-lines":"Línea de la rejilla horizontal","scales-text":"Texto de escalas","scales-lines":"Líneas de escalas",watermark:"Filigrana",crosshair:"Cruz","navigation-buttons":"Botones de Navegacion","symbol-description":"Descripcion del Simbolo","ohlc-values":"Valores de OHLC","indicator-titles":"Títulos del indicador","indicator-arguments":"Indicador de Argumentos","indicator-values":"Valores del indicador","visible-on mouse":"Visibilidad del mouse sobre","always-visible":"Siempre Visible","always-invisible":"Siempre Invicible",themes:"Temas",blue:"Azul",black:"Negro",grey:"Gris",indicators:"Indicadores","type-indicator":"Nombre del tipo de indicador","bears-power":"Energía de osos","bulls-power":"Energía de toros",stochastic:"Estocastico","simple-moving":"Promedio del Movimiento Simple","exponential-moving":"Valor medio en momiento exponencial","bollinger-bands":"Grupos de Bollinger","williams-fractal":"Wiliams Fractal","ichimoku-cloud":"Ichimoku Cloud","double-exponential":"Promedio del moviemto doble exponencial","parabolic-sar":"Parabolico de SAR","standard-deviation":"Desviacion Estandar",envelope:"Sobre (Envelope)","williams-%r":"Variedad del porcentaje de Williams",atr:"ATR",rsi:"RSI",adx:"ADX","awesome-oscillator":"Increible oscilador","acceleration/deceleration":"Aceleración/desaceleracion","keltner-channels":"Canal de Keltner","donchian-channel":"Canal de Donchian",macd:"MACD","zoom-in":"Aumentar el zoom","zoom-out":"Disminuir el zoom",lock:"Fijar todas herramientas del dibujo",clear:"Eliminar todas las herramientas del dibujo",save:"Guardar",restore:"Restaurar","stay-in-drawing":"Quedarse en modo dibujo","show-hide":"Ocultar todas las herramientas de dibujo","magnet-mode":"Modo Iman","roulette-mode":"Modo Ruleta",more:"Mas","vertical-line":"Línea Vertical","horizontal-line":"Línea Horizontal","trend-line":"Línea de tendecnia","trend-angle":"Angulo de tendencia","horizontal-ray":"Haz horizontal",arrow:"Flecha",ray:"Haz","parallel-channel":"Canal paralelo","disjoint-angle":"Angulo divergente","flat-top/bottom":"Plano Superior/inferior",dot:"Punto",cross:"Cruzado",brush:"Cepillo",rectangle:"Rectangulo","rotated-rectangle":"Rectangulo Girado",ellipse:"Elipse",triangle:"Triangulo",polyline:"Polilinea",curve:"Curva","double-curve":"Double Curve -es",arc:"Arco",text:"Texto","anchored-text":"Texto Anclado","arrow-mark":"Marca de Flecha","arrow-mark-left":"Marca de flecha izquierda","arrow-mark-right":"Marca de flecha derecha","arrow-mark-up":"Marca de flecha arriba","arrow-mark-down":"Marca de flecha abajo",flagcolor:"Color de la bandera",flag:"Bandera",note:"Nota","anchored-note":"Nota anclada",all:"Todo",commodity:"Mercancia",currency:"Moneda",index:"Indice",stock:"Stock",crypto:"Crypto","no-financial":"Ningun Instrumento Financiero coincide con su criterio","indicator-not-found":"Ningun indicador emparejo con sus criterios",candle:"Velas Japonesas",area:"Area",bar:"Barras",hollow:"Velas vacias",bid:"Oferta",ask:"Preguntar",mid:"Media",open:"Abierto",high:"Alto",low:"Bajo",close:"Cerrado",value:"Valor",delete:"Eliminar",params:"Parametros",coordinates:"Coordenadas",visibility:"Vsibilidad",normal:"Normal",dash:"Guion",point:"Puntos",points:"Puntos","show-price":"Mostrar el Precio","show-price-range":"Mostrar el Rango de Precio","show-text":"Mostrar el Texto","show-time":"Mostrar el Intervalo de Tiempo","text-color":"Color del Texto De Estadistica","text-alignment":"Alineacion del Texto","left-end":"Final Izquiero","right-end":"Final Derecho","show-bars":"Mostrar la Variedad de Barras","show-bars-range":"Mostrar la Variedad de Barras","show-date":"Mostrar el Rango de Fechas","show-date-time-range":"Muestre el Rango del Tiempo Fecha","show-distance":"Mostrar Distancia","show-angle":"Mostrar Angulo","always-show-stats":"Mostrar Siempre Estadisticas",middle:"Media",signals:"Señales",simple:"Simple","with-markers":"Con Marcadores",step:"Paso","custom-color":"Color personalizado","buy-time":"Buy Time(ES)","purchase-time":"PURCHASE\nTIME (ES)",optionResult:"Result","bars-roulete":" bars, ","day-roulete":" d, ","hour-roulete":" h, ","minute-roulete":" m "},ar:{"1-minute":"1 دقيقة","5-minutes":"5 دقائق","15-minutes":"15 دقائق","30-minutes":"30 دقيقة","1-hour":"1 ساعة","4-hours":"4 ساعات","8-hours":"8 ساعات","1-day":"1 يوم","1-week":"1 اسبوع","1-month":"1 شهر","1m":"1m","5m":"5m","15m":"15m","30m":"30m","1h":"1h","4h":"4h","8h":"8h","1D":"1D","1W":"1W","1M":"1M","link-symbol-to":"رابط الرمز لجميع البيانات","link-interval-to":"رابط فاصل لجميع البيانات","link-crosshair-on":"رابط تقاطع لجميع البيانات","track-time-on":"المسار الزمني لجميع البيانات","color-bars-based":"لون القضبان إستنادا على الإغلاق السابق",borders:"السكتة الدماغية",border:"السكتة الدماغية",wick:"فتيلة","price-line":"خط السعر",scale:"سلم",scales:"النطاقات","override-min":"تجاوز الحد الأدنى للقراد","price-source":"مصدر السعر",line:"خط",fill:"ملء",type:"نوع","hlc-bars":"قضبان HLC","up-color":"اللون أعلاه","down-color":"اللون أسفله",default:"افتراضيا","default-tch":"افتراضيا",ok:"حسنا",cancel:"إلغاء",style:"أسلوب",inputs:"مساهمات",K:"ك",D:"د",KLine:"الخط ك",DLine:"الخط د",ADX:"ADX",DIM:"DI-",DIP:"DI+",fastLength:"طول سريع",slowLength:"طول بطئ",signalLength:"إشارة التمهيد",histogram:"الرسم البياني",signal:"إشارة",U:"الأعلى",M:"الأوسط",L:"ضعيف",cloud:"سحابة",smallPeriod:"مدة قصيرة",middlePeriod:"مدة متوسطة",largePeriod:"مدة طويلة",TenkanSen:"TenkanSen",KijunSen:"KijunSen",ChinkouSpan:"ChinkouSpan",SenkouSpanA:"SenkouSpanA",SenkouSpanB:"SenkouSpanB",A:"أ",B:"ب",lenght:"الطول",percent:"نسبه مئويه",avarage:"متوسط",startAf:"بدء",stepAf:"خطوة",maxAf:"ماكس",multi:"متعدد",lineUp:"خط للأعلى",lineDown:"خط للسفل",period:"فترة",background:"خلفية",timezone:"منطقة زمنية",right:"يمين",left:"يسار","auto-scale":"السلم التلقائي",percentage:"النسبة المئوية","log-scale":"تسجيل الجدول","scale-series":"تجاهل مقياس المؤشر","lock-scale":"إغلاق الجدول","track-time":"مسار زمني","top-margin":"الهامش العلوي","bottom-margin":"الهامش السفلي","right-margin":"الهامش الأيمن","left-axis":"المحور الأيسر","right-axis":"المحور الأيمن",countdown:"العد التنازلي","symbol-last":"رمز اخر قيمة","indicator-last":"مؤشراخر قيمة","symbol-labels":"رمز العلامات","indicator-labels":"مؤشر العلامات","precise-labels":"علامات دقيقة",label:"علامة","vert-grid-lines":"الخط العمودي للشبكة","horz-grid-lines":"الخط الأفقي للشبكة","scales-text":"النص على المقاييس","scales-lines":"مقياس الخطوط",watermark:"العلامة المائية",crosshair:"التقاطع","navigation-buttons":"أزرار التنقل","symbol-description":"رمز الوصف","ohlc-values":"قيم OHLC","indicator-titles":"أسماء المؤشرات","indicator-arguments":"حجج المؤشرات","indicator-values":"معنى المؤشر","visible-on mouse":"مرئية على الماوس ","always-visible":"مرئية دائما","always-invisible":"دائما غير مرئية",themes:"المواضيع",blue:"سماوي",black:"أسود",grey:"رمادي",indicators:"مؤشرات","type-indicator":"أدخل اسم المؤشر","bears-power":"قوة الدببة","bulls-power":"قوة الثيران",stochastic:"العشوائية","simple-moving":"متوسط متحرك بسيط","exponential-moving":"المتوسط المتحرك الأسي","bollinger-bands":"خطوط بولينجر","williams-fractal":"كسورية ويليامز","ichimoku-cloud":"إيشيموكو كلاود","double-exponential":"المتوسط المتحرك المزدوج","parabolic-sar":"مؤشر مكافئ SAR","standard-deviation":"الانحراف المعياري",envelope:"ظرف","williams-%r":"نسبة ويليامز",atr:"ATR",rsi:"RSI",adx:"ADX","awesome-oscillator":"المذبذب العجيب","acceleration/deceleration":"التسارع / التباطؤ","keltner-channels":"قنوات كيلتنر","donchian-channel":"قناة دونشيان",macd:"MACD","zoom-in":"تكبير","zoom-out":"تصغير",lock:"إصلاح كل الأشياء المقدمة",clear:"مسح كل الأشياء المرسومة",save:"حفظ",restore:"إعادة ","stay-in-drawing":"البقاء في وضع الرسم","show-hide":"إخفاء جميع الأشياءالمقدمة","magnet-mode":"مغناطيس","roulette-mode":"روليت",more:"أكثر","vertical-line":"خط عمودي","horizontal-line":"خط أفقي","trend-line":"اتجاه الخط","trend-angle":"زاوية الاتجاه","horizontal-ray":"شعاع أفقي",arrow:"سهم",ray:"شعاع ","parallel-channel":"قناة","disjoint-angle":"زاوية متباينة","flat-top/bottom":"شقة أعلى / أسفل",dot:"نقطة",cross:"تقاطع",brush:"فرشاة",rectangle:"مستطيل","rotated-rectangle":"مستطيل مستدير",ellipse:"قطعة ناقصة",triangle:"مثلث",polyline:"خط متقطع",curve:"منحنى","double-curve":"Double Curve -ar",arc:"قوس",text:"نص","anchored-text":"نص راسخ","arrow-mark":"سهم مارك","arrow-mark-left":"سهم موجه لليسار","arrow-mark-right":"سهم موجه لليمين","arrow-mark-up":"سهم موجه للأسفل","arrow-mark-down":"سهم موجه للأعلى",flagcolor:"لون العلم",flag:"علم",note:"ملحوظة","anchored-note":"ملاحظة راسخة",all:"الكل",commodity:"سلعة",currency:"عملة",index:"مؤشر",stock:"سهم",crypto:"مشفرة","no-financial":"لاتوجد أداة مالية مطابقة للمعايير الخاصة بك","indicator-not-found":"لا توجد مؤشرات تطابق معاييرك",candle:"الشمعات اليابانية",area:"منطقة",bar:"الحانات",hollow:"الشموع الفارغة",bid:"عرض",ask:"اسأل",mid:"متوسط",open:"فتح",high:"مرتفع",low:"منخفض",close:"غلق",value:"القيمة",delete:"حذف",params:"المعايير .إعدادات.خيارات",coordinates:"إحداثيات",visibility:"رؤية",normal:"عادي",dash:"اندفاع",point:"نقاط",points:"نقاط","show-price":"اظهار السعر","show-price-range":"هامش إظهار السعر","show-text":"إظهار النص","show-time":"هامش إظهار النص","text-color":"إحصائيات لون النص","text-alignment":"محاذاة النص","left-end":"نهاية اليسار","right-end":"النهاية اليمنى","show-bars":"هامش إظهار القضبان","show-bars-range":"هامش إظهار القضبان","show-date":"هامش إظهار التاريخ ","show-date-time-range":"هامش إظهار التاريخ الزمني","show-distance":"إظهار المسافة","show-angle":"إظهار الزاوية","always-show-stats":" إظهار الإحصاءات دائما ",middle:"المتوسط",signals:"الإشارات",simple:"بسيط","with-markers":"مع علامات",step:"خطوة","custom-color":"Custom color-ar","buy-time":"Buy Time(AR)","purchase-time":"Purchase Time(AR)","bars-roulete":" bars, ","day-roulete":" d, ","hour-roulete":" h, ","minute-roulete":" m "},default:{}},o=i("./src/scripts/utils/utils.js"),h=i("./node_modules/axios/index.js"),c=i.n(h),l=function ConnectorWidgets(t){var e=this;!function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,ConnectorWidgets),_defineProperty(this,"addListener",function(t){e.listeners.push(t)}),_defineProperty(this,"getNews",function(t){if(e.options.newsUrl){var a="".concat(e.options.newsUrl,"&from=").concat(t.interval.from,"&to=").concat(t.interval.to,"&count=100");e.getData(a,[t.listener],t)}}),_defineProperty(this,"getEvents",function(t){if(e.options.eventsUrl){var a=e.convertUnixToEventsAPIDate(t.interval.from),i=e.convertUnixToEventsAPIDate(t.interval.to),s="".concat(e.options.eventsUrl,"?f=json&view=range&volatility=2&start=").concat(a,"&end=").concat(i,"&culture=").concat(t.lang,"&countrycode=").concat(t.countries.join(","));e.getData(s,[t.listener],t)}}),_defineProperty(this,"convertUnixToEventsAPIDate",function(t){var e=new Date(1e3*t),a=e.getUTCFullYear().toString(),i=(e.getUTCMonth()+1).toString();i=i.length>1?i:"0"+i;var s=e.getUTCDate().toString();return s=s.length>1?s:"0"+s,"".concat(a).concat(i).concat(s)}),_defineProperty(this,"getData",function(t,e,a){c.a.get(t).then(function(t){if(200!==t.status){var i=new Error(t.statusText);throw i.res=t,i}for(var s=0;s<e.length;s++)e[s].onConnectorMessage(t.data,e[s],a)}).catch(function(t){console.warn(t)})}),_defineProperty(this,"parseSignals",function(t){var a=JSON.parse(t).map(function(t){return{id:t.resultuid,strength:t.quality,symbol:t.symbol,period:e.convertIntervalToPeriod(t.interval),pattern:t.pattern,patternEN:t.pattern,direction:t.direction,forecast:t.direction>0?"Buy":"Sell",isSgnlUpdated:!1,relevant:t.relevant,patternEndTime:parseInt(t.patternendtime,10),predictionPriceFrom:t.predictionpricefrom,predictionPriceTo:t.predictionpriceto,predictionTimeFrom:t.predictiontimefrom,predictionTimeTo:t.predictiontimeto,resistancex0:t.resistancex0,resistancex1:t.resistancex1,resistancey0:t.resistancey0,resistancey1:t.resistancey1,supportx0:t.supportx0,supportx1:t.supportx1,supporty0:t.supporty0,supporty1:t.supporty1,stoploss:t.stoploss,trend:t.trend,forecastPriceFrom:t.predictionpricefrom,forecastPriceTo:t.predictionpriceto,length:t.length,isVisible:!1}});return e.combineSignals(a)}),_defineProperty(this,"combineSignals",function(t){for(var e={},a=0;a<t.length;a++)e[t[a].symbol]||(e[t[a].symbol]={}),e[t[a].symbol][t[a].id]=t[a];return e}),_defineProperty(this,"convertIntervalToPeriod",function(t){switch(t){case 1:return"minute";case 5:return"minute5";case 15:return"minute15";case 30:return"minute30";case 60:return"hour";case 240:return"hour4";case 480:return"hour8";case 1440:case"day":return"day";case"week":return"week";case"month":return"month";case"minute":return"minute";case"minute5":return"minute5";case"minute15":return"minute15";case"minute30":return"minute30";case"hour":return"hour";default:return"minute"}}),_defineProperty(this,"getMiddlePrice",function(t,e,a){return((parseFloat(t)+parseFloat(e))/2).toFixed(a)}),_defineProperty(this,"createWebSocketConn",function(){var t=e.options.wsUrl+"?subscriber=true";e.client=new WebSocket(t),e.client.onmessage=function(t){if(e.listeners)for(var a=0;a<e.listeners.length;a++){var i=e.processRatesData(JSON.parse(t.data));e.listeners[a].onConnectorMessage(i,e.listeners[a])}},e.client.onopen=function(){e.client.connected=!0,e.updateSubscription();for(var t=0;t<e.listeners.length;t++)e.listeners[t].onConnect()},e.client.onclose=function(){}}),_defineProperty(this,"updateSubscription",function(){if(e.client){for(var t=[],a=0;a<e.listeners.length;a++){for(var i=!1,s=0;s<t.length;s++)if(t[s].id===e.listeners[a].id&&t[s].period===e.listeners[a].getServerPeriod()){i=!0;break}i||t.push({id:e.listeners[a].id,period:e.listeners[a].getServerPeriod()})}JSON.stringify(t.sort())!==JSON.stringify(e.subscriptions.sort())&&(e.subscriptions=t,e.subscribe(e.subscriptions))}}),_defineProperty(this,"getBars",function(t){if(e.client&&e.client.connected){var a="";switch(t.cmd){case"getFirstData":a="".concat(e.options.url).concat(t.pair.ID,"/").concat(t.period,"/").concat(t.numb,"/?withCurrentBar=true&param=full"),e.getBarsData(a,t.listener,t);break;case"getDataOnUpdate":a="".concat(e.options.wsUrl.replace("ws","http"),"?command=getfirstbar&id=").concat(t.pair.ID,"&period=").concat(t.period,"&param=full"),e.getBarsData(a,t.listener,t);break;case"getDataFromSeconds":a="".concat(e.options.url).concat(t.pair.ID,"/").concat(t.period,"/").concat(t.numb,"/").concat(t.startSeconds,"?param=full"),e.getBarsData(a,t.listener,t)}}}),_defineProperty(this,"processRatesData",function(t){var a=[],i=null;if(t.data){i=JSON.parse(t.data);for(var s=0;s<i.length;s++)a.push({security:i[s].Name,bidPrice:i[s].CurrentValue})}else if(t.updated){for(var r=[],n=!1,h=0;h<e.listeners.length;h++){var c=e.listeners[h];if(c.session&&"open"===c.session&&t.updated%c.getCurrentTimeStep()===0&&c.chart){for(var l=c.pair,d=c.period,p=0;p<r.length;p++){r[p].pair.ID===l.ID&&r[p].period===d&&c.chart&&(r[p].pair=l,r[p].period=d,r[p].callBacks.push({listener:c,callBack:c.chart.updateChart})),n=!0;break}n||r.push({pair:l,period:d,callBacks:[{listener:c,callBack:c.chart.updateChart}]})}}for(var u=0;u<r.length;u++)e.getDataOnUpdate(r[u]);r=null}var g={};if(t.module)if("rates"===t.module)for(var v=0;v<t.args.length;v++)a.push({security:t.args[v].Name,bid:t.args[v].Bid,ask:t.args[v].Ask});else if("bars"===t.module&&"update"===t.cmd){var f=Object(o.b)(t);f.args.bar&&(f.args.bar=e.processModuleBarItem(f.args.bar)),g={module:f.module,cmd:f.cmd,args:f.args}}else"signals"===t.module&&("list"===t.cmd?e.processSignalsList(t.args):e.processSignals(t.args));return{rates:a,mdata:Object.keys(g).length?g:void 0}}),_defineProperty(this,"processModuleBarItem",function(t,a){var i,s=a;if(!s)for(var r in s=0,t)t.hasOwnProperty(r)&&"time"!==r&&(i=t[r].replace(",",".").split(".")).length>1&&i[1].length>s&&(s=i[1].length);return{ask:{low:t.lowAsk,high:t.highAsk,open:t.openAsk,close:t.closeAsk,date:t.time},bid:{low:t.lowBid,high:t.highBid,open:t.openBid,close:t.closeBid,date:t.time},mid:{low:e.getMiddlePrice(t.lowBid,t.lowAsk,s),high:e.getMiddlePrice(t.highBid,t.highAsk,s),open:e.getMiddlePrice(t.openBid,t.openAsk,s),close:e.getMiddlePrice(t.closeBid,t.closeAsk,s),date:t.time}}}),_defineProperty(this,"getDataOnUpdate",function(t){var a="".concat(e.options.url).concat(t.pair.ID,"/").concat(t.period,"/1");c.a.get(a).then(function(a){if(200!==a.status){var i=new Error(a.statusText);throw i.res=a,i}for(var s=e.processChartDataBars(a.data,a.headers),r=0;r<t.callBacks.length;r++){var n={pair:t.pair,period:t.period,callBack:t.callBacks[r].callBack};t.callBacks[r].listener.onConnectorMessage(s.bars[0],t.callBacks[r].listener,n)}}).catch(function(t){console.warn(t)})}),_defineProperty(this,"processChartDataBars",function(t,a){for(var i={ask:[],bid:[],mid:[]},s=a.precission,r=0;r<t.length;r++)t[r-1]&&t[r]&&t[r].T>=t[r-1].T||(i.ask.push({low:parseFloat(t[r].LA).toFixed(s),high:parseFloat(t[r].HA).toFixed(s),open:parseFloat(t[r].OA).toFixed(s),close:parseFloat(t[r].CA).toFixed(s),date:t[r].T}),i.bid.push({low:parseFloat(t[r].LB).toFixed(s),high:parseFloat(t[r].HB).toFixed(s),open:parseFloat(t[r].OB).toFixed(s),close:parseFloat(t[r].CB).toFixed(s),date:t[r].T}),i.mid.push({low:e.getMiddlePrice(t[r].LB,t[r].LA,s),high:e.getMiddlePrice(t[r].HB,t[r].HA,s),open:e.getMiddlePrice(t[r].OB,t[r].OA,s),close:e.getMiddlePrice(t[r].CB,t[r].CA,s),date:t[r].T}));return{bars:i,precission:s,quotation:a.quotation,session:a.session?a.session.toLowerCase():"open"}}),_defineProperty(this,"getBarsData",function(t,a,i){c.a.get(t).then(function(t){if(200!==t.status){var s=new Error(t.statusText);throw s.res=t,s}var r=e.processChartDataBars(JSON.parse(t.data),t.headers);"getFirstData"===i.cmd&&r.bars&&Object.keys(r.bars).length&&!a.hasNextData&&(r.bars.ask[0].isCurrentData=!0,r.bars.bid[0].isCurrentData=!0,r.bars.mid[0].isCurrentData=!0),a.onConnectorMessage(r,a,i)}).catch(function(t){console.warn(t)})}),_defineProperty(this,"getAutoChartistSignals",function(){e.client&&e.client.send(JSON.stringify({module:"signals",cmd:"",args:JSON.stringify(e.getNamesOfCurrencies())}))}),_defineProperty(this,"getAutoChartistSignalsList",function(){e.client&&e.client.send(JSON.stringify({module:"signals",cmd:"list"}))}),_defineProperty(this,"processSignals",function(t){if(e.client){var a=e.parseSignals(t);if(e.listeners)for(var i=0;i<e.listeners.length;i++){var s=a[e.listeners[i].pair.Name];s?e.listeners[i].onConnectorMessage(s,e.listeners[i]):e.listeners[i].chart&&(e.listeners[i].signalsData={},e.listeners[i].chart.updateSignals())}}}),_defineProperty(this,"processSignalsList",function(t){if(e.client){var a=JSON.parse(t);e.listeners&&(e.listeners[0].techChart.signalsList=a,e.listeners[0].techChart.updateSignalsDropdown(a))}}),_defineProperty(this,"getNamesOfCurrencies",function(){return e.listeners.map(function(t){return t.pair.Name})}),_defineProperty(this,"getConnectionSettings",function(){e.options.wsUrl=e.options.wsUrl.replace("https:","").replace("http:","").replace("wss:","").replace("ws:","");var t=e.options.wsUrl.split("?")[0]+"?command=getConnectingStr";fetch(t).then(function(t){if(200===t.status)return t.text();var e=new Error(t.statusText);throw e.res=t,e}).then(function(t){var a=window.location.protocol.replace("http","ws");e.options.wsUrl=a+e.options.wsUrl,e.options.wsUrl=e.options.wsUrl.replace(/\/\/informer./,"//".concat(t,".")),e.options.wsUrl=e.options.wsUrl.replace("bal/",""),e.createWebSocketConn()}).catch(function(t){console.warn(t)})}),_defineProperty(this,"subscribe",function(t){e.client.send(JSON.stringify({module:"binding",cmd:"update",args:t}))}),this.listeners=[],this.client=null,this.subscriptions=[],this.options=Object(o.b)(t.connectorOptions),this.type=this.options.type,this.options.pair=t.pair,this.getConnectionSettings()};LibCanvas.measureText=function(t,e,a){var i=t.font;t.font=e;var s=t.measureText(a);return t.font=i,s},LibCanvas.getPosition=function(t,e){var a=Math.round(2*t)/2,i=a%1;return e%2===0&&.5===i?a-=.5:e%2!==0&&0===i&&(a-=.5),a},LibCanvas.clearRect=function(t,e,a,i,s,r){if(t||e){var n=e||t.getContext("2d");n&&n.clearRect(a,i,s,r)}},LibCanvas.drawLine=function(t,e,a,i,s,r,n,o,h,c){if(t||e){var l,d=e||t.getContext("2d");d&&(o&&d.setLineDash&&d.setLineDash(o),h&&(l=d.lineWidth,d.lineWidth=h),c&&(d.globalAlpha=c),d.beginPath(),d.moveTo(a,i),d.lineTo(s,r),d.strokeStyle=n,d.stroke(),o&&d.setLineDash,h&&(d.lineWidth=l),c&&(d.globalAlpha=1))}},LibCanvas.drawArc=function(t,e,a,i,s,r,n,o,h,c,l,d){if(t||e){var p=e||t.getContext("2d");p&&(h&&p.setLineDash&&p.setLineDash(h),s*=Math.PI/180,r=-r*(Math.PI/180),p.beginPath(),p.arc(a,i,n,s,r,d),p.lineWidth=c,p.stroke())}},LibCanvas.drawEllipse=function(t,e,a,i,s,r,n,o,h,c,l,d,p,u,g){if(t||e){var v,f=e||t.getContext("2d");f&&(g&&f.setLineDash&&f.setLineDash(g),f.globalAlpha=u||1,l&&(f.fillStyle=l),p&&(f.strokeStyle=p),d&&(v=f.strokeWidth,f.lineWidth=d),f.beginPath(),f.ellipse(a,i,s,r,n,o,h,c),f.stroke(),f.fill(),d&&(f.lineWidth=v))}},LibCanvas.drawRectangle=function(t,e,a,i,s,r,n,o,h){if(t||e){var c,l=e||t.getContext("2d");l&&(h&&(c=l.lineWidth,l.lineWidth=h),n&&(l.fillStyle=n,"transparent"==n?l.clearRect(a,i,s,r):l.fillRect(a,i,s,r)),o&&(l.strokeStyle=o,l.strokeRect(a,i,s,r)),h&&(l.lineWidth=c))}},LibCanvas.drawRoundedRectangleWithBorderStyle=function(t,e,a,i,s,r,n,o,h,c){if(t||e){var l,d=e||t.getContext("2d");d&&c&&(l=d.lineWidth,d.lineWidth=c);var p=a+s,u=i+r;r<5&&(n=0),d.beginPath(),d.strokeStyle=h,d.lineWidth=c,d.moveTo(a+n,i),d.lineTo(p-n,i),d.quadraticCurveTo(p,i,p,i+n),d.lineTo(p,i+r-n),d.quadraticCurveTo(p,u,p-n,u),d.lineTo(a+n,u),d.quadraticCurveTo(a,u,a,u-n),d.lineTo(a,i+n),d.quadraticCurveTo(a,i,a+n,i),o&&(d.fillStyle=o,d.fill()),d.stroke(),c&&(d.lineWidth=l)}},LibCanvas.drawGradient=function(t,e,a,i,s,r,n){if(t||e){var o=e||t.getContext("2d");if(o){var h=o.createLinearGradient(a,a,r,s);h.addColorStop(0,"rgba(0,0,0,0)"),h.addColorStop(1,n),o.fillStyle=h,o.fillRect(i,a,s,r)}}},LibCanvas.drawRectangleRound=function(t,e,a,i,s,r,n,o,h){if(t||e){var c=e||t.getContext("2d");c&&(c.beginPath(),c.moveTo(a,i),c.lineTo(a+s,i),c.quadraticCurveTo(a+s+n,i,a+s+n,i+n),c.lineTo(a+s+n,i+n+r),c.quadraticCurveTo(a+s+n,i+2*n+r,a+s,i+2*n+r),c.lineTo(a,i+2*n+r),c.quadraticCurveTo(a-n,i+2*n+r,a-n,i+n+r),c.lineTo(a-n,i+n),c.quadraticCurveTo(a-n,i,a,i),c.strokeStyle=h,c.fillStyle=o,h&&(c.strokeStyle=h),c.stroke(),o&&(c.fillStyle=o,c.fill()))}},LibCanvas.drawQuadraticCurve=function(t,e,a,i,s,r,n,o,h,c,l){if(t||e){var d,p=e||t.getContext("2d");p&&(p.globalAlpha=c||1,l&&p.setLineDash&&p.setLineDash(l),h&&(d=p.lineWidth,p.lineWidth=h),o&&(p.strokeStyle=o),n&&(p.fillStyle=n),p.beginPath(),p.moveTo(a.x,a.y),p.quadraticCurveTo(i.x,i.y,s.x,s.y),p.stroke(),p.fill(),h&&(p.lineWidth=d))}},LibCanvas.drawText=function(t,e,a,i,s,r,n){if(t||e){var o=e||t.getContext("2d");o&&(o.font=r,o.fillStyle=n,o.fillText(s,a,i))}},LibCanvas.drawPolygon=function(t,e,a,i,s,r,n,o,h,c){if(!(a.length<2||!i&&!s)&&(t||e)){var l=e||t.getContext("2d");if(l){var d;i&&(l.fillStyle=i),s&&(null!==n&&(d=l.lineWidth,l.lineWidth=n),l.strokeStyle=s),c&&l.setLineDash&&l.setLineDash(c),l.beginPath(),l.moveTo(a[0][0],a[0][1]),o=void 0==o?a.length:Math.min(a.length,o);for(var p=1;p<o;++p)l.lineTo(a[p][0],a[p][1]);void 0!=r&&!0!==r||l.closePath(),h&&(l.globalAlpha=h),i&&l.fill(),l.globalAlpha=1,s&&(l.stroke(),null!==n&&(l.lineWidth=d))}}},LibCanvas.inCircle=function(t,e,a){return Math.hypot(a.x-t,a.y-e)<=a.radius},LibCanvas.inRect=function(t,e,a,i,s,r){var n=Math.min(a,s),o=Math.max(a,s),h=Math.min(i,r),c=Math.max(i,r);return t>=n&&t<=o&&e>=h&&e<=c},LibCanvas.inTriangle=function(t,e,a){function sign(t,e,a){return(t[0]-a[0])*(e[1]-a[1])-(e[0]-a[0])*(t[1]-a[1])}var i=[t,e],s=sign(i,a[0],a[1])<0,r=sign(i,a[1],a[2])<0,n=sign(i,a[2],a[0])<0;return s==r&&r==n},LibCanvas.drawCircle=function(t,e,a,i,s,r,n,o,h){if(t||e){var c=e||t.getContext("2d");c&&(h&&(c.globalAlpha=h),c.setLineDash([0,0]),c.beginPath(),c.arc(a,i,s,0,2*Math.PI,!1),c.fillStyle=n,c.fill(),r&&(c.lineWidth=r,c.strokeStyle=o||n,c.stroke()),h&&(c.globalAlpha=1))}},LibCanvas.createImage=function(t){if(!t)return!1;var e=new Image;return e.src=t,e},LibCanvas.drawImage=function(t,e,a,i,s,r,n,o){if(isNaN(a)||isNaN(i)||!s)return!1;if(t||e){var h=e||t.getContext("2d");if(h)if(r)void 0!=n&&void 0!=o?h.drawImage(r,a,i,n,o):h.drawImage(r,a,i);else{var c=new Image;c.onload=function(){void 0!=n&&void 0!=o?h.drawImage(c,a,i,n,o):h.drawImage(c,a,i)},c.src=s}}},LibCanvas.setClip=function(t,e,a,i,s,r){if(t||e){var n,o=e||t.getContext("2d");o&&(n=o.lineWidth,o.lineWidth=0,o.rect(a,i,s,r),o.stroke(),o.clip(),o.lineWidth=n)}},LibCanvas.drawLinearGradient=function(t,e,a,i,s,r,n,o,h,c,l,d){if(t||e){var p=e||t.getContext("2d"),u=p.createLinearGradient(a,i,s,r);u.addColorStop(0,l),u.addColorStop(1,d),p.fillStyle=u,p.fillRect(n,o,h,c)}},LibCanvas.drawArrow=function(t,e,a,i,s,r,n,o,h,c,l,d){if(t||e){var p,u=e||t.getContext("2d");h&&u.setLineDash&&u.setLineDash(h),o&&(u.strokeStyle=o),n&&(u.fillStyle=n),c&&(u.lineWidth=c),l&&(u.globalAlpha=l),u.beginPath(),u.lineWidth=1,u.moveTo(a,i-1),u.lineTo(s,r-1),u.lineTo(s,r+1),u.lineTo(a,i+1),u.closePath(),u.stroke(),u.fill(),p=Math.atan((r-i)/(s-a)),p+=(s>a?90:-90)*Math.PI/180,function drawArrowHead(){u.save(),u.beginPath(),u.translate(s,r),u.rotate(p),u.moveTo(0,0),u.lineTo(6,15),d?(u.lineTo(-6,15),u.closePath(),u.fill(),u.strokeStyle=o,u.lineWidth=.5,u.stroke()):(u.moveTo(0,0),u.lineTo(-6,15),u.stroke()),u.restore()}()}},LibCanvas.setShadow=function(t,e,a,i,s,r){if(t||e){var n=e||t.getContext("2d");n.shadowBlur=i||0,n.shadowColor=a||"#0000",n.shadowOffsetX=s||0,n.shadowOffsetY=r||0}},LibIndicators.toDataDictionary=function(t){for(var e={},a=0;a<t.length;a++)e[t[a].T]=t[a];return e},LibIndicators.SMA_noRounding=function(t,e){if(null===t||t.length<e)return[];for(var a=[],i=t.sort(sortTimeDescending),s=0,r=0,n=0,o=0,h=[],c=i.length-e,l=0;l<i.length;l++){var d=i[l];if(o<=c){if(h=i.slice(o,o+e),o++,h.forEach(function(t){r+=t.C}),s=r/e,n=d.T,r=0,isNaN(s)||isNaN(n))continue;a.push({T:n,P:s})}}return a},LibIndicators.SMA=function(t,e){if(null===t||t.length<e)return{};var a=[];return LibIndicators.SMA_noRounding(t,e).forEach(function(t){a.push({T:t.T,P:toFixed(t.P)})}),LibIndicators.toDataDictionary(a)},LibIndicators.EMA_noRounding=function(t,e){if(null===t||t.length<e)return{};var a=(t=t.sort(sortTimeAscending)).slice(0,e),i=LibIndicators.SMA_noRounding(a,e),s=i[0].P;s=parseFloat(s);var r,n=i[0].T,o=[];r=2/(e+1),o.push({T:n,P:parseFloat(s)});for(var h=e;h<t.length;h++)n=t[h].T,s=toFixed(s=(t[h].C-s)*r+s),isNaN(s)||isNaN(n)||o.push({T:n,P:s});return o},LibIndicators.EMA=function(t,e){if(null===t||t.length<e)return{};var a=[];return LibIndicators.EMA_noRounding(t,e).forEach(function(t){a.push({T:t.T,P:toFixed(t.P)})}),LibIndicators.toDataDictionary(a)},LibIndicators.StandartDeviation=function(t,e){if(null===t||t.length<e)return{};for(var a=t.sort(sortTimeAscending),i=0,s=[],r=[],n=[],o=0;o<=a.length-e;o++){for(var h=0,c=0;c<e;c++)h+=a[o+c].C,i=a[o+c].T;var l=h/e;s.push({T:i,C:l});for(var d=0,p=0;p<e;p++)d+=Math.pow(a[o+p].C-l,2)/e;r.push({T:i,C:d})}for(var u=0;u<r.length;u++){var g=Math.sqrt(r[u].C);n.push({T:r[u].T,P:g})}return LibIndicators.toDataDictionary(n)},LibIndicators.BollingerBands=function(t,e){if(null===t||t.length<e)return{};for(var a=t.sort(sortTimeDescending),i=[],s=0,r=[],n=a.length-e,o=0,h=0,c=0,l=0,d=0,p=0;p<a.length;p++){var u=a[p];if(s<=n){if(r=a.slice(s,s+e),s++,h=LibIndicators.SMA_noRounding(r,e),o=getValuesFromDictionary(o=LibIndicators.StandartDeviation(r,e)),l=(c=h[0].P)+2*o[0].P,l=Math.round(1e5*l)/1e5,d=c-2*o[0].P,d=Math.round(1e5*d)/1e5,isNaN(c)||isNaN(d)||isNaN(l)||isNaN(u.T))continue;i.push({T:u.T,M:c,U:l,L:d})}}return LibIndicators.toDataDictionary(i)},LibIndicators.Envelopes=function(t,e,a,i){if(null===t||t.length<e)return{};a?a/=1e4:a=.025;for(var s=t,r=[],n=0,o=0,h=0,c="EMA"===i.toUpperCase()?LibIndicators.EMA_noRounding(s,e):LibIndicators.SMA_noRounding(s,e),l=0;l<c.length;l++)o=(n=c[l].P)+n*a,o=Math.round(1e5*o)/1e5,h=n-n*a,h=Math.round(1e5*h)/1e5,isNaN(n)||isNaN(h)||isNaN(o)||isNaN(c[l].T)||r.push({T:c[l].T,M:n,U:o,L:h});return LibIndicators.toDataDictionary(r)},LibIndicators.So=function(t,e,a){if(null===t||t.length<e)return{};for(var i=[],s=t.sort(sortTimeDescending),r=[],n=0,o=0,h=0,c=0,l=0,d=0,p=s.length-e,u=0;u<s.length;u++)d<=p?(r=s.slice(u,u+e),n=Math.max.apply(Math,r.map(function(t){return t.H})),o=Math.min.apply(Math,r.map(function(t){return t.L})),h=r[r.length-e].C,c=r[r.length-e].T,d++):(u===p&&u++,h=s[u].C,c=s[u].T),l=toFixed(l=n-o===0?50:(h-o)/(n-o)*100),i.push({T:c,P:l});for(var g=0,v=0,f=[],y=0;y<=i.length-e;y++)(r=i.slice(y,y+a)).forEach(function(t){g+=parseFloat(t.P)}),v=toFixed(v=g/a),isNaN(v)||isNaN(i[y].P)||isNaN(i[y].T)||(f.push({T:i[y].T,K:i[y].P,D:v}),g=0,v=0);return LibIndicators.toDataDictionary(f)},LibIndicators.SoForK=function(t,e){if(null===t||t.length<e)return{};for(var a=[],i=t.sort(sortTimeDescending),s=[],r=0,n=0,o=0,h=0,c=0,l=0,d=i.length-e,p=0;p<i.length;p++)l<=d?(s=i.slice(p,p+e),r=Math.max.apply(Math,s.map(function(t){return t.H})),n=Math.min.apply(Math,s.map(function(t){return t.L})),o=s[s.length-e].C,h=s[s.length-e].T,l++):(p===d&&p++,o=i[p].C,h=i[p].T),c=r-n===0?50:(o-n)/(r-n)*100,a.push({T:h,P:c});return a},LibIndicators.WilliamsR=function(t,e){if(null===t||t.length<e)return{};for(var a=[],i=t.sort(sortTimeDescending),s=[],r=0,n=0,o=0,h=0,c=0,l=0,d=i.length-e,p=0;p<i.length;p++)l<=d?(s=i.slice(p,p+e),r=Math.max.apply(Math,s.map(function(t){return t.H})),n=Math.min.apply(Math,s.map(function(t){return t.L})),o=s[s.length-e].C,h=s[s.length-e].T,l++):(p===d&&p++,o=i[p].C,h=i[p].T),c=toFixed(c=r-n===0?50:(r-o)/(r-n)*-100),isNaN(c)||isNaN(h)||a.push({T:h,P:c});return LibIndicators.toDataDictionary(a)},LibIndicators.RSI=function(t,e){if(null===t||t.length<e)return{};for(var a=t.sort(sortTimeAscending),i=[],s=0,r=0,n=0,o=[],h=0,c=0,l=0,d=0,p=0,u=0,g=0,v=1;v<a.length;v++)if(r=a[v].C,n=a[v-1].C,s=a[v].T,o.push({T:s,C:r-n}),v>=e){if(c=0,l=0,v===e){if(o.forEach(function(t){h=t.C,s=t.T,h>0?d+=Math.abs(h):h<0&&(p+=Math.abs(h))}),d/=e,g=toFixed(g=100-100/(1+(u=0===(p/=e)?0:d/p))),isNaN(g)||isNaN(s))continue;i.push(new Object({T:a[v].T,P:g}))}if(v>e){if(h=o[v-1].C,s=o[v-1].T,h>0?(c=(d*(e-1)+Math.abs(h))/e,l=(p*(e-1)+0)/e):0===h?(l=(p*(e-1)+0)/e,c=(d*(e-1)+0)/e):(c=(d*(e-1)+0)/e,l=(p*(e-1)+Math.abs(h))/e),u=Math.abs(l)<1e-5?0:c/l,g=toFixed(g=Math.abs(l)<1e-5?100:100-100/(1+u)),d=c,p=l,isNaN(g)||isNaN(s))continue;i.push({T:s,P:g})}}return LibIndicators.toDataDictionary(i)},LibIndicators.BearsPower=function(t,e){if(t.length<e)return{};var a=libIndicatorsUtils_clone(t);a=a.sort(sortTimeDescending);for(var i=LibIndicators.EMA_noRounding(a,e),s=[],r=[],n=0;n<a.length;n++)a[n].T>=i[0].T&&r.push(a[n]);var o=LibIndicators.toDataDictionary(i);for(n=0;n<r.length;n++){var h=r[n].T,c=r[n].L-o[h].P;isNaN(c)||isNaN(h)||s.push({T:h,P:c})}return LibIndicators.toDataDictionary(s)},LibIndicators.BullsPower=function(t,e){if(t.length<e)return{};var a=Object.assign(t);a=a.sort(sortTimeDescending);for(var i=LibIndicators.EMA_noRounding(a,e),s=[],r=[],n=0;n<a.length;n++)a[n].T>=i[0].T&&r.push(t[n]);for(var o=LibIndicators.toDataDictionary(i),h=0;h<r.length;h++){var c=r[h].T,l=r[h].H-o[c].P;isNaN(l)||isNaN(c)||s.push({T:c,P:l})}return LibIndicators.toDataDictionary(s)},LibIndicators.BullsBearsPower=function(t,e){if(null===t||t.length<e)return[];var a=libIndicatorsUtils_clone(t);a=a.sort(sortTimeDescending);var i=[],s=LibIndicators.BearsPower(a,e),r=LibIndicators.BullsPower(a,e),n=LibIndicators.EMA_noRounding(a,e);s=getValuesFromDictionary(s),r=getValuesFromDictionary(r),n=getValuesFromDictionary(n);for(var o=[],h=0;h<s.length;h++)o.push(s[h].T);if((o=o.sort(function(t,e){return t>e?-1:t<e?1:0})).length<2)return null;var c=o[0],l=(o[1],toFixed(s[0].P)),d=toFixed(r[0].P),p=toFixed(n[0].P),u=toFixed(s[1].P),g=toFixed(r[1].P),v=toFixed(n[1].P);return d>0&&d<g&&p<v?i.push({T:c,P:-1}):l<0&&l>u&&p>v?i.push({T:c,P:1}):i.push({T:c,P:0}),LibIndicators.toDataDictionary(i)},LibIndicators.ATR=function(t,e){if(t.length<e)return{};var a=libIndicatorsUtils_clone(t);a=a.sort(sortTimeAscending);for(var i=[],s=0;s<e;s++){var r=a[s].H,n=a[s].L,o={T:a[s].T};if(0===s)o.P=Math.abs(r-n),i.push(o);else{var h=a[s-1].C,c=Math.abs(r-n);c=Math.max(Math.abs(r-h),c),c=Math.max(Math.abs(n-h),c),o.P=c,i.push(o)}}var l=[],d=i.reduce(function(t,e){return t+e.P},0)/i.length;for(d=Math.round(1e5*d)/1e5,l.push({T:a[e-1].T,P:d}),s=e;s<a.length;s++){var p=a[s].T;r=a[s].H,n=a[s].L,h=a[s-1].C,c=Math.abs(r-n),c=Math.max(Math.abs(r-h),c),c=Math.max(Math.abs(n-h),c);var u=(l.slice(-1)[0].P*(e-1)+c)/e;u=toFixed(u),isNaN(u)||isNaN(p)||l.push({T:p,P:u})}return LibIndicators.toDataDictionary(l.reverse())},LibIndicators.ATR_Average=function(t,e,a){var i=[];if(null===t||t.length<e+a)return{};var s=libIndicatorsUtils_clone(t);s=s.sort(sortTimeDescending);var r=LibIndicators.ATR(s,e);r=getValuesFromDictionary(r);for(var n=0;n<r.length-a;n++){var o=r.slice(n,n+a),h=0;o.forEach(function(t){h+=t.P});var c=h/a,l=r[n];l.P/1.2>c?i.push({T:l.T,P:1}):1.2*l.P<c?i.push({T:l.T,P:-1}):i.push({T:l.T,P:0})}return i},LibIndicators.Ichimoku=function(t,e,a,i,s){if(t.length<e)return{};var r=libIndicatorsUtils_clone(t);r=r.sort(sortTimeAscending);var n,o,h,c,l,d,p,u,g,v,f={};s=Math.abs(r[0].T-r[1].T);for(var y=r.length,D=0;D<y;D++){if(g=-1/0,v=1/0,y-D>=e){for(var w=0;w<e;w++)g=Math.max(g,r[D+w].H),v=Math.min(v,r[D+w].L);n=(g+v)/2,u=r[e-1+D].T,n=Math.round(1e5*n)/1e5,f[u]?f[u].TenkanSen=n:f[u]={T:u,TenkanSen:n}}if(g=-1/0,v=1/0,y-D>=a){for(var m=0;m<a;m++)g=Math.max(g,r[D+m].H),v=Math.min(v,r[D+m].L);o=(g+v)/2,u=r[a-1+D].T,o=Math.round(1e5*o)/1e5,f[u]?f[u].KijunSen=o:f[u]={T:u,KijunSen:o}}if(u=D<a?r[D].T-s*a:r[D-a].T,h=r[D].C,h=Math.round(1e5*h)/1e5,void 0===f[u]?f[u]={T:u,ChinkouSpan:h}:f[u].ChinkouSpan=h,D>=a&&(c=(f[u=r[D].T].TenkanSen+f[u].KijunSen)/2,c=Math.round(1e5*c)/1e5,void 0===f[l=r[D+a]?r[D+a].T:u+s*a]?f[l]={T:l,SenkouSpanA:c}:f[l].SenkouSpanA=c),y-D>=i){u=r[D].T;for(var b=-1/0,C=1/0,x=0;x<i;x++)b=Math.max(b,r[D+x].H),C=Math.min(C,r[D+x].L);d=(b+C)/2,d=Math.round(1e5*d)/1e5,f[p=r[D+a+i-1]?r[D+a+i-1].T:r[y-1].T+s*(D+a+i-y)]?f[p].SenkouSpanB=d:f[p]={T:p,SenkouSpanB:d}}}return f},LibIndicators.Fractal=function(t,e){if(e||(e=5),!t||t.length<e)return{};var a=libIndicatorsUtils_clone(t);a=a.sort(sortTimeAscending);for(var i={},s=e%2===0?e/2-1:Math.floor(e/2),r=0;r<a.length-e+1;r++){var n=a.slice(r,e+r),o=n.reduce(function(t,e){return t.H>e.H?t:e}),h=n.reduce(function(t,e){return t.L<e.L?t:e});n.indexOf(o)===s&&(i[o.T]={T:o.T,fractalHigh:o.H}),n.indexOf(h)===s&&(void 0===i[h.T]?i[h.T]={T:h.T,fractalLow:h.L}:i[h.T].fractalLow=h.L)}return i},LibIndicators.ADX=function(t,e){if(null===t||t.length<e)return{};for(var a=t.sort(sortTimeAscending),i=[],s=[],r=[],n=1;n<a.length;n++){var o=a[n].H,h=a[n].L,c=a[n-1].H,l=a[n-1].L,d=a[n-1].C,p=a[n].T,u=Math.max(o-h,Math.abs(o-d),Math.abs(h-d)),g=0,v=0;if(o>c?(g=o-c,g=Math.round(1e4*g)/1e4):g=0,h<l?(v=l-h,v=Math.round(1e4*v)/1e4):v=0,g>v?v=0:v>g?g=0:v===g&&(v=0,g=0),i.push({T:p,TR:u,DMP:g,DMM:v}),n>=e){var f,y,D,w=0,m=0,b=0,C=0,x=0,L=0,P=0,S=0;if(n===e){for(var T=i.slice(0,e),O=0;O<T.length;O++)w+=parseFloat(T[O].TR),b+=parseFloat(T[O].DMP),m+=parseFloat(T[O].DMM);f=w,y=b,D=m,L=(x=b/w*100)+(C=m/w*100),S=(P=Math.abs(x-C))/L*100,s.push({T:p,DIP:x,DIM:C,DISUM:L,DIDIF:P,DX:S})}else n>e&&(w=f-f/e+parseFloat(i[n-1].TR),m=D-D/e+parseFloat(i[n-1].DMM),L=(x=(b=y-y/e+parseFloat(i[n-1].DMP))/w*100)+(C=m/w*100),S=(P=Math.abs(x-C))/L*100,s.push({T:p,DIP:x,DIM:C,DISUM:L,DIDIF:P,DX:S}),f=w,y=b,D=m)}}var B,A,F=0,k=s.slice(0,e);for(O=0;O<k.length;O++)F+=parseFloat(k[O].DX);var j=F/e;if(k.length>=e){j=toFixed(j),B=toFixed(k[e-1].DIM),A=toFixed(k[e-1].DIP),j=isNaN(j)?0:j,B=isNaN(B)?0:B,A=isNaN(A)?0:A,r.push({T:k[e-1].T,DIP:A,DIM:B,ADX:j}),F=j;for(var E=e;E<s.length;E++)j=toFixed(j=(F*(e-1)+s[E].DX)/e),B=toFixed(s[E].DIM),A=toFixed(s[E].DIP),j=isNaN(j)?0:j,B=isNaN(B)?0:B,A=isNaN(A)?0:A,r.push({T:s[E].T,DIP:A,DIM:B,ADX:j}),F=j}return LibIndicators.toDataDictionary(r)},LibIndicators.ADXdiff=function(t,e){if(null===t||t.length<e)return{};for(var a=t.sort(sortTimeAscending),i=[],s=[],r=1;r<a.length;r++){var n=a[r].H,o=a[r].L,h=a[r-1].H,c=a[r-1].L,l=a[r-1].C,d=a[r].T,p=Math.max(n-o,Math.abs(n-l),Math.abs(o-l)),u=0,g=0;if((u=n>h?n-h:0)>(g=o<c?c-o:0)?g=0:g>u?u=0:g===u&&(g=0,u=0),i.push({T:d,TR:p,DMP:u,DMM:g}),r>=e){var v,f,y,D=0,w=0,m=0,b=0,C=0,x=0,L=0,P=0;if(r===e){for(var S=i.slice(0,e),T=0;T<S.length;T++)D+=parseFloat(S[T].TR),m+=parseFloat(S[T].DMP),w+=parseFloat(S[T].DMM);v=D,f=m,y=w,x=(C=m/D*100)+(b=w/D*100),P=(L=Math.abs(C-b))/x*100,s.push({T:d,DIP:C,DIM:b,DISUM:x,DIDIF:L,DX:P})}else r>e&&(D=v-v/e+parseFloat(i[r-1].TR),w=y-y/e+parseFloat(i[r-1].DMM),P=(L=(C=(m=f-f/e+parseFloat(i[r-1].DMP))/D*100)-(b=w/D*100))/(x=C+b)*100,s.push({T:d,DIP:C,DIM:b,DISUM:x,DIDIF:L,DX:P}),v=D,f=m,y=w)}}return s},LibIndicators.MACD=function(t,e,a,i){if(!e||!a||!i||t.length<a)return{};var s=libIndicatorsUtils_clone(t);s=s.sort(function(t,e){return t.T-e.T});var r={},n=LibIndicators.EMA_noRounding(s,e),o=LibIndicators.EMA_noRounding(s,a);for(var h in n=LibIndicators.toDataDictionary(n),o=LibIndicators.toDataDictionary(o)){var c=o[h].T,l=n[c].P-o[h].P;r[c]={T:c,macdLine:l,signalLine:0,histogram:0}}var d=[];for(var p in r){var u=parseInt(p);d.push({T:u,O:0,H:0,L:0,C:r[p].macdLine})}var g=LibIndicators.EMA_noRounding(d,i);for(var v in g=LibIndicators.toDataDictionary(g)){var f=parseInt(v);r[f].signalLine=g[f].P,r[f].histogram=r[f].macdLine-g[f].P}return r},LibIndicators.Dema=function(t,e){if(null===t||t.length<e)return{};t=t.sort(sortTimeAscending);for(var a=LibIndicators.EMA_noRounding(t,e),i=[],s=[],r=0;r<a.length;r++)i.push({T:a[r].T,O:0,H:0,L:0,C:a[r].P});var n=LibIndicators.EMA_noRounding(i,e);for(r=0;r<n.length;r++){var o=2*a[r+e-1].P-n[r].P;s.push({T:n[r].T,P:o})}return LibIndicators.toDataDictionary(s)},LibIndicators.ParabolicSar=function(t,e,a,i){if(t.length<3)return{};e?e/=100:e=.02,a?a/=100:a=.02,i?i/=100:i=.2;var s=libIndicatorsUtils_clone(t).sort(sortTimeAscending),r={},n={},o=!0,h=0;r[s[3].T]={T:s[3].T,P:0,EP:0,ST:0,D:!0},o=o?s[4].L>Math.min(s[4].L,s[3].L,s[2].L,s[1].L,s[0].L):s[4].H>=Math.min(s[4].L,s[3].L,s[2].L,s[1].L,s[0].L),r[s[4].T]={T:s[4].T,P:Math.min(s[4].L,s[3].L,s[2].L,s[1].L,s[0].L),EP:Math.max(s[4].H,s[3].H,s[2].H,s[1].H,s[0].H),ST:e,D:o},n[s[4].T]={T:s[4].T,P:r[s[4].T].P};for(var c=5;c<s.length-1;c++)r[s[c].T]={T:s[c].T,P:0,EP:0,ST:0,D:!0},r[s[c-1].T].D===r[s[c-2].T].D?r[s[c-1].T].D?(s[c].H>r[s[c-1].T].EP?r[s[c].T].EP=s[c].H:r[s[c].T].EP=r[s[c-1].T].EP,h=r[s[c-1].T].ST*(r[s[c-1].T].EP-r[s[c-1].T].P),r[s[c-1].T].P+h<Math.min(s[c-1].L,s[c-2].L)?r[s[c].T].P=r[s[c-1].T].P+h:r[s[c].T].P=Math.min(s[c-1].L,s[c-2].L),r[s[c].T].EP>r[s[c-1].T].EP?r[s[c-1].T].ST>=i?r[s[c].T].ST=i:r[s[c].T].ST=r[s[c-1].T].ST+a:r[s[c].T].ST=r[s[c-1].T].ST,r[s[c].T].D=s[c+1].L>r[s[c].T].P):(r[s[c].T].EP=Math.min(s[c].L,r[s[c-1].T].EP),h=r[s[c-1].T].ST*(r[s[c-1].T].EP-r[s[c-1].T].P),r[s[c-1].T].P+h>Math.max(s[c-1].H,s[c-2].H)?r[s[c].T].P=r[s[c-1].T].P+h:r[s[c].T].P=Math.max(s[c-1].H,s[c-2].H),r[s[c].T].EP<r[s[c-1].T].EP?r[s[c-1].T].ST>=i?r[s[c].T].ST=i:r[s[c].T].ST=r[s[c-1].T].ST+a:r[s[c].T].ST=r[s[c-1].T].ST,r[s[c].T].D=s[c+1].H>=r[s[c].T].P):(r[s[c].T].P=r[s[c-1].T].EP,r[s[c].T].ST=a,r[s[c-1].T].D?(s[c].H>r[s[c-1].T].EP?r[s[c].T].EP=s[c].H:r[s[c].T].EP=r[s[c-1].T].EP,r[s[c].T].D=s[c+1].L>r[s[c].T].P):(s[c].L<r[s[c-1].T].EP?r[s[c].T].EP=s[c].L:r[s[c].T].EP=r[s[c-1].T].EP,r[s[c].T].D=s[c+1].H>=r[s[c].T].P)),isNaN(r[s[c].T].P)||isNaN(s[c].T)||(n[s[c].T]={T:s[c].T,P:r[s[c].T].P});return n},LibIndicators.Keltner=function(t,e,a,i){if(null===t||t.length<e)return{};a||(a=1),i||(i="EMA");var s=[],r=0,n=0,o=0,h=0,c=t;switch(i){case"SMA":r=LibIndicators.SMA_noRounding(c,e);break;case"EMA":default:r=LibIndicators.EMA_noRounding(c,e)}for(var l=LibIndicators.ATR(c,e),d=0;d<r.length;d++)n=r[d].P,o=(n=Math.round(1e5*n)/1e5)+a*l[r[d].T].P,o=Math.round(1e5*o)/1e5,h=n-a*l[r[d].T].P,h=Math.round(1e5*h)/1e5,s.push({T:r[d].T,M:n,U:o,L:h});return LibIndicators.toDataDictionary(s)},LibIndicators.Donchian=function(t,e){if(null===t||t.length<e)return{};for(var a=t.sort(sortTimeDescending),i=[],s=0;s<a.length-e;s++){for(var r=-1/0,n=1/0,o=0;o<e;o++)r=Math.max(r,a[s+o].H),n=Math.min(n,a[s+o].L);var h=(r+n)/2;i.push({T:a[s].T,M:h,U:r,L:n})}return LibIndicators.toDataDictionary(i)},LibIndicators.AO=function(t){if(null===t||t.length<5)return{};for(var e=t.sort(sortTimeDescending),a=[],i=[],s=0;s<e.length;s++)i.push({T:e[s].T,O:0,H:0,L:0,C:(e[s].H+e[s].L)/2});var r=LibIndicators.SMA_noRounding(i,5),n=LibIndicators.SMA_noRounding(i,34);for(var o in r=LibIndicators.toDataDictionary(r),n=LibIndicators.toDataDictionary(n)){var h=n[o].T,c=n[o].P,l=r[o].P-c;a.push({T:h,P:l})}return LibIndicators.toDataDictionary(a)},LibIndicators.AC=function(t){if(null===t||t.length<5)return{};for(var e=t.sort(sortTimeDescending),a=[],i=getValuesFromDictionary(LibIndicators.AO(e)),s=[],r=0;r<i.length;r++)s.push({T:i[r].T,O:0,H:0,L:0,C:i[r].P});var n=LibIndicators.SMA_noRounding(s,5);for(var o in n){var h=n[o].T,c=n[o].P,l=i[o].P-c;a.push({T:h,P:l})}return LibIndicators.toDataDictionary(a)},Indicator.prototype.createData=function(t){this.data=Indicator.calculate(this,Indicator.convertDataToOCLHT(t)),this.oscillatorPrecissionFlag&&this.getCurrentOscillatorPrecission()},Indicator.prototype.createCurrentValue=function(t){var e=t[0].date,a=Indicator.createDataforOnePointIndicator(this,t),i=Indicator.calculate(this,Indicator.convertDataToOCLHT(a));this.isChanged=this.checkValueHasChanged(this.data[e],i[e]),i[e]&&(this.data[e]=i[e])},Indicator.prototype.checkValueHasChanged=function(t,e){for(var a in t)if(t.hasOwnProperty(a)&&e&&t[a]===e[a]&&"T"!==a)return!1;return!0},Indicator.createDataforOnePointIndicator=function(t,e){var a=[],i=t.name,s=t.params;switch(i.toLowerCase()){case"sma":case"ema":case"bb":case"sar":case"williamsr":case"std":case"atr":case"bulls":case"bears":case"keltner":a=e.slice(0,s.period);break;case"dema":case"fractal":case"adx":a=e.slice(0,2*s.period);break;case"donchian":case"rsi":a=e.slice(0,s.period+1);break;case"ichimoku":a=e.slice(0,s.largePeriod);break;case"env":a=e.slice(0,s.lenght);break;case"macd":a=e.slice(0,s.slowLength);break;case"so":a=e.slice(0,s.K);break;case"ao":a=e.slice(0,34);break;case"ac":a=e.slice(0,39);break;default:a=[]}return a},Indicator.prototype.createShowData=function(){if(this.showData=[],this.chartData.chart&&this.chartData.chart.selectedData&&0!==this.chartData.chart.selectedData.length&&this.data&&0!==Object.keys(this.data).length){var t=this.getExtraIndicatorsDataNumb(),e=this.chartData.getCurrentTimeStep(),a=this.chartData.chart.selectedData[0].date;this.chartData.chart.selectedData[0].isCurrentData&&(a+=t*e);var i=this.chartData.chart.selectedData[this.chartData.chart.selectedData.length-1].date-e;this.chartData.chart.selectedData[this.chartData.chart.selectedData.length-1].date===this.chartData.data[this.chartData.typeData][this.chartData.data[this.chartData.typeData].length-1].date&&(i-=t*e);for(var s=this.data,r=Object.keys(s),n=r.length-1;n>=0;n--)parseInt(r[n])<=a&&parseInt(r[n])>=i&&this.showData.push(s[r[n]])}},Indicator.prototype.getExtraIndicatorsDataNumb=function(){switch(this.name.toLowerCase()){case"ichimoku":return this.params.largePeriod+this.params.middlePeriod;default:return 0}},Indicator.getValuesFromDictionary=function(t){return Object.values(t).sort(function(t,e){return t.T>e.T?-1:t.T<e.T?1:0})},Indicator.prototype.convertToDTO=function(){var t={};return t.name=this.name,t.fullName=this.fullName,t.params=Object.assign({},this.params),t.colors=Object.assign({},this.colors),t.opacity=Object.assign({},this.opacity),t.lineWidth=Object.assign({},this.lineWidth),t.type=this.type,t.hidden=this.hidden,t.h=this.h,t.top=this.top,t},Indicator.convertFromDTO=function(t,e){return new Indicator(t,e)},Indicator.prototype.draw=function(){var t=this.chartData.chart;if(t&&t.selectedData&&0!==t.selectedData.length){var e=Indicator.getValuesFromDictionary(this.data);if(e&&0!==e.length&&!this.hidden)if("oscillator"===this.type)t.oscillatorCharts[this.id].clear(),t.oscillatorCharts[this.id].draw(this,e,t),t.chartData.options.Chart.needPriceOscillators&&t.oscillatorCharts[this.id].drawPriceLineCurrentOscillator(this,e,t);else if("trend"===this.type)switch(this.name.toLowerCase()){case"sma":case"ema":case"dema":t.drawLinePT(this,e,t.canvasDataNormalContext);break;case"bb":case"env":case"keltner":case"donchian":t.drawBollingerBandsIndicator(this,e,t.canvasDataNormalContext);break;case"fractal":t.drawFractal(this,e,t.canvasDataNormalContext);break;case"ichimoku":t.drawIchimoku(this,e,t.canvasDataNormalContext);break;case"sar":t.drawSar(this,e,t.canvasDataNormalContext);break;default:return}}},Indicator.prototype.applyIndicatorHeight=function(t,e){this.h=t.height,this.w=parseFloat(e.parent.style.width),this.top=t.top},Indicator.calculate=function(t,e){var a=[],i=t.name,s=t.params;switch(i.toLowerCase()){case"sma":a=LibIndicators.SMA(e,s.period);break;case"ema":a=LibIndicators.EMA(e,s.period);break;case"bb":a=LibIndicators.BollingerBands(e,s.period);break;case"dema":a=LibIndicators.Dema(e,s.period);break;case"fractal":a=LibIndicators.Fractal(e,s.period);break;case"sar":a=LibIndicators.ParabolicSar(e,s.startAf,s.stepAf,s.maxAf);break;case"ichimoku":a=LibIndicators.Ichimoku(e,s.smallPeriod,s.middlePeriod,s.largePeriod,s.timePeriod);break;case"env":a=LibIndicators.Envelopes(e,s.lenght,s.percent,s.avarage);break;case"macd":a=LibIndicators.MACD(e,s.fastLength,s.slowLength,s.signalLength);break;case"adx":a=LibIndicators.ADX(e,s.period);break;case"williamsr":a=LibIndicators.WilliamsR(e,s.period);break;case"rsi":a=LibIndicators.RSI(e,s.period);break;case"std":a=LibIndicators.StandartDeviation(e,s.period);break;case"atr":a=LibIndicators.ATR(e,s.period);break;case"so":a=LibIndicators.So(e,s.K,s.D);break;case"bulls":a=LibIndicators.BullsPower(e,s.period);break;case"bears":a=LibIndicators.BearsPower(e,s.period);break;case"keltner":a=LibIndicators.Keltner(e,s.period,s.multi);break;case"donchian":a=LibIndicators.Donchian(e,s.period);break;case"ao":a=LibIndicators.AO(e);break;case"ac":a=LibIndicators.AC(e);break;default:a=[]}return a},Indicator.getNextId=function(){return Indicator.id++},Indicator.convertDataToOCLHT=function(t){return t.map(function(t){return{O:parseFloat(t.open),C:parseFloat(t.close),L:parseFloat(t.low),H:parseFloat(t.high),T:t.date}})},Indicator.prototype.getCurrentOscillatorPrecission=function(){var t;for(var e in this.data)if(this.data.hasOwnProperty(e)){t=this.data[e];break}var a=1;for(var i in t)t.hasOwnProperty(i)&&"T"!==i&&(a=a<=t[i].toFixed(0).length?t[i].toFixed(0).length:a);this.oscillatorPrecission=this.oscillatorPrecission-a,this.oscillatorPrecissionFlag=!1},Indicator.id=0;var d=function(){function mouseDown(t){return d.pressed=!0,1!==(t=fixEvent(t)).which&&0!==t.which||(e={x:t.pageX,y:t.pageY,element:this},function addDocumentEventHandlers(){document.onmousemove=mouseMove,document.onmouseup=mouseUp,document.ondragstart=document.body.onselectstart=function(){return!1}}()),!1}function mouseMove(s){if(s=fixEvent(s),e){if(Math.abs(e.x-s.pageX)<5&&Math.abs(e.y-s.pageY)<5)return!1;var r=e.element;a=r,t=r.dragObject;var n=function getMouseOffset(t,e,a){var i=function getOffset(t){return t.getBoundingClientRect?function getOffsetRect(t){var e=getComputedStyle(t),a=(t.getBoundingClientRect(),document.body),i=document.documentElement,s=window.pageYOffset||i.scrollTop||a.scrollTop,r=window.pageXOffset||i.scrollLeft||a.scrollLeft,n=i.clientTop||a.clientTop||0,o=i.clientLeft||a.clientLeft||0,h=parseFloat(e.top)+s-n,c=parseFloat(e.left)+r-o;return{top:Math.round(h),left:Math.round(c)}}(t):function getOffsetSum(t){for(var e=0,a=0;t;)e+=parseInt(t.offsetTop),a+=parseInt(t.offsetLeft),t=t.offsetParent;return{top:e,left:a}}(t)}(t);return{x:e-i.left,y:a-i.top}}(r,e.x,e.y,t.bodyTop);e=null,t.onDragStart(n)}if(t.onDragMove(s,s.pageX,s.pageY),t.forTrget)var o=function getCurrentTarget(e){if(navigator.userAgent.match("MSIE")||navigator.userAgent.match("Gecko"))var a=e.clientX,i=e.clientY;else a=e.pageX,i=e.pageY;t.hide();var s=document.elementFromPoint(a,i);for(t.show();s;){if(s.dropTarget&&s.dropTarget.canAccept(t))return s.dropTarget;s=s.parentNode}return null}(s);return i!=o&&(i&&i.onLeave(a),o&&o.onEnter(a),i=o),!1}function mouseUp(){d.pressed=!1,t?(i&&(i.accept(t,a),t.onDragSuccess(i,a)),t.downLip(),t.downStyle(),t=null):e=null,function removeDocumentEventHandlers(){document.onmousemove=document.onmouseup=document.ondragstart=document.body.onselectstart=null}(),d.pressed=!1}var t,e,a,i;return{makeDraggable:function makeDraggable(t){t.onmousedown=mouseDown}}}(),p=function MoveLib(){var t=this;this.DragObjects=[],this.dropTargetContainer={},window.resize=null,window.resize=function(){t.moveResize()},this.addDragObject=function(t,e){this.DragObjects.push(new DragObject(t,e))},this.setContainer=function(t){this.dropTargetContainer=t,this.setBords()},this.setBords=function(){this.DragObjects.forEach(function(e){e.setBord(t.dropTargetContainer)})},this.addToolBarTop=function(t){new DropTarget(t,"tch-move-toolbarTop")},this.addToolBarLeft=function(){new DropTarget(toolbarLeft,"tch-move-toolbarLeft")},this.moveResize=function(t){this.DragObjects.forEach(function(e){e.moveForResize(t)})},this.resizeDragObjects=function(){this.DragObjects.forEach(function(t){t.reCalculationSize()}),this.setBords(this.dropTargetContainer)}};DragObject.prototype.deltaLip=15,DropTarget.prototype.classTargetOK="tch-uponMe",DragObject.prototype.setBord=function(t){this.downLip(),this.bord.left=t.left,this.bord.top=t.top,this.bord.right=t.right-this.geom.width,this.bord.bottom=t.bottom-this.geom.height,this.moveForSetBord()},DragObject.prototype.reCalculationSize=function(){this.geom.width=this.parent.getBoundingClientRect().width,this.geom.height=this.parent.getBoundingClientRect().height,this.geom.borderTopWidth=parseFloat(getComputedStyle(this.parent).borderTopWidth),this.geom.borderLeftWidth=parseFloat(getComputedStyle(this.parent).borderLeftWidth),this.geom.borderBottomWidth=parseFloat(getComputedStyle(this.parent).borderBottomWidth),this.geom.borderRightWidth=parseFloat(getComputedStyle(this.parent).borderRightWidth)},DragObject.prototype.moveForSetBord=function(){this.fixPos.top&&(this.s.top=this.bord.top+"px"),this.fixPos.right&&(this.s.left=this.bord.right+"px"),this.fixPos.bottom&&(this.s.top=this.bord.bottom+"px"),this.fixPos.left&&(this.s.left=this.bord.left+"px")},DragObject.prototype.moveForResize=function(t){var e=t?t.top:0,a=t?t.left:0;this.minLeft=parseFloat(getComputedStyle(this.parent).left)-this.parent.getBoundingClientRect().left,this.minTop=parseFloat(getComputedStyle(this.parent).top)-this.parent.getBoundingClientRect().top,this.maxLeft=document.documentElement.clientWidth-(this.geom.borderLeftWidth+this.geom.borderRightWidth)+this.minLeft-this.geom.width,this.maxTop=document.documentElement.clientHeight-(this.geom.borderTopWidth+this.geom.borderBottomWidth)+this.minTop-this.geom.height,this.fixMinMax.top&&(this.s.top=this.minTop+"px"),this.fixMinMax.right&&(this.s.left=this.maxLeft+"px"),this.fixMinMax.bottom&&(this.s.top=this.maxTop+"px"),this.fixMinMax.left&&(this.s.left=this.minLeft+"px"),!t||this.fixPos.top||this.fixPos.bottom||(this.s.top=parseFloat(this.s.top)-e+"px"),!t||this.fixPos.right||this.fixPos.left||(this.s.left=parseFloat(this.s.left)-a+"px")},p.prototype.FunctionOnBrouse={Opera:{},ie:{},edge:{},chrome:{},safari:{},firefox:{},unknown:{}},p.prototype.ForBrouse=p.prototype.FunctionOnBrouse[function detectBrouse(){return-1!==navigator.userAgent.indexOf("Opera")||-1!==navigator.userAgent.indexOf("OPR")?"opera":-1!==navigator.userAgent.indexOf("MSIE")||document.documentMode?"ie":window.StyleMedia?"edge":-1!==navigator.userAgent.indexOf("Chrome")?"chrome":-1!==navigator.userAgent.indexOf("Safari")?"safari":-1!==navigator.userAgent.indexOf("Firefox")?"firefox":"unknown"}()],Picker.shownPickers=[],Picker.html="<div class='tch-color-picker-container'><div class='tch-color-picker'></div></div>",Picker.createSingle=function(t,e){return t.innerHTML=Picker.html,new Picker(t,e)},Picker.prototype.init=function(){for(var t=this.parent.querySelectorAll(".tch-color-picker"),e=0;e<t.length;e++)this.addPickerEvents(t[e]);this.getImgUrl()},Picker.prototype.getImgUrl=function(){if(!Picker.imgUrl){var t=document.createElement("span");this.parent.appendChild(t),t.classList.toggle("tch-color-picker-img-url",!0),Picker.imgUrl=getComputedStyle(this.parent.querySelector(".tch-color-picker-img-url")).backgroundImage.match(/url\(["|']?([^"']*)["|']?\)/)[1],this.parent.removeChild(t)}},Picker.prototype.addPickerEvents=function(t){var e=this;t.onclick=function(t){t.preventDefault(),e.createPallete(t.target)}},Picker.rgbaToArray=function(t){for(var e,a=[],i=t.replace("rgba(","").replace(")","").split(","),s=0;s<i.length;s++)e=parseFloat(i[s]),isNaN(e)||(a[s]=e);return a},Picker.prototype.createPallete=function(t){var e=t.style.backgroundColor;(e=Picker.getColor(e))&&(this.rgba=Picker.rgbaToArray(e)),Picker.shownPickers.push(this);var a=document.createElement("div");a.className="tch-color-picker-palette",a.addEventListener("mousedown",function(t){t.stopPropagation()}),document.addEventListener("mousedown",Picker.pickerListener),t.parentNode.appendChild(a),this.paletteRect=a.getBoundingClientRect(),this.palette=a,this.picker=t;var i=document.createElement("div");a.appendChild(i),this.createTablePallete(a),this.createScroll(a),this.createChangeButton(a)},Picker.prototype.createScroll=function(t){var e=document.createElement("div");e.className="container-scroll";var a=document.createElement("input");a.setAttribute("type","range"),a.setAttribute("min","0"),a.setAttribute("max","1"),a.setAttribute("step","0.1"),a.setAttribute("value",this.rgba[3]),e.appendChild(a),t.appendChild(e),this.scroll=a;var i=this;a.oninput=function(t){i.rgba[3]=parseFloat(t.target.value),i.updateValue()},this.setScrollColor()},Picker.prototype.createChangeButton=function(t){var e=document.createElement("input");e.setAttribute("type","button"),e.className="btn-custom-color",e.setAttribute("value",this.techChart.translation["custom-color"]);var a=this;e.onclick=function(){"wrapper-table"===t.querySelector("div").className?a.createCanvasPallete(t):a.createTablePallete(t),a.pointerRect=a.pointer.getBoundingClientRect(),a.canvasRect=a.ctx.canvas.getBoundingClientRect()},t.appendChild(e)},Picker.prototype.createTablePallete=function(t){for(var e=this,a=document.createElement("table"),i=[],s=0;s<8;s++)i[s]=[];i[0][0]="rgba(0, 0, 0, 1)",i[0][1]="rgba(66, 66, 66, 1)",i[0][2]="rgba(101, 101, 101, 1)",i[0][3]="rgba(152, 152, 152, 1)",i[0][4]="rgba(182, 182, 182, 1)",i[0][5]="rgba(203, 203, 203, 1)",i[0][6]="rgba(216, 216, 216, 1)",i[0][7]="rgba(238, 238, 238, 1)",i[0][8]="rgba(242, 242, 242, 1)",i[0][9]="rgba(255, 255, 255, 1)",i[1][0]="rgba(151, 0, 0, 1)",i[1][1]="rgba(255, 0, 0, 1)",i[1][2]="rgba(255, 152, 0, 1)",i[1][3]="rgba(255, 255, 0, 1)",i[1][4]="rgba(0, 255, 0, 1)",i[1][5]="rgba(0, 255, 255, 1)",i[1][6]="rgba(73, 133, 231, 1)",i[1][7]="rgba(0, 0, 255, 1)",i[1][8]="rgba(152, 0, 255, 1)",i[1][9]="rgba(255, 0, 255, 1)",i[2][0]="rgba(230, 184, 175, 1)",i[2][1]="rgba(244, 204, 204, 1)",i[2][2]="rgba(252, 229, 205, 1)",i[2][3]="rgba(255, 242, 204, 1)",i[2][4]="rgba(217, 234, 211, 1)",i[2][5]="rgba(208, 224, 227, 1)",i[2][6]="rgba(201, 218, 248, 1)",i[2][7]="rgba(207, 226, 243, 1)",i[2][8]="rgba(217, 210, 233, 1)",i[2][9]="rgba(234, 209, 220, 1)",i[3][0]="rgba(221, 126, 107, 1)",i[3][1]="rgba(234, 153, 153, 1)",i[3][2]="rgba(249, 203, 156, 1)",i[3][3]="rgba(255, 229, 153, 1)",i[3][4]="rgba(182, 215, 168, 1)",i[3][5]="rgba(162, 196, 201, 1)",i[3][6]="rgba(164, 194, 244, 1)",i[3][7]="rgba(159, 197, 232, 1)",i[3][8]="rgba(180, 167, 214, 1)",i[3][9]="rgba(213, 166, 189, 1)",i[4][0]="rgba(204, 65, 37, 1)",i[4][1]="rgba(224, 102, 102, 1)",i[4][2]="rgba(246, 178, 107, 1)",i[4][3]="rgba(255, 217, 102, 1)",i[4][4]="rgba(147, 196, 125, 1)",i[4][5]="rgba(118, 165, 175, 1)",i[4][6]="rgba(109, 158, 235, 1)",i[4][7]="rgba(111, 168, 220, 1)",i[4][8]="rgba(142, 124, 195, 1)",i[4][9]="rgba(194, 123, 160, 1)",i[5][0]="rgba(166, 28, 0, 1)",i[5][1]="rgba(204, 0, 0, 1)",i[5][2]="rgba(230, 145, 56, 1)",i[5][3]="rgba(241, 194, 50, 1)",i[5][4]="rgba(106, 168, 79, 1)",i[5][5]="rgba(69, 129, 142, 1)",i[5][6]="rgba(60, 120, 216, 1)",i[5][7]="rgba(61, 133, 198, 1)",i[5][8]="rgba(103, 78, 167, 1)",i[5][9]="rgba(166, 77, 121, 1)",i[6][0]="rgba(133, 32, 12, 1)",i[6][1]="rgba(153, 0, 0, 1)",i[6][2]="rgba(180, 95, 6, 1)",i[6][3]="rgba(191, 144, 0, 1)",i[6][4]="rgba(56, 118, 29, 1)",i[6][5]="rgba(19, 79, 92, 1)",i[6][6]="rgba(17, 85, 204, 1)",i[6][7]="rgba(11, 83, 148, 1)",i[6][8]="rgba(53, 28, 117, 1)",i[6][9]="rgba(116, 27, 71, 1)",i[7][0]="rgba(91, 15, 0, 1)",i[7][1]="rgba(102, 0, 0, 1)",i[7][2]="rgba(120, 63, 4, 1)",i[7][3]="rgba(127, 96, 0, 1)",i[7][4]="rgba(39, 78, 19, 1)",i[7][5]="rgba(12, 52, 61, 1)",i[7][6]="rgba(28, 69, 135, 1)",i[7][7]="rgba(7, 55, 99, 1)",i[7][8]="rgba(32, 18, 77, 1)",i[7][9]="rgb(76, 17, 48)";for(var r=0;r<8;r++){for(var n=document.createElement("tr"),o=0;o<10;o++){var h=document.createElement("td"),c=document.createElement("div");c.style.background=i[r][o],c.className="wrapper-color",c.onclick=function(t){for(var a=t.target.style.background.split("(")[1].split(")")[0].split(","),i=0;i<3;i++)e.rgba[i]=a[i];e.updateValue()},h.appendChild(c),n.appendChild(h)}a.appendChild(n)}var l=t.querySelector("div");l.innerHTML="",l.className="wrapper-table",l.appendChild(a)},Picker.prototype.createCanvasPallete=function(t){var e=document.createElement("canvas"),a=document.createElement("div");a.className="tch-color-picker-pointer";var i=e.getContext("2d");this.pointer=a,this.ctx=i;var s=t.querySelector("div");s.innerHTML="",s.className="wrapper-canvas",s.appendChild(a),s.appendChild(e);var r=s.getElementsByTagName("canvas")[0];this.ctx.canvas.width=r.clientWidth,this.ctx.canvas.height=r.clientHeight;for(var n=e.width,o=e.height,h=0;h<n;h++){var c=this.getColorGradient(h,1,n,1);i.fillStyle="rgba("+c[0]+","+c[1]+","+c[2]+","+c[3]+")",i.fillRect(h,0,1,o)}var l=this;a.onmouseup=function(){l.pressed=!1},a.onmousedown=function(){l.pressed=!0},e.onmousedown=function(){l.pressed=!0},e.onmouseup=function(){l.pressed=!1},e.onclick=function(t){l.setPointerPosition(t)},e.onmousemove=function(t){l.pressed&&l.setPointerPosition(t)},a.onmousemove=function(t){l.pressed&&l.setPointerPosition(t)},this.pointerRect=a.getBoundingClientRect(),this.canvasRect=e.getBoundingClientRect()},Picker.prototype.getColorGradient=function(t,e,a){return[Picker.getR(t,a),Picker.getG(t,a),Picker.getB(t,a),255]},Picker.getR=function(t,e){var a=Math.floor(255*Math.cos(2*t*Math.PI/e));return a>0?a:0},Picker.getG=function(t,e){var a=Math.floor(255*Math.sin(2*t*Math.PI/e));return a>0?a:0},Picker.getB=function(t,e){var a=Math.floor(255*Math.sin(2*t*Math.PI/e+Math.PI));return a>0?a:0},Picker.prototype.setPointerPosition=function(t){var e=Math.floor(t.clientX-this.paletteRect.left),a=Math.floor(t.clientY-this.paletteRect.top);this.pointer.style.zIndex=2,this.pointer.style.top=a-this.pointerRect.height/2+"px",this.pointer.style.left=e-this.pointerRect.width/2+"px",this.pointerRect=this.pointer.getBoundingClientRect(),this.canvasRect=this.ctx.canvas.getBoundingClientRect();var i=this.canvasRect.left-this.paletteRect.left;this.canvasRect.right<=this.pointerRect.right&&(e=this.canvasRect.width+i-this.pointerRect.width/2-2),this.canvasRect.left>=this.pointerRect.left&&(e=i+this.pointerRect.width/2);var s=this.canvasRect.top-this.paletteRect.top;this.canvasRect.top>this.pointerRect.top&&(a=s+this.pointerRect.height/2),this.canvasRect.bottom<this.pointerRect.bottom&&(a=s-this.pointerRect.height/2+this.canvasRect.height-2),this.pointer.style.top=a-this.pointerRect.height/2+"px",this.pointer.style.left=e-this.pointerRect.width/2+"px",e=Math.floor(e-(this.canvasRect.left-this.paletteRect.left)),a=Math.floor(a-(this.canvasRect.top-this.paletteRect.top));var r=this.getColorGradient(e,a,this.canvasRect.width,this.canvasRect.height);this.rgba[0]=r[0],this.rgba[1]=r[1],this.rgba[2]=r[2],this.rgba[3]=r[3],this.updateValue()},Picker.prototype.updateValue=function(){var t=this.getColor();this.picker||(this.picker=this.parent.querySelector(".tch-color-picker")),this.picker.style.backgroundColor=t,this.pointer&&(this.pointer.style.backgroundColor=t),this.picker.onchange&&this.picker.onchange(t),this.onchange&&this.onchange(t),this.setScrollColor()},Picker.prototype.setScrollColor=function(){if(this.scroll){var t=this.getColor(),e=(t=t.replace("rgba(","").replace(")","")).split(", "),a="linear-gradient(to right,rgba("+e[0]+", "+e[1]+", "+e[2]+", 0)5%,rgba("+e[0]+", "+e[1]+", "+e[2]+", 1)95%)";this.scroll.style.background=a}},Picker.prototype.setColor=function(t){t=Picker.getColor(t),this.rgba=Picker.rgbaToArray(t),this.updateValue()},Picker.prototype.getColor=function(){return"rgba("+this.rgba[0]+", "+this.rgba[1]+", "+this.rgba[2]+", "+this.rgba[3]+")"},Picker.pickerListener=function(){for(var t=0;t<Picker.shownPickers.length;t++){if(Picker.shownPickers[t].palette){var e=Picker.shownPickers[t].palette;e.parentNode.removeChild(e)}Picker.shownPickers.splice(t,1)}document.removeEventListener("mousedown",Picker.pickerListener)},Picker.getColor=function(t){return 0!==t.indexOf("#")?0===t.indexOf("rgba")?t:0===t.indexOf("rgb")?t.replace(")",", 1)").replace("rgb","rgba"):t:/^#([A-Fa-f0-9]{3}){1,2}$/.test(t)?(3==(e=t.substring(1).split("")).length&&(e=[e[0],e[0],e[1],e[1],e[2],e[2]]),"rgba("+[(e="0x"+e.join(""))>>16&255,e>>8&255,255&e].join(",")+",1)"):void 0;var e},Line_Line.prototype=Object.create(DrawingObject.prototype),Line_Line.prototype.constructor=Line_Line,Line_Line.prototype.addSettingsLineEvent=function(t){var e=t.querySelector(".tch-line-settings-panel"),a=e.querySelector(".tch-line-delete"),i=e.querySelector(".tch-line-params"),s=this;a.onclick=function(t){t.stopPropagation(),t.preventDefault(),s.chartData.chart.removeDrawingObjectsOtherCharts(s.chartData.editDrawingObject),s.chartData.chart.redrawDrawingObjectsOtherCharts(),s.chartData.editDrawingObject.remove(),s.chartData.chart.redrawDrawingObjects(),s.chartData.chart.redrawInfo(),s.chartData.techChart.autoSaveParams(),e.classList.toggle("tch-hidden",!0)},i.onclick=function(e){e.stopPropagation(),e.preventDefault(),s.createLineSettingsPanel(t)}},Line_Line.prototype.addPanelLineSettingEvent=function(t){var e=t.querySelector(".tch-line-settings-panel-cancel"),a=t.querySelector(".tch-line-settings-panel-submit"),i=t.querySelector(".tch-line-settings-form"),s=t.querySelector(".tch-line-settings-panel-default"),r=this;e.onclick=function(e){r.cancelPanelSettingLine(e,t),r.state="normal",r.chartData.techChart.autoSaveParams()},a.onclick=function(t){r.submitLineSettings(t,i),r.state="normal",r.chartData.techChart.autoSaveParams()},s.onclick=function(e){r.setDefaultLineSettings(e,t),e.preventDefault(),e.stopPropagation(),r.state="normal",r.chartData.techChart.autoSaveParams()},r=this,t.oncloseall=function(){r.isSettingsPanelOpen=!1}},Line_Line.prototype.setDefaultLineSettings=function(t){t.preventDefault(),t.stopPropagation()},Line_Line.prototype.submitLineSettings=function(t,e){e.classList.toggle("tch-hidden",!0),t.preventDefault(),t.stopPropagation()},Line_Line.prototype.cancelPanelSettingLine=function(t,e){var a=e.querySelector(".tch-line-settings-style"),i=e.querySelector(".tch-line-settings-coordinates"),s=e.querySelector(".tch-line-settings-visibility");a.classList.toggle("tch-hidden",!1),i.classList.toggle("tch-hidden",!0),s.classList.toggle("tch-hidden",!0),this.restoreOldSettingsLine(e.querySelector(".tch-line-settings-form")),this.updatePixels(),this.chartData.editDrawingObject.state="normal",this.chartData.editDrawingObject.draw(this.chartData.chart.canvasDrawingContext),this.chartData.chart.updateDrawingObjectsOtherChart(this),this.chartData.chart.drawActiveDrawingObjectsOtherCharts(this.id),this.chartData.editDrawingObject=null,this.chartData.chart.redrawInfo(),e.classList.toggle("tch-hidden",!0),t.preventDefault(),t.stopPropagation()},Line_Line.prototype.restoreOldSettingsLine=function(t){for(var e,a=t.querySelectorAll("input"),i=0;i<a.length;i++)void 0!==a[i].oldValue&&(e=a[i].oldValue,this[a[i].name]=e,delete a[i].oldValue,this.applyValue(e,a[i].name));for(var s=t.querySelectorAll("select"),r=0;r<s.length;r++)void 0!==s[r].oldValue&&(e=s[r].oldValue,this[s[r].name]=e,delete s[r].oldValue);var n=t.querySelectorAll(".tch-color-picker");for(i=0;i<n.length;i++){var o=n[i].getAttribute("name");o&&(e=n[i].style.backgroundColor,n[i].oldValue!==e&&(n[i].style.backgroundColor=n[i].oldValue,this[o]=n[i].oldValue,this.applyValue(n[i].oldValue,o),delete n[i].oldValue))}},Line_Line.prototype.createLineSettingsPanel=function(t){this.createSettingsPanel(t),this.fillSettingsPanelFull(t);var e=t.querySelector(".tch-line-settings-style"),a=t.querySelector(".tch-line-settings-coordinates"),i=t.querySelector(".tch-line-settings-visibility"),s=t.querySelector(".tch-line-settings-panel-header li:first-child "),r=t.querySelector(".tch-line-settings-panel-header li:nth-child(2) "),n=t.querySelector(".tch-line-settings-panel-header li:last-child ");s.onclick=function(){e.classList.toggle("tch-hidden",!1),a.classList.toggle("tch-hidden",!0),i.classList.toggle("tch-hidden",!0),s.classList.toggle("tch-tab-selected",!0),r.classList.toggle("tch-tab-selected",!1),n.classList.toggle("tch-tab-selected",!1)},r.onclick=function(){e.classList.toggle("tch-hidden",!0),a.classList.toggle("tch-hidden",!1),i.classList.toggle("tch-hidden",!0),s.classList.toggle("tch-tab-selected",!1),r.classList.toggle("tch-tab-selected",!0),n.classList.toggle("tch-tab-selected",!1)},n.onclick=function(){e.classList.toggle("tch-hidden",!0),a.classList.toggle("tch-hidden",!0),i.classList.toggle("tch-hidden",!1),s.classList.toggle("tch-tab-selected",!1),r.classList.toggle("tch-tab-selected",!1),n.classList.toggle("tch-tab-selected",!0)},this.fillLineStyle(t),this.fillLineCoordinates(t),this.fillLineVisibility(t),this.addPanelLineSettingEvent(t)},Line_Line.prototype.fillLineCoordinates=function(t){var e=t.querySelector(".tch-line-settings-coordinates");e.innerHTML="";var a=this.getCoordinatesRows();this.fillDivWithRows(e,a)},Line_Line.prototype.fillLineVisibility=function(t){var e=t.querySelector(".tch-line-settings-visibility");e.innerHTML="";var a=this.getVisibilityRows();this.fillDivWithRows(e,a)},Line_Line.prototype.getCoordinatesRows=function(){return[]},Line_Line.prototype.getVisibilityRows=function(){for(var t=[{name:"1 Minute",value:"1"},{name:"5 Minutes",value:"5"},{name:"15 Minutes",value:"15"},{name:"30 Minutes",value:"30"},{name:"1 Hour",value:"60"},{name:"4 Hours",value:"hour4"},{name:"8 Hours",value:"hour8"},{name:"1 Day",value:"day"},{name:"1 Week",value:"week"},{name:"1 Month",value:"month"}],e=[],a=0;a<t.length;a++)e.push([{text:t[a].name,options:{line:this,id:"tch-settingsStyle-input-visibility-"+t[a].name,name:"visibility",type:"checkbox",checked:-1===this.periods.indexOf(t[a].value),onchange:this.changeCheckboxInput}}]);return e},Line_Line.prototype.getStyleRows=function(){return[[{className:"tch-ss-basic"},{text:this.chartData.techChart.translation.line,options:{line:this,id:"tch-settingsStyle-input-color",forId:"tch-settingsStyle-input-color",name:"color",type:"colorpicker",value:this.color,onchange:this.changeValueInput}},{text:"",options:{line:this,id:"tch-settingsStyle-input-width",name:"width",type:"range",min:1,max:7,step:2,value:this.width,onchange:this.changeValueInput}},{text:"",options:{line:this,className:"input-styled",id:"tch-settingsStyle-input-lineType",name:"lineType",type:"select",value:this.lineType,options:[{value:"normal",text:this.chartData.techChart.translation.normal},{value:"dash",text:this.chartData.techChart.translation.dash},{value:"points",text:this.chartData.techChart.translation.point}],onchange:this.changeValueSelect}}]]},Line_Line.prototype.getTextStyleRow=function(){return[{className:"tch-ss-textStyleRow"},{text:this.chartData.techChart.translation["text-color"],options:{line:this,id:"tch-settingsStyle-input-textColor",name:"textColor",type:"colorpicker",value:this.textColor,onchange:this.changeValueInput}},{text:"",options:{line:this,className:"input-styled",id:"tch-settingsStyle-input-textFamily",name:"textFamily",type:"select",value:this.textFamily,options:[{value:"veranda",text:"Veranda"},{value:"areal",text:"Areal"},{value:"timesNewRoman",text:"Times New Roman"}],onchange:this.changeValueSelect}},{text:"",options:{line:this,className:"input-styled",id:"tch-settingsStyle-input-textSize",name:"textSize",type:"select",value:this.textSize,options:[{value:"10",text:"10"},{value:"12",text:"12"},{value:"14",text:"14"}],onchange:this.changeValueSelect}},{text:"Bold",options:{line:this,id:"tch-settingsStyle-input-textBold",name:"textBold",type:"checkbox",checked:this.textBold,onchange:this.changeCheckboxInput}},{text:"Italic",options:{line:this,id:"tch-settingsStyle-input-textItalic",name:"textItalic",type:"checkbox",checked:this.textItalic,onchange:this.changeCheckboxInput}}]},Line_Line.prototype.getTextAlignRow=function(){return[{className:"tch-ss-textAlignRow"},{text:this.chartData.techChart.translation["text-alignment"],options:{line:this,className:"input-styled",id:"tch-settingsStyle-input-TextAlignHorizontal",name:"textAlignHorizontal",type:"select",value:this.textAlignHorizontal,options:[{value:"left",text:"Left"},{value:"center",text:"Center"},{value:"right",text:"Right"}],onchange:this.changeValueSelect}},{text:"",options:{line:this,className:"input-styled",id:"tch-settingsStyle-input-textAlignVertical",name:"textAlignVertical",type:"select",value:this.textAlignVertical,options:[{value:"top",text:"Top"},{value:"middle",text:"Middle"},{value:"bottom",text:"Bottom"}],onchange:this.changeValueSelect}}]},Line_Line.prototype.getLeftEndRow=function(){return[{className:"tch-ss-leftEndRow"},{text:this.chartData.techChart.translation["left-end"],options:{line:this,id:"tch-settingsStyle-input-leftEnd",inputRowClassName:"tch-checkbox-input-row",labelRowClassName:"tch-checkbox-label-row",afterLabelRowClassName:"tch-checkbox-after-label-row",name:"leftEnd",type:"checkbox",checked:this.leftEnd,onchange:this.changeCheckboxInput}},{text:"",options:{line:this,className:"input-styled",id:"tch-settingsStyle-input-leftEndType",name:"leftEndType",type:"select",value:this.leftEndType,options:[{value:"normal",text:this.chartData.techChart.translation.normal},{value:"arrow",text:this.chartData.techChart.translation.arrow}],onchange:this.changeValueSelect}}]},Line_Line.prototype.getRightEndRow=function(){return[{className:"tch-ss-rightEndRow"},{text:this.chartData.techChart.translation["right-end"],options:{line:this,id:"tch-settingsStyle-input-rightEnd",inputRowClassName:"tch-checkbox-input-row",labelRowClassName:"tch-checkbox-label-row",afterLabelRowClassName:"tch-checkbox-after-label-row",name:"rightEnd",type:"checkbox",checked:this.rightEnd,onchange:this.changeCheckboxInput}},{text:"",options:{line:this,className:"input-styled",id:"tch-settingsStyle-input-rightEndType",name:"rightEndType",type:"select",value:this.rightEndType,options:[{value:"normal",text:this.chartData.techChart.translation.normal},{value:"arrow",text:this.chartData.techChart.translation.arrow}],onchange:this.changeValueSelect}}]},Line_Line.prototype.getBackgroundRow=function(){return[{className:"tch-ss-backgroundRow"},{text:this.chartData.techChart.translation.background,options:{line:this,id:"tch-settingsStyle-input-fillColor",forId:"tch-settingsStyle-input-fill",labelClassName:"label-fill",name:"fillColor",type:"colorpicker",value:this.fillColor,onchange:this.changeValueInput}},{text:"",options:{line:this,id:"tch-settingsStyle-input-fill",afterLabelClassName:"after-label-fill",name:"fill",type:"checkbox",checked:this.fill,onchange:this.changeCheckboxInput}}]},Line_Line.prototype.getShowDateRow=function(){return[{className:"tch-ss-showDateRow"},{text:this.chartData.techChart.translation["show-time"],options:{line:this,id:"tch-settingsStyle-input-showTime",name:"showTime",type:"checkbox",checked:this.showTime,onchange:this.changeCheckboxInput}}]},Line_Line.prototype.getShowTextRow=function(){return[{className:"tch-ss-showTextRow"},{text:this.chartData.techChart.translation["show-text"],options:{line:this,id:"tch-settingsStyle-input-showText",name:"showText",type:"checkbox",checked:this.showText,onchange:this.changeCheckboxInput}}]},Line_Line.prototype.getMiddleSettingsRow=function(){return[{className:"tch-ss-middleSettingsRow"},{text:this.chartData.techChart.translation.middle,options:{line:this,id:"tch-settingsStyle-input-middleColor",forId:"tch-settingsStyle-input-drawMiddle",labelClassName:"label-draw-middle",name:"middleColor",type:"colorpicker",value:this.middleColor,onchange:this.changeValueInput}},{text:"",options:{line:this,id:"tch-settingsStyle-input-drawMiddle",afterLabelClassName:"after-label-draw-middle",name:"drawMiddle",type:"checkbox",checked:this.drawMiddle,onchange:this.changeCheckboxInput}},{text:"",options:{line:this,id:"tch-settingsStyle-input-middleWidth",name:"middleWidth",type:"range",min:1,max:7,step:2,value:this.middleWidth,onchange:this.changeValueInput}},{text:"",options:{line:this,id:"tch-settingsStyle-input-middleType",name:"middleType",className:"input-styled",type:"select",value:this.middleType,options:[{value:"normal",text:this.chartData.techChart.translation.normal},{value:"dash",text:this.chartData.techChart.translation.dash},{value:"points",text:this.chartData.techChart.translation.point}],onchange:this.changeValueSelect}}]},Line_Line.prototype.getTextAreaRow=function(){return[{className:"tch-ss-textAreaRow"},{text:"",options:{line:this,className:"input-styled",id:"tch-settingsStyle-input-textArea",name:"textArea",type:"textarea",value:this.textArea,onchange:this.changeValueInput}}]},Line_Line.prototype.getShowAngleRow=function(){return[{className:"tch-ss-showAngleRow"},{text:this.chartData.techChart.translation["show-angle"],options:{line:this,id:"tch-settingsStyle-input-showAngle",name:"showAngle",type:"checkbox",checked:this.showAngle,onchange:this.changeCheckboxInput}}]},Line_Line.prototype.getStatsTextColorRow=function(){return[{className:"tch-ss-statsTextColorRow"},{text:this.chartData.techChart.translation["text-color"],options:{line:this,id:"tch-settingsStyle-input-statsTextColor",name:"statsTextColor",type:"colorpicker",value:this.statsTextColor,onchange:this.changeValueInput}}]},Line_Line.prototype.getShowDateTimeRangeRow=function(){return[{className:"tch-ss-showDateTimeRang"},{text:this.chartData.techChart.translation["show-date-time-range"],options:{line:this,id:"tch-settingsStyle-input-showDateRange",name:"showDateRange",type:"checkbox",checked:this.showDateRange,onchange:this.changeCheckboxInput}}]},Line_Line.prototype.getShowBarsRangeRow=function(){return[{className:"tch-ss-showBarsRangeRow"},{text:this.chartData.techChart.translation["show-bars-range"],options:{line:this,id:"tch-settingsStyle-input-showBarsRange",name:"showBarsRange",type:"checkbox",checked:this.showBarsRange,onchange:this.changeCheckboxInput}}]},Line_Line.prototype.getShowPriceRangeRow=function(){return[{className:"tch-ss-showPriceRangeRow"},{text:this.chartData.techChart.translation["show-price-range"],options:{line:this,id:"tch-settingsStyle-input-showPriceRange",name:"showPriceRange",type:"checkbox",checked:this.showPriceRange,onchange:this.changeCheckboxInput}}]},Line_Line.prototype.getShowPriceRow=function(){return[{className:"tch-ss-showPriceRow"},{text:this.chartData.techChart.translation["show-price"],options:{line:this,id:"tch-settingsStyle-input-showPrice",name:"showPrice",type:"checkbox",checked:this.showPrice,onchange:this.changeCheckboxInput}}]},Line_Line.prototype.getShowDistance=function(){return[{className:"tch-ss-showDistance"},{text:this.chartData.techChart.translation["show-distance"],options:{line:this,id:"tch-settingsStyle-input-showDistance",name:"showDistance",type:"checkbox",checked:this.showDistance,onchange:this.changeCheckboxInput}}]},Line_Line.prototype.getAlwaysShowStatsRow=function(){return[{className:"tch-ss-alwaysShowStatsRow"},{text:this.chartData.techChart.translation["always-show-stats"],options:{line:this,id:"tch-settingsStyle-input-alwaysShowStats",name:"alwaysShowStats",type:"checkbox",checked:this.alwaysShowStats,onchange:this.changeCheckboxInput}}]},Line_Line.prototype.setVisibility=function(t,e){if("restoreOldSettingsLine"===e)this.periods=t;else{var a=this.chartData.chart.parent.querySelectorAll(".tch-line-settings-container input[name='visibility']");this.periods=[];for(var i=0;i<a.length;i++)if(!a[i].checked){var s=a[i].id.split("-");this.periods.push(ChartData.convertValueToPeriod(s[s.length-1]))}}this.chartData.chart.redrawInfo()},Line_Line.prototype.getVisibility=function(){return this.periods.splice()},Line_Line.prototype.fillLineStyle=function(t){var e=t.querySelector(".tch-line-settings-style");e.innerHTML="";var a=this.getStyleRows();this.fillDivWithRows(e,a)},Line_Line.prototype.getTimeCandleForLine=function(t,e){return e[t].date},Line_Line.prototype.createCheckboxforVisible=function(t,e){for(var a=[{name:"Minute",value:"1"},{name:"Minute5",value:"5"},{name:"Minute15",value:"15"},{name:"Minute30",value:"30"},{name:"Hours",value:"60"},{name:"Hours4",value:"Hour4"},{name:"Hour8",value:"Hour8"},{name:"Day",value:"Day"},{name:"Week",value:"Week"},{name:"Month",value:"Month"}],i=document.createElement("td"),s=0;s<a.length;s++){var r=document.createElement("label");r.innerText=a[s].name;var n=document.createElement("input");n.type="checkbox",n.name="periods",n.value=a[s].value,-1!==e.indexOf(a[s].value)?n.checked=!1:n.checked=!0,r.appendChild(n),i.appendChild(r)}return i},Line_Line.prototype.draw=function(t,e,a,i,s){if(this.periods.length&&-1!==this.periods.indexOf(this.chartData.period))return!1;if(LibCanvas.drawLine(null,t,e,i,a,s,this.color,this.getLineTypeArray(this.lineType,this.width),this.width,1),"edit"===this.state||"active"===this.state){LibCanvas.drawLine(null,t,e,i,a,s,this.color,[],parseFloat(this.width)+10,.1);for(var r=0;r<this.circles.length;r++){var n=this.circles[r].points[0].active?"red":"white";this.circles[r].drawWithShadow(t,n,this.color,.1)}}return!0},Line_Line.prototype.getLineTypeArray=function(t,e){switch(t){case"normal":return[];case"dash":return[3*e,2*e];case"points":return[e,e];default:return[]}},Line_Line.prototype.drawArrow=function(t,e,a,i,s,r){var n;"up"===r?(n=LibDrawing_LibDrawing.degToRad(135-a-s),this.drawWing(t,e,n,i,i),n=LibDrawing_LibDrawing.degToRad(225-a+s),this.drawWing(t,e,n,i,-i)):"down"===r&&(n=LibDrawing_LibDrawing.degToRad(-45-a-s),this.drawWing(t,e,n,i,i),n=LibDrawing_LibDrawing.degToRad(45-a+s),this.drawWing(t,e,n,i,-i))},Line_Line.prototype.drawWing=function(t,e,a,i,s){var r=parseFloat(e.x),n=parseFloat(e.y),o=-1*Math.sin(a)*s+Math.cos(a)*i+r,h=Math.cos(a)*s+Math.sin(a)*i+n;LibCanvas.drawLine(null,t,r,n,o,h,this.color,[],this.width,1)},Line_Line.prototype.isFocused=function(t,e){return LibDrawing_LibDrawing.isPointOnLine({x1:this.points[0].x,x2:this.points[1].x,y1:this.points[0].y,y2:this.points[1].y},{x:t,y:e})},Line_Line.prototype.fillSettingsPanelFull=function(t){t.innerHTML=this.htmlFullSettingsPanel(),t.setAttribute("tch-line-type",this.constructor.name)},Line_Line.convertFromDTO=function(t,e){var a=DrawingObject.convertFromDTO(t,e);a.circles=a.restoreCircles(e);for(var i=0;i<a.circles.length;i++)a.circles[i].points[0]=a.points[i],a.circles[i].data[0]=a.data[i];return a.updateCustomPropsByObj(a,e),a},Line_Line.prototype.updateCustomPropsByObj=function(t,e){t.color=e.color,t.width=e.width,t.periods=e.periods.slice(0),t.lineType=e.lineType},Line_Line.prototype.cloneCircles=function(t){for(var e=[],a=0;a<t.length;a++)e.push(t[a].convertToDTO());return e},Line_Line.prototype.restoreCircles=function(t){for(var e=[],a=0;a<t.circles.length;a++)e.push(LibDrawing_LibDrawing.convertFromDTO(this.chartData,t.circles[a]));return e},Line_Line.prototype.htmlFullSettingsPanel=function(){return"<div class='tch-line-settings-form'><ul class='tch-line-settings-panel-header tch-dropdown-header'><li class='tch-tab-selected' tch-text='style'>"+this.chartData.techChart.translation.style+"</li><li tch-text='coordinates'>"+this.chartData.techChart.translation.coordinates+"</li><li tch-text='visibility'>"+this.chartData.techChart.translation.visibility+"</li></ul><div class='tch-line-settings-panel-main'><div class='tch-line-settings-style'></div><div class='tch-line-settings-coordinates tch-hidden'><table><tbody></tbody></table></div><div class='tch-line-settings-visibility tch-hidden'><span></span><table><tbody></tbody></table></div></div><ul class='tch-dropdown-footer tch-clearfix'><li><input class='tch-line-settings-panel-default tch-btn tch-btn-default' type='button' tch-text='default' value='"+this.chartData.techChart.translation.default+"'/></li><li><input class=' tch-line-settings-panel-submit tch-btn tch-btn-submit' type='submit' tch-text='ok' value='"+this.chartData.techChart.translation.ok+"'><input class='tch-line-settings-panel-cancel tch-btn tch-btn-cancel' type='button' tch-text='cancel' value='"+this.chartData.techChart.translation.cancel+"'/></li></ul></div>"},Line_Line.prototype.htmlSettingsPanel=function(){return"<div class='tch-line-settings-panel'><ul class='tch-line-panel-header'><li class='tch-line-delete' tch-text='delete'>"+this.chartData.techChart.translation.delete+"</li><li class='tch-line-params' tch-text='params'>"+this.chartData.techChart.translation.params+"</li></ul></div>"},Line_Line.prototype.createSettingsPanel=function(t){t.classList.toggle("tch-hidden",!1),this.chartData.techChart.moveElements.DragObjects.push(new DragObject(t)),t.onclick=function(t){t.stopPropagation()}},Line_Line.prototype.fillDivWithRows=function(t,e){for(var a=0;a<e.length;a++)t.appendChild(this.createDivRow(e[a]))},Line_Line.prototype.createDivRow=function(t){for(var e=document.createElement("div"),a=0;a<t.length;a++)t[a].className?e.className=t[a].className:"select"===t[a].options.type?e.appendChild(this.createSelectWithLabel(t[a].text,t[a].options)):"textarea"===t[a].options.type?e.appendChild(this.createTextAreaWithLabel(t[a].text,t[a].options)):"colorpicker"===t[a].options.type?e.appendChild(this.createColorPickerWithLabel(t[a].text,t[a].options)):"button"===t[a].options.type?e.appendChild(this.createButtonWithLabel(t[a].text,t[a].options)):e.appendChild(this.createInputWithLabel(t[a].text,t[a].options));return e},Line_Line.prototype.changeValueInput=function(t,e){if(t.target.line){void 0===t.target.oldValue&&(t.target.oldValue=t.target.line[t.target.name]),e&&void 0===e.oldValue&&(e.oldValue=t.target.line[t.target.name]);var a=t.target.value;t.target.line.applyValue(a,t.target.name)}},Line_Line.prototype.clickButton=function(t){var e=t.target.getAttribute("buttonvalue");void 0===t.target.oldValue&&(t.target.oldValue=t.target.line[t.target.name]),"on"===e?(t.target.setAttribute("buttonvalue","off"),e="off"):(t.target.setAttribute("buttonvalue","on"),e="on"),t.target.line.applyValue(e,t.target.name,t)},Line_Line.prototype.applyValue=function(t,e){this[e]=t,this.isObjectEdit=!0,this.chartData.chart.redrawInfo(),this.isObjectEdit=!1,this.chartData.chart.updateDrawingObjectsOtherChart(this),this.chartData.chart.drawActiveDrawingObjectsOtherCharts(this.id)},Line_Line.prototype.changeCheckboxInput=function(t){void 0===t.target.oldValue&&(t.target.oldValue=t.target.line[t.target.name]);var e=t.target.checked;t.target.line.applyValue(e,t.target.name)},Line_Line.prototype.changeValueSelect=function(t){void 0===t.target.oldValue&&(t.target.oldValue=t.target.line[t.target.name]);var e=t.target.selectedOptions[0].value;t.target.line.applyValue(e,t.target.name)},Line_Line.prototype.createColorPickerWithLabel=function(t,e){var a=document.createElement("div");if(t){var i=document.createElement("label");i.textContent=t,i.htmlFor=e.id,a.appendChild(i),i.onmousedown=function(t){t.stopPropagation(),Picker.pickerListener()}}var s=document.createElement("div");for(var r in e)e.hasOwnProperty(r)&&(s[r]=e[r]);var n=Picker.createSingle(s,this.chartData.techChart),o=s.querySelector(".tch-color-picker");if(e.onchange){o.setAttribute("name",e.name),o.oldValue=this[e.name];var h={target:{name:e.name,line:this,oldValue:this[e.name]}};n.onchange=function(t){h.target.value=t,e.onchange(h,s)}}return n.setColor(this[e.name]),a.appendChild(s),a},Line_Line.prototype.createTextAreaWithLabel=function(t,e){var a=document.createElement("div");if(t){var i=document.createElement("label");i.textContent=t,i.htmlFor=e.id,a.appendChild(i),i.onmousedown=function(t){t.stopPropagation(),Picker.pickerListener()}}var s=document.createElement("textarea");for(var r in e)e.hasOwnProperty(r)&&"type"!==r&&(s[r]=e[r]);return s.onmousedown=function(t){t.stopPropagation(),Picker.pickerListener()},a.appendChild(s),a},Line_Line.prototype.createInputWithLabel=function(t,e){var a=document.createElement("div"),i=this.chartData.techChart.makeTchTextValue(t);if(t){var s=document.createElement("label");s.textContent=t,s.htmlFor=e.id,s.setAttribute("tch-text",i),a.appendChild(s),s.onmousedown=function(t){t.stopPropagation(),Picker.pickerListener()}}var r=document.createElement("input");for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);return r.onmousedown=function(t){t.stopPropagation(),Picker.pickerListener()},a.appendChild(r),a},Line_Line.prototype.createLinkCheckbox=function(t,e){var a,i=document.createElement("div"),s=this.chartData.techChart.makeTchTextValue(t),r=document.createElement("input");for(var n in e)e.hasOwnProperty(n)&&("tch-checkbox-input-row"===e[n]&&(r.className=e.inputRowClassName),r[n]=e[n]);return r.onmousedown=function(t){t.stopPropagation(),Picker.pickerListener()},i.appendChild(r),t&&((a=document.createElement("label")).textContent="",a.htmlFor=e.id,e.afterLabelRowClassName&&(a.className=e.afterLabelRowClassName),a.setAttribute("tch-label","marketsNoConn"),i.appendChild(a),a.onmousedown=function(t){t.stopPropagation(),Picker.pickerListener()}),t&&((a=document.createElement("label")).textContent=t,a.htmlFor=e.id,e.labelRowClassName&&(a.className=e.labelRowClassName),a.setAttribute("tch-text",s),i.appendChild(a),a.onmousedown=function(t){t.stopPropagation(),Picker.pickerListener()}),i},Line_Line.prototype.createInputAndLabel=function(t,e){var a=document.createElement("div"),i=this.chartData.techChart.makeTchTextValue(t);t&&((s=document.createElement("label")).textContent=t,s.htmlFor=e.id,e.labelClassName&&(s.className=e.labelClassName),s.setAttribute("tch-text",i),a.appendChild(s),s.onmousedown=function(t){t.stopPropagation(),Picker.pickerListener()});var s,r=document.createElement("input");for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);return r.onmousedown=function(t){t.stopPropagation(),Picker.pickerListener()},a.appendChild(r),t&&((s=document.createElement("label")).textContent="",s.htmlFor=e.id,e.afterLabelClassName&&(s.className=e.afterLabelClassName),s.setAttribute("tch-label","marketsNoConn"),a.appendChild(s),s.onmousedown=function(t){t.stopPropagation(),Picker.pickerListener()},e.afterLabelClassName&&(s.onmouseover=function(){a.parentNode.querySelector("."+e.afterLabelClassName.substring(6)).classList.toggle(e.afterLabelClassName.substring(6)+"--text-color",!0)},s.onmouseout=function(){a.parentNode.querySelector("."+e.afterLabelClassName.substring(6)).classList.toggle(e.afterLabelClassName.substring(6)+"--text-color",!1)})),a},Line_Line.prototype.createButtonWithLabel=function(t,e){var a=document.createElement("div"),i=this.chartData.techChart.makeTchTextValue(t);if(t){var s=document.createElement("label");s.textContent=t,s.htmlFor=e.id,s.setAttribute("tch-text",i),a.appendChild(s),s.onmousedown=function(t){t.stopPropagation()}}var r=document.createElement("input");for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);return r.setAttribute("buttonValue",e.buttonValue),r.onmousedown=function(t){t.stopPropagation(),Picker.pickerListener()},a.appendChild(r),a},Line_Line.prototype.createSelectWithLabel=function(t,e){var a=document.createElement("div"),i=this.chartData.techChart.makeTchTextValue(t);if(t){var s=document.createElement("label");s.textContent=t,s.htmlFor=e.id,s.setAttribute("tch-text",i),a.appendChild(s),s.onmousedown=function(t){t.stopPropagation(),Picker.pickerListener()}}for(var r=document.createElement("select"),n=0;n<e.options.length;n++){var o=document.createElement("option");i=this.chartData.techChart.makeTchTextValue(e.options[n].text),o.value=e.options[n].value,o.text=e.options[n].text,o.setAttribute("tch-text",i),o.value===e.value&&(o.selected=!0),r.appendChild(o)}for(var h in e)e.hasOwnProperty(h)&&"options"!==h&&"type"!==h&&(r[h]=e[h]);return r.onmousedown=function(t){t.stopPropagation(),Picker.pickerListener()},a.appendChild(r),a},Line_Line.prototype.addSettingsLineEvent=function(t){var e=t.querySelector(".tch-line-settings-panel"),a=e.querySelector(".tch-line-delete"),i=e.querySelector(".tch-line-params"),s=this;a.onclick=function(t){t.stopPropagation(),t.preventDefault(),s.chartData.chart.removeDrawingObjectsOtherCharts(s.chartData.editDrawingObject),s.chartData.chart.redrawDrawingObjectsOtherCharts(),s.chartData.editDrawingObject.remove(),s.chartData.chart.redrawDrawingObjects(),s.chartData.chart.redrawInfo(),s.chartData.techChart.autoSaveParams(),e.classList.toggle("tch-hidden",!0)},i.onclick=function(e){e.stopPropagation(),e.preventDefault(),s.createLineSettingsPanel(t)}},Text.prototype=Object.create(Line_Line.prototype),Text.prototype.constructor=Text,Text.convertFromDTO=function(t,e){var a=DrawingObject.convertFromDTO(t,e);return a.updateCustomPropsByObj(a,e),a},Text.prototype.getStylePropsNames=function(){return["color","fontFamily","fontSize","textArea","fill","fillColor","border","borderColor","bold","borderColor","italic"]},Text.prototype.applyTextParams=function(){this.textSpan.textContent=this.textArea,this.textSpan.style.fontSize=this.fontSize+"px",this.textSpan.style.fontFamily=this.fontFamily,this.textSpan.style.color=this.color,this.textSpan.style.fontWeight="on"===this.bold?"bolder":"normal",this.textSpan.style.fontStyle="on"===this.italic?"italic":"normal",this.textSpan.style.background=this.fill?this.fillColor:"",this.textSpan.style.border=this.border?"2px solid "+this.borderColor:"none",this.textSpan.style.top=this.points[0].y+"px",this.textSpan.style.left=this.points[0].x+"px";var t=this.textSpan.getBoundingClientRect();this.rect.width=t.width,this.rect.height=t.height},Text.prototype.getTextAreaRow=function(){return[{className:"tch-ss-textAreaRow"},{text:this.chartData.techChart.translation.text,options:{line:this,className:"input-styled",id:"tch-settingsStyle-input-textArea",labelClassName:"label-text-area",name:"textArea",type:"textarea",value:this.textArea,oninput:this.changeValueInput}}]},Text.prototype.getTextStyleRow=function(){return[{className:"tch-ss-basic"},{text:"",options:{line:this,id:"tch-settingsStyle-input-color",name:"color",type:"colorpicker",value:this.color,onchange:this.changeValueInput}},{text:"",options:{line:this,className:"input-styled",id:"tch-settingsStyle-input-fontFamily",name:"fontFamily",type:"select",value:this.fontFamily,options:[{value:"Verdana",text:"Verdana"},{value:"Courier New",text:"Courier New"},{value:"Times New Roman",text:"Times New Roman"},{value:"Arial",text:"Arial"}],onchange:this.changeValueSelect}},{text:"",options:{line:this,className:"input-styled",id:"tch-settingsStyle-input-fontSize",name:"fontSize",type:"select",value:this.fontSize,options:[{value:10,text:"10"},{value:11,text:"11"},{value:12,text:"12"},{value:14,text:"14"},{value:16,text:"16"},{value:20,text:"20"},{value:24,text:"24"},{value:28,text:"28"},{value:32,text:"32"},{value:40,text:"40"}],onchange:this.changeValueSelect}},{text:"",options:{line:this,id:"tch-settingsStyle-input-bold",name:"bold",type:"button",value:"B",buttonValue:this.bold,onclick:this.clickButton}},{text:"",options:{line:this,id:"tch-settingsStyle-input-italic",name:"italic",type:"button",value:"I",buttonValue:this.italic,onclick:this.clickButton}}]},Text.prototype.getBackgroundRow=function(){return[{className:"tch-ss-backgroundRow"},{text:this.chartData.techChart.translation.background,options:{line:this,id:"tch-settingsStyle-input-fillColor",forId:"tch-settingsStyle-input-fill",labelClassName:"label-fill",name:"fillColor",type:"colorpicker",value:this.fillColor,onchange:this.changeValueInput}},{text:"",options:{line:this,id:"tch-settingsStyle-input-fill",afterLabelClassName:"after-label-fill",name:"fill",type:"checkbox",checked:this.fill,onchange:this.changeCheckboxInput}}]},Text.prototype.getBorderRow=function(){return[{className:"tch-ss-backgroundRow"},{text:this.chartData.techChart.translation.border,options:{line:this,id:"tch-settingsStyle-input-borderColor",forId:"tch-settingsStyle-input-border",labelClassName:"label-border",name:"borderColor",type:"colorpicker",value:this.borderColor,onchange:this.changeValueInput}},{text:"",options:{line:this,id:"tch-settingsStyle-input-border",afterLabelClassName:"after-label-border",name:"border",type:"checkbox",checked:this.border,onchange:this.changeCheckboxInput}}]},Circle.prototype=Object.create(DrawingObject.prototype),Circle.prototype.constructor=Circle,Circle.prototype.draw=function(t,e,a){LibCanvas.drawCircle(null,t,this.points[0].x,this.points[0].y,this.radius,this.lineWidth,e,a)},Circle.prototype.drawShadow=function(t,e,a,i){LibCanvas.drawCircle(null,t,this.points[0].x,this.points[0].y,this.radius+5,this.lineWidth,a,a,i)},Circle.prototype.drawWithShadow=function(t,e,a,i){this.drawShadow(t,e,a,i),this.draw(t,e,a)},Circle.convertFromDTO=function(t,e){var a=DrawingObject.convertFromDTO(t,e);return a.updateCustomPropsByObj(a,e),a},Circle.prototype.updateCustomPropsByObj=function(t,e){t.radius=e.radius,t.lineWidth=e.lineWidth},ArrowMark.prototype=Object.create(Text.prototype),ArrowMark.prototype.constructor=ArrowMark,ArrowMark.prototype.createArrowMarkIcon=function(t){this.chartData&&this.chartData.chart&&(this.chartData.chart.drawingTextContainer&&!this.chartData.chart.drawingTextContainer.querySelector("#"+this.id)&&(this.icon=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.icon.setAttribute("id",this.id),this.icon.setAttribute("viewBox",this.viewbox.x+" "+this.viewbox.y+" "+this.viewbox.width+" "+this.viewbox.height),this.icon.setAttribute("heigth",this.size+"px"),this.icon.setAttribute("width",this.size+"px"),this.icon.style.position="absolute",this.icon.style.display="block",this.chartData.chart.drawingTextContainer.appendChild(this.icon)),this.icon&&(this.icon.innerHTML=this.getArrowMarkIcon(this.constructor.name),this.applyArrowMarkPosition(),this.drawCircle(t)))},ArrowMark.prototype.applyArrowMarkPosition=function(){var t=this.getPoint();this.icon.style.left=t.x+this.centeringSvg.x+"px",this.icon.style.top=t.y-this.size/2-this.centeringSvg.y+"px"},ArrowMark.prototype.applyTextParams=function(){this.textSpan.textContent=this.textArea,this.textSpan.style.fontSize=this.fontSize+"px",this.textSpan.style.fontFamily=this.fontFamily,this.textSpan.style.color=this.color,this.textSpan.style.fontWeight="on"===this.bold?"bolder":"normal",this.textSpan.style.fontStyle="on"===this.italic?"italic":"normal";var t=this.textSpan.getBoundingClientRect();this.rect.width=t.width,this.rect.height=t.height,this.applyTextPosition()},ArrowMark.prototype.applyTextPosition=function(){var t=this.getPoint();this.textSpan.style.left=t.x+this.size+"px",this.textSpan.style.top=t.y-this.size/2+"px"},ArrowMark.prototype.drawCircle=function(t){if("edit"===this.state||"active"===this.state){for(var e=0;e<this.circles.length;e++)this.circles[e].points[0].active||this.circles[e].draw(t,"white",this.color);for(e=0;e<this.circles.length;e++)this.circles[e].points[0].active&&this.circles[e].draw(t,"red",this.color)}},ArrowMark.prototype.getRect=function(){var t=this.getPoint();return{x1:t.x,y1:t.y-this.size/2,x2:this.rect.width<=6?t.x+this.size:t.x+this.rect.width+this.size,y2:t.y+this.size/2}},ArrowMark.prototype.getPoint=function(){return{x:parseFloat(this.points[0].x),y:parseFloat(this.points[0].y)}},ArrowMark.prototype.getStylePropsNames=function(){return["color","fontFamily","textArea","bold","italic","colorMark"]},ArrowMark.prototype.getArrowMarkRow=function(){return[{className:"tch-ss-arrowmarkRow"},{text:this.chartData.techChart.translation["arrow-mark"],options:{line:this,id:"tch-settingsStyle-input-colorMark",name:"colorMark",type:"colorpicker",value:this.colorLabel,onchange:this.changeValueInput}}]},ArrowMark.prototype.getTextStyleRow=function(){return[{className:"tch-ss-basic"},{text:this.chartData.techChart.translation["text-font"],options:{line:this,id:"tch-settingsStyle-input-color",name:"color",type:"colorpicker",value:this.color,onchange:this.changeValueInput}},{text:"",options:{line:this,className:"input-styled",id:"tch-settingsStyle-input-fontFamily",name:"fontFamily",type:"select",value:this.fontFamily,options:[{value:"Verdana",text:"Verdana"},{value:"Courier New",text:"Courier New"},{value:"Times New Roman",text:"Times New Roman"},{value:"Arial",text:"Arial"}],onchange:this.changeValueSelect}},{text:"",options:{line:this,id:"tch-settingsStyle-input-bold",name:"bold",type:"button",value:"B",buttonValue:this.bold,onclick:this.clickButton}},{text:"",options:{line:this,id:"tch-settingsStyle-input-italic",name:"italic",type:"button",value:"I",buttonValue:this.italic,onclick:this.clickButton}}]},ArrowMark.prototype.getArrowMarkIcon=function(t){var e=this.colorMark.replace(/ /g,"");switch(t){case"ArrowMarkLeft":return"<path d='M401.947,159.301c0-8.583-6.949-15.742-15.497-15.889l0,0H197.515c-7.021-1.589-12.309-7.886-12.309-15.369V78.976 c0-8.675-5.397-11.163-11.993-5.535L4.948,190.735c-6.598,5.634-6.598,14.847,0,20.479l168.262,117.29 c6.599,5.632,11.996,3.146,11.996-5.528v-49.067c0-8.673,7.097-15.771,15.771-15.771l185.201-0.276 c8.676-0.004,15.771-7.101,15.771-15.771L401.947,159.301z' fill="+e+"></path>";case"ArrowMarkRight":return"<path d='M397,190.734L228.738,73.444c-6.599-5.632-11.996-3.147-11.996,5.528v49.068c0,8.672-7.099,15.77-15.77,15.77 l-104.176,0.156H15.69v0.125C7.051,144.139,0.002,151.214,0,159.857l0.002,82.789c0,8.673,7.095,15.771,15.765,15.771 l183.426-0.275h1.834c8.647,0.028,15.717,7.107,15.717,15.765v49.067c0,8.675,5.397,11.163,11.993,5.535l168.265-117.294 C403.598,205.579,403.598,196.367,397,190.734z' fill="+e+"></path>";case"ArrowMarkUp":return"<path d='M298.055,147.199c0,2.787-1.267,9.271-13.036,9.271h-54.037v178.856c0.072,0.48,0.144,1.159,0.144,1.939 c0,3.177-1.207,6.106-3.416,8.269c-2.858,2.798-7.224,4.222-12.988,4.222h-83.056c-11.493,0-14.525-8.149-14.525-12.454V160.236 H67.606c-13.841,0-15.904-6.594-15.904-10.521c0-6.293,5.996-12.577,7.197-13.775c3.176-4.305,89.036-118.195,101.529-130.718 c4.558-4.534,9.131-5.339,12.163-5.209c7.293,0.3,12.268,5.915,12.808,6.56l104.838,126.674 C291.75,134.631,298.055,141.068,298.055,147.199z' fill="+e+"></path>";case"ArrowMarkDown":return"<path d='M157.355,309.63c-6.728,0-11.351-5.221-11.863-5.82L52.686,191.656 c-2.458-2.274-8.784-9.154-6.391-15.164c1.42-3.568,5.124-5.379,11.014-5.379h47.837V12.765 c-0.234-1.496-0.424-4.906,1.947-7.985C109.54,1.61,113.723,0,119.526,0h73.536c5.211,0,8.213,1.969,9.823,3.628 c3.008,3.1,3.057,6.853,3.04,7.577v156.58h43.85c2.703,0,10.943,0,13.467,6.103c2.622,6.369-3.742,13.391-5.76,15.387 c-2.812,3.818-78.823,104.648-89.886,115.722C163.768,308.814,159.917,309.63,157.355,309.63z' fill="+e+"></path>"}},ArrowMarkLeft.prototype=Object.create(ArrowMark.prototype),ArrowMarkLeft.prototype.constructor=ArrowMarkLeft,ArrowMarkLeft.convertFromDTO=function(t,e){var a=DrawingObject.convertFromDTO(t,e);a.circles=a.restoreCircles(e);for(var i=0;i<a.circles.length;i++)a.circles[i].points[0]=a.points[i],a.circles[i].data[0]=a.data[i];return a.updateCustomPropsByObj(a,e),a},ArrowMarkRight.prototype=Object.create(ArrowMark.prototype),ArrowMarkRight.prototype.constructor=ArrowMarkRight,ArrowMarkRight.convertFromDTO=function(t,e){var a=DrawingObject.convertFromDTO(t,e);a.circles=a.restoreCircles(e);for(var i=0;i<a.circles.length;i++)a.circles[i].points[0]=a.points[i],a.circles[i].data[0]=a.data[i];return a.updateCustomPropsByObj(a,e),a},ArrowMarkUp.prototype=Object.create(ArrowMark.prototype),ArrowMarkUp.prototype.constructor=ArrowMarkUp,ArrowMarkUp.convertFromDTO=function(t,e){var a=DrawingObject.convertFromDTO(t,e);a.circles=a.restoreCircles(e);for(var i=0;i<a.circles.length;i++)a.circles[i].points[0]=a.points[i],a.circles[i].data[0]=a.data[i];return a.updateCustomPropsByObj(a,e),a},ArrowMarkDown.prototype=Object.create(ArrowMark.prototype),ArrowMarkDown.prototype.constructor=ArrowMarkDown,ArrowMarkDown.convertFromDTO=function(t,e){var a=DrawingObject.convertFromDTO(t,e);a.circles=a.restoreCircles(e);for(var i=0;i<a.circles.length;i++)a.circles[i].points[0]=a.points[i],a.circles[i].data[0]=a.data[i];return a.updateCustomPropsByObj(a,e),a},TrendLine.prototype=Object.create(Line_Line.prototype),TrendLine.prototype.constructor=TrendLine,TrendLine.convertFromDTO=function(t,e){var a=Line_Line.convertFromDTO(t,e);return a.updateCustomPropsByObj(a,e),a},TrendLine.prototype.getRightEndPoint=function(t,e,a,i){return(i=void 0===i?LibDrawing_LibDrawing.findLineAngleDeg(t):i)>=-45&&i<45?LibDrawing_LibDrawing.findPointOnLineByX(t,e):i>=45&&i<135?LibDrawing_LibDrawing.findPointOnLineByY(t,0):i<-45&&i>=-135?LibDrawing_LibDrawing.findPointOnLineByY(t,a):LibDrawing_LibDrawing.findPointOnLineByX(t,0)},TrendLine.prototype.getLeftEndPoint=function(t,e,a,i){return(i=void 0===i?LibDrawing_LibDrawing.findLineAngleDeg(t):i)>=-45&&i<45?LibDrawing_LibDrawing.findPointOnLineByX(t,0):i>=45&&i<135?LibDrawing_LibDrawing.findPointOnLineByY(t,a):i<-45&&i>=-135?LibDrawing_LibDrawing.findPointOnLineByY(t,0):LibDrawing_LibDrawing.findPointOnLineByX(t,e)},HorizontalLine.prototype=Object.create(Line_Line.prototype),HorizontalLine.prototype.constructor=HorizontalLine,HorizontalLine.convertFromDTO=function(t,e){var a=Line_Line.convertFromDTO(t,e);return a.updateCustomPropsByObj(a,e),a},VerticalLine.prototype=Object.create(Line_Line.prototype),VerticalLine.prototype.constructor=VerticalLine,VerticalLine.prototype.setShowTime=function(t){this.showTime=t},VerticalLine.prototype.getShowTime=function(){return this.showTime},VerticalLine.convertFromDTO=function(t,e){var a=Line_Line.convertFromDTO(t,e);return a.updateCustomPropsByObj(a,e),a},Arrow.prototype=Object.create(TrendLine.prototype),Arrow.prototype.constructor=Arrow,Arrow.convertFromDTO=function(t,e){var a=Line.convertFromDTO(t,e);return a.updateCustomPropsByObj(a,e),a},Ray.prototype=Object.create(TrendLine.prototype),Ray.prototype.constructor=Ray,Ray.convertFromDTO=function(t,e){var a=Line_Line.convertFromDTO(t,e);return a.updateCustomPropsByObj(a,e),a},HorizontalRay.prototype=Object.create(HorizontalLine.prototype),HorizontalRay.prototype.constructor=HorizontalRay,HorizontalRay.convertFromDTO=function(t,e){return HorizontalLine.convertFromDTO(t,e)},TrendAngle.prototype=Object.create(Ray.prototype),TrendAngle.prototype.constructor=TrendAngle,TrendAngle.prototype.removalLength=50,TrendAngle.convertFromDTO=function(t,e){var a=TrendLine.convertFromDTO(t,e);return a.updateCustomPropsByObj(a,e),a},ParallelChannel.prototype=Object.create(TrendLine.prototype),ParallelChannel.prototype.constructor=ParallelChannel,ParallelChannel.convertFromDTO=function(t,e){var a=TrendLine.convertFromDTO(t,e);return a.updateCustomPropsByObj(a,e),a},ParallelChannel.prototype.completeFigure=function(t,e){if(!(this.points.length<3)){this.heightData={v:t.v-this.data[1].v,y:this.points[1].y-e.y};var a=this.getMiddleData(this.data[0],this.data[1]),i=this.getMiddlePoint(this.points[0],this.points[1]);this.points[2].x=i.x,this.points[2].y=parseFloat(i.y)-parseFloat(this.heightData.y),this.data[2].d=a.d,this.data[2].v=parseFloat(a.v)+parseFloat(this.heightData.v),this.circles[2]&&(this.circles[2].points=[this.points[2]],this.circles[2].data=[this.data[2]])}},ParallelChannel.prototype.drawParallelogram=function(t,e,a,i){var s=[];s.push([e.x,e.y]),s.push([a.x,a.y]),s.push([parseFloat(a.x),parseFloat(a.y)-parseFloat(i)]),s.push([parseFloat(e.x),parseFloat(e.y)-parseFloat(i)]),LibCanvas.drawPolygon(null,t,s,this.fillColor,!1,!0,0,4,this.opacity)},ParallelChannel.prototype.getMiddleData=function(t,e){var a={};return a.v=(parseFloat(t.v)+parseFloat(e.v))/2,a.d=parseInt((t.d+e.d)/2),a},ParallelChannel.prototype.getMiddlePoint=function(t,e){var a={};return a.x=(parseFloat(t.x)+parseFloat(e.x))/2,a.y=(parseFloat(t.y)+parseFloat(e.y))/2,a},ParallelChannel.prototype.getEndPoints=function(t,e,a,i,s){var r;return r=this.leftEnd?this.getLeftEndPoint({x1:t,y1:e,x2:a,y2:i},this.chartData.chart.w,this.chartData.chart.h,s):{x:t,y:e},{rep:this.rightEnd?this.getRightEndPoint({x1:t,y1:e,x2:a,y2:i},this.chartData.chart.w,this.chartData.chart.h,s):{x:a,y:i},lep:r}},DisjointAngle.prototype=Object.create(ParallelChannel.prototype),DisjointAngle.prototype.constructor=DisjointAngle,DisjointAngle.prototype.fillFigure=function(t,e,a,i,s,r,n,o,h){var c,l,d,p,u={x1:e,y1:a,x2:i,y2:s},g={x1:r,y1:n,x2:o,y2:h};e<i?(this.leftEnd?(c=LibDrawing_LibDrawing.findPointOnLineByX(u,0),p=LibDrawing_LibDrawing.findPointOnLineByX(g,0)):(c={x:e,y:a},p={x:r,y:n}),this.rightEnd?(l=LibDrawing_LibDrawing.findPointOnLineByX(u,this.chartData.chart.w),d=LibDrawing_LibDrawing.findPointOnLineByX(g,this.chartData.chart.w)):(l={x:i,y:s},d={x:o,y:h})):(this.leftEnd?(c=LibDrawing_LibDrawing.findPointOnLineByX(u,this.chartData.chart.w),p=LibDrawing_LibDrawing.findPointOnLineByX(g,this.chartData.chart.w)):(c={x:e,y:a},p={x:r,y:n}),this.rightEnd?(l=LibDrawing_LibDrawing.findPointOnLineByX(u,0),d=LibDrawing_LibDrawing.findPointOnLineByX(g,0)):(l={x:i,y:s},d={x:o,y:h}));var v=[];v.push([c.x,c.y]),v.push([p.x,p.y]),v.push([d.x,d.y]),v.push([l.x,l.y]),LibCanvas.drawPolygon(null,t,v,this.fillColor,!1,!1,0,4,this.opacity)},DisjointAngle.convertFromDTO=function(t,e){var a=TrendLine.convertFromDTO(t,e);return a.updateCustomPropsByObj(a,e),a},FlatTopBottom.prototype=Object.create(DisjointAngle.prototype),FlatTopBottom.prototype.constructor=FlatTopBottom,FlatTopBottom.prototype.fixFlatLineEnds=function(t,e){return this.leftEnd&&(e=e<t?0:this.chartData.chart.w),this.rightEnd&&(t=e<t?this.chartData.chart.w:0),{x2:t,x3:e}},FlatTopBottom.convertFromDTO=function(t,e){var a=TrendLine.convertFromDTO(t,e);return a.updateCustomPropsByObj(a,e),a},Polyline.prototype=Object.create(TrendLine.prototype),Polyline.prototype.constructor=Polyline,Polyline.prototype.checkClosed=function(t,e){var a=!1;if(this.points.length>2){var i=Math.abs(this.points[0].x-e.x),s=Math.abs(this.points[0].y-e.y);a=i<20&&s<20}return a},Rectangle.prototype=Object.create(TrendLine.prototype),Rectangle.prototype.constructor=Rectangle,Curve.prototype=Object.create(TrendLine.prototype),Curve.prototype.constructor=Curve,Curve.prototype.getPeekPoint=function(){var t,e,a,i,s,r=((t=LibCanvas.getPosition(this.points[0].x,this.width))+(e=LibCanvas.getPosition(this.points[1].x,this.width)))/2,n=((a=LibCanvas.getPosition(this.points[0].y,this.width))+(i=LibCanvas.getPosition(this.points[1].y,this.width)))/2;s=LibDrawing_LibDrawing.findLineAngleDeg({x1:t,y1:a,x2:e,y2:i});var o=LibDrawing_LibDrawing.degToRad(s);return{x:r+Math.sin(o)*this.height,y:n+Math.cos(o)*this.height}},Curve.prototype.arePointsOnCurve=function(t,e,a,i,s,r){var n=!1,o=[],h=0;(i>=.9||i<=0)&&(i=.1);for(var c=0;c<1+i;c+=i)if(c>1&&(c=1),0===c?o.push(LibDrawing_LibDrawing.getPeekOnCurve(c,t,e,a)):(h++,o.push(LibDrawing_LibDrawing.getPeekOnCurve(c,t,e,a)),n=LibDrawing_LibDrawing.isPointOnLine({x1:o[h-1].x,x2:o[h].x,y1:o[h-1].y,y2:o[h].y},{x:s,y:r})),n)return!0;return!1},Curve.prototype.getPosition=function(){var t=LibCanvas.getPosition(this.points[0].x,this.width),e=LibCanvas.getPosition(this.points[0].y,this.width),a=LibCanvas.getPosition(this.points[1].x,this.width),i=LibCanvas.getPosition(this.points[1].y,this.width);if(this.points[2])var s=LibCanvas.getPosition(this.points[2].x,this.width),r=LibCanvas.getPosition(this.points[2].y,this.width);return{x0:t,y0:e,x1:a,y1:i,x2:s,y2:r}},Curve.prototype.isFocusedOnCircles=function(t,e){if(this.periods.length&&-1!==this.periods.indexOf(this.chartData.period))return!1;this.isObjectEdit=!1;for(var a=!1,i=0,s=0;s<this.circles.length;s++){if(i++,LibDrawing_LibDrawing.isPointOnCircle(this.circles[s],{x:t,y:e})){this.circles[s].points[0].active=!0,this.points[s].active=!0,a=!0;break}this.circles[s].points[0].active=!1,this.points[s].active=!1}for(;i<this.circles.length;)this.circles[i].points[0].active=!1,this.points[i].active=!1,i++;return!!a||a},Triangle.prototype=Object.create(TrendLine.prototype),Triangle.prototype.constructor=Triangle,RotatedRect.prototype=Object.create(TrendLine.prototype),RotatedRect.prototype.constructor=RotatedRect,RotatedRect.convertFromDTO=function(t,e){var a=TrendLine.convertFromDTO(t,e);return a.updateCustomPropsByObj(a,e),a},RotatedRect.prototype.movePoints=function(t){var e={x1:this.points[0].x,y1:this.points[0].y,x2:this.points[1].x,y2:this.points[1].y},a={x:t.x,y:t.y},i=this.getTopLeftData(e,!1,a,!0);this.height=i.h,this.points[2].x=i.x,this.points[2].y=i.y,this.data[2].d=this.chartData.chart.toXValue(this.points[2].x),this.data[2].v=this.chartData.chart.toYValue(this.points[2].y),this.circles[2].points=[this.points[2]],this.circles[2].data=[this.data[2]];var s=this.getTopRightData(e,this.height,null,!0);this.points[3].x=s.x,this.points[3].y=s.y,this.data[3].d=this.chartData.chart.toXValue(this.points[3].x),this.data[3].v=this.chartData.chart.toYValue(this.points[3].y),this.circles[3].points=[this.points[3]],this.circles[3].data=[this.data[3]];var r=this.getTopLeftData(e,this.height,null,!1);this.points[4].x=r.x,this.points[4].y=r.y,this.data[4].d=this.chartData.chart.toXValue(this.points[4].x),this.data[4].v=this.chartData.chart.toYValue(this.points[4].y),this.circles[4].points=[this.points[4]],this.circles[4].data=[this.data[4]];var n=this.getTopRightData(e,this.height,null,!1);this.points[5].x=n.x,this.points[5].y=n.y,this.data[5].d=this.chartData.chart.toXValue(this.points[5].x),this.data[5].v=this.chartData.chart.toYValue(this.points[5].y),this.circles[5].points=[this.points[5]],this.circles[5].data=[this.data[5]],this.circles[2].points[0].active=!0,this.points[2].active=!0,this.circles[3].points[0].active=!0,this.points[3].active=!0,this.circles[4].points[0].active=!0,this.points[4].active=!0,this.circles[5].points[0].active=!0,this.points[5].active=!0},RotatedRect.prototype.getTopLeftData=function(t,e,a,i){var s=e||0===e?e:LibDrawing_LibDrawing.distanceToLine(t,a),r={};r.x=parseFloat(this.points[0].x),r.y=parseFloat(this.points[0].y);var n=LibDrawing_LibDrawing.findLineAngleDeg({x1:this.points[0].x,y1:this.points[0].y,x2:this.points[1].x,y2:this.points[1].y}),o=s*Math.cos(LibDrawing_LibDrawing.degToRad(90-n)),h=s*Math.sin(LibDrawing_LibDrawing.degToRad(90-n)),c={};return i?(c.x=r.x+o,c.y=r.y+h,c.h=s):(c.x=r.x-o,c.y=r.y-h,c.h=s),c},RotatedRect.prototype.getTopRightData=function(t,e,a,i){var s=e||0===e?e:LibDrawing_LibDrawing.distanceToLine(t,a),r={};r.x=parseFloat(this.points[1].x),r.y=parseFloat(this.points[1].y);var n=LibDrawing_LibDrawing.findLineAngleDeg({x1:this.points[0].x,y1:this.points[0].y,x2:this.points[1].x,y2:this.points[1].y}),o=s*Math.cos(LibDrawing_LibDrawing.degToRad(90-n)),h=s*Math.sin(LibDrawing_LibDrawing.degToRad(90-n)),c={};return i?(c.x=r.x+o,c.y=r.y+h,c.h=s):(c.x=r.x-o,c.y=r.y-h,c.h=s),c},RotatedRect.prototype.getPositions=function(){var t=LibCanvas.getPosition(this.points[0].x,this.width),e=LibCanvas.getPosition(this.points[0].y,this.width),a=LibCanvas.getPosition(this.points[1].x,this.width),i=LibCanvas.getPosition(this.points[1].y,this.width);if(this.points[2]&&this.points[3]&&this.points[4]&&this.points[5])var s=LibCanvas.getPosition(this.points[2].x,this.width),r=LibCanvas.getPosition(this.points[2].y,this.width),n=LibCanvas.getPosition(this.points[3].x,this.width),o=LibCanvas.getPosition(this.points[3].y,this.width),h=LibCanvas.getPosition(this.points[4].x,this.width),c=LibCanvas.getPosition(this.points[4].y,this.width),l=LibCanvas.getPosition(this.points[5].x,this.width),d=LibCanvas.getPosition(this.points[5].y,this.width);return{x0:t,x1:a,x2:s,x3:n,x4:h,x5:l,y0:e,y1:i,y2:r,y3:o,y4:c,y5:d}},Arc.prototype=Object.create(TrendLine.prototype),Arc.prototype.constructor=Arc,Arc.convertFromDTO=function(t,e){var a=TrendLine.convertFromDTO(t,e);return a.updateCustomPropsByObj(a,e),a},Arc.prototype.getTopData=function(t,e,a){var i=e||0===e?e:LibDrawing_LibDrawing.distanceToLine(t,a),s={};s.x=(parseFloat(t.x1)+parseFloat(t.x2))/2,s.y=(parseFloat(t.y1)+parseFloat(t.y2))/2;var r=LibDrawing_LibDrawing.findLineAngleDeg({x1:this.points[0].x,y1:this.points[0].y,x2:this.points[1].x,y2:this.points[1].y}),n=i*Math.cos(LibDrawing_LibDrawing.degToRad(90-r)),o=i*Math.sin(LibDrawing_LibDrawing.degToRad(90-r)),h={};return h.x=s.x+n,h.y=s.y+o,h.h=i,h},Arc.prototype.getMiddleData=function(t,e){var a={};return a.v=(parseFloat(t.v)+parseFloat(e.v))/2,a.d=parseInt((t.d+e.d)/2),a},Arc.prototype.getMiddlePoint=function(t,e){var a={};return a.x=(parseFloat(t.x)+parseFloat(e.x))/2,a.y=(parseFloat(t.y)+parseFloat(e.y))/2,a},Arc.prototype.getPositions=function(){var t=LibCanvas.getPosition(this.points[0].x,this.width),e=LibCanvas.getPosition(this.points[0].y,this.width),a=LibCanvas.getPosition(this.points[1].x,this.width),i=LibCanvas.getPosition(this.points[1].y,this.width);if(this.points[2])var s=LibCanvas.getPosition(this.points[2].x,this.width),r=LibCanvas.getPosition(this.points[2].y,this.width);return{x0:t,y0:e,x1:a,y1:i,x2:s,y2:r}},Arc.prototype.getPoints=function(){var t=this.getPositions();return{p0:{x:t.x0,y:t.y0},middlePoint:{x:t.x2,y:t.y2},p2:{x:t.x1,y:t.y1},p4:{x:t.x2-(t.x1-t.x0)/2,y:t.y2-(t.y1-t.y0)/2},p5:{x:t.x2+(t.x1-t.x0)/2,y:t.y2+(t.y1-t.y0)/2}}},Axis.prototype.moveX=function(t){var e=this.x1-t,a=parseFloat(this.textX)-t;this.x1=e,this.x2=e,this.textX=a.toFixed(1)},Axis.prototype.show=function(t,e,a,i,s,r,n,o,h){var c;if(e){this.x1===this.x2?(c=LibCanvas.getPosition(this.x1,1),LibCanvas.drawLine(null,e,c,Math.round(this.y1),c,Math.round(this.y2),s,this.getLineTypeArray(r,1),1)):(c=LibCanvas.getPosition(this.y1,1),LibCanvas.drawLine(null,e,Math.round(this.x1),c,Math.round(this.x2),c,s,this.getLineTypeArray(r,1),1));var l="valueLines"===this.lineClass?0:-4,d=document.createElement("span"),p="valueLines"===this.lineClass?this.value:this.value+"\n"+this.Mmmdd;"Default"!==h&&0===this.x1&&(p=this.getValueFromTickAxis(p,h)),d.innerText=p,d.style.left=(parseFloat(this.textX)+-2).toFixed(1)+"px",d.style.top=(parseFloat(this.textY)+l).toFixed(1)+"px",d.style.color=n,d.style.fontSize=o+"px",i.appendChild(d)}},Axis.prototype.getLineTypeArray=function(t,e){switch(t){case"normal":return[];case"dash":return[3*e,2*e];case"points":return[e,e];default:return[]}},Axis.prototype.getValueFromTickAxis=function(t,e){return"Default"===e?t:parseFloat(t).toFixed(e.length-1)},Brush.prototype=Object.create(Line_Line.prototype),Brush.prototype.constructor=Brush,Brush.convertFromDTO=function(t,e){var a=Line_Line.convertFromDTO(t,e);return a.updateCustomPropsByObj(a,e),a},OscillatorChart.prototype.init=function(t){this.parent=t,this.parent.chart=this,this.parent.innerHTML=this.iniStr,this.dataPanelContainer=this.parent.querySelector(".tch-oscillator-data-panel"),this.createLabel()},OscillatorChart.prototype.createLabel=function(){var t=this.parent.querySelector(".tch-chart-oscillator-rate-text-container");switch(this.name.toLowerCase()){case"adx":t.appendChild(this.createLabelSpan("ADX")),t.appendChild(this.createLabelSpan("DIM")),t.appendChild(this.createLabelSpan("DIP"));break;case"macd":t.appendChild(this.createLabelSpan("histogram")),t.appendChild(this.createLabelSpan("macd")),t.appendChild(this.createLabelSpan("signal"));break;case"so":t.appendChild(this.createLabelSpan("Kline")),t.appendChild(this.createLabelSpan("Dline"));break;case"williamsr":case"rsi":case"atr":case"bulls":case"bears":case"ao":case"ac":case"std":t.appendChild(this.createLabelSpan())}},OscillatorChart.prototype.createLabelSpan=function(t){var e=document.createElement("div");e.classList.add("tch-chart-oscillator-rate-text");var a=document.createElement("div");e.appendChild(a);var i=document.createElement("span");return t?i.classList.add("tch-oscillator-rate-value"+t):i.classList.add("tch-oscillator-rate-value"),i.classList.add("tch-oscillator-price"),a.appendChild(i),e},OscillatorChart.prototype.getValue=function(t,e){return!(t<this.top||t>this.top+this.h||!this.scaleParams)&&this.toYValue(t,e)},OscillatorChart.prototype.setElementsPositionAndSize=function(t,e,a,i){this.w=t||this.w,this.h=e||this.h,this.top=i||this.top,this.clipPathOffset=a||this.clipPathOffset,this.parent.style.top=this.top+"px",this.parent.style.height=this.h+"px",this.canvasDataNormal=this.parent.querySelector(".tch-chart-data-normal"),this.canvasDataNormal.setAttribute("width",this.w-a+"px"),this.canvasDataNormal.setAttribute("height",this.h+"px"),this.canvasDataNormalContext=this.canvasDataNormal.getContext("2d"),this.canvasDataPixelated=this.parent.querySelector(".tch-chart-data-pixelated"),this.canvasDataPixelated.setAttribute("width",this.w-a+"px"),this.canvasDataPixelated.setAttribute("height",this.h+"px"),this.canvasDataPixelatedContext=this.canvasDataPixelated.getContext("2d")},OscillatorChart.prototype.clear=function(){LibCanvas.clearRect(null,this.canvasDataNormalContext,0,0,this.canvasDataNormal.width,this.canvasDataNormal.height),LibCanvas.clearRect(null,this.canvasDataPixelatedContext,0,0,this.canvasDataPixelated.width,this.canvasDataPixelated.height)},OscillatorChart.prototype.draw=function(t,e,a){if(!t.hidden)switch(t.name.toLowerCase()){case"adx":this.drawADX(t,e,a);break;case"macd":this.drawMACD(t,e,a);break;case"williamsr":case"rsi":case"atr":this.drawLinePT(t,e,a);break;case"so":this.drawSO(t,e,a);break;case"bulls":case"bears":this.drawHistogram(t,e,a,this.getColorLineHistogram);break;case"ao":case"ac":this.drawHistogram(t,e,a,this.getColorAoHistogram);break;case"std":this.drawLinePT(t,e,a)}},OscillatorChart.prototype.drawPriceLineCurrentOscillator=function(t,e){if(!t.hidden&&e[0]&&this.scaleParams)switch(t.name.toLowerCase()){case"adx":this.drawPriceLineOscillator(e[0].ADX,t.lineWidth.ADX,t.colors.ADX),this.drawPriceLineOscillator(e[0].DIM,t.lineWidth.DIM,t.colors.DIM),this.drawPriceLineOscillator(e[0].DIP,t.lineWidth.DIP,t.colors.DIP),this.drawPriceValueOscillator(e[0].ADX,t.colors.ADX,"ADX",t.oscillatorPrecission),this.drawPriceValueOscillator(e[0].DIM,t.colors.DIM,"DIM",t.oscillatorPrecission),this.drawPriceValueOscillator(e[0].DIP,t.colors.DIP,"DIP",t.oscillatorPrecission);break;case"macd":this.drawPriceLineOscillator(e[0].histogram,t.lineWidth.histogram,t.colors.histogram),this.drawPriceLineOscillator(e[0].macdLine,t.lineWidth.macd,t.colors.macd),this.drawPriceLineOscillator(e[0].signalLine,t.lineWidth.signal,t.colors.signal),this.drawPriceValueOscillator(e[0].histogram,t.colors.histogram,"histogram",t.oscillatorPrecission),this.drawPriceValueOscillator(e[0].macdLine,t.colors.macd,"macd",t.oscillatorPrecission),this.drawPriceValueOscillator(e[0].signalLine,t.colors.signal,"signal",t.oscillatorPrecission);break;case"so":this.drawPriceLineOscillator(e[0].D,t.lineWidth.DLine,t.colors.DLine),this.drawPriceValueOscillator(e[0].D,t.colors.DLine,"Dline",t.oscillatorPrecission),this.drawPriceLineOscillator(e[0].K,t.lineWidth.KLine,t.colors.KLine),this.drawPriceValueOscillator(e[0].K,t.colors.KLine,"Kline",t.oscillatorPrecission);break;case"williamsr":case"rsi":case"atr":case"bulls":case"bears":case"std":this.drawPriceLineOscillator(e[0].P,t.lineWidth.line,t.colors.line),this.drawPriceValueOscillator(e[0].P,t.colors.line,"",t.oscillatorPrecission);break;case"ao":case"ac":this.drawPriceLineOscillator(e[0].P,t.lineWidth.line,"#0000FF"),this.drawPriceValueOscillator(e[0].P,"#0000FF","",t.oscillatorPrecission)}},OscillatorChart.prototype.drawPriceLineOscillator=function(t,e,a){if(!this.chartData.data||0!==this.chartData.data.length){var i=this.toYPixels(t);if(!(i>this.h)){var s=this.canvasDataPixelatedContext,r=LibCanvas.getPosition(i,e);LibCanvas.drawLine(null,s,0,r,this.w,r,a,[e,e],e,null)}}},OscillatorChart.prototype.drawPriceValueOscillator=function(t,e,a,i){var s,r=this.chartData.options.Chart.scalesFontSize,n=parseFloat((""+t).replace(",","."));n=n.toFixed(i),(s=a?this.parent.querySelector(".tch-oscillator-rate-value"+a):this.parent.querySelector(".tch-oscillator-rate-value")).style.fontSize=r+"px";var o=this.toYPixels(t);o>this.h||o<=0?s.parentNode.style.display="none":(s.parentNode.style.display="block",s.innerText=n,this.priceTextHeight||(this.priceTextHeight=s.parentNode.getBoundingClientRect().height),this.priceTextColor||(this.priceTextColor=this.chartData.chart.getPriceTextColor(e)),s.parentNode.style.left=this.w+4+"px",s.parentNode.style.top=o-this.priceTextHeight/2+"px",s.parentNode.style.backgroundColor=e,s.parentNode.style.color=this.priceTextColor)},OscillatorChart.prototype.drawLinePT=function(t,e,a){var i=this;if(e[0]&&this.scaleParams){var s=this.canvasDataNormalContext,r=e.map(function(t){return[a.toXPixels(t.T).toFixed(1),i.toYPixels(t.P).toFixed(1)]});LibCanvas.drawPolygon(null,s,r,null,t.colors.line,!1,t.lineWidth.line,r.length)}},OscillatorChart.prototype.getColorLineHistogram=function(t){return t.colors.line},OscillatorChart.prototype.getColorAoHistogram=function(t,e,a){return a[e][2]>(a[e+1]?a[e+1][2]:a[e][2])?t.colors.lineUp:t.colors.lineDown},OscillatorChart.prototype.drawHistogram=function(t,e,a,i){if(e&&0!==e.length&&parent&&e[0]&&this.scaleParams){for(var s=[],r=Math.round(this.toYPixels(0)),n=0;n<e.length;n++)if(e[n]){var o=LibCanvas.getPosition(a.toXPixels(e[n].T),t.lineWidth.line);if(o>=0&&o<=a.w-a.chartData.rightPadding){var h=Math.round(this.toYPixels(e[n].P));s.push([[o,r],[o,h],e[n].P])}}for(var c,l=this.canvasDataPixelatedContext,d=0;d<s.length;d++)c=i(t,d,s),LibCanvas.drawLine(null,l,s[d][0][0],s[d][0][1],s[d][1][0],s[d][1][1],c,[],t.lineWidth.line,1);var p=s[0],u=LibCanvas.getPosition(p[0][1],1);LibCanvas.drawLine(null,l,0,u,this.w,u,t.colors.line,[1,1],1,null)}},OscillatorChart.prototype.drawSO=function(t,e,a){if(e&&0!==e.length&&e[0]&&this.scaleParams){for(var i=this.canvasDataNormalContext,s={D:[],K:[]},r=0;r<e.length;r++)if(e[0]){var n=a.toXPixels(e[r].T);n>=0&&n<=a.w-a.chartData.rightPadding&&(s.D.push([n.toFixed(1),this.toYPixels(e[r].D).toFixed(1)]),s.K.push([n.toFixed(1),this.toYPixels(e[r].K).toFixed(1)]))}LibCanvas.drawPolygon(null,i,s.D,null,t.colors.DLine,!1,t.lineWidth.DLine,s.D.length),LibCanvas.drawPolygon(null,i,s.K,null,t.colors.KLine,!1,t.lineWidth.KLine,s.K.length)}},OscillatorChart.prototype.drawADX=function(t,e,a){if(e&&0!==e.length&&e[0]&&this.scaleParams){for(var i={ADX:[],DIM:[],DIP:[]},s=0;s<e.length;s++)if(e[s]){var r=a.toXPixels(e[s].T);r>=0&&r<=a.w-a.chartData.rightPadding&&(i.ADX.push([r.toFixed(1),this.toYPixels(e[s].ADX).toFixed(1)]),i.DIM.push([r.toFixed(1),this.toYPixels(e[s].DIM).toFixed(1)]),i.DIP.push([r.toFixed(1),this.toYPixels(e[s].DIP).toFixed(1)]))}var n=this.canvasDataNormalContext;LibCanvas.drawPolygon(null,n,i.ADX,null,t.colors.ADX,!1,t.lineWidth.ADX,i.ADX.length),LibCanvas.drawPolygon(null,n,i.DIM,null,t.colors.DIM,!1,t.lineWidth.DIM,i.DIM.length),LibCanvas.drawPolygon(null,n,i.DIP,null,t.colors.DIP,!1,t.lineWidth.DIP,i.DIP.length)}},OscillatorChart.prototype.drawMACD=function(t,e,a){if(e&&0!==e.length&&parent&&e[0]){for(var i={L:[],S:[]},s=[],r=Math.round(this.toYPixels(0)),n=0;n<e.length;n++)if(e[n]){var o=LibCanvas.getPosition(a.toXPixels(e[n].T),t.lineWidth.histogram);if(o>=0&&o<=a.w-a.chartData.rightPadding){var h=Math.round(this.toYPixels(e[n].histogram));s.push([[o,r],[o,h]]),i.L.push([o.toFixed(1),this.toYPixels(e[n].macdLine).toFixed(1)]),i.S.push([o.toFixed(1),this.toYPixels(e[n].signalLine).toFixed(1)])}}var c=this.canvasDataNormalContext,l=this.canvasDataPixelatedContext;LibCanvas.drawPolygon(null,c,i.L,null,t.colors.macd,!1,t.lineWidth.macd,i.L.length),LibCanvas.drawPolygon(null,c,i.S,null,t.colors.signal,!1,t.lineWidth.signal,i.S.length);for(var d=0;d<s.length;d++)LibCanvas.drawLine(null,l,s[d][0][0],s[d][0][1],s[d][1][0],s[d][1][1],t.colors.histogram,[],t.lineWidth.histogram,1);var p=s[0],u=LibCanvas.getPosition(p[0][1],1);LibCanvas.drawLine(null,l,0,u,this.w,u,t.colors.histogram,[1,1],1,null)}},OscillatorChart.prototype.toYValue=function(t,e){if(isNaN(t))return!1;t-=this.getOffsetY();var a=this.h;return(parseFloat(this.scaleParams.minB)+this.scaleParams.deltaY*(a-t)).toFixed(e)},OscillatorChart.prototype.toYPixels=function(t){return!isNaN(t)&&this.h-(t-this.scaleParams.minB)/this.scaleParams.deltaY},OscillatorChart.prototype.getValueAxis=function(t,e){this.scaleParams&&(e=this.getCurrPrecission(),this.valueAxis=u.prototype.getValueAxis(this.scaleParams.minB,this.scaleParams.maxB,4,this.w,this.h,t,e,this.top),this.valueAxis.shift())},OscillatorChart.prototype.getOffsetY=function(){return this.top},OscillatorChart.prototype.getScaleParams=function(t,e){if(t&&0!==t.length){var a=this.getMaxValue(t,e),i=this.getMinValue(t,e),s=u.prototype.getDeltaYforBoundsCalculation(i,a,this.h,this.marginTop,this.marginBottom),r=parseFloat(u.prototype.getMaxB(s,a,this.marginTop,e)),n=parseFloat(u.prototype.getMinB(s,i,this.marginBottom,e));return n===r&&(n-=1/Math.pow(10,e),r+=1/Math.pow(10,e)),{minB:n,maxB:r,deltaY:parseInt(Math.pow(10,12)*(r-n)/this.h)/Math.pow(10,12)}}},OscillatorChart.prototype.getMaxValue=function(t){if(t&&0!==t.length){for(var e=Number.MIN_VALUE,a=0;a<t.length;a++)for(var i in t[a])if(t[a].hasOwnProperty(i)&&"T"!==i){var s=t[a][i];e<s&&(e=s)}return e}},OscillatorChart.prototype.getMinValue=function(t){if(t&&0!==t.length){for(var e=Number.MAX_VALUE,a=0;a<t.length;a++)for(var i in t[a])if(t[a].hasOwnProperty(i)&&"T"!==i){var s=t[a][i];e>s&&(e=s)}return e}},OscillatorChart.prototype.redrawOnResize=function(){var t=this.chartData.getIndicatorIndex(this.chartData.indicators,this),e=this.chartData.indicators[t],a=Indicator.getValuesFromDictionary(e.data);e.createShowData(),this.scaleParams=this.getScaleParams(e.showData,parseInt(this.chartData.precission)),this.setElementsPositionAndSize(this.w,this.h,this.clipPathOffset),this.clear(),this.draw(e,a,this.chartData.chart),this.chartData.chart.redrawGrid()},OscillatorChart.prototype.drawLabels=function(){},OscillatorChart.prototype.getCurrPrecission=function(){var t=this.chartData.indicators;for(var e in t)if(t.hasOwnProperty(e)&&t[e].id===this.id)return t[e].oscillatorPrecission},NewsBubble.prototype=Object.create(Bubble.prototype),NewsBubble.prototype.constructor=NewsBubble,EventsBubble.prototype=Object.create(Bubble.prototype),EventsBubble.prototype.constructor=EventsBubble,Bubble.currentId=0,Bubble.prototype.isFocused=function(t,e){var a=this.getPositionLeft(),i=this.getPositionTop(),s=2*this.radius,r={x1:a,x2:a+s,y1:i,y2:i+s};return LibDrawing_LibDrawing.isPointInRect(r,{x:t,y:e},5)},Bubble.prototype.moveBubbleX=function(t){this.point.x-=t,this.divBubble.style.left=this.getPositionLeft()+"px",this.chartData.options.Chart.autoScale&&(this.updatePixelsY(),this.divBubble.style.top=this.getPositionTop()+"px")},Bubble.prototype.moveBubbleY=function(t){this.point.y-=t,this.divBubble.style.top=this.getPositionTop()+"px"},Bubble.prototype.show=function(t){this.parent=t,this.divBubble=document.createElement("div"),this.divBubble.classList.toggle("tch-bubble-id-"+this.id,!0),this.divBubble.classList.toggle("tch-bubbles",!0);var e=document.createElement("span");e.textContent=this.text,this.setParams(),this.resize(this.candleWidth),this.divBubble.appendChild(e),this.parent.appendChild(this.divBubble)},Bubble.prototype.remove=function(){return this.removeTooltip(),this.parent.removeChild(this.divBubble),this},Bubble.prototype.updatePixels=function(){this.updatePixelsY(),this.updatePixelsX()},Bubble.prototype.updatePixelsY=function(){this.point.y=this.chartData.chart.toYPixels(this.value)},Bubble.prototype.updatePixelsX=function(){this.point.x=this.chartData.chart.toXPixels(this.date)},Bubble.getBubbles=function(t,e,a,i,s){if(!t.chart||!t.chart.showData||0===t.chart.showData.length)return[];i=i||t.chart.showData[t.chart.showData.length-1].date,s=s||t.chart.showData[0].date;var r=Bubble.selectItems(i,s,e,a),n=Bubble.convertToBubbles(r,t,a);return this.combineBubbles(n)},Bubble.prototype.fixPosition=function(){var t=this.chartData.chart,e=t.binarySearhElementWithField(t.showData,parseFloat(this.point.x),"x"),a=t.showData[e]?t.showData[e]:t.showData[0];this.point.x=a.x,this.point.y=t.toYPixels(a.high),this.value=a.high,this.date=a.date},Bubble.selectItems=function(t,e,a,i){for(var s=[],r=0;r<a.length;r++){var n=Bubble["getDate"+i](a[r]);if(n>t&&n<e)s.push(a[r]);else if(n<t)break}return s},Bubble.getDateNewsBubble=function(t){return t.PublishDate},Bubble.getDateEventsBubble=function(t){var e=t.DateTime.Year,a=t.DateTime.Month-1,i=t.DateTime.Day,s=t.DateTime.Hour,r=t.DateTime.Minute,n=t.DateTime.Second;return Date.UTC(e,a,i,s,r,n)/1e3},Bubble.convertToBubbles=function(t,e,a){if(0===t.length)return[];for(var i=e.chart.showData,s=[],r=0,n="getDate"+a,o=0;o<i.length;o++){for(var h=[];t[r]&&Bubble[n](t[r])>=i[o].date;)h.push(t[r++]);if(h.length){var c=Bubble.createBubble(i[o],e,h,a);s.push(c)}}return s},Bubble.createBubble=function(t,e,a,i){var s={date:t.date,value:t.high,items:a,point:{x:t.x,y:e.chart.toYPixels(t.high)},id:Bubble.getId()};switch(i){case"NewsBubble":return new NewsBubble(e,s);case"EventsBubble":return new EventsBubble(e,s);default:return new Bubble(e,s)}},Bubble.combineBubbles=function(t){if(t&&0===t.length)return[];for(var e=[],a=0;a<t.length;a++)e[e.length-1]&&Bubble.isTouch(e[e.length-1],t[a])?e[e.length-1].items=e[e.length-1].items.concat(t[a].items):e.push(t[a]);for(var i=0;i<e.length;i++)e[i].fixPosition();return e},Bubble.sortItemsByDate=function(t){return t.sort(function(t,e){return e.date-t.date})},Bubble.isTouch=function(t,e){return Math.abs(parseFloat(t.point.x)-parseFloat(e.point.x))<=t.radius+e.radius},Bubble.deleteRedundantBubblesLeftRight=function(t,e,a){Bubble.deleteRedundantBubblesFromRight(t,a),Bubble.deleteRedundantBubblesFromLeft(t,e)},Bubble.deleteRedundantBubblesFromRight=function(t,e){for(;t.length&&parseInt(t[0].point.x)>e;)t[0].remove(),t.splice(0,1)},Bubble.deleteRedundantBubblesFromLeft=function(t,e){for(;t.length&&parseInt(t[t.length-1].point.x)<e;)t[t.length-1].remove(),t.splice(t.length-1,1)},Bubble.prototype.resize=function(t){this.cY=3*t,this.radius=this.getRadius(t),this.divBubble.style.left=this.getPositionLeft()+"px",this.divBubble.style.top=this.getPositionTop()+"px";var e=2*this.radius;this.divBubble.style.width=e+"px",this.divBubble.style.height=e+"px",this.divBubble.style.fontSize=1.8*this.radius+"px"},Bubble.prototype.hideTooltip=function(){this.tooltip.mouseLeaveParentDiv()},Bubble.prototype.removeTooltip=function(){this.tooltip&&this.tooltip.remove()},Bubble.prototype.getPositionLeft=function(){return parseFloat(this.point.x)-this.radius},Bubble.prototype.getPositionTop=function(){return parseFloat(this.point.y)-1.5*this.radius-this.cY},Bubble.prototype.setParams=function(){this.divBubble.style.left=this.getPositionLeft()+"px",this.divBubble.style.top=this.getPositionTop()+"px";var t=2*this.radius;this.divBubble.style.width=t+"px",this.divBubble.style.height=t+"px",this.divBubble.style.fontSize=1.8*this.radius+"px"},Bubble.prototype.getRadius=function(t){var e=.6*t;return e<9?9:e},Bubble.getId=function(){return Bubble.currentId++},Tooltip.prototype.init=function(){this.point=this.getPoint(),this.data=this.processData(this.bubble.items),this.isFocused=!0,this.isVisible=!1,this.parentDiv=this.getParentDiv(),this.parentDiv.innerHTML="",this.draw()},Tooltip.prototype.getParentDiv=function(){return null},Tooltip.prototype.draw=function(){this.createMarkup()},Tooltip.prototype.createMarkup=function(){this.createParentDiv(),this.createHeaderDiv(),this.createDateDiv(),1!==this.data.length&&(this.createSpansDiv(),this.createSpans(),this.setSpansClasses()),this.createBodyDiv(),this.parentDiv.classList.toggle("tch-hidden",!1),this.isVisible=!0,this.adjustParentDivPosition()},Tooltip.prototype.createParentDiv=function(){this.parentDiv.addEventListener("mouseenter",this.mouseEnterParentDiv.bind(this)),this.parentDiv.addEventListener("mouseleave",this.mouseLeaveParentDiv.bind(this)),this.parentDiv.onmousedown=function(t){t.preventDefault(),t.stopPropagation()},this.parentDiv.onmouseup=function(t){t.preventDefault(),t.stopPropagation()}},Tooltip.prototype.mouseEnterParentDiv=function(){this.isFocused=!0},Tooltip.prototype.updateInfo=function(){},Tooltip.prototype.mouseLeaveParentDiv=function(){this.isFocused=!1;var t=this;this.leaveTimeout=setTimeout(function(){t.leaveParentDiv()},400)},Tooltip.prototype.leaveParentDiv=function(){!this.isFocused&&this.isVisible&&(this.parentDiv.classList.toggle("tch-hidden",!0),this.isVisible=!1,this.parentDiv.innerHTML="")},Tooltip.prototype.createHeaderDiv=function(){this.headerDiv=document.createElement("div"),this.parentDiv.appendChild(this.headerDiv),this.headerDiv.classList.toggle("tch-tooltip-header",!0)},Tooltip.prototype.createDateDiv=function(){this.dateDiv=document.createElement("div"),this.headerDiv.appendChild(this.dateDiv),this.dateDiv.classList.toggle("tch-tooltip-date",!0),this.dateDiv.innerHTML=this.data[this.bubble.currentPageIndex].date},Tooltip.prototype.createSpansDiv=function(){this.spansDiv=document.createElement("div"),this.headerDiv.appendChild(this.spansDiv),this.spansDiv.classList.toggle("tch-tooltip-spans",!0)},Tooltip.prototype.createSpans=function(){this.leftArrowSpan=document.createElement("span"),this.spansDiv.appendChild(this.leftArrowSpan),this.leftArrowSpan.addEventListener("mousedown",this.clickLeftArrow.bind(this)),this.leftArrowSpan.innerHTML=" ",this.pagesSpan=document.createElement("span"),this.spansDiv.appendChild(this.pagesSpan),this.pagesSpan.classList.toggle("tch-tooltip-pages",!0),this.pagesSpan.innerHTML=this.bubble.currentPage+"/"+this.data.length,this.rightArrowSpan=document.createElement("span"),this.spansDiv.appendChild(this.rightArrowSpan),this.rightArrowSpan.addEventListener("mousedown",this.clickRightArrow.bind(this)),this.rightArrowSpan.innerHTML=" "},Tooltip.prototype.setSpansClasses=function(){1===this.bubble.currentPage?(this.leftArrowSpan.classList.toggle("tch-tooltip-left-arrow",!0),this.rightArrowSpan.classList.toggle("tch-tooltip-right-arrow-active",!0)):this.bubble.currentPage===this.data.length?(this.rightArrowSpan.classList.toggle("tch-tooltip-right-arrow",!0),this.leftArrowSpan.classList.toggle("tch-tooltip-left-arrow-active",!0)):(this.leftArrowSpan.classList.toggle("tch-tooltip-left-arrow-active",!0),this.rightArrowSpan.classList.toggle("tch-tooltip-right-arrow-active",!0))},Tooltip.prototype.updateSpansClasses=function(){1===this.bubble.currentPage?(this.leftArrowSpan.classList.toggle("tch-tooltip-left-arrow-active",!1),this.leftArrowSpan.classList.toggle("tch-tooltip-left-arrow",!0),this.rightArrowSpan.classList.toggle("tch-tooltip-right-arrow-active",!0)):this.bubble.currentPage===this.data.length?(this.rightArrowSpan.classList.toggle("tch-tooltip-right-arrow-active",!1),this.rightArrowSpan.classList.toggle("tch-tooltip-right-arrow",!0),this.leftArrowSpan.classList.toggle("tch-tooltip-left-arrow",!1),this.leftArrowSpan.classList.toggle("tch-tooltip-left-arrow-active",!0)):(this.leftArrowSpan.classList.toggle("tch-tooltip-left-arrow-active",!0),this.rightArrowSpan.classList.toggle("tch-tooltip-right-arrow-active",!0))},Tooltip.prototype.clickLeftArrow=function(){this.leftArrowSpan.classList.contains("tch-tooltip-left-arrow-active")&&(--this.bubble.currentPage,--this.bubble.currentPageIndex,this.update())},Tooltip.prototype.clickRightArrow=function(){this.rightArrowSpan.classList.contains("tch-tooltip-right-arrow-active")&&(++this.bubble.currentPage,++this.bubble.currentPageIndex,this.updateSpansClasses(),this.update())},Tooltip.prototype.remove=function(){this.isFocused=!1,this.parentDiv.classList.toggle("tch-hidden",!0),this.isVisible=!1},Tooltip.prototype.update=function(){1!==this.data.length&&this.updateSpansClasses(),this.dateDiv.innerHTML=this.data[this.bubble.currentPageIndex].date,1!==this.data.length&&(this.pagesSpan.innerHTML=this.bubble.currentPage+"/"+this.data.length),this.updateInfo()},Tooltip.prototype.refresh=function(){this.isFocused=!0,this.parentDiv.classList.toggle("tch-hidden",!1),this.isVisible=!0,this.point=this.getPoint(),this.data=this.processData(this.bubble.items),this.reAppend(),this.update(),this.adjustParentDivPosition()},Tooltip.prototype.getPoint=function(){return{x:this.bubble.getPositionLeft(),y:this.bubble.getPositionTop()}},Tooltip.prototype.adjustParentDivPosition=function(){var t=this.parentDiv.getBoundingClientRect();this.isAdjustRight(t)?this.isAdjustLeft(t)?this.parentDiv.style.left=this.point.x- -1*(this.chartData.chart.w-this.point.x-t.width-2*this.bubble.radius)+"px":this.parentDiv.style.left=this.point.x-t.width+"px":this.parentDiv.style.left=this.point.x+2*this.bubble.radius+"px",this.isAdjustBottom(t)?(this.parentDiv.style.top=this.point.y-t.height+"px",this.isAdjustTop(t)&&(this.parentDiv.style.top="15px")):this.isAdjustTop(t)?(this.parentDiv.style.top="15px",this.isAdjustBottom(t)&&(this.parentDiv.style.top=this.point.y-t.height+"px")):this.parentDiv.style.top=this.point.y+this.bubble.radius/2+"px"},Tooltip.prototype.isAdjustRight=function(t){return this.point.x+t.width+2*this.bubble.radius>this.chartData.chart.w-this.chartData.rightPadding},Tooltip.prototype.isAdjustBottom=function(t){return this.point.y+t.height+this.bubble.radius/2>this.chartData.chart.h},Tooltip.prototype.isAdjustLeft=function(t){return this.point.x-t.width-2*this.bubble.radius<=0},Tooltip.prototype.isAdjustTop=function(t){return this.point.y-t.height-this.bubble.radius/2<=0},TooltipEvents.processEventItem=function(t){var e={previous:t.Revised||t.Previous,actual:t.Actual,consensus:t.Consensus,revised:t.Revised?t.Previous:"",better:t.Better,worst:t.Worst,volatility:t.Volatility,tentative:t.Tentative};return e.previous&&(e.previous=e.previous.toFixed(t.Precision).replace(".",","),e.previous=t.PotPrevious?t.Unit+e.previous+t.PotPrevious:e.previous+t.Unit),e.actual&&(e.actual=e.actual.toFixed(t.Precision).replace(".",","),e.actual=t.PotActual?t.Unit+e.actual+t.PotActual:e.actual+t.Unit),e.consensus&&(e.consensus=e.consensus.toFixed(t.Precision).replace(".",","),e.consensus=t.PotConsensus?t.Unit+e.consensus+t.PotConsensus:e.consensus+t.Unit),e.revised&&(e.revised=e.revised.toFixed(t.Precision).replace(".",","),e.revised=t.PotConsensus?t.Unit+e.revised+t.PotConsensus:e.revised+t.Unit),e},TooltipEvents.prototype=Object.create(Tooltip.prototype),TooltipEvents.prototype.constructor=TooltipEvents,TooltipEvents.prototype.getLinkHref=function(t){if(!t.HTMLDescription)return null;var e=t.HTMLDescription.match('href="(.*?)"');return e&&e[1]?e[1]:null},TooltipNews.prototype=Object.create(Tooltip.prototype),TooltipNews.prototype.constructor=TooltipNews,Signal.prototype.draw=function(t){var e=this.supportLine;e.start.x=LibCanvas.getPosition(e.start.x,this.width),LibCanvas.drawLine(null,t,e.start.x,e.start.y,e.end.x,e.end.y,e.color,[],this.width);var a=this.resistanceLine;a.start.x=LibCanvas.getPosition(a.start.x,this.width),LibCanvas.drawLine(null,t,a.start.x,a.start.y,a.end.x,a.end.y,a.color,[],this.width);var i=LibCanvas.getPosition(this.patternEndTime,this.width);LibCanvas.drawLine(null,t,i,0,i,t.canvas.clientHeight,"#ff0000",[6,4],2,1),this.predictionArea.x?LibCanvas.drawRectangle(null,t,this.predictionArea.x,this.predictionArea.y,this.predictionArea.width,this.predictionArea.height,this.predictionArea.color,"#ff0000",this.width,[]):(LibCanvas.drawLine(null,t,e.end.x,e.end.y,this.predictionLines.support.end.x,this.predictionLines.support.end.y,this.predictionLines.color,[4,2],this.width),LibCanvas.drawLine(null,t,a.end.x,a.end.y,this.predictionLines.resistance.end.x,this.predictionLines.resistance.end.y,this.predictionLines.color,[4,2],this.width)),this.dirArrow.end&&LibCanvas.drawArrow(null,t,this.dirArrow.start.x,this.dirArrow.start.y,this.dirArrow.end.x,this.dirArrow.end.y,this.dirArrow.color,"#fff",[],this.width,1,!0)},Signal.prototype.calcPoints=function(){var t=this.convertData();this.patternEndTime=t.patternEnd,this.supportLine.end=this.getMissingPoint(t.pointAx,t.pointAy,t.pointBx,t.pointBy,t.patternEnd),t.pointAx>t.pointCx?this.supportLine.start=this.getMissingPoint(t.pointAx,t.pointAy,t.pointBx,t.pointBy,t.pointCx):(this.supportLine.start.x=t.pointAx,this.supportLine.start.y=t.pointAy),this.resistanceLine.end=this.getMissingPoint(t.pointCx,t.pointCy,t.pointDx,t.pointDy,t.patternEnd),t.pointAx<t.pointCx?this.resistanceLine.start=this.getMissingPoint(t.pointCx,t.pointCy,t.pointDx,t.pointDy,t.pointAx):(this.resistanceLine.start.x=t.pointCx,this.resistanceLine.start.y=t.pointCy),this.calculatePredictions(t),this.calculateArrow(t)},Signal.prototype.calculatePredictions=function(t){if(t.predictionPriceFrom)this.predictionArea.x=t.predictionTimeFrom+3,this.predictionArea.y=t.predictionPriceTo,this.predictionArea.width=t.predictionTimeTo-t.predictionTimeFrom,this.predictionArea.height=Math.abs(t.predictionPriceTo-t.predictionPriceFrom);else{var e=this.getIntersectionPoint(t.pointAx,t.pointAy,t.pointBx,t.pointBy,t.pointCx,t.pointCy,t.pointDx,t.pointDy);this.calculateResistancePredictions(t,e),this.calculateSupportPredictions(t,e)}},Signal.prototype.getMissingPoint=function(t,e,a,i,s){if(isNaN(t)||isNaN(e)||isNaN(a)||isNaN(i)||isNaN(s))return!1;var r,n,o=Math.abs(t-a),h=Math.abs(e-i);return n=s>t?a>t?a:t:a>t?t:a,r=Math.abs(s-n)*h/o,{x:s,y:n==t?e>i?e+r:e-r:e>i?i-r:i+r}},Signal.prototype.getIntersectionPoint=function(t,e,a,i,s,r,n,o){var h=Math.round(i-e),c=Math.round(t-a),l=Math.round(e*a-t*i),d=Math.round(o-r),p=Math.round(s-n),u=Math.round(r*n-s*o);if(h*p!=d*c)return{x:Math.round(-(l*p-u*c)/(h*p-d*c)),y:Math.round(-(h*u-d*l)/(h*p-d*c))}},Signal.prototype.calculateResistancePredictions=function(t,e){var a=Math.round(this.resistanceLine.end.x+(this.resistanceLine.end.x-this.resistanceLine.start.x)/2),i=0;a>=e.x&&e.x>t.patternEnd?(a=Math.round(e.x-.2*(e.x-this.resistanceLine.start.x)),i=Math.round((a-this.resistanceLine.start.x)*(this.resistanceLine.end.y-this.resistanceLine.start.y)/(this.resistanceLine.end.x-this.resistanceLine.start.x)+this.resistanceLine.start.y)):i=Math.round((a-this.resistanceLine.start.x)*(this.resistanceLine.end.y-this.resistanceLine.start.y)/(this.resistanceLine.end.x-this.resistanceLine.start.x)+this.resistanceLine.start.y),this.predictionLines.resistance={end:{x:a,y:i}}},Signal.prototype.calculateSupportPredictions=function(t,e){var a=Math.round(this.supportLine.end.x+(this.supportLine.end.x-this.supportLine.start.x)/2),i=0;a>=e.x&&e.x>t.patternEnd?(a=Math.round(e.x-.2*(e.x-this.supportLine.start.x)),i=Math.round((a-this.supportLine.start.x)*(this.supportLine.end.y-this.supportLine.start.y)/(this.supportLine.end.x-this.supportLine.start.x)+this.supportLine.start.y)):i=Math.round((a-this.supportLine.start.x)*(this.supportLine.end.y-this.supportLine.start.y)/(this.supportLine.end.x-this.supportLine.start.x)+this.supportLine.start.y),this.predictionLines.support={end:{x:a,y:i}}},Signal.prototype.calculateArrow=function(t){var e=this.chartData.chart.getNearestCandleIndex(this.data.patternEndTime);if(!(this.chartData.chart.showData[e].date<this.patternEndTime)){var a=this.chartData.chart.showData[e],i=this.toYPixels((parseFloat(a.close)+parseFloat(a.open))/2),s=this.toXPixels(this.chartData.data&&this.chartData.data.mid[0]?new Date(this.chartData.data.mid[0].date).getTime():(new Date).getTime());this.dirArrow.end={x:Math.round(s+20)},this.dirArrow.start={y:i},t.predictionTimeFrom&&s+20>t.predictionTimeTo&&(this.dirArrow.end.x=t.predictionTimeTo-5),1==this.data.direction?(this.dirArrow.color=this.resistanceLine.color,t.predictionPriceFrom?(this.dirArrow.start.x=this.resistanceLine.end.x,this.dirArrow.end.y=t.predictionPriceFrom):(this.dirArrow.start.x=this.supportLine.end.x,this.dirArrow.end.y=Math.round((this.dirArrow.end.x-this.resistanceLine.start.x)*(this.resistanceLine.end.y-this.resistanceLine.start.y)/(this.resistanceLine.end.x-this.resistanceLine.start.x)+this.resistanceLine.start.y))):(this.dirArrow.color="#ff0000",t.predictionPriceTo?(this.dirArrow.start.x=this.supportLine.end.x,this.dirArrow.end.y=t.predictionPriceTo):(this.dirArrow.start.x=this.resistanceLine.end.x,this.dirArrow.end.y=(this.dirArrow.end.x-this.supportLine.start.x)*(this.supportLine.end.y-this.supportLine.start.y)/(this.supportLine.end.x-this.supportLine.start.x)+this.supportLine.start.y))}},Signal.prototype.convertData=function(){var t=this.chartData.getCurrentTimeStepByServerPeriod();return{pointAx:this.toXPixels(this.data.supportx0+t),pointAy:this.toYPixels(this.data.supporty0),pointBx:this.toXPixels(this.data.supportx1+t),pointBy:this.toYPixels(this.data.supporty1),pointCx:this.toXPixels(this.data.resistancex0+t),pointCy:this.toYPixels(this.data.resistancey0),pointDx:this.toXPixels(this.data.resistancex1+t),pointDy:this.toYPixels(this.data.resistancey1),patternEnd:this.toXPixels(this.data.patternEndTime),predictionTimeFrom:this.toXPixels(this.data.predictionTimeFrom),predictionTimeTo:this.toXPixels(this.data.predictionTimeTo),predictionPriceFrom:this.toYPixels(this.data.predictionPriceFrom),predictionPriceTo:this.toYPixels(this.data.predictionPriceTo)}},Signal.prototype.toXPixels=function(t){return this.chartData.chart.toXPixels(t)},Signal.prototype.toYPixels=function(t){return this.chartData.chart.toYPixels(t)};var u=function Chart(t,e,a){!function Chart_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,Chart),a.store.setChart(Chart),this.techChart=a,this.parent=t,this.chartData=e,this.chartData.chart=this,this.resizeTimer,this.showData=[],this.selectedData=[],this.timeAxis=[],this.w,this.h,this.top,this.curX,this.curY,this.crosshair={params:{x:0,y:0}},this.isShowCrosshair=!1,this.valueAxis=[],this.timeAxisStep,this.valueAxisCount=5,this.valueTextHeigh=11,this.useCanvas=!0,this.canvasGrid,this.canvasGridContext,this.canvasDrawing,this.canvasDrawingContext,this.canvasDataNormal,this.canvasDataNormalContext,this.canvasDataPixelated,this.canvasDataPixelatedContext,this.canvasRateNormal,this.canvasRateNormalContext,this.canvasRatePixelated,this.canvasRatePixelatedContext,this.canvasInfo,this.canvasInfoContext,this.divEventListener,this.drawingTextContainer,this.waterMarkContainer,this.navigationButtonsContainer,this.bubblesContainer,this.isPressed=!1,this.isSetScaleY=!1,this.dataPanel,this.isBusy=!1,this.chartOscillatorContainer,this.oscillatorCharts={},this.zoomSelector,this.axisTextContainer,this.optionsTextContainer,this.offX=50,this.offY=18,this.priceTextWidth=!1,this.crosshairTextHeight=!1,this.crosshairTextWidth=!1,this.parentRect,this.priceTextColor,this.redrawOnMoveTimeout=null,this.moving={totalX:0,totalY:0},this.tappedClickTimer=null,this.index=0,this.magnetDistance=30,this.clipPathOffset=8,this.resizeEdgeHeight=5,this.getNewsTimeout=null,this.getEventsTimeout=null,this.signalsDataPanel=null,this.signals=Object.keys(e.signalsData),this.newsBubbles=[],this.recreateNewsBubblesTimeout=null,this.eventsBubbles=[],this.recreateEventsBubblesTimeout=null,this.isOptionActive=!1,this.isPipsShow=!1};u.prototype.html=function(){return"<div class='tch-chart-background'>\n            <div class='tch-spinner-container'></div>\n        </div>\n        <div class='tch-chart-container'>\n            <canvas class='tch-chart-grid'></canvas>\n            <div class='tch-chart-watermark-container'>\n                <div>\n                  <span class='tch-chart-watermark'>WaterMark</span>\n                </div>\n            </div>\n            <canvas class='tch-chart-drawing'></canvas>\n            <canvas class='tch-chart-data-normal'></canvas>\n            <canvas class='tch-chart-data-pixelated'></canvas>\n            <div class='tch-axis-text'></div>\n            <div class='tch-drawing-text'></div>\n            <canvas class='tch-chart-signals'></canvas>\n            <div class='tch-news-bubbles-container'></div>\n            <div class='tch-events-bubbles-container'></div>\n            <div class='tch-chart-oscillators-container'></div>\n            <canvas class='tch-chart-drawing-active'></canvas>\n            <canvas class='tch-chart-info tch-move-container'></canvas>\n            <canvas class='tch-chart-rate-normal'></canvas>\n            <canvas class='tch-chart-rate-pixelated'></canvas>\n\n            <div class='tch-chart-rate-text-container'>\n            <div class='tch-chart-rate-text'>\n            <div style='display: none;'>\n                <span class='tch-options-label-triangle tch-options-triangle tch-rate-triangle'></span>\n                <span class='tch-last-bar-value tch-price'></span>\n            </div>\n            </div>\n                <div class='tch-chart-rate-text'>\n                    <div style='display: none;'><span class='tch-rate-value tch-price'></span></div>\n                </div>\n            </div>\n            <div class='tch-chart-info-text-container'>\n                <div class='tch-chart-info-text'>\n                    <div style='display: none;'>\n                        <span class='tch-info-value tch-price'></span>\n                    </div>\n                    <div style='display: none;'>\n                        <span class='tch-info-date'></span>\n                    </div>\n                </div>\n            </div>\n            <div class='tch-zoom-selector'></div>\n            <div class='tch-line-settings-container tch-hidden tch-move'></div>\n            <ul class='tch-nav-buttons  tch-nav-many'>\n                <li class='tch-nav-left'></li>\n                <li class='tch-nav-out'></li>\n                <li class='tch-nav-ref'></li>\n                <li class='tch-nav-in'></li>\n                <li class='tch-nav-right'></li>\n            </ul>\n            <ul class='tch-nav-buttons  tch-nav-one'>\n                <li class = 'tch-nav-start'></li>\n            </ul>\n            <div class='tch-chart-event-listener'></div>\n            <div class='tch-tooltip-container tch-news-tooltip-container tch-hidden'></div>\n            <div class='tch-tooltip-container tch-events-tooltip-container tch-hidden'></div>\n        <div>"},u.prototype.createOscillatorCharts=function(){this.resizeOscillatorHeights(),this.chartOscillatorContainer=this.parent.querySelector(".tch-chart-oscillators-container");for(var t=0;t<this.chartData.indicators.length;t++)if("oscillator"===this.chartData.indicators[t].type){var e=document.createElement("div");e.classList.add("tch-oscillator-"+this.chartData.indicators[t].id),this.chartOscillatorContainer.appendChild(e);var a={w:this.chartData.indicators[t].w,h:this.chartData.indicators[t].h,top:this.chartData.indicators[t].top,name:this.chartData.indicators[t].name};this.oscillatorCharts[this.chartData.indicators[t].id]=new OscillatorChart(this.chartData.indicators[t].id,this.chartData,a),this.oscillatorCharts[this.chartData.indicators[t].id].init(e)}},u.prototype.setOscillatorChartsPostionAndSize=function(){for(var t=0;t<this.chartData.indicators.length;t++)"oscillator"===this.chartData.indicators[t].type&&this.oscillatorCharts[this.chartData.indicators[t].id].setElementsPositionAndSize()},u.prototype.resizeOscillatorHeights=function(){var t;!this.parentRect&&this.chartData.parentRect&&(this.parentRect=this.chartData.parentRect),this.parentRect?(t=this.parentRect.height,this.parentRect=this.parent.getBoundingClientRect(),this.chartData.parentRect=this.parentRect):(this.parentRect=this.parent.getBoundingClientRect(),this.chartData.parentRect=this.parentRect,t=this.parentRect.height);for(var e=2*this.chartData.options.Chart.scalesFontSize+10,a=this.chartData.options.Chart.oldScalesFontSize?2*this.chartData.options.Chart.oldScalesFontSize+10:e,i=(this.parentRect.height-e)/(t-a),s=0;s<this.chartData.indicators.length;s++)if("oscillator"===this.chartData.indicators[s].type){var r=this.chartData.indicators[s];r.h=r.h*i,r.top=r.top*i}!this.h&&this.chartData.h&&(this.h=this.chartData.h),!this.top&&this.chartData.top&&(this.top=this.chartData.top),this.h*=i,this.top*=i,this.chartData.h=this.h,this.chartData.top=this.top},u.prototype.init=function(t,e){if(this.parent){this.setChartElementsSize(this.chartData),this.parent.innerHTML=this.html();var a=this.parent.querySelector(".tch-chart-container");if(t||(a.style.opacity=0,a.style.visibility="hidden"),this.createOscillatorCharts(),this.setElementsPositionAndSize(),this.checkHasEnoughData(this.chartData,this.w)||!this.chartData.hasPrevData)this.chartData.data&&this.chartData.data[this.chartData.typeData]&&0!==this.chartData.data[this.chartData.typeData].length&&(this.selectedData=this.selectDataToShow(this.chartData.data[this.chartData.typeData],this.chartData.startDateSeconds,this.chartData.spacing,this.w),this.chartData.startX>this.w/2&&(this.chartData.startX=this.w/2),this.showData=this.processDataToShow(this.selectedData,this.chartData.rightPadding,this.chartData.spacing,this.w,this.h,this.chartData.precission,this.chartData.startX,null),this.newsBubbles=[],this.setGetNewsTimeout(),this.eventsBubbles=[],this.setGetEventsTimeout(),this.deleteRedundantElements(this.showData,0,this.w,this.chartData.rightPadding,this.chartData.spacing),this.chartData.indicators&&this.chartData.indicators.length&&this.createIndicatorsShowData(),this.valueAxis=this.getValueAxis(this.chartData.scaleParams.minB,this.chartData.scaleParams.maxB,this.valueAxisCount,this.w,this.h,this.chartData.options.Chart.scalesFontSize,this.chartData.precission),this.timeAxis=this.getTimeAxis(this.showData,this.w,this.parentRect.height-this.offY,this.chartData.period,this.chartData.timeMode,this.chartData.localization),this.getOscillatorChartsAxis(),this.updateDrawingObjectsPixels(),this.drawDataPanel(this.showData[0]),this.draw(this.showData,this.h),this.chartData.techChart.initializationDone||this.moveRightChart(this,this.w*this.techChart.configuration.offsetChart),this.drawActiveDrawingObjects(),this.clearGrid(),this.drawTimeAxis(this.timeAxis),this.drawValueAxis(this.valueAxis),this.drawOscillatorChartsAxis(),this.drawChartBorder(),this.drawCurrent(this.chartData.currentValue),e||this.addEvents(),t||(a.style.visibility="initial",a.style.transition="opacity 1s ease",a.style.opacity=1),this.chartData.isShowAllSignals&&this.drawActiveSignal(),this.chartData.techChart.initializationDone=!0,this.initialized=!0,this.chartData.techChart.setCanAddTab());else{var i=this.getLastDate(this.chartData.data[this.chartData.typeData]);if(i){var s=this.getExtraDataNumb(this.chartData,this.w);this.chartData.getExtraData(this.chartData,i,s,this.chartData.getExtraDataOnInitComplete)}else this.chartData.getFirstData()}}},u.prototype.resizeChartHeight=function(){this.setChartSizes(),this.setWatermarkSize(),this.showData=this.processDataToShow(this.selectedData,this.chartData.rightPadding,this.chartData.spacing,this.w,this.h,this.chartData.precission,this.chartData.startX,null),this.valueAxis=this.getValueAxis(this.chartData.scaleParams.minB,this.chartData.scaleParams.maxB,this.valueAxisCount,this.w,this.h,this.chartData.options.Chart.scalesFontSize,this.chartData.precission),this.updateDrawingObjectsPixels(),this.getOscillatorChartsAxis(),this.draw(this.showData,this.h),this.drawActiveDrawingObjects(),this.clearGrid(),this.drawTimeAxis(this.timeAxis),this.drawValueAxis(this.valueAxis),this.drawOscillatorChartsAxis(),this.drawChartBorder(),this.drawCurrent(this.chartData.currentValue)},u.prototype.getScalesOffsetData=function(){this.chartData.currentValue[this.chartData.typeData]=this.getCurrentValue(),this.chartData.precission=this.chartData.precission?this.chartData.precission:5;var t=this.chartData.precission;if(0!==this.chartData.getOscillatorChartsPrecission()){var e=this.chartData.currentValue[this.chartData.typeData].split("").length;t=(8>e?8:e)-1-this.chartData.currentValue[this.chartData.typeData].replace(",",".").split(".")[0].length}var a=parseFloat(this.chartData.currentValue[this.chartData.typeData]).toFixed(t),i=Axis.prototype.getValueFromTickAxis(a,this.chartData.options.Chart.typeTick),s=LibCanvas.measureText(this.canvasGridContext,this.chartData.options.Chart.scalesFontSize+"px Arial",i),r=LibCanvas.measureText(this.canvasGridContext,this.chartData.options.Chart.scalesFontSize+"px Arial",a);this.offX=Math.max(parseInt(r.width),parseInt(s.width))+10,this.offY=parseInt(2*this.chartData.options.Chart.scalesFontSize)+10},u.prototype.getCurrentValue=function(){var t="0.00000";return this.chartData.data[this.chartData.typeData][0]?t=this.chartData.data[this.chartData.typeData][0].close:this.chartData.currentValue[this.chartData.typeData]&&(t=this.chartData.currentValue[this.chartData.typeData]),t},u.prototype.setChartSizes=function(){var t=this.offX,e=(this.offY,this.clipPathOffset);this.canvasGrid.style.backgroundColor=this.chartData.colors.Chart.backgroundColor,this.canvasSignals.setAttribute("width",this.w-e+"px"),this.canvasSignals.setAttribute("height",this.h+"px"),this.canvasSignalsContext=this.canvasSignals.getContext("2d"),this.canvasDrawingActive.setAttribute("width",this.w-e+"px"),this.canvasDrawingActive.setAttribute("height",this.h+"px"),this.canvasDrawingActiveContext=this.canvasDrawingActive.getContext("2d"),this.canvasDrawing.setAttribute("width",this.w-e+"px"),this.canvasDrawing.setAttribute("height",this.h+"px"),this.canvasDrawingContext=this.canvasDrawing.getContext("2d"),this.drawingText.style.width=this.w-e+"px",this.drawingText.style.height=this.h+"px",this.newsBubblesContainer.style.width=this.w-e+"px",this.newsBubblesContainer.style.height=this.h+"px",this.eventsBubblesContainer.style.width=this.w-e+"px",this.eventsBubblesContainer.style.height=this.h+"px",this.canvasDataNormal.setAttribute("width",this.w-e+"px"),this.canvasDataNormal.setAttribute("height",this.h+"px"),this.canvasDataNormalContext=this.canvasDataNormal.getContext("2d"),this.canvasDataPixelated.setAttribute("width",this.w-e+"px"),this.canvasDataPixelated.setAttribute("height",this.h+"px"),this.canvasDataPixelatedContext=this.canvasDataPixelated.getContext("2d"),this.waterMarkContainer.style.width=this.w-e+"px",this.waterMarkContainer.style.height=this.h+"px",this.waterMarkContainer.style.color=this.chartData.colors.Chart.watermarkColor,this.waterMarkContainer.style.fontSize=parseInt(this.h/4)+"px",this.canvasRateNormal.setAttribute("width",this.w+t+"px"),this.canvasRateNormal.setAttribute("height",this.h+"px"),this.canvasRateNormalContext=this.canvasRateNormal.getContext("2d"),this.canvasRatePixelated.setAttribute("width",this.w+t+"px"),this.canvasRatePixelated.setAttribute("height",this.h+"px"),this.canvasRatePixelatedContext=this.canvasRatePixelated.getContext("2d"),this.divEventListener=this.parent.querySelector(".tch-chart-event-listener"),this.divEventListener.classList.toggle("tch-cursor-"+this.chartData.cursorType),this.drawingTextContainer=this.parent.querySelector(".tch-drawing-text"),this.drawingTextContainer.style.top="0px"},u.prototype.setElementsPositionAndSize=function(){var t;this.parentRect?(t=this.parentRect.height,this.parentRect=this.parent.getBoundingClientRect(),this.chartData.parentRect=this.parentRect):(this.parentRect=this.parent.getBoundingClientRect(),this.chartData.parentRect=this.parentRect,t=this.parentRect.height),this.canvasGrid=this.parent.querySelector(".tch-chart-grid"),this.canvasGrid.setAttribute("height",parseInt(this.parentRect.height)+"px"),this.canvasGridContext=this.canvasGrid.getContext("2d"),this.getScalesOffsetData();var e=this.offX,a=this.offY,i=this.clipPathOffset;this.w=parseInt(this.parentRect.width)-e,this.h&&Object.keys(this.oscillatorCharts).length?this.h=(this.h+a)*parseInt(this.parentRect.height)/t-a:this.h=parseInt(this.parentRect.height)-a,this.top=0,this.chartData.h=this.h,this.chartData.top=this.top;var s=Object.keys(this.oscillatorCharts);if(s.length)for(var r,n,o=this.parentRect.height/t,h=0;h<s.length;h++){var c=this.oscillatorCharts[s[h]];r=c.h*o,n=c.top*o,c.parent.classList.toggle("tch-oscillator",!0),c.parent.style.height=r+"px",c.parent.style.top=n+"px",c.setElementsPositionAndSize(this.w,r,i)}this.canvasSignals=this.parent.querySelector(".tch-chart-signals"),this.canvasDrawingActive=this.parent.querySelector(".tch-chart-drawing-active"),this.canvasDrawing=this.parent.querySelector(".tch-chart-drawing"),this.drawingText=this.parent.querySelector(".tch-drawing-text"),this.newsBubblesContainer=this.parent.querySelector(".tch-news-bubbles-container"),this.eventsBubblesContainer=this.parent.querySelector(".tch-events-bubbles-container"),this.newsTooltipContainer=this.parent.querySelector(".tch-news-tooltip-container"),this.eventsTooltipContainer=this.parent.querySelector(".tch-events-tooltip-container"),this.canvasDataNormal=this.parent.querySelector(".tch-chart-data-normal"),this.canvasDataPixelated=this.parent.querySelector(".tch-chart-data-pixelated"),this.waterMarkContainer=this.parent.querySelector(".tch-chart-watermark-container"),this.canvasRateNormal=this.parent.querySelector(".tch-chart-rate-normal"),this.canvasRatePixelated=this.parent.querySelector(".tch-chart-rate-pixelated"),this.canvasInfo=this.parent.querySelector(".tch-chart-info"),this.canvasInfo.setAttribute("height",parseInt(this.parentRect.height)+"px"),this.canvasInfo.setAttribute("width",this.w+e+"px"),this.canvasInfoContext=this.canvasInfo.getContext("2d"),this.canvasGrid.setAttribute("width",this.w+e+"px"),this.setChartSizes();var l=this.waterMarkContainer.querySelector("span"),d=this.techChart.translation[this.techChart.getPeriods()[this.chartData.period].key];l.textContent=this.chartData.pair.FullName+", "+d,this.setWatermarkSize(),this.navButtons=this.parent.querySelector(".tch-nav-buttons.tch-nav-many");var p=(this.w-this.navButtons.offsetWidth)/2;this.navButtons.style.left=p+"px",this.navButtons.style.bottom=a+"px",this.navButtonStartContainer=this.parent.querySelector(".tch-nav-buttons.tch-nav-one"),this.navButtonStartContainer.style.left=this.w-e+"px",this.navButtonStartContainer.style.bottom=a+"px",this.chartOscillatorContainer=this.parent.querySelector(".tch-chart-oscillators-container"),this.axisTextContainer=this.parent.querySelector(".tch-axis-text"),this.zoomSelector=this.parent.querySelector(".tch-zoom-selector"),this.zoomInBtn=this.parent.querySelector(".tch-zoomin-btn"),this.parent.parentNode&&this.parent.parentNode.parentNode&&this.parent.parentNode.parentNode&&this.parent.parentNode.parentNode.parentNode&&(this.dataPanel=this.parent.parentNode.parentNode.parentNode.querySelector(".tch-data-panel")),this.crosshair.text={},this.crosshair.text.spanValue=this.parent.querySelector(".tch-info-value"),this.crosshair.text.spanDate=this.parent.querySelector(".tch-info-date"),this.crosshair.text.spanValue.style.background=this.chartData.colors.Chart.crosshair,this.crosshair.text.spanDate.style.background=this.chartData.colors.Chart.crosshair,this.crosshair.text.spanValue.parentNode.style.backgroundColor=this.chartData.colors.Chart.crosshair,this.crosshair.text.spanDate.parentNode.style.backgroundColor=this.chartData.colors.Chart.crosshair,this.browser=this.detectBrowser(window,document)},u.prototype.setWatermarkSize=function(){var t=this.waterMarkContainer.querySelector("span");if(this.w>0)for(;t.getBoundingClientRect().width>this.w-10;){var e=parseInt(this.waterMarkContainer.style.fontSize);e-=1,this.waterMarkContainer.style.fontSize=e+"px"}},u.prototype.getChartElementsSize=function(){return{candleWidth:this.chartData.candleWidth,lineSpacing:1.5*this.chartData.candleWidth}},u.prototype.addEvents=function(){var t=this;window.onscroll=function(){t.parentRect=t.parent.getBoundingClientRect()};var e=t.divEventListener;e.onmouseover=function(e){t.rectChart_mouseOver(e,t)},e.onmouseout=function(e){t.rectChart_mouseOut(e,t)},e.onmousemove=function(e){t.rectChart_mouseMove(e,t)},e.onmousedown=function(e){t.rectChart_mouseDown(e,t)},e.onmouseup=function(e){t.rectChart_mouseUp(e,t)},e.addEventListener("touchstart",function(e){t.rectChart_touchStart(e,t,null)}),e.addEventListener("touchmove",function(e){t.rectChart_touchMove(e,t)}),e.addEventListener("touchend",function(e){t.rectChart_touchEnd(e,t)}),e.ondblclick=function(e){t.rectChart_dblclick(e,t)},e.oncontextmenu=function(e){t.rectChart_contextMenu(e,t)},"firefox"==this.detectBrowser(window,document)?e.addEventListener("MozMousePixelScroll",function(e){t.rectChart_mouseWheel(e,t)}):"ie"==this.detectBrowser(window,document)?e.addEventListener("wheel",function(e){t.rectChart_mouseWheel(e,t)}):e.addEventListener("mousewheel",function(e){t.rectChart_mouseWheel(e,t)}),this.addNavBtnsEvents(t)},u.prototype.rectChart_dblclick=function(t,e){var a=Math.floor(t.clientX-e.parentRect.left),i=Math.floor(t.clientY-e.parentRect.top);(a>e.w&&i<e.h||"click"===t.type)&&(e.chartData.options.Chart.autoScale||(e.chartData.options.Chart.autoScale=!0,this.chartData.scaleParams=this.getScaleParams(this.selectedData,this.h,this.chartData.precission),this.resizeShowDataValuesY(this.showData,this.h,this.chartData.scaleParams),e.chartData.indicators&&e.chartData.indicators.length&&e.createIndicatorsShowData(),e.updateDrawingObjectsPixels(),e.resizeNewsBubbles(),e.resizeEventsBubbles(),e.draw(e.showData,e.h),e.valueAxis=e.getValueAxis(e.chartData.scaleParams.minB,e.chartData.scaleParams.maxB,e.valueAxisCount,e.w,e.h,e.chartData.options.Chart.scalesFontSize,e.chartData.precission),e.getOscillatorChartsAxis(),e.clearGrid(),e.drawValueAxis(e.valueAxis),e.drawTimeAxis(e.timeAxis),e.drawOscillatorChartsAxis(),e.drawChartBorder(),e.drawCurrentValue(),this.activeSignal&&this.redrawActiveSignal())),e=null},u.prototype.rectChart_mouseWheel=function(t,e){if(t&&t.preventDefault&&t.preventDefault(),e.showData&&!(e.showData.length<1)&&!(Math.abs(t.deltaX)>Math.abs(t.deltaY))){var a=Math.floor(t.clientX-e.parentRect.left),i=t.deltaY?t.deltaY:t.detail;if(a<e.w)e.zoomX(i,1.2);else{e.chartData.options.Chart.autoScale=!1;var s=i>0?-15:15,r=parseFloat(e.chartData.scaleParams.minB),n=parseFloat(e.chartData.scaleParams.maxB),o=s*e.chartData.scaleParams.deltaY;e.chartData.scaleParams.minB=r+o,e.chartData.scaleParams.maxB=n-o,e.chartData.scaleParams.deltaY=(e.chartData.scaleParams.maxB-e.chartData.scaleParams.minB)/e.h,e.resizeShowDataValuesY(e.showData,e.h,e.chartData.scaleParams),e.updateDrawingObjectsPixels(),e.removeNewsTooltip(),e.removeEventsTooltip(),e.resizeNewsBubbles(),e.resizeEventsBubbles(),e.draw(e.showData,e.h),e.valueAxis=e.getValueAxis(e.chartData.scaleParams.minB,e.chartData.scaleParams.maxB,e.valueAxisCount,e.w,e.h,e.chartData.options.Chart.scalesFontSize,e.chartData.precission),e.getOscillatorChartsAxis(),e.clearGrid(),e.drawValueAxis(e.valueAxis),e.drawTimeAxis(e.timeAxis),e.drawOscillatorChartsAxis(),e.drawChartBorder(),e.drawCurrentValue()}e.moveCrosshairXY(e.showData,e.curX,e.curY,e.w,e.h),e.chartData.editDrawingObject&&"drawingTrend"===e.chartData.state&&(e.chartData.editDrawingObject.moveTo(e.crosshair.params.x,e.crosshair.params.y,e.crosshair.params),e.chartData.editDrawingObject.updateValues()),e.redrawInfo(),this.activeSignal&&this.redrawActiveSignal(),e.drawActiveDrawingObjects(!0),e.chartData.techChart.autoSaveParams(),e=null}},u.prototype.rectChart_mouseOver=function(t,e){d&&d.pressed||(e.isShowCrosshair=!0)},u.prototype.rectChart_mouseOut=function(t,e){if(!d||!d.pressed){switch(t.preventDefault(),e.isShowCrosshair=!1,e.chartData.state){case"zoomIn":e.rectChart_mouseOut_zoomIn(t);break;case"drawingBrush":e.rectChart_mouseOut_Brush(t);break;default:e.rectChart_mouseOut_default(t,e)}e=null}},u.prototype.rectChart_mouseOut_zoomIn=function(t){t.preventDefault()},u.prototype.rectChart_mouseOut_Brush=function(){if(this.rectChart_mouseUp_drawingBrush(),this.chartData.isDrawingObjectsLocked&&this.chartData.techChart.switchLockBtn(),this.chartData.editDrawingObject){if(0===this.chartData.editDrawingObject.circles.length)return;this.chartData.editDrawingObject.state="normal",this.chartData.editDrawingObject.draw(this.canvasDrawingContext),this.chartData.editDrawingObject=null}},u.prototype.rectChart_mouseOut_default=function(t,e){t.preventDefault(),t.target.classList.remove("moveX"),t.target.classList.remove("moveY"),e.isPressed=!1,e.clearInfo(),e.drawActiveDrawingObjects(),e.setResizeOscillatorOff(),e.crosshair.text&&(e.crosshair.text.spanDate.parentNode.style.display="none",e.crosshair.text.spanValue.parentNode.style.display="none"),this.navButtons.classList.toggle("tch-active",!1),e=null},u.prototype.rectChart_contextMenu=function(t,e){t.preventDefault();var a=!1;if(e.chartData.editDrawingObject&&("drawingBrush"===e.chartData.state?(e.rectChart_mouseUp_drawingBrush(),a=!0):e.chartData.editDrawingObject.drawingStage.current<=e.chartData.editDrawingObject.drawingStage.max&&(e.removeDrawingObjectsOtherCharts(e.chartData.editDrawingObject),e.redrawAllDrawingObjectsOtherCharts(),e.chartData.editDrawingObject.remove(),a=!0),a))return e.chartData.state="default",e.chartData.techChart.deactivateMenuTypeAll(),e.redrawDrawingObjects(),void e.redrawActiveDrawingObjects();var i=Math.floor(t.clientX-e.parentRect.left),s=Math.floor(t.clientY-e.parentRect.top);e.curX=i,e.curY=s,this.chartData.editDrawingObject&&(this.chartData.editDrawingObject.state="normal",this.chartData.editDrawingObject.draw(this.canvasDrawingContext),e.chartData.editDrawingObject=null),this.chartData.activeDrawingObject&&(this.chartData.activeDrawingObject.state="normal",this.chartData.activeDrawingObject.draw(this.canvasDrawingContext),e.chartData.activeDrawingObject=null);for(var r=0;r<e.chartData.drawingObjects.length;r++){if(e.chartData.drawingObjects[r].isFocused(e.curX,e.curY)){e.chartData.drawingObjects[r].state="edit",e.chartData.editDrawingObject=e.chartData.drawingObjects[r],e.redrawDrawingObjects(),e.drawActiveDrawingObjects(!0);var n=e.getSettingsPanelContainer();e.chartData.editDrawingObject.fillSettingsPanel(n),n.classList.toggle("tch-hidden",!1),n.offsetWidth+i>e.parentRect.width&&(n.style.left=e.parentRect.width-n.offsetWidth+"px"),n.offsetHeight+s>e.parentRect.height&&(n.style.top=parseInt(n.style.top)-n.offsetHeight+"px");break}e.chartData.drawingObjects[r]instanceof Roulete?(e.chartData.drawingObjects[r].remove(),!1===this.chartData.isStayDrawingMode&&(this.chartData.techChart.setState("default"),this.chartData.techChart.setRouleteBtn("Off")),this.redrawDrawingObjects(),this.redrawInfo()):e.chartData.drawingObjects[r].state="normal"}e=null},u.prototype.rectChart_mouseDown=function(t,e){var a=Math.floor(t.clientX-e.parentRect.left),i=Math.floor(t.clientY-e.parentRect.top);e.setActiveChart(),t.preventDefault(),e.curX=a,e.curY=i,1===t.which||0===t.which?("default"!==e.chartData.state&&!1===e.chartData.techChart.charts[0].chartData.isShowDrawingObjects&&e.chartData.techChart.hiddeAllDrawing(),e["rectChart_mouseDown_"+(e.chartData.state?e.chartData.state:"default")](t)):3===t.which&&t.preventDefault(),e=null},u.prototype.rectChart_touchStart=function(t,e){if(t.changedTouches.length>1)return!1;t.clientX=t.changedTouches[0].clientX,t.clientY=t.changedTouches[0].clientY,t.radiusX=t.changedTouches[0].radiusX,t.radiusY=t.changedTouches[0].radiusY;var a=Math.floor(t.clientX-e.parentRect.left),i=Math.floor(t.clientY-e.parentRect.top);e.curX=a,e.curY=i,null===e.tappedClickTimer?e.tappedClickTimer=setTimeout(function(){e.tappedClickTimer=null,e.rectChart_mouseMove(t,e),e.rectChart_mouseDown(t,e),e.redrawInfo()},200):(clearTimeout(e.tappedClickTimer),e.tappedClickTimer=null,e.rectChart_dblclick(t,e)),t.preventDefault()},u.prototype.rectChart_touchMove=function(t,e){t.clientX=t.changedTouches[0].clientX,t.clientY=t.changedTouches[0].clientY,t.isNoLimitedMove=!0,e.rectChart_mouseMove(t,e)},u.prototype.rectChart_touchEnd=function(t,e){e.rectChart_mouseUp(t,e)},u.prototype.rectChart_mouseDown_drawingAnchoredText=function(t){this.rectChart_mouseDown_drawingTextObject(t,"AnchoredText")},u.prototype.rectChart_mouseUp_drawingAnchoredText=function(t){this.rectChart_mouseUp_drawingText(t)},u.prototype.rectChart_mouseDown_drawingText=function(t){this.rectChart_mouseDown_drawingTextObject(t,"Text")},u.prototype.rectChart_mouseDown_drawingFlag=function(t){this.rectChart_mouseDown_drawingOnePointObject(t,"Flag"),this.draw()},u.prototype.rectChart_mouseUp_drawingFlag=function(){this.redrawInfo(),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseUp_drawingText=function(){this.redrawInfo(),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseDown_drawingTextObject=function(t,e){this.rectChart_mouseDown_drawingOnePointObject(t,e),this.draw();var a=this.getSettingsPanelContainer();a.closeCounter=1,this.chartData.editDrawingObject.createLineSettingsPanel(a)},u.prototype.rectChart_mouseDown_drawingArrowMarkLeft=function(t){this.rectChart_mouseDown_drawingOnePointObject(t,"ArrowMarkLeft")},u.prototype.rectChart_mouseDown_drawingArrowMarkRight=function(t){this.rectChart_mouseDown_drawingOnePointObject(t,"ArrowMarkRight")},u.prototype.rectChart_mouseDown_drawingArrowMarkUp=function(t){this.rectChart_mouseDown_drawingOnePointObject(t,"ArrowMarkUp")},u.prototype.rectChart_mouseDown_drawingArrowMarkDown=function(t){this.rectChart_mouseDown_drawingOnePointObject(t,"ArrowMarkDown")},u.prototype.rectChart_mouseUp_drawingArrowMarkLeft=function(){this.redrawInfo(),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseUp_drawingArrowMarkRight=function(){this.redrawInfo(),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseUp_drawingArrowMarkUp=function(){this.redrawInfo(),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseUp_drawingArrowMarkDown=function(){this.redrawInfo(),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseUp_drawingBrush=function(){this.chartData.editDrawingObject&&(this.chartData.editDrawingObject.completeFigure(),this.completeFigureOtherCharts(this.chartData.editDrawingObject.id),this.redrawInfo(),this.drawActiveDrawingObjects(!0),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id))},u.prototype.rectChart_mouseDown_drawingNote=function(t){this.rectChart_mouseDown_drawingOnePointObject(t,"Note");var e=this.getSettingsPanelContainer();e.closeCounter=1,this.chartData.editDrawingObject.createLineSettingsPanel(e)},u.prototype.rectChart_mouseUp_drawingNote=function(){this.redrawInfo(),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseDown_drawingAnchoredNote=function(t){this.rectChart_mouseDown_drawingOnePointObject(t,"AnchoredNote");var e=this.getSettingsPanelContainer();e.closeCounter=1,this.chartData.editDrawingObject.createLineSettingsPanel(e)},u.prototype.rectChart_mouseUp_drawingAnchoredNote=function(){this.redrawInfo(),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseDown_drawingRectangle=function(t){this.rectChart_mouseDown_drawingPointsObject(t,"Rectangle")},u.prototype.rectChart_mouseUp_drawingRectangle=function(){},u.prototype.rectChart_mouseDown_drawingPolyline=function(t){this.rectChart_mouseDown_drawingPointsObject(t,"Polyline")},u.prototype.rectChart_mouseUp_drawingPolyline=function(){},u.prototype.rectChart_mouseDown_drawingRotatedRect=function(t){this.rectChart_mouseDown_drawingPointsObject(t,"RotatedRect")},u.prototype.rectChart_mouseDown_drawingFlatTopBottom=function(t){this.rectChart_mouseDown_drawingPointsObject(t,"FlatTopBottom"),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseDown_drawingParallelChannel=function(t){this.rectChart_mouseDown_drawingPointsObject(t,"ParallelChannel"),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseDown_drawingDisjointAngle=function(t){this.rectChart_mouseDown_drawingPointsObject(t,"DisjointAngle"),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseDown_drawingTrendAngle=function(t){this.rectChart_mouseDown_drawingPointsObject(t,"TrendAngle"),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseDown_drawingRay=function(t){this.rectChart_mouseDown_drawingPointsObject(t,"Ray"),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseDown_drawingTrendLine=function(t){this.rectChart_mouseDown_drawingPointsObject(t,"TrendLine"),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseDown_drawingArrow=function(t){this.rectChart_mouseDown_drawingPointsObject(t,"Arrow"),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseDown_drawingArc=function(t){this.rectChart_mouseDown_drawingPointsObject(t,"Arc"),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseDown_drawingEllipse=function(t){this.rectChart_mouseDown_drawingPointsObject(t,"Ellipse"),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseDown_drawingTriangle=function(t){this.rectChart_mouseDown_drawingPointsObject(t,"Triangle")},u.prototype.rectChart_mouseDown_drawingRoulete=function(t){var e=this.getDrawingObjectIndexByType("Roulete");e>-1&&this.chartData.drawingObjects[e].drawingStage.current>=this.chartData.drawingObjects[e].drawingStage.max?(this.chartData.state="default",this.chartData.drawingObjects[e].remove(),this.redrawInfo(),this.rectChart_mouseDown_default(t)):this.rectChart_mouseDown_drawingPointsObject(t,"Roulete")},u.prototype.rectChart_mouseUp_drawingRoulete=function(){this.redrawInfo(),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseUp_drawingTriangle=function(){this.redrawInfo(),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseUp_drawingRectangle=function(){this.redrawInfo(),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseDown_drawingCurve=function(t){this.rectChart_mouseDown_drawingPointsObject(t,"Curve"),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseUp_drawingCurve=function(){this.redrawInfo(),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseUp_drawingArrow=function(){this.redrawInfo(),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseUp_drawingArc=function(){this.redrawInfo(),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseUp_drawingEllipse=function(){this.redrawInfo(),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseUp_drawingRotatedRect=function(){this.redrawInfo(),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseUp_drawingRay=function(){this.redrawInfo(),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseUp_drawingHorizontalRay=function(){this.redrawInfo(),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseUp_drawingHorizontalLine=function(){this.redrawInfo(),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseUp_drawingVerticalLine=function(){this.redrawInfo(),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseUp_drawingTrendLine=function(){this.redrawInfo(),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseUp_drawingTrendAngle=function(){this.redrawInfo(),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseUp_drawingFlatTopBottom=function(){this.redrawInfo(),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseUp_drawingDisjointAngle=function(){this.redrawInfo(),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.rectChart_mouseUp_drawingParallelChannel=function(){this.redrawInfo(),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)},u.prototype.toggleDisabledClasses=function(t){var e=[".tch-zoomin-btn",".tch-zoomout-btn",".tch-show-hide-drawing-btn",".tch-roulete-drawing-btn",".tch-dropdown-container-periods",".tch-chart-type-container",".tch-indicator-container",".tch-settings-button",".tch-tab-btn"];this.techChart.configuration.modules.headerButtons.searchQuotationButton&&e.push(".tch-search");for(var a=0;a<e.length;a++){var i=this.chartData.techChart.parent.querySelector(e[a]);if(".tch-search"===e[a])i.disabled=t,i.classList.toggle("tch-disabled",t),i.parentElement.classList.toggle("tch-disabled",t);else if(".tch-dropdown-container-periods"===e[a]||".tch-chart-type-container"===e[a]||".tch-indicator-container"===e[a])i.classList.toggle("tch-disabled",t),i.childNodes[0].classList.toggle("tch-disabled",t),i.childNodes[1].classList.toggle("tch-disabled",t);else if(".tch-tab-btn"===e[a]&&Object.keys(this.chartData.techChart.groupCharts).length!==this.chartData.techChart.maxTabsQuantity)i.classList.toggle("tch-tab-btn-disable",t),i.parentElement.classList.toggle("tch-tab-btn-disable",t);else{if(i.classList.contains("tch-roulete-drawing-btn")&&i.classList.contains("tch-active"))continue;i.classList.toggle("tch-disabled",t),i.parentElement.classList.toggle("tch-disabled",t)}}for(var s=this.chartData.techChart.parent.querySelectorAll(".tch-chart-tab"),r=0;r<s.length;r++)s[r].classList.toggle("tch-disabled",t)},u.prototype.checkDisabledStates=function(t,e){var a=this.chartData.editDrawingObject;"drawingRoulete"===t&&a.drawingStage.max==e-1?this.toggleDisabledClasses(!1):"edit"===t&&1==e?this.toggleDisabledClasses(!0):("drawing"!==t.substring(0,7)||a.drawingStage.max!=e-1||this.chartData.isStayDrawingMode)&&(a.drawingStage.max!=e-1||this.chartData.isStayDrawingMode)||this.toggleDisabledClasses(!1)},u.prototype.rectChart_mouseDown_drawingPointsObject=function(t,e){if(this.chartData.editDrawingObject)this.chartData.editDrawingObject.drawingStage.current<=this.chartData.editDrawingObject.drawingStage.max?(this.chartData.editDrawingObject.updateLastPoint({d:this.crosshair.params.dateSeconds,v:this.crosshair.params.value},{x:this.crosshair.params.x,y:this.crosshair.params.y}),this.chartData.editDrawingObject.drawingStage.current++,this.chartData.editDrawingObject.drawingStage.current<=this.chartData.editDrawingObject.drawingStage.max?this.chartData.editDrawingObject.appendPoint({d:this.crosshair.params.dateSeconds,v:this.crosshair.params.value},{x:this.crosshair.params.x,y:this.crosshair.params.y,active:!0}):(this.chartData.state=this.chartData.isStayDrawingMode?this.chartData.state:"default",this.chartData.editDrawingObject.points[this.chartData.editDrawingObject.points.length-1].active=!1,this.redrawInfo()),this.updateDrawingObjectsOtherChart(this.chartData.editDrawingObject),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)):(this.chartData.editDrawingObject.state="normal",this.chartData.editDrawingObject.draw(this.canvasDrawingContext),this.updateDrawingObjectsOtherChart(this.chartData.editDrawingObject),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id),this.chartData.editDrawingObject=null,this.redrawInfo(),this.rectChart_mouseDown_drawingPointsObject(t,e));else{this.chartData.isDrawingObjectsLocked&&this.chartData.techChart.switchLockBtn();var a={};a.points=[{x:this.crosshair.params.x,y:this.crosshair.params.y},{x:this.crosshair.params.x,y:this.crosshair.params.y,active:!0}];var i=this.crosshair.params.dateSeconds,s=this.crosshair.params.value;a.data=[{d:i,v:s},{d:i,v:s}];var r=LibDrawing_LibDrawing.createDrawingObjectByType(e,[this.chartData,a]);r.state="edit",this.chartData.editDrawingObject=r,this.chartData.drawingObjects.push(r),this.chartData.editDrawingObject.drawingStage.current++,this.createDrawingObjectOtherCharts(e,r.id,a),this.drawActiveDrawingObjectsOtherCharts(r.id)}"default"===this.chartData.state&&this.chartData.techChart.deactivateMenuTypeAll()},u.prototype.rectChart_mouseDown_drawingBrush=function(){if(this.chartData.isDrawingObjectsLocked&&this.chartData.techChart.switchLockBtn(),this.chartData.editDrawingObject){if(0==this.chartData.editDrawingObject.circles.length)return;this.chartData.editDrawingObject.state="normal",this.chartData.editDrawingObject.draw(this.canvasDrawingContext),this.chartData.editDrawingObject=null}var t={};t.points=[{x:this.crosshair.params.x,y:this.crosshair.params.y},{x:this.crosshair.params.x,y:this.crosshair.params.y,active:!0}];var e=this.crosshair.params.dateSeconds,a=this.crosshair.params.value;t.data=[{d:e,v:a},{d:e,v:a}];var i=new Brush(this.chartData,t);i.state="edit",this.chartData.editDrawingObject=i,this.chartData.drawingObjects.push(i),this.chartData.editDrawingObject.drawingStage.current++,this.createDrawingObjectOtherCharts("Brush",i.id,t),this.drawActiveDrawingObjectsOtherCharts(i.id)},u.prototype.rectChart_mouseDown_drawingHorizontalLine=function(t){this.rectChart_mouseDown_drawingOnePointObject(t,"HorizontalLine")},u.prototype.rectChart_mouseDown_drawingHorizontalRay=function(t){this.rectChart_mouseDown_drawingOnePointObject(t,"HorizontalRay")},u.prototype.rectChart_mouseDown_drawingOnePointObject=function(t,e){this.chartData.isDrawingObjectsLocked&&this.chartData.techChart.switchLockBtn(),this.chartData.editDrawingObject&&(this.chartData.editDrawingObject.state="normal",this.chartData.editDrawingObject.draw(this.canvasDrawingContext),this.chartData.editDrawingObject=null);var a={};a.points=[{x:this.crosshair.params.x,y:this.crosshair.params.y},{x:this.crosshair.params.x,y:this.crosshair.params.y,active:!0}];var i=this.crosshair.params.dateSeconds,s=this.crosshair.params.value;a.data=[{d:i,v:s},{d:i,v:s}];var r=LibDrawing_LibDrawing.createDrawingObjectByType(e,[this.chartData,a]);r.state="edit",this.chartData.editDrawingObject=r,this.chartData.drawingObjects.push(r),this.createDrawingObjectOtherCharts(e,r.id,a),this.redrawActiveDrawingObjects(!0),this.drawActiveDrawingObjectsOtherCharts(r.id),this.chartData.state=this.chartData.isStayDrawingMode?this.chartData.state:"default","default"===this.chartData.state&&this.chartData.techChart.deactivateMenuTypeAll()},u.prototype.rectChart_mouseDown_drawingVerticalLine=function(){this.chartData.isDrawingObjectsLocked&&this.chartData.techChart.switchLockBtn(),this.chartData.editDrawingObject&&(this.chartData.editDrawingObject.state="normal",this.chartData.editDrawingObject.draw(this.canvasDrawingContext),this.chartData.editDrawingObject=null);var t={};t.points=[{x:this.crosshair.params.x,y:0},{x:this.crosshair.params.x,y:this.h}];var e=this.crosshair.params.dateSeconds;t.data=[{d:e}];var a=new VerticalLine(this.chartData,t);a.state="edit",this.chartData.editDrawingObject=a,this.chartData.drawingObjects.push(a),this.createDrawingObjectOtherCharts("VerticalLine",a.id,t),this.redrawActiveDrawingObjects(!0),this.drawActiveDrawingObjectsOtherCharts(a.id),this.chartData.state=this.chartData.isStayDrawingMode?this.chartData.state:"default","default"===this.chartData.state&&this.chartData.techChart.deactivateMenuTypeAll()},u.prototype.createDrawingObjectOtherCharts=function(t,e,a){for(var i=this.chartData.techChart.charts,s=0;s<i.length;s++)if(s!==this.chartData.techChart.activeChartIndex&&i[s].chartData.pair.ID===this.chartData.pair.ID){var r=LibDrawing_LibDrawing.createDrawingObjectByType(t,[i[s].chartData,a]);i[s].chartData.drawingObjects.push(r),r.id=e}},u.prototype.rectChart_mouseDown_zoomIn=function(){this.curY>this.h||this.curX>this.w||(this.chartData.zoomData.startX=this.curX,this.chartData.zoomData.startY=this.curY,this.isPressed=!0)},u.prototype.rectChart_mouseDown_default=function(t){if(this.curX<this.w&&this.curY<this.parentRect.height-this.offY){if(!this.chartData.isDrawingObjectsLocked){var e=!1;if(this.chartData.editDrawingObject){if(this.chartData.editDrawingObject.isFocused(this.curX,this.curY))return this.chartData.activeDrawingObject&&(this.chartData.activeDrawingObject.state="normal",this.chartData.activeDrawingObject.isPressed=!1,this.chartData.activeDrawingObject=null),this.chartData.editDrawingObject.isPressed=!0,this.chartData.editDrawingObject.state="edit",void this.redrawDrawingObjects();this.chartData.editDrawingObject.state="normal",this.chartData.editDrawingObject=null,e=!0}if(this.chartData.activeDrawingObject){if(this.chartData.activeDrawingObject.isFocused(this.curX,this.curY))return this.chartData.activeDrawingObject.state="edit",this.chartData.editDrawingObject=this.chartData.activeDrawingObject,this.chartData.editDrawingObject.isPressed=!0,this.chartData.activeDrawingObject=null,this.redrawDrawingObjects(),void this.drawActiveDrawingObjects(!0);this.chartData.activeDrawingObject.state="normal",this.chartData.activeDrawingObject=null,e=!0}for(var a=0;a<this.chartData.drawingObjects.length;a++)if(this.chartData.drawingObjects[a].isFocused(this.curX,this.curY))return this.chartData.drawingObjects[a].state="edit",this.chartData.editDrawingObject&&(this.chartData.editDrawingObject.state="normal"),this.chartData.editDrawingObject=this.chartData.drawingObjects[a],this.chartData.activeDrawingObject&&(this.chartData.activeDrawingObject.state="normal",this.chartData.activeDrawingObject=null),e=!0,void this.redrawDrawingObjects();e&&(this.redrawInfo(),this.redrawDrawingObjects())}if(this.isPressed=!0,this.chartData.indicators.length){var i;for(a=0;a<this.chartData.indicators.length;a++)if("oscillator"===this.chartData.indicators[a].type){i=this.oscillatorCharts[this.chartData.indicators[a].id].top,Math.abs(this.curY-i)<this.resizeEdgeHeight&&(this.isResizeOscillator=!0,this.oscillatorCharts[this.chartData.indicators[a].id].parent.classList.toggle("tch-chart-resized-top",!0),a>0&&"oscillator"===this.chartData.indicators[a-1].type&&this.oscillatorCharts[this.chartData.indicators[a-1].id].parent.classList.toggle("tch-chart-resized-bottom",!0));var s=this.oscillatorCharts[this.chartData.indicators[a].id].h;Math.abs(this.curY-(i+s))<this.resizeEdgeHeight&&(this.isResizeOscillator=!0,this.oscillatorCharts[this.chartData.indicators[a].id].parent.classList.toggle("tch-chart-resized-bottom",!0))}if(this.isResizeOscillator)return void(Math.abs(this.curY-this.h)&&this.parent.classList.toggle("tch-chart-resized-bottom",!0))}this.chartData.options.Chart.autoScale?t.target.classList.add("moveX"):(t.target.classList.add("moveX"),t.target.classList.add("moveY"))}else this.curX>this.w&&this.curY<this.parentRect.height-this.offY&&(this.chartData.options.Chart.autoScale=!1,this.isSetScaleY=!0,this.isPressed=!0,t.target.classList.add("moveY"));this.chartData.techChart.closePanelSettingIndicator(t)},u.prototype.rectChart_mouseUp=function(t,e){t.preventDefault(),1!==t.which&&0!==t.which||(e["rectChart_mouseUp_"+(e.chartData.state?e.chartData.state:"default")](t),e.mouseUpOtherCharts(e)),e.chartData.techChart.autoSaveParams(),e=null},u.prototype.mouseUpOtherCharts=function(t){for(var e=t.chartData.techChart.charts,a=0;a<e.length;a++)a===t.chartData.techChart.activeChartIndex&&"zoomIn"==e[a].chartData.state&&e[a].rectChart_mouseUp_zoomIn()},u.prototype.setResizeOscillatorOff=function(){if(this.isResizeOscillator){var t=this.parent.querySelectorAll(".tch-chart-resized-top");t&&t.length&&u.removeClass(t,"tch-chart-resized-top");var e=this.parent.querySelectorAll(".tch-chart-resized-bottom");e&&e.length&&u.removeClass(e,"tch-chart-resized-bottom"),this.parent.classList.toggle("tch-chart-resized-top",!1),this.parent.classList.toggle("tch-chart-resized-bottom",!1),this.isResizeOscillator=!1}},u.prototype.rectChart_mouseUp_default=function(t){t.target.classList.remove("moveX"),t.target.classList.remove("moveY"),this.isPressed=!1,this.isSetScaleY=!1,this.setResizeOscillatorOff(),this.chartData.editDrawingObject&&(this.chartData.editDrawingObject.isPressed?(this.chartData.editDrawingObject.isPressed=!1,this.chartData.editDrawingObject.updateValues()):(this.chartData.editDrawingObject.state="normal",this.chartData.editDrawingObject.draw(this.canvasDrawingContext),this.chartData.editDrawingObject=null),this.redrawInfo()),this.navButtonStartContainer.onmouseup(t)},u.prototype.rectChart_mouseUp_zoomIn=function(){if(this.isPressed){this.chartData.techChart.parent.querySelector(".tch-zoomin-btn").classList.toggle("tch-active"),this.chartData.zoomData.endX=this.curX,this.chartData.zoomData.endY=this.curY;var t,e=!1;this.scaleZoomDataQuantCandles(this.chartData.zoomData,5),this.chartData.zoomData.startY!==this.chartData.zoomData.endY&&this.showData.length<=10&&(e=!0),e||(t={maxValue:this.chartData.scaleParams.maxB,minValue:this.chartData.scaleParams.minB,startDate:this.chartData.startDateSeconds,candleWidth:this.chartData.candleWidth,startX:this.w-parseFloat(this.showData[0].x)},this.chartData.zoomSteps.push(t),this.chartData.zoomData.click?this.zoomX(-100,2):this.zoomArea(this.chartData.zoomData)),this.chartData.techChart.parent.querySelector(".tch-zoomout-btn").disabled=!1,this.isPressed=!1,this.zoomSelector.style.display="none",this.chartData.state="default",this.chartData.techChart.autoSaveParams()}},u.prototype.rectChart_mouseMove_drawingPointsObject=function(){if(this.chartData.editDrawingObject&&this.chartData.editDrawingObject.drawingStage.current<=this.chartData.editDrawingObject.drawingStage.max){var t=this.clearInfo();this.drawCrosshair(t,t.canvas.height,this.techChart.configuration.modules.headerButtons.createPipsButton),this.chartData.editDrawingObject.moveTo(this.curX,this.curY,this.crosshair.params),this.drawActiveDrawingObjects(!0),this.updateDrawingObjectsOtherChart(this.chartData.editDrawingObject),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)}},u.prototype.rectChart_mouseMove_drawingBrushObject=function(){if(this.chartData.editDrawingObject&&1==this.chartData.editDrawingObject.drawingStage.current){var t=this.clearInfo();this.drawCrosshair(t,t.canvas.height,this.techChart.configuration.modules.headerButtons.createPipsButton),this.chartData.editDrawingObject.moveTo(this.curX,this.curY,this.crosshair.params),this.drawActiveDrawingObjects(!0),this.updateDrawingObjectsOtherChart(this.chartData.editDrawingObject),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id)}},u.prototype.rectChart_mouseMove_zoomIn=function(){if(this.isPressed){var t=this.chartData.zoomData.startX,e=this.chartData.zoomData.startY,a=this.curX,i=this.curY;t>this.w-8&&(t=this.w-8),e>this.h&&(e=this.h),a>this.w-8&&(a=this.w-8),i>this.h&&(i=this.h);var s=Math.abs(a-t),r=Math.abs(i-e);this.zoomSelector.style.left=a-t<0?a+"px":t+"px",this.zoomSelector.style.top=i-e<0?i+"px":e+"px",this.zoomSelector.style.width=s+"px",this.zoomSelector.style.height=r+"px",this.zoomSelector.style.display="block"}},u.prototype.processMoving=function(t,e){if(this.isSetScaleY){if(Math.abs(e)<1)return;var a=e>0?-15:15;this.chartData.options.Chart.autoScale=!1;var i=parseFloat(this.chartData.scaleParams.minB),s=parseFloat(this.chartData.scaleParams.maxB),r=a*this.chartData.scaleParams.deltaY;this.chartData.scaleParams.minB=i-r,this.chartData.scaleParams.maxB=s+r,this.chartData.scaleParams.deltaY=(this.chartData.scaleParams.maxB-this.chartData.scaleParams.minB)/this.h,this.resizeShowDataValuesY(this.showData,this.h,this.chartData.scaleParams),this.updateDrawingObjectsPixels(),this.resizeNewsBubbles(),this.resizeEventsBubbles(),this.draw(this.showData,this.h),this.valueAxis=this.getValueAxis(this.chartData.scaleParams.minB,this.chartData.scaleParams.maxB,this.valueAxisCount,this.w,this.h,this.chartData.options.Chart.scalesFontSize,this.chartData.precission),this.getOscillatorChartsAxis(),this.clearGrid(),this.drawValueAxis(this.valueAxis),this.drawTimeAxis(this.timeAxis),this.drawOscillatorChartsAxis(),this.drawChartBorder(),this.drawCurrentValue(),this.clearInfo(),this.drawActiveDrawingObjects()}else{if(this.chartData.options.Chart.autoScale){if(!this.moveChartX(this,t))return}else if(!this.moveChartY(this,e)&!this.moveChartX(this,t))return;this.showData[0].date===this.selectedData[0].date&&this.showData[this.showData.length-1].date===this.selectedData[this.selectedData.length-1].date||(this.selectedData=this.getSelectedDataByShowData(this.showData),this.chartData.scaleParams=this.getScaleParams(this.selectedData,this.h,this.chartData.precission),this.resizeShowDataValuesY(this.showData,this.h,this.chartData.scaleParams)),this.chartData.indicators&&this.chartData.indicators.length&&this.createIndicatorsShowData(),this.updateDrawingObjectsPixels(),this.draw(this.showData,this.h),this.valueAxis=this.getValueAxis(this.chartData.scaleParams.minB,this.chartData.scaleParams.maxB,this.valueAxisCount,this.w,this.h,this.chartData.options.Chart.scalesFontSize,this.chartData.precission),this.getOscillatorChartsAxis(),this.clearGrid(),this.drawValueAxis(this.valueAxis),this.drawTimeAxis(this.timeAxis),this.drawOscillatorChartsAxis(),this.drawChartBorder(),this.drawCurrentValue()}this.activeSignal&&this.redrawActiveSignal()},u.prototype.rectChart_mouseMove_default=function(t,e,a,i,s){if(t.preventDefault(),t.stopPropagation(),this.isPressed){this.moving.totalX+=e,this.moving.totalY+=a;var r=this;this.movingTimeout||(e=this.moving.totalX,a=this.moving.totalY,r.moving.totalX=0,r.moving.totalY=0,this.movingTimeout=setTimeout(function(){r.processMoving(e,a),r.movingTimeout=null,r=null},5))}else if(this.chartData.isDrawingObjectsLocked)this.focusNewsBubbles(i,s),this.focusEventsBubbles(i,s),this.navButtons.onmousemove();else if(this.chartData.editDrawingObject&&this.chartData.editDrawingObject.isPressed){var n=this.crosshair.params.x,o=this.crosshair.params.y,h=this.crosshair.params.dateSeconds,c=this.crosshair.params.value;this.curX=i,this.curY=s;var l=this.clearInfo();this.drawCrosshair(l,l.canvas.height,this.techChart.configuration.modules.headerButtons.createPipsButton),e=n-this.crosshair.params.x,a=o-this.crosshair.params.y;var d=h-this.crosshair.params.dateSeconds,p=c-this.crosshair.params.value;if(Math.abs(e)<1&&Math.abs(a)<1)return;this.chartData.editDrawingObject.isObjectEdit?this.chartData.editDrawingObject.shiftTo(e,a,this.crosshair.params,d,p):(this.chartData.editDrawingObject.moveTo(this.curX,this.curY,this.crosshair.params),this.drawActiveDrawingObjects(!0)),this.updateDrawingObjectsOtherChart(this.chartData.editDrawingObject),this.drawActiveDrawingObjectsOtherCharts(this.chartData.editDrawingObject.id),this.drawActiveDrawingObjects()}else{var u=!1,g=null,v=null,f=!1;this.chartData.editDrawingObject&&(g=this.chartData.editDrawingObject.isObjectEdit,v=this.chartData.editDrawingObject.isChanged);for(var y=0;y<this.chartData.drawingObjects.length;y++){if(this.chartData.drawingObjects[y].isFocused(this.curX,this.curY)){"edit"===this.chartData.drawingObjects[y].state||"active"===this.chartData.drawingObjects[y].state?u=!0:(this.chartData.drawingObjects[y].state="active",this.chartData.activeDrawingObject=this.chartData.drawingObjects[y],u=!0),this.chartData.editDrawingObject&&this.chartData.editDrawingObject.isChanged!==v&&(f=!0);break}"active"===this.chartData.drawingObjects[y].state?(this.chartData.drawingObjects[y].state="normal",this.chartData.activeDrawingObject=null,this.chartData.drawingObjects[y].draw(this.canvasDrawingContext),u=!0):"edit"===this.chartData.drawingObjects[y].state&&(u=!0),!this.chartData.editDrawingObject||this.chartData.editDrawingObject.isChanged===v&&g===this.chartData.editDrawingObject.isObjectEdit||(f=!0)}f&&this.drawActiveDrawingObjects(!0),this.focusNewsBubbles(i,s),this.focusEventsBubbles(i,s),u?(this.redrawInfo(),this.redrawDrawingObjects()):this.navButtons.onmousemove()}var D;if(this.chartData.indicators.length)for(y=0;y<this.chartData.indicators.length;y++)if("oscillator"===this.chartData.indicators[y].type){if(D=this.oscillatorCharts[this.chartData.indicators[y].id].top,Math.abs(this.curY-D)<this.resizeEdgeHeight){t.target.classList.toggle("tch-cursor-arrow",!1),t.target.classList.toggle("moveY",!0);break}t.target.classList.toggle("moveY",!1),t.target.classList.toggle("tch-cursor-arrow",!0)}},u.prototype.rectChart_mouseMove=function(t,e){if(!d||!d.pressed){t.preventDefault();var a=Math.floor(t.clientX-e.parentRect.left),i=Math.floor(t.clientY-e.parentRect.top),s=e.curX-a,r=e.curY-i;if(e.isResizeOscillator)e.resizeOscillatorOnMouseMove(e.curY,r);else switch(e.chartData.state){case"default":e.rectChart_mouseMove_default(t,s,r,a,i);break;case"drawingBrush":e.rectChart_mouseMove_drawingBrushObject(t,s,r,a,i);break;case"zoomIn":e.rectChart_mouseMove_zoomIn(t,e);break;default:e.rectChart_mouseMove_drawingPointsObject(t,s,r,a,i)}e.curX=a,e.curY=i,e.moveCrosshairXY(e.showData,e.curX,i,e.w,e.h),e.redrawInfo(),e=null}},u.prototype.resize=function(){var t=(parseInt(this.parentRect.width)-this.offX)/2;this.showData&&this.showData.length&&this.showData[0].x<t&&(this.chartData.startX=0),this.init()},u.prototype.horizontalArrowEvent=function(t){this.moveChartX(this,t)&&(this.showData[0].date===this.selectedData[0].date&&this.showData[this.showData.length-1].date===this.selectedData[this.selectedData.length-1].date||(this.selectedData=this.getSelectedDataByShowData(this.showData),this.chartData.scaleParams=this.getScaleParams(this.selectedData,this.h,this.chartData.precission),this.resizeShowDataValuesY(this.showData,this.h,this.chartData.scaleParams)),this.chartData.indicators&&this.chartData.indicators.length&&this.createIndicatorsShowData(),this.updateDrawingObjectsPixels(),this.draw(this.showData,this.h),this.valueAxis=this.getValueAxis(this.chartData.scaleParams.minB,this.chartData.scaleParams.maxB,this.valueAxisCount,this.w,this.h,this.chartData.options.Chart.scalesFontSize,this.chartData.precission),this.getOscillatorChartsAxis(),this.clearGrid(),this.drawValueAxis(this.valueAxis),this.drawTimeAxis(this.timeAxis),this.drawOscillatorChartsAxis(),this.drawChartBorder(),this.drawCurrentValue(),this.redrawInfo())},u.prototype.verticalArrowEvent=function(t){this.chartData.options.Chart.autoScale=!1,this.moveChartY(this,t,!0),this.draw(this.showData,this.h),this.clearGrid(),this.drawValueAxis(this.valueAxis),this.drawTimeAxis(this.timeAxis),this.drawChartBorder(),this.drawCurrentValue(),this.redrawInfo()},u.prototype.redraw=function(){this.selectedData=this.selectDataToShow(this.chartData.data[this.chartData.typeData],this.chartData.startDateSeconds,this.chartData.spacing,this.w),this.showData=this.processDataToShow(this.selectedData,this.chartData.rightPadding,this.chartData.spacing,this.w,this.h,this.chartData.precission,this.chartData.startX,null),this.chartData.scaleParams=this.getScaleParams(this.selectedData,this.h,this.chartData.precission),this.resizeShowDataValuesY(this.showData,this.h,this.chartData.scaleParams),this.chartData.indicators&&this.chartData.indicators.length&&this.createIndicatorsShowData(),this.valueAxis=this.getValueAxis(this.chartData.scaleParams.minB,this.chartData.scaleParams.maxB,this.valueAxisCount,this.w,this.h,this.chartData.options.Chart.scalesFontSize,this.chartData.precission,this.offY),this.timeAxis=this.getTimeAxis(this.showData,this.w,this.parentRect.height-this.offY,this.chartData.period,this.chartData.timeMode,this.chartData.localization),this.getOscillatorChartsAxis(),this.updateDrawingObjectsPixels(),this.drawDataPanel(this.showData[0]),this.draw(this.showData,this.h),this.drawActiveDrawingObjects(),this.activeSignal&&this.redrawActiveSignal(),this.clearGrid(),this.drawTimeAxis(this.timeAxis),this.drawValueAxis(this.valueAxis),this.drawOscillatorChartsAxis(),this.drawChartBorder(),this.drawCurrent(this.chartData.currentValue)},u.prototype.redrawActiveDrawingObjects=function(t){this.clearCanvas(this.canvasDrawingActive),this.drawActiveDrawingObjects(t)},u.prototype.drawChart=function(t,e){if(!t||0===t.length||isNaN(e))return!1;var a=this.canvasDataNormalContext,i=this.canvasDataPixelatedContext;if(!a||!i)return!1;var s=this.canvasDataNormalContext.canvas,r=this.canvasDataPixelatedContext.canvas;return LibCanvas.clearRect(s,null,0,0,s.width,s.height),LibCanvas.clearRect(r,null,0,0,r.width,r.height),this.chartData.indicators&&this.chartData.indicators.length&&this.drawIndicators(),this.redrawDrawingObjects(),!0},u.prototype.setBackgroundColor=function(t){this.chartData.colors.Chart.backgroundColor=t,this.canvasGrid.style.backgroundColor=this.chartData.colors.Chart.backgroundColor},u.prototype.setColorDown=function(t){var e;if(t.indexOf("#")>-1)e=this.hexToRgb(t);else{var a=t.split(")")[0];e={r:(a=(a=a.split("(")[1]).split(", "))[0],g:a[1],b:a[2]}}e="rgba("+e.r+","+e.g+","+e.b+", 0.12)",this.chartData.colors.AreaChart.colorDown=e},u.prototype.setChartThemes=function(t){t=t.toLowerCase(),this.chartData.colors=Object(o.b)(this.chartData.themes[t]),this.chartData.chart.init(!0)},u.prototype.createShowData=function(){this.showData=this.processDataToShow(this.selectedData,this.chartData.rightPadding,this.chartData.spacing,this.w,this.h,this.chartData.precission,this.chartData.startX,null)},u.prototype.isPositionValid=function(){return parseFloat(this.showData[0].x)<this.w-this.chartData.rightPadding+this.chartData.spacing},u.prototype.getElementsByXRange=function(t,e,a){if(!t||0===t.length||isNaN(e)||isNaN(a))return[];var i=this.binarySearhElementWithField(t,e,"x"),s=this.binarySearhElementWithField(t,a,"x");return t.slice(s,i+1)},u.prototype.binarySearhElementWithField=function(t,e,a){for(var i,s,r=t.length-1,n=0;r>n;)if((s=t[i=(r+n)/2|0])[a]>e)n=i+1;else{if(!(s[a]<e))return i;r=i-1}return t[r]&&t[r][a]>e&&r!==t.length-1&&(r+=1),r},u.prototype.detectBrowser=function(t,e){return-1!==t.navigator.userAgent.indexOf("Opera")||-1!==t.navigator.userAgent.indexOf("OPR")?"opera":-1!==t.navigator.userAgent.indexOf("MSIE")||e.documentMode?"ie":t.StyleMedia?"edge":-1!==t.navigator.userAgent.indexOf("Chrome")?"chrome":-1!==t.navigator.userAgent.indexOf("Safari")?"safari":-1!==t.navigator.userAgent.indexOf("Firefox")?"firefox":"unknown"},u.countDigits=function(t){var e=(""+t).replace(",",".").split(".");return e.length>1?e[1].length:0},u.prototype.checkHasEnoughData=function(t,e){return this.getExtraDataNumb(t,e)<=0},u.prototype.getExtraDataNumb=function(t,e){var a=this.selectDataToShow(t.data[t.typeData],t.startDateSeconds,t.spacing,e);return this.pxToDataNumb(Math.ceil((e-t.rightPadding)/t.spacing))-a.length},u.prototype.pxToDataNumb=function(t){return!t||isNaN(t)?0:t},u.prototype.selectDataToShow=function(t,e,a,i){if(!t||0===t.length||isNaN(e)||isNaN(a)||isNaN(i))return[];for(var s=[],r=Math.ceil(i/a),n=0;n<t.length&&s.length<=r;n++)if(t[n]){if(t[n].date>e)continue;s.push(t[n])}return s},u.prototype.getCoordinateX=function(t,e,a,i){if(t=parseFloat(t),e=parseFloat(e),a=parseFloat(a),i=parseFloat(i),!(isNaN(t)||isNaN(e)||isNaN(a)||isNaN(i))){var s=parseFloat(t-e-i*a);return(s=s>0?s:0).toFixed(1)}},u.prototype.getCoordinateY=function(t,e,a,i){if(t=parseFloat(t),e=parseFloat(e),a=parseFloat(a),i=parseFloat(i),!(isNaN(t)||isNaN(e)||isNaN(a)||isNaN(i)||0===i))return parseFloat(e-(t-a)/i).toFixed(1)},u.prototype.drawChartBorder=function(){var t=LibCanvas.getPosition(this.parentRect.height-this.offY,2);LibCanvas.drawLine(null,this.canvasGridContext,0,t,Math.round(this.w-7),t,this.chartData.colors.Chart.colorScalesLines,[],2),t=LibCanvas.getPosition(this.w-7,2),LibCanvas.drawLine(null,this.canvasGridContext,t,-7,t,Math.round(this.parentRect.height-this.offY),this.chartData.colors.Chart.colorScalesLines,[],2),this.drawChartOscillatorsBorder(2)},u.prototype.drawChartOscillatorsBorder=function(t){var e,a;for(var i in this.oscillatorCharts)this.oscillatorCharts.hasOwnProperty(i)&&(a=this.oscillatorCharts[i].top,e=LibCanvas.getPosition(a,t),LibCanvas.drawLine(null,this.canvasGridContext,0,e,Math.round(this.w-7),e,this.chartData.colors.Chart.colorScalesLines,[],t))},u.prototype.clearGrid=function(){this.axisTextContainer.innerHTML="";var t=this.canvasGridContext,e=t.canvas;LibCanvas.clearRect(null,t,0,0,e.width,e.height)},u.prototype.clearCanvas=function(t,e){LibCanvas.clearRect(null,e,0,0,t.width,t.height)},u.prototype.clearSignals=function(){var t=this.canvasSignalsContext,e=t.canvas;this.clearCanvas(e,t)},u.prototype.clearOptions=function(){var t=this.canvasOptionsContext,e=t.canvas;this.clearCanvas(e,t)},u.prototype.getNearestCandleIndex=function(t){if(!this.showData||0===this.showData.length)return!1;if(this.showData[0].date<=t)return 0;var e=this.binarySearhElementWithField(this.showData,t,"date");return this.showData[e].date<t&&(e-=1),e},u.prototype.setChartZoomedSize=function(t,e,a){var i=t>0?this.chartData.candleWidth/t:this.chartData.candleWidth*t;if(a<0)this.chartData.zoomView=this.chartData.zoomView/e;else{if(!(a>0))return;this.chartData.zoomView=this.chartData.zoomView*e}this.chartData.candleWidth=i*this.chartData.zoomView,this.chartData.candleWidth<1?this.chartData.candleWidth=1:this.chartData.candleWidth>100&&(this.chartData.candleWidth=100),this.chartData.spacing=1.5*this.chartData.candleWidth},u.prototype.getElementIndexByPositionX=function(t,e){if(e>t[0].x)return-1;for(var a=t.length-1,i=0;i<t.length;i++)if(parseFloat(t[i].x)<=e){a=i;break}return a},u.prototype.redrawInfo=function(){var t=this.clearInfo();this.drawCrosshair(t,t.canvas.height,this.techChart.configuration.modules.headerButtons.createPipsButton),this.drawActiveDrawingObjects()},u.prototype.clearInfo=function(){var t=this.canvasInfoContext,e=t.canvas;return this.clearCanvas(e,t),t},u.prototype.getIndexByDate=function(t,e){var a=-1,i=u.binaryIndexByDate(t,e);return null!==i&&(a=i),a},u.binaryIndexByDate=function(t,e){for(var a,i,s=0,r=t.length-1;s<=r;)if((i=t[a=(s+r)/2|0]).date>e)s=a+1;else{if(!(i.date<e))return a;r=a-1}return null},u.prototype.createShowDataToAdd=function(t){for(var e=[],a=0;a<t.length;a++){var i=this.createShowDataItem(t[a],this.chartData.precission);t[a].isCurrent&&(i.isCurrent=!0),e.push(i)}return e},u.prototype.getSelectedDataByShowData=function(t){return u.getSelectedDataByShowDataBinary(t,this.chartData.data[this.chartData.typeData])},u.getSelectedDataByShowDataBinary=function(t,e){if(!t||0===t.length)return[];var a=t[0].date,i=u.binaryIndexByDate(e,a),s=t[t.length-1].date,r=u.binaryIndexByDate(e,s);return e.slice(i,r+1)},u.prototype.getValueFromTick=function(t,e){var a;switch(e){case"Default":a=t;break;case"1":a=parseFloat(t).toFixed(0);break;case"10":a=parseFloat(t).toFixed(1);break;case"100":a=parseFloat(t).toFixed(2);break;case"1000":a=parseFloat(t).toFixed(3);break;case"10000":a=parseFloat(t).toFixed(4);break;case"100000":a=parseFloat(t).toFixed(5);break;case"1000000":a=parseFloat(t).toFixed(6);break;default:a=t}return a},u.binaryIndexOfCandleByTime=function(t,e){for(var a,i,s=0,r=e.length-1;s<=r;)if((i=e[a=(s+r)/2|0]).date>t)s=a+1;else{if(!(i.date<t))return a;r=a-1}return null},u.removeClass=function(t,e){for(var a=0;a<t.length;a++)t[a].classList.toggle(e,!1)},u.prototype.drawDataPanel=function(t){if(t&&this.dataPanel){var e=new Date(1e3*t.date);this.dataPanel.querySelector(".tch-data-panel-header  span:nth-child(2)").innerText=this.chartData.pair.FullName,this.dataPanel.querySelector(".tch-data-panel-header  span:nth-child(3)").innerText=this.techChart.translation[this.techChart.getPeriods()[this.chartData.period].key],this.dataPanel.querySelector(".tch-data-panel-header  span:nth-child(4)").innerText=this.getLocalizedTimeText(e,this.chartData.localization,5,this.chartData.timeMode);var a=this.dataPanel.querySelector(".tch-data-candle");a.innerHTML="";var i,s,r,n,o,h=["open","high","low","close"];if(t.open)s=t.open,r=t.high,n=t.low,o=t.close;else if(t.date>=this.chartData.data[this.chartData.typeData][0].date)s=this.chartData.data[this.chartData.typeData][0].open,r=this.chartData.data[this.chartData.typeData][0].high,n=this.chartData.data[this.chartData.typeData][0].low,o=this.chartData.data[this.chartData.typeData][0].close;else{var c=this.chartData.data[this.chartData.typeData].length-1;s=this.chartData.data[this.chartData.typeData][c].open,r=this.chartData.data[this.chartData.typeData][c].high,n=this.chartData.data[this.chartData.typeData][c].low,o=this.chartData.data[this.chartData.typeData][c].close}var l=this.chartData.options.Chart.typeTick;"Default"!==this.chartData.options.Chart.typeTick&&(s=this.getValueFromTick(s,l),r=this.getValueFromTick(r,l),n=this.getValueFromTick(n,l),o=this.getValueFromTick(o,l)),i=[s,r,n,o];for(var d=0;d<4;d++){var p=document.createElement("li");p.innerHTML="<span tch-text='"+h[d]+"'>"+this.techChart.translation[h[d]]+"</span>";var u=document.createElement("span");u.innerText=i[d],a[h[d]]=u,p.appendChild(u),a.appendChild(p)}this.updateIndicatorsDataPanel(t.date)}},u.prototype.updateDataPanel=function(t){var e=this.techChart.configuration.modules.chartElements.isDataPanelCreate;if(t&&e){var a=new Date(1e3*t.date);this.dataPanel.querySelector(".tch-data-panel-header  span:nth-child(2)").innerText=this.chartData.pair.FullName,this.dataPanel.querySelector(".tch-data-panel-header  span:nth-child(3)").innerText=this.techChart.translation[this.techChart.getPeriods()[this.chartData.period].key],this.dataPanel.querySelector(".tch-data-panel-header  span:nth-child(4)").innerText=this.getLocalizedTimeText(a,this.chartData.localization,5,this.chartData.timeMode);var i,s,r,n,o,h=this.dataPanel.querySelector(".tch-data-candle"),c=["open","high","low","close"];if(t.open)s=t.open,r=t.high,n=t.low,o=t.close;else if(t.date>=this.chartData.data[this.chartData.typeData].date)s=this.chartData.data[this.chartData.typeData].open,r=this.chartData.data[this.chartData.typeData].high,n=this.chartData.data[this.chartData.typeData].low,o=this.chartData.data[this.chartData.typeData].close;else{var l=this.chartData.data[this.chartData.typeData].length-1;s=this.chartData.data[this.chartData.typeData][l].open,r=this.chartData.data[this.chartData.typeData][l].high,n=this.chartData.data[this.chartData.typeData][l].low,o=this.chartData.data[this.chartData.typeData][l].close}var d=this.chartData.options.Chart.typeTick;"Default"!==this.chartData.options.Chart.typeTick&&(s=this.getValueFromTick(s,d),r=this.getValueFromTick(r,d),n=this.getValueFromTick(n,d),o=this.getValueFromTick(o,d)),i=[s,r,n,o];for(var p=0;p<4;p++)h[c[p]].innerText=i[p];this.chartData.index===this.chartData.techChart.activeChartIndex&&this.chartData.indicators&&this.chartData.indicators.length&&this.updateIndicatorsDataPanel(t.date)}},u.prototype.addTimeAxisForPrediction=function(t,e){if(!e||!this.timeAxis)return t;var a;if(!t||t.length<=0?(t=[],a=this.timeAxis[0]):a=t[0],!a)return t;for(var i=(e=parseFloat(e))*this.chartData.spacing,s={x:a.x1,x1:a.x1,date:a.date};parseFloat(s.x1)+i<this.w;){s.date=s.date+this.chartData.getCurrentTimeStep()*e,s.x1=s.x=parseFloat(s.x1)+i;var r=this.createHourTimeAxis(s,this.w,this.parentRect.height-this.offY,this.chartData.timeMode,this.chartData.localization);if(!r)break;r.isPrediction=!0,t.unshift(r)}return t},u.prototype.addTimeAxisForPast=function(t,e){if(!e||!this.timeAxis)return t;var a;if(!t||t.length<=0?(t=[],a=this.timeAxis[this.timeAxis.length-1]):a=t[t.length-1],!a)return t;for(var i=(e=parseFloat(e))*this.chartData.spacing,s={x:a.x1,x1:a.x1,date:a.date};parseFloat(s.x1)-i>0;){s.date=s.date-this.chartData.getCurrentTimeStep()*e,s.x1=s.x=parseFloat(s.x1)-i;var r=this.createHourTimeAxis(s,this.w,this.parentRect.height-this.offY);if(!r)break;r.isPast=!0,t.push(r)}return t},u.prototype.createTimeAxis=function(t,e,a,i){var s,r=this.techChart.configuration.lang,n=this.getLocalizedTimeText(new Date(1e3*e.date),r,9,this.chartData.timeMode);if(this.canvasGridContext){var o=LibCanvas.measureText(this.canvasGridContext,this.chartData.options.Chart.scalesFontSize+"px Arial",n),h=LibCanvas.measureText(this.canvasGridContext,this.chartData.options.Chart.scalesFontSize+"px Arial",t);s=o.width>h.width?o.width:h.width}return new Axis(t,parseFloat(e.x),0,parseFloat(e.x),i,"timeLines",parseFloat(e.x)-s/2,i+parseFloat(this.valueTextHeigh)/3,"timeText",e.date,n,this.canvasGridContext)},u.prototype.createDaysTimeAxis=function(t,e,a,i,s){var r=new Date(1e3*t.date);s=s||navigator.language;var n=this.getLocalizedTimeText(r,s,1,i);return this.createTimeAxis(n,t,e,a)},u.prototype.createHourTimeAxis=function(t,e,a,i,s){var r=new Date(1e3*t.date),n=this.getLocalizedTimeText(r,s,3,i);return this.createTimeAxis(n,t,e,a)},u.prototype.getHourTimeAxisFromItems=function(t,e,a,i,s,r){for(var n=null;!n&&(n=this.getHourTimeAxisByPeriod(t,e,a,i,s,r),!((i/=2)<=30));)i<=150&&i>30?i=60:i<=300&&i>150?i=300:i<=450&&i>300?i=600:i<=900&&i>450&&(i=900);return n},u.prototype.getHourTimeAxisByPeriod=function(t,e,a,i,s,r){for(var n=null,o=null,h=0;h<t.length;h++)if(t[h].date%i===0&&(o=new Date(1e3*t[h].date)),o){(n=this.createHourTimeAxis(t[h],e,a,s,r)).showDataItem=t[h];break}return n},u.prototype.getTimeAxis=function(t,e,a,i,s,r){this.timeAxisStep=this.getTimeAxisStep();var n=[],o=this.getFirstAxis(t,e,a,i,s,r);if(o){n.push(o);for(var h=!1,c=0;c<t.length;null)if(t[c].date!==n[0].date)if(h){if(t[c].x>0){var l=this.createHourTimeAxis(t[c],e,a,s,r);l&&n.push(l)}c+=this.timeAxisStep}else c++;else h=!0,c+=this.timeAxisStep}return n=this.addTimeAxisForPast(n,this.timeAxisStep),n=this.addTimeAxisForPrediction(n,this.timeAxisStep),this.fixFirstTimeAxis(n)},u.prototype.fixFirstTimeAxis=function(t){return t.length&&parseFloat(t[0].x1)>this.w-7&&t.shift(),t},u.prototype.getDayTimeAxis=function(t,e,a,i,s){for(var r=null,n=null,o=0;o<t.length;o++)if(t[o].date%86400===0?n=new Date(1e3*t[o].date):t[o+1]&&new Date(1e3*t[o].date).getUTCDate()!==new Date(1e3*t[o+1].date).getUTCDate()&&(n=new Date(1e3*t[o].date)),n){(r=this.createDaysTimeAxis(t[o],e,a,i,s)).showDataItem=t[o];break}return r},u.prototype.drawTimeAxis=function(t){t&&t.length&&this.showTimeAxis(t,this.axisTextContainer)},u.prototype.showTimeAxis=function(t,e,a){var i;a=a||this.chartData.options.Chart.typeTick,i=this.chartData.colors.Chart.vertGridLines;for(var s=0;s<t.length;s++)t[s].show(null,this.canvasGridContext,null,e,i,this.chartData.options.Chart.typeVertGridLines,this.chartData.colors.Chart.scalesText,this.chartData.options.Chart.scalesFontSize,a)},u.prototype.getNextTimeAxisToLeft=function(t,e,a,i,s,r,n){if(t&&e&&a&&i&&s&&void 0!==r&&n){this.removeTimeAxisForPast(e);var o=[];a=parseFloat(a);var h=!1,c=0;for(e[0].date<=t[0].date&&(c=(c=e.length*a-a)<0?0:c);c<t.length;)if(t[c].date!==e[e.length-1].date)if(h){if(t[c].x>0){var l=this.createHourTimeAxis(t[c],i,s,r,n);l&&o.push(l)}c+=a}else c++;else c+=a,h=!0;return this.addTimeAxisForPast(o,a)}},u.prototype.getNextTimeAxisToRight=function(t,e,a,i,s,r,n){if(t&&e&&a&&i&&s&&void 0!==r&&n){this.removeTimeAxisForPrediction(e);var o=[];a=parseFloat(a);var h=!1,c=t.length-1;for(c=c<0?0:c;c<t.length&&c>=0;)if(t[c].date!=e[0].date)if(h){if(parseFloat(t[c].x)<i){var l=this.createHourTimeAxis(t[c],i,s,r,n);l&&o.unshift(l)}c-=a}else c--;else c-=a,h=!0;return this.addTimeAxisForPrediction(o,a)}},u.prototype.removeTimeAxisForPrediction=function(t){if(t&&0!==t.length)for(;t.length>1&&t[0].isPrediction;)t.splice(0,1)},u.prototype.removeTimeAxisForPast=function(t){if(t&&0!==t.length)for(;t.length>1&&t[0].isPast;)t.splice(0,1)},u.prototype.needsTimeAxisToRight=function(){var t=this.timeAxisStep*this.chartData.spacing,e=0;return this.chartData.candleWidth&&(e=this.chartData.candleWidth/2),!(!this.timeAxis||!this.timeAxis.length)&&parseFloat(this.timeAxis[0].x1)+t<=this.w-e},u.prototype.needsTimeAxisToLeft=function(){var t=this.timeAxisStep*this.chartData.spacing;return!(!this.timeAxis||!this.timeAxis.length)&&parseFloat(this.timeAxis[this.timeAxis.length-1].x1)-t>0},u.prototype.getFirstAxis=function(t,e,a,i,s,r){if(t&&0!==t.length){if(1===this.timeAxisStep)return this.createHourTimeAxis(t[0],e,a,s,r);var n=parseFloat(t[0].x)-this.timeAxisStep*this.chartData.spacing,o=parseFloat(t[0].x),h=this.getElementsByXRange(t,n,o),c=null;return c||(c=this.getHourTimeAxisFromItems(h,e,a,3600,s,r)),c||(c=this.createHourTimeAxis(t[0],e,a,s,r)),c}},u.prototype.getTimeAxisStep=function(){if(this.chartData.spacing){var t=parseInt(250/this.chartData.spacing);return t<5&&t>2?t=5:t>5?(t=parseInt(t/5),t*=5):t<=0&&(t=2),parseInt(t)}},u.prototype.moveAxisX=function(t,e,a,i){if(t&&0!==t.length){for(var s=t.length-1;s>=0;s--)t[s].moveX(e,a,i),this.isRedundantAxis(t[s],a,i)&&t.splice(s,1);this.addExtraTimeAxisOnMove(e,t,a,i,this.chartData.period,this.w-this.chartData.rightPadding,this.parentRect.height-this.offY,this.chartData.timeMode,this.chartData.localization),this.fixFirstTimeAxis(this.timeAxis)}},u.prototype.addExtraTimeAxisOnMove=function(t,e,a,i,s,r,n,o,h){var c;this.needsTimeAxisToLeft()&&(c=this.getNextTimeAxisToLeft(this.showData,this.timeAxis,this.timeAxisStep,r,n,o,h),this.timeAxis=this.timeAxis.concat(c)),this.needsTimeAxisToRight()&&(c=this.getNextTimeAxisToRight(this.showData,this.timeAxis,this.timeAxisStep,r,n,o,h),this.timeAxis=c.concat(this.timeAxis))},u.prototype.isRedundantAxis=function(t,e,a){var i=!1,s=parseFloat(t.x1);return(s<=e||s>=a)&&(i=!0),i},u.prototype.getLocalizedTimeText=function(t,e,a,i){var s="",r={};if("default"===e&&(e="ru"),"safari"===this.browser)"local"!==i&&(t=new Date(t.getTime()+60*t.getTimezoneOffset()*1e3)),1===a?s=(s=t.toLocaleDateString("short")).slice(0,s.length-3):3===a?s=(s=t.toLocaleTimeString("short")).slice(0,s.length-3):5===a&&(s=(s=t.toLocaleString("short","short")).slice(0,s.length-3));else{switch("local"!==i&&(r.timeZone="utc"),a){case 1:r.month="2-digit",r.day="2-digit";break;case 3:r.hour="2-digit",r.minute="2-digit";break;case 5:r.month="2-digit",r.day="2-digit",r.year="2-digit",r.hour="2-digit",r.minute="2-digit"}9!==a&&(s=t.toLocaleTimeString(e,r))}return 9===a&&(r.month="ar"!==e?"short":"2-digit",r.day="2-digit",(s=(s=t.toLocaleDateString("ar"!==e?e:"en",r)).replace(" ","/")).length>6&&"edge"!==this.browser&&(s=s.substring(0,6))),s},u.prototype.getValueAxis=function(t,e,a,i,s,r,n,o){o=o||0;for(var h=[],c=(e-t)/a,l=(e-t)/s,d=e-c/2,p=0;p<a;p++){var u=s-((d=0===p?d:d-c)-t)/l,g=i+7,v=u-r/2-2;v>s-r/2&&(v=s-r/2),u+=o,v+=o;var f=new Axis(d.toFixed(n),0,u,i,u,"valueLines",g,v,"valueText");h.push(f)}return h},u.prototype.drawValueAxis=function(t,e,a){void 0!==e&&null!==e||(e=this.h);var i,s=parseInt(e/parseFloat(this.chartData.options.Chart.scalesFontSize)),r=t.length,n=s<r,o=r%2===0?r/2:r-1-parseInt(r/2);i=this.chartData.colors.Chart.horzGridLines;for(var h=0;h<r;h++)(0===s||1===s&&(a?h>0:h!==o)||2===s&&0!==h&&h!==r-1||s>2&&n&&h%2!==0)&&(t[h].value=""),t[h].show(parent,this.canvasGridContext,null,this.axisTextContainer,i,this.chartData.options.Chart.typeHorzGridLines,this.chartData.colors.Chart.scalesText,this.chartData.options.Chart.scalesFontSize,this.chartData.options.Chart.typeTick)},u.prototype.drawOscillatorChartsAxis=function(){var t=this.oscillatorCharts;for(var e in t)t.hasOwnProperty(e)&&t[e].valueAxis&&t[e].valueAxis.length&&this.drawValueAxis(t[e].valueAxis,t[e].h,!0)},u.prototype.getOscillatorChartsAxis=function(){var t=this.oscillatorCharts;for(var e in t)t.hasOwnProperty(e)&&t[e].getValueAxis(this.chartData.options.Chart.scalesFontSize,parseInt(this.chartData.precission,this.offY))},u.prototype.moveChartX=function(t,e,a,i){return 0!==(e=this.deltaCorrectionForMoveChartX(e))&&(this.moveGraphicX(e,this.w,this.chartData.rightPadding,this.chartData.spacing,i),this.moveAxisX(this.timeAxis,e,0,this.w-this.chartData.rightPadding),this.setGetNewsTimeout(),this.setGetEventsTimeout(),!0)},u.prototype.deltaCorrectionForMoveChartX=function(t,e){if(!t)return 0;e||(e=this);var a=e.chartData.data[e.chartData.typeData],i=e.showData,s=e.chartData.spacing,r=e.w-e.chartData.rightPadding,n=e.chartData.hasPrevData;return t<0?e.leftDeltaCorrection(t,a,i,s,r,n):e.rightDeltaCorrection(t,a,i,s,r)},u.prototype.leftDeltaCorrection=function(t,e,a,i,s,r){var n=a[a.length-1],o=parseFloat(n.x);if(e[e.length-1].date===n.date)if(e.length===a.length){var h=parseFloat(a[0].x);s-h+o>=2*i?h>s-i?t=0:h+Math.abs(t)>s-i&&(t=-(s-h-i)):o>=i||o>s-h?t=0:o+Math.abs(t)>i&&(t=-(i-o))}else!r&&o>=i?t=0:o+Math.abs(t)>i&&(t=-(i-o));else{var c=this.binarySearhElementWithField(e,n.date,"date"),l=(e.length-c)*i;Math.abs(t)>l&&(t=-(l-o))}return t.toFixed(0)},u.prototype.rightDeltaCorrection=function(t,e,a,i,s){var r,n=a[0],o=parseFloat(n.x);return e[0].date===n.date?o<=s/2?t=0:t>(r=o-s/2)&&(t=r):t>(r=this.binarySearhElementWithField(e,n.date,"date")*i+s/2)&&(t=r),t.toFixed(0)},u.prototype.moveChartXwithoutData=function(t){var e=parseFloat(this.showData[t.showData.length-1].x)-this.chartData.spacing;t=this,this.movingTimeout=setTimeout(function(){t.moveRightChart(t,e),t.movingTimeout=null,t=null},20)},u.prototype.moveChartY=function(t,e){if(0===e)return!1;t.moveElementsY(t.showData,e),t.moveNewsBubblesY(e),t.moveEventsBubblesY(e);var a=parseFloat(e)*t.chartData.scaleParams.deltaY;return t.chartData.scaleParams.maxB=parseFloat(t.chartData.scaleParams.maxB)-a,t.chartData.scaleParams.minB=parseFloat(t.chartData.scaleParams.minB)-a,!0},u.prototype.moveGraphicX=function(t,e,a,i){if(0!==t){if(this.moveElementsX(this.showData,t,e,a),this.deleteRedundantElements(this.showData,t,e,a,i),this.moveNewsBubblesX(t),this.moveEventsBubblesX(t),this.needsElementToLeft(this.showData,i)){var s=this.getDataToLeft(this.chartData.data[this.chartData.typeData],this.showData,i);this.addElementsToLeft(this.showData,s,i)}if(this.needsElementToRight(this.showData,e,a,i)){var r=this.getDataToRight(this.chartData.data[this.chartData.typeData],this.showData,e,a,i);this.addElementsToRight(this.showData,r,i,e,a)}this.deleteRedundantElements(this.showData,t,e,a,i),this.chartData.startDateSeconds=this.showData[0].date;var n=this.showData&&this.showData.length?this.showData[0].x:0;this.chartData.startX=e-a-parseFloat(n)}},u.prototype.canMove=function(t,e,a,i,s){if(t.showData[0]){var r=!1,n=parseFloat(t.showData[0].x),o=parseFloat(t.showData[t.showData.length-1].x);return e<0?(r=!t.needsElementToLeft(t.showData,s)||t.chartData.hasPrevData)||(r=t.chartData.data[t.chartData.typeData].length*t.chartData.candleWidth<a/2?o<a-t.chartData.data[t.chartData.typeData].length*t.chartData.candleWidth-(i+7*t.chartData.candleWidth):o<2*t.chartData.spacing):e>0&&((r=!t.needsElementToRight(t.showData,a,i,s)||t.chartData.hasNextData)||(r=t.chartData.data[t.chartData.typeData].length*t.chartData.candleWidth<a/2?n>t.chartData.data[t.chartData.typeData].length*t.chartData.candleWidth+i+7*t.chartData.candleWidth:n>a/2)),r}},u.prototype.updateChart=function(t,e){!e||e.session&&"close"===e.session.toLowerCase()||(!e.isWaitForData&&!e.hasNextData&&e.data&&e.data[e.typeData]&&e.data[e.typeData].length&&e.data[e.typeData][0].isCurrentData?e.chart.getDataOnUpdateComplete(e.chart,t):e.hasNextData=!0)},u.prototype.getDataOnUpdateComplete=function(t,e){if(t.chartData.data.bid[0]||t.chartData.data.bid[0].isCurrentData){if(e){t.chartData.data.ask[0]=e.ask,t.chartData.data.bid[0]=e.bid,t.chartData.data.mid[0]=e.mid,t.chartData.data.ask[0].isCurrentData=!1,t.chartData.data.bid[0].isCurrentData=!1,t.chartData.data.mid[0].isCurrentData=!1;var a={};a.bid=t.createCurrentDataItem(t.chartData.data.bid[0],t.chartData.currentValue.bid),a.ask=t.createCurrentDataItem(t.chartData.data.ask[0],t.chartData.currentValue.ask),a.mid=t.createCurrentDataItem(t.chartData.data.mid[0],t.chartData.currentValue.mid),a.ask.isCurrentData=!0,a.bid.isCurrentData=!0,a.mid.isCurrentData=!0,t.chartData.data.bid.unshift(a.bid),t.chartData.data.ask.unshift(a.ask),t.chartData.data.mid.unshift(a.mid)}if(t.selectedData[0].isCurrentData){if(t.selectedData[0]=t.chartData.data[this.chartData.typeData][1],t.selectedData.unshift(t.chartData.data[this.chartData.typeData][0]),!t.showData[0].x)return!1;var i=parseFloat(t.showData[0].x);t.showData=t.processDataToShow(t.selectedData,t.chartData.rightPadding,t.chartData.spacing,t.w,t.h,t.chartData.precission);var s=parseFloat(t.showData[0].x)-i;t.moveChartX(t,s),t.deleteRedundantElements(t.showData,0,t.w,t.chartData.rightPadding,t.chartData.spacing),t.chartData.indicators&&t.chartData.indicators.length&&(t.createIndicatorsShowData(),t.drawIndicators()),t.valueAxis=t.getValueAxis(t.chartData.scaleParams.minB,t.chartData.scaleParams.maxB,t.valueAxisCount,t.w,t.h,t.chartData.options.Chart.scalesFontSize,t.chartData.precission),t.getOscillatorChartsAxis(),t.timeAxis=t.getTimeAxis(t.showData,t.w,t.parentRect.height-t.offY,t.chartData.period,t.chartData.timeMode,t.chartData.localization),t.updateDrawingObjectsPixels(),t.chartData.updateIndicatorsData(),t.draw(t.showData,t.h),t.clearGrid(),t.drawTimeAxis(t.timeAxis),t.drawValueAxis(t.valueAxis),t.drawOscillatorChartsAxis(),t.drawChartBorder(),t.drawCurrent(t.chartData.currentValue),t.moveCrosshairXY(t.showData,t.curX,t.curY,t.w,t.h),t.redrawInfo(),t.updateDrawingObjectsPixels(),t.redrawDrawingObjects()}}},u.prototype.drawCurrentValue=function(){this.isDrawCurrentShowData(this.chartData,this.showData)?this.drawCurrent(this.chartData.currentValue):this.redrawCurrentPriceLine(this.chartData.currentValue)},u.prototype.isDrawCurrentShowData=function(t,e){if(!t||!t.data||!e||0===e.length||!t.data[t.typeData]||0===t.data[t.typeData].length)return!1;if(e[0].isCurrentData)return!0;var a=t.data[t.typeData][0].date===e[0].date&&!t.hasNextData,i=this.isPositionValid();return a&&i},u.prototype.drawCurrent=function(t,e){if(!t||0===parseFloat(t[this.chartData.typeData])||!this.chartData.scaleParams)if(e)t.ask=e.ask.close,t.bid=e.bid.close,t.mid=e.mid.close;else{if(!this.chartData.data[this.chartData.typeData][0]||!this.chartData.data[this.chartData.typeData][0].isCurrentData)return;t.ask=this.chartData.data.ask[0].close,t.bid=this.chartData.data.bid[0].close,t.mid=this.chartData.data.mid[0].close}t.ask=t.ask.replace(",","."),t.bid=t.bid.replace(",","."),t.mid=t.mid.replace(",","."),this.chartData.currentValue.ask=t.ask,this.chartData.currentValue.bid=t.bid,this.chartData.currentValue.mid=t.mid;var a,i=this.chartData.chart.constructor.name;if(this.isDrawCurrentShowData(this.chartData,this.showData)){if(this.updateCurrentData(t),this.chartData.options.Chart.autoScale&&(parseFloat(t[this.chartData.typeData])>this.chartData.scaleParams.maxV||parseFloat(t[this.chartData.typeData])<this.chartData.scaleParams.minV)){var s=this.getScaleParams(this.selectedData,this.h,this.chartData.precission);if(isNaN(parseFloat(s.minB))&&isNaN(parseFloat(s.maxB))&&isNaN(parseFloat(s.deltaY)))return;this.chartData.options.Chart.scaleSeriesOnly||this.resizeShowDataByTrendIndicators(),(s.minB<this.chartData.scaleParams.minB||s.maxB>this.chartData.scaleParams.maxB)&&(this.chartData.scaleParams=s,this.resizeShowDataValuesY(this.showData,this.h,this.chartData.scaleParams),this.draw(this.showData,this.h),this.valueAxis=this.getValueAxis(this.chartData.scaleParams.minB,this.chartData.scaleParams.maxB,this.valueAxisCount,this.w,this.h,this.chartData.options.Chart.scalesFontSize,this.chartData.precission,this.offY),this.getOscillatorChartsAxis(),this.clearGrid(),this.drawValueAxis(this.valueAxis),this.drawOscillatorChartsAxis(),this.drawTimeAxis(this.timeAxis),this.drawChartBorder())}var r=this.canvasRateNormalContext,n=this.canvasRatePixelatedContext;switch(LibCanvas.clearRect(null,r,0,0,r.canvas.width,r.canvas.height),LibCanvas.clearRect(null,n,0,0,n.canvas.width,n.canvas.height),this.drawCurrentShowData(t,e),this.chartData.updateCurrentIndicatorsData(),this.redrawOscillators(),i){case"BarChart":case"HollowChart":case"CandleChart":a=this.chartData.colors[i].candleBear;break;case"LineChart":case"AreaChart":a=this.chartData.colors[i].priceLine}}else this.redrawCurrentPriceLine(this.chartData.currentValue);this.drawCurrentLabel(t,a,!0,!1,this.chartData.colors[i])},u.prototype.redrawCurrentPriceLine=function(t){var e=this.canvasRateNormalContext,a=this.canvasRatePixelatedContext;LibCanvas.clearRect(null,e,0,0,e.canvas.width,e.canvas.height),LibCanvas.clearRect(null,a,0,0,a.canvas.width,a.canvas.height),this.drawCurrentPriceLine(t),this.drawLastBarPrice(this.showData[0])},u.prototype.drawCurrentPriceLine=function(t){if(!this.chartData.data[this.chartData.typeData]||0!==this.chartData.data[this.chartData.typeData].length){var e=this.toYPixels(t[this.chartData.typeData]);if(e>this.h||e<0)this.parent.querySelector(".tch-rate-value").parentNode.style.display="none";else{var a,i,s,r=this.chartData.chart.constructor.name;switch(r){case"HollowChart":s=this.chartData.chart.showData[0].hollowCandlePriceLine;break;case"BarChart":case"CandleChart":case"LineChart":case"AreaChart":a=this.chartData.colors[r].candleBear,i=this.chartData.colors[r].candleBool,s=parseFloat(this.chartData.data[this.chartData.typeData][0].close)>parseFloat(this.chartData.data[this.chartData.typeData][0].open)?i:a}"LineChart"!==r&&"AreaChart"!==r||(s=this.chartData.colors[r].priceLine);var n=this.chartData.options.Chart.widthPriceLine;e=LibCanvas.getPosition(e,n),this.chartData.options.Chart.needPriceLine&&this.showData.length>0&&(this.showData[0].date!==this.chartData.data[this.chartData.typeData][0].date||this.chartData.isExpired||this.drawCurrentShowData(t,void 0),LibCanvas.drawLine(null,this.canvasRatePixelatedContext,0,e,this.w+this.offX,e,s,[n,n],n));var o=s===a;this.drawPrice(parseFloat(t[this.chartData.typeData]).toFixed(this.chartData.precission),e,"tch-price-bear",o,s)}}},u.prototype.drawLastBarPrice=function(t){if(t){var e,a,i,s=this.chartData.chart.constructor.name;switch(e=this.parent.querySelector(".tch-rate-value"),"LineChart"!==s&&"AreaChart"!==s||(a=this.chartData.colors[s].priceLine,i=this.chartData.colors[s].priceLine),s){case"BarChart":case"HollowChart":case"CandleChart":case"LineChart":case"AreaChart":a=this.chartData.colors[s].candleBear,i=this.chartData.colors[s].candleBool}var r=parseFloat(t.close)>=parseFloat(t.open)?i:a,n=this.toYPixels(t.close),o=r===a;n>0&&n<this.h?(this.drawPrice(parseFloat(t.close).toFixed(this.chartData.precission),n,"tch-price-bear",o,r,!0),this.chartData.isShowPriceLineOfLastBar&&LibCanvas.drawLine(null,this.canvasRatePixelatedContext,0,n,this.w,n,r,[],this.chartData.options.Chart.widthPriceLine)):e.parentNode.style.display="none"}},u.prototype.drawCurrentLabel=function(t,e,a,i,s){if(this.parent){var r,n=t[this.chartData.typeData],o=this.chartData.chart.constructor.name;r=this.isOptionActive?13:this.chartData.options.Chart.scalesFontSize;var h=this.canvasRatePixelatedContext.canvas;if(h&&this.canvasRatePixelatedContext&&n){i&&LibCanvas.clearRect(null,this.canvasRatePixelatedContext,0,0,h.width,h.height),n=parseFloat((""+n).replace(",","."));var c=this.parent.querySelector(".tch-rate-value");c.style.fontSize=r+"px";var l=this.toYPixels(n);if(l>this.h)return void(c.parentNode.style.display="none");if(this.selectedData&&this.selectedData.length&&this.selectedData[0].isCurrentData){s.candleBool,parseFloat(this.selectedData[0].close)>parseFloat(this.selectedData[0].open)&&(e="LineChart"===o||"AreaChart"===o?this.chartData.colors[o].colorLine:s.candleBool),"HollowChart"===o&&(e=this.chartData.chart.showData[0].hollowCandlePriceLine);var d=this.chartData.options.Chart.widthPriceLine;l=LibCanvas.getPosition(l,d),this.chartData.options.Chart.needPriceLine&&("LineChart"!==o&&"AreaChart"!==o||(e=this.chartData.colors[o].priceLine),LibCanvas.drawLine(null,this.canvasRatePixelatedContext,0,l,this.w+this.offX,l,e,[],d));var p=e!==("LineChart"===o||"AreaChart"===o?this.chartData.colors[o].colorLine:s.candleBool);l>0&&l<this.h?this.drawPrice(n.toFixed(this.chartData.precission),l,"tch-price-bear",p,e):c.parentNode.style.display="none"}}}},u.prototype.updatePositionLabelSpanTriangle=function(){this.parent.querySelector(".tch-options-triangle").style.top=parseFloat(this.y).toFixed(1)+"px"},u.prototype.drawCurrentPath=function(t,e,a,i,s,r,n,o){if(a){var h,c,l,d,p;h={x:r,y:e-3},c={x:r-8,y:e+o/2},l={x:r,y:e+o+2},d={x:s,y:e+o+2},p={x:s,y:e-3};var u=[];u.push([h.x,h.y]),u.push([c.x,c.y]),u.push([l.x,l.y]),u.push([d.x,d.y]),u.push([p.x,p.y]),LibCanvas.drawPolygon(null,a,u,i,null)}},u.prototype.updateCurrentData=function(t){var e=parseFloat(t[this.chartData.typeData]);this.chartData.data&&this.chartData.data[this.chartData.typeData].length&&this.chartData.data[this.chartData.typeData][0].isCurrentData&&(e>parseFloat(this.chartData.data[this.chartData.typeData][0].high)?this.chartData.data[this.chartData.typeData][0].high=t[this.chartData.typeData]:e<parseFloat(this.chartData.data[this.chartData.typeData][0].low)&&(this.chartData.data[this.chartData.typeData][0].low=t[this.chartData.typeData]),this.chartData.data[this.chartData.typeData][0].close=t[this.chartData.typeData]),this.selectedData&&this.selectedData[0]&&this.selectedData[0].isCurrentData&&(e>parseFloat(this.selectedData[0].high)?this.selectedData[0].high=t[this.chartData.typeData]:e<parseFloat(this.selectedData[0].low)&&(this.selectedData[0].low=t[this.chartData.typeData]),this.selectedData[0].close=t[this.chartData.typeData])},u.prototype.getCurrentDataComplete=function(t,e){t.isDrawCurrentShowData(t.chartData,t.showData)&&(t.chartData.data.bid[0].isCurrentData&&(t.chartData.data.bid[0].low=e[0].bid.low,t.chartData.data.bid[0].high=e[0].bid.high,t.chartData.data.bid[0].close=e[0].bid.close,t.chartData.data.ask[0].low=e[0].ask.low,t.chartData.data.ask[0].high=e[0].ask.high,t.chartData.data.ask[0].close=e[0].ask.close,t.chartData.data.mid[0].low=e[0].mid.low,t.chartData.data.mid[0].high=e[0].mid.high,t.chartData.data.mid[0].close=e[0].mid.close),t.selectedData[0].isCurrentData&&(t.selectedData[0].low=e[0][this.chartData.typeData].low,t.selectedData[0].high=e[0][this.chartData.typeData].high,t.selectedData[0].close=e[0][this.chartData.typeData].close),t.chartData.currentValue.ask=e[0].ask.close,t.chartData.currentValue.bid=e[0].bid.close,t.chartData.currentValue.mid=e[0].mid.close,t.drawCurrent(t.chartData.currentValue,!!t.selectedData[0].isCurrentData&&e[0]))},u.prototype.drawPrice=function(t,e,a,i,s){var r;(r=this.parent.querySelector(".tch-rate-value")).parentNode.style.display="block";var n=this.chartData.options.Chart.typeTick;r.innerText="Default"!==n?this.getValueFromTick(t,n):t,this.priceTextHeight||(this.priceTextHeight=r.parentNode.getBoundingClientRect().height),this.priceTextColor||(this.priceTextColor=this.getPriceTextColor(s)),this.priceTextColor&&this.isOptionActive&&(this.priceTextColor="#FFFFFF"),r.parentNode.style.left=this.w+"px",r.parentNode.style.top=e-this.priceTextHeight/2+"px",r.parentNode.style.backgroundColor=s,r.parentNode.style.color=this.priceTextColor},u.prototype.getPriceTextColor=function(t){var e;if(t.indexOf("#")>-1)e=this.hexToRgb(t);else{var a=t.split(")")[0];a=(a=a.split("(")[1]).split(", "),e={r:parseInt(a[0]),g:parseInt(a[1]),b:parseInt(a[2])}}return(e.r+e.g+e.b)/3<=127?"#FFFFFF":"#000000"},u.prototype.hexToRgb=function(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null},u.prototype.createCurrentDataItem=function(t,e){var a=parseFloat(t.close),i=parseFloat(e),s=a<i?t.close:e,r=a>i?t.close:e;return{open:t.close,close:e,low:s,high:r,date:t.date+this.chartData.getCurrentTimeStep(),isCurrentData:!0}},u.prototype.drawCrosshairChart=function(t){if(this.isPressed||!this.isShowCrosshair||!this.useCanvas||!t)return this.crosshair.text.spanValue.parentNode.style.display="none",this.crosshair.text.spanDate.parentNode.style.display="none",!1;var e=this.crosshair.showData,a=this.curX,i=this.curY;if(!e||0===e.length)return!1;var s=this.getElementIndexByPositionX(e,a);if(s<0)if(a>parseFloat(e[0].x))s=0;else{if(!(a<parseFloat(e[e.length-1].x)))return!1;s=e.length-1}var r=e[s];return!!r&&(this.getStepedCursorParams(a,i,e[0],e[e.length-1],r),this.isShowCrosshair?this.showCrosshair(t):this.crosshair.text.spanValue.parentNode.style.display="none",this.crosshair.isUpdatedTime&&this.updateDataPanel(r),r)},u.prototype.showCrosshair=function(t){var e,a=this.parentRect.height-this.offY,i=this.crosshair.width,s=(this.curX,this.curY),r=this.chartData.colors.Chart.colorCrossHair,n=parseInt(this.chartData.options.Chart.widthCrossHair),o=this.chartData.options.Chart.scalesFontSize,h=this.getLineTypeArray(this.chartData.options.Chart.typeCrossHair,n);if(this.crosshair.params.x<this.w-8){e=LibCanvas.getPosition(this.crosshair.params.x,2),LibCanvas.drawLine(null,t,e,Math.round(a),e,0,r,h,2*n),this.crosshair.text.spanDate.parentNode.style.display="block",this.crosshair.text.spanDate.innerText=this.crosshair.params.time,this.crosshair.text.spanDate.style.textAlign="center",this.crosshairTextWidth||(this.crosshairTextWidth=this.crosshair.text.spanDate.parentNode.getBoundingClientRect().width);var c=this.crosshair.params.x-this.crosshairTextWidth/2-7;this.crosshair.params.x+this.crosshairTextWidth/2-7>this.w&&(c=this.w-this.crosshairTextWidth-7),this.crosshair.params.x-this.crosshairTextWidth/2<0&&(c=0),this.crosshair.text.spanDate.parentNode.style.left=c.toFixed(1)+"px",this.crosshair.text.spanDate.parentNode.style.top=a.toFixed(1)+"px"}else this.crosshair.text.spanDate.parentNode.style.display="none";var l=this.crosshair.params.value,d=this.chartData.options.Chart.typeTick;if(l="Default"!==d?this.getValueFromTick(l,d):this.crosshair.params.value,s<a){var p;if(this.crosshair.text.spanValue.parentNode.style.display="block",s>this.h){l="";for(var u=Object.keys(this.oscillatorCharts),g=0;g<u.length&&(p=this.oscillatorCharts[u[g]].getCurrPrecission(),!(l=this.oscillatorCharts[u[g]].getValue(s,p)));g++);}if(!l)return void(this.crosshair.text.spanValue.parentNode.style.display="none");e=LibCanvas.getPosition(this.crosshair.params.y,2),LibCanvas.drawLine(null,t,Math.round(i)+this.offX,e,0,e,r,h,2*n),this.crosshair.text.spanValue.innerText=l,this.crosshair.text.spanValue.style.fontSize=o+"px",this.crosshairTextHeight||(this.crosshairTextHeight=this.crosshair.text.spanValue.parentNode.getBoundingClientRect().height),this.crosshair.text.spanValue.parentNode.style.right="0",this.crosshair.text.spanValue.parentNode.style.left=i-this.priceOffset+"px",this.crosshair.text.spanValue.parentNode.style.top=e-this.crosshairTextHeight/2+"px"}else this.crosshair.text.spanValue.parentNode.style.display="none"},u.prototype.moveCrosshairXY=function(t,e,a,i,s){this.crosshair.showData=t,this.crosshair.width=i,this.crosshair.height=s},u.prototype.getStepedCursorParams=function(t,e,a,i,s){var r=this.crosshair.params.value,n=this.crosshair.params.time,o=this.getStepedCursorParamsX(t,a,i,s),h=o.dateSeconds;if(t=o.x,this.crosshair.params.dateSeconds!==h){var c=new Date(1e3*h),l=this.getLocalizedTimeText(c,this.chartData.localization,5,this.chartData.timeMode);this.crosshair.params.dateSeconds=h,this.crosshair.params.time=l}this.crosshair.params.x=t;var d=this.getStepedCursorParamsY(e,s);e=d.y;var p=d.value;this.crosshair.params.y=e,this.crosshair.params.value=p,this.crosshair.isUpdatedTime=n!==this.crosshair.params.time,this.crosshair.isUpdatedValue=r!==this.crosshair.params.value},u.prototype.getStepedCursorParamsY=function(t,e){var a=t;if(this.isMagnetModeOn()&&Number(this.crosshair.params.x)===Number(e.x)){var i=this.magnetDistance,s=this.toYPixels(e.open);Math.abs(s-t)<i&&(a=s,i=Math.abs(s-t));var r=this.toYPixels(e.low);Math.abs(r-t)<i&&(a=r,i=Math.abs(r-t));var n=this.toYPixels(e.high);Math.abs(n-t)<i&&(a=n,i=Math.abs(n-t));var o=this.toYPixels(e.close);Math.abs(o-t)<i&&(a=o,i=Math.abs(r-t))}return{y:a,value:this.toYValue(a)}},u.prototype.isMagnetModeOn=function(){var t=this.chartData.editDrawingObject&&this.chartData.editDrawingObject.isPressed&&!this.chartData.editDrawingObject.isObjectEdit,e=this.chartData.state.indexOf("drawing")>-1;return this.chartData.isMagnetMode&&(e||t)},u.prototype.getStepedCursorParamsX=function(t,e,a,i){var s,r=this.crosshair.params.dateSeconds;return t>e.x?(t=(s=Math.floor((this.curX-e.x)/this.chartData.spacing))*this.chartData.spacing+parseFloat(e.x))!==this.crosshair.params.x&&(r=e.date+s*this.chartData.getCurrentTimeStep()):t<a.x?(s=Math.floor((a.x-t)/this.chartData.spacing),(t=parseFloat(a.x)-s*this.chartData.spacing)!==this.crosshair.params.x&&(r=a.date-s*this.chartData.getCurrentTimeStep(),this.crosshair.params.x=t)):(t=parseFloat(i.x))!==this.crosshair.params.x&&(r=i.date,this.crosshair.params.x=t),{x:t,dateSeconds:r}},u.prototype.setCursorType=function(t){this.chartData.cursorType=t;for(var e=this.divEventListener.classList;e.length>1;)e.remove(e.item(1));e.add("tch-cursor-"+t)},u.prototype.getLineTypeArray=function(t,e){switch(t){case"normal":return[2*e,0];case"dash":return[5*e,2*e];case"points":return[2*e,2*e];default:return[]}},u.prototype.drawPips=function(t){var e,a,i=this.chartData.scaleParams,s=this.chartData.chart.curY,r=this.chartData.chart.curX,n=this.h,o=this.chartData.currentValue[this.chartData.typeData],h=this.chartData.colors.Chart.pipsColor;if(!(s>n)){var c=this.calculationsForDrawPips(i,s,r,n,o);LibCanvas.drawLine(null,t,c.left,c.downY,c.left,c.upY,h,[],2),this.drawPipsValue(t,c.left,c.upY,s,i,n,o),e=this.createArrArrowDown(c.left,c.downY),LibCanvas.drawPolygon(null,t,e,null,h,!1,2,e.length),a=this.createArrArrowUp(c.left,c.upY),LibCanvas.drawPolygon(null,t,a,null,h,!1,2,a.length)}},u.prototype.calculationsForDrawPips=function(t,e,a,i,s){var r=i-(s/t.deltaY-t.minB/t.deltaY);return{downY:Math.max(e,r)-1,upY:Math.min(e,r)+1,left:a>150?a-80:a+80}},u.prototype.createArrArrowUp=function(t,e){if(isNaN(parseFloat(t))||!isFinite(t)||isNaN(parseFloat(e))||!isFinite(e))return[];var a=[];return t=+t,e=+e,a.push([t-5,e+5]),a.push([t,e]),a.push([t+5,e+5]),a},u.prototype.createArrArrowDown=function(t,e){if(isNaN(parseFloat(t))||!isFinite(t)||isNaN(parseFloat(e))||!isFinite(e))return[];var a=[];return t=+t,e=+e,a.push([t-5,e-5]),a.push([t,e]),a.push([t+5,e-5]),a},u.prototype.drawPipsValue=function(t,e,a,i,s,r,n){t.font="13px Arial";var o=this.chartData.colors.Chart.pipsColor,h=this.calculationsForDrawPipsValue(s,i,a,n,r);e-=t.measureText(h.pips).width+7,LibCanvas.drawText(null,t,e,h.textY,h.pips,"12px Segoe UI",o)},u.prototype.calculationsForDrawPipsValue=function(t,e,a,i,s){var r=+t.minB+t.deltaY*(s-e),n=i.split(".");return{pips:Math.abs(r-parseFloat(i)).toFixed(n[n.length-1].length),textY:Math.max(65,a-14)}},u.prototype.getVariable=function(t,e){return String(t.getPropertyValue(e)).trim()},u.prototype.deactivateChart=function(){if(this.parent){this.parent.classList.remove("tch-active"),this.parent.querySelector(".tch-line-settings-container").classList.toggle("tch-hidden",!0);var t=!1;this.chartData.activeDrawingObject&&(this.chartData.activeDrawingObject.state="normal",this.chartData.activeDrawingObject=null,t=!0),this.chartData.editDrawingObject&&(this.chartData.editDrawingObject.state="normal",this.chartData.editDrawingObject=null,t=!0),t&&(this.redrawInfo(),this.redrawDrawingObjects())}},u.prototype.setActiveChart=function(t){if(t||this.chartData.index!==this.chartData.techChart.activeChartIndex){var e=this.chartData.techChart.getActiveChartData().state;this.chartData.state=e,this.chartData.techChart.setActiveChartProps(this.chartData);for(var a=this.chartData.techChart.charts,i=0;i<a.length;i++)i!==this.chartData.techChart.activeChartIndex&&a[i].deactivateChart();if(a.length>1&&a[this.chartData.techChart.activeChartIndex].parent.classList.add("tch-active"),!1===this.chartData.isStayDrawingMode&&"drawingRoulete"===this.chartData.state&&(this.chartData.state="default",this.chartData.techChart.setRouleteBtn("Off")),this.chartData.techChart.setActiveChartParams(),this.chartData.drawingObjects.length)for(var s=0;s<this.chartData.drawingObjects.length;s++)(this.chartData.drawingObjects[s].drawingStage.current===this.chartData.drawingObjects[s].drawingStage.max&&"curve"===this.chartData.drawingObjects[s].name||this.chartData.drawingObjects[s].drawingStage.current<this.chartData.drawingObjects[s].drawingStage.max)&&(this.removeDrawingObjectsOtherCharts(this.chartData.drawingObjects[s]),this.chartData.drawingObjects[s].remove(),this.redrawDrawingObjects(),this.redrawDrawingObjectsOtherCharts())}},u.prototype.getMaxB=function(t,e,a,i){var s=e/2;return t>1e-8&&(s=a*t),(parseFloat(parseFloat(e).toFixed(i))+Math.ceil(Math.pow(10,i)*s)/Math.pow(10,i)).toFixed(i)},u.prototype.getMinB=function(t,e,a,i){var s=e/2;return t>1e-8&&(s=a*t),(parseFloat(parseFloat(e).toFixed(i))-Math.ceil(Math.pow(10,i)*s)/Math.pow(10,i)).toFixed(i)},u.prototype.getDeltaYforBoundsCalculation=function(t,e,a,i,s){return parseInt(Math.pow(10,12)*(parseFloat(e)-parseFloat(t))/(a-(i+s)))/Math.pow(10,12)},u.prototype.getScaleParams=function(t,e,a){if(!t||0===t.length||!this.chartData.options.Chart.autoScale)return this.chartData.scaleParams;var i=this.getMaxValue(t,a),s=this.getMinValue(t,a),r=this.getDeltaYforBoundsCalculation(s,i,e,this.chartData.marginTop,this.chartData.marginBottom),n=this.getMaxB(r,i,this.chartData.marginTop,a),o=this.getMinB(r,s,this.chartData.marginBottom,a);return{minB:o,maxB:n,deltaY:parseInt(1e11*(n-o)/e)/1e11,minV:s,maxV:i}},u.prototype.getOscillatorsScaleParams=function(){for(var t=0;t<this.chartData.indicators.length;t++){var e=this.chartData.indicators[t];if("oscillator"===e.type){var a=this.oscillatorCharts[e.id];e.createData(this.chartData.data[this.chartData.typeData]),e.createShowData(),a.scaleParams=a.getScaleParams(e.showData,parseInt(this.chartData.precission))}}},u.prototype.getScaleParamsByExtremum=function(t,e,a,i,s,r){var n=this.getDeltaYforBoundsCalculation(t,e,s,a,i),o=this.getMaxB(n,e,a,r),h=this.getMinB(n,t,i,r);return{minB:h,maxB:o,deltaY:parseInt(Math.pow(10,12)*(o-h)/s)/Math.pow(10,12),minV:t,maxV:e}},u.prototype.checkExtremum=function(t,e){return e<t.min&&(t.min=e),e>t.max&&(t.max=e),t},u.prototype.getLastDate=function(t){var e=null;return t&&t.length&&(e=t[t.length-1].date),e},u.prototype.getDataToRight=function(t,e,a,i,s){var r=e[0],n=parseFloat(r.x),o=r.date,h=this.getNumberOfDataToRight(n,a,i,s),c=this.getIndexByDate(t,o),l=[];return c>-1&&c>0&&c-h>0?(l=t.slice(c-h,c),this.chartData.hasNextData&&!this.chartData.isWaitFallBackData&&c<this.chartData.fallBack/2&&(this.chartData.isWaitFallBackData=!0,this.getDataOnMove(this,-this.chartData.fallBack/2,this.chartData.data[this.chartData.typeData][0].date,!0))):this.chartData.hasNextData?(l=[],this.getDataOnMove(this,-h,o)):c>-1&&c-h<=0&&(l=t.slice(0,c)),l},u.prototype.getDataToLeft=function(t,e,a){var i=e[e.length-1],s=parseFloat(i.x),r=i.date,n=Math.ceil(s/a),o=this.getIndexByDate(t,r),h=[];if(o>-1&&o<t.length-1){h=t.slice(o+1,o+n+1);var c=e.length>this.chartData.fallBack?e.length:this.chartData.fallBack;this.chartData.hasPrevData&&!this.chartData.isWaitFallBackData&&o>this.chartData.data[this.chartData.typeData].length-c&&(this.chartData.isWaitFallBackData=!0,this.getDataOnMove(this,this.chartData.fallBack/2,this.chartData.data[this.chartData.typeData][this.chartData.data[this.chartData.typeData].length-1].date,!0))}else this.chartData.hasPrevData&&(h=[],this.getDataOnMove(this,n,r));return h},u.prototype.getDataOnMove=function(t,e,a,i){this.waitForData||(e<0?i?this.chartData.getExtraData(this.chartData,a,e,this.chartData.getFallBackDataOnMoveToLeftComplete):this.chartData.getExtraData(this.chartData,a,e,this.chartData.getExtraDataOnMoveToLeftComplete):i?this.chartData.getExtraData(this.chartData,a,e,this.chartData.getFallBackDataOnMoveToRightComplete):this.chartData.getExtraData(this.chartData,a,e,this.chartData.getExtraDataOnMoveToRightComplete))},u.prototype.getFallBackDataOnMoveToLeftComplete=function(t){t.chartData.isWaitFallBackData=!1},u.prototype.getFallBackDataOnMoveToRightComplete=function(t){t.chartData.isWaitFallBackData=!1},u.prototype.getDataOnMoveToRightComplete=function(t,e){t.addElementsToLeft(t.showData,e,t.chartData.spacing,t.w,t.chartData.rightPadding)},u.prototype.getDataOnMoveToLeftComplete=function(t,e){t.addElementsToRight(t.showData,e,t.chartData.spacing,t.w,t.chartData.rightPadding)},u.prototype.addElementsToRight=function(t,e,a,i,s){for(var r=this.createShowDataToAdd(e),n=r.length-1;n>=0&&(e[n].isCurrentData&&(r[n].isCurrentData=!0),this.addElementToRight(t,r[n],a,i,s),!(parseFloat(t[0].x)>=i-s));n--);},u.prototype.addElementToRight=function(t,e,a,i,s){var r=parseFloat(t[0].x),n=t[0].date;if(e.date>n){var o=r+a;o>i-s&&(o=i-s),e.x=o.toFixed(1),this.resizeShowItemValuesY(e,this.h,this.chartData.scaleParams),t.unshift(e)}},u.prototype.addElementsToLeft=function(t,e,a){for(var i=this.createShowDataToAdd(e),s=0;s<i.length&&(this.addElementToLeft(t,i[s],a),!(parseFloat(t[t.length-1].x)<=0));s++);},u.prototype.addElementToLeft=function(t,e,a){var i=parseFloat(t[t.length-1].x);if(e.date<t[t.length-1].date){var s=i-a;s<0&&(s=0),e.x=s.toFixed(1),this.resizeShowItemValuesY(e,this.h,this.chartData.scaleParams),t[t.length]=e}},u.prototype.drawIndicators=function(){for(var t=0;t<this.chartData.indicators.length;t++)this.chartData.indicators[t].data&&("oscillator"===this.chartData.indicators[t].type&&this.oscillatorCharts[this.chartData.indicators[t].id].clear(),this.chartData.indicators[t].draw())},u.prototype.drawIchimoku=function(t,e,a){for(var i,s,r,n={TenkanSen:[],KijunSen:[],ChinkouSpan:[],SenkouSpanA:[],SenkouSpanB:[]},o=0;o<e.length;o++)if(void 0!==e[o]){var h=this.toXPixels(e[o].T);h=h.toFixed(1);var c=void 0;e[o].TenkanSen&&(c=this.toYPixels(e[o].TenkanSen),n.TenkanSen.push([h,c])),e[o].KijunSen&&(c=this.toYPixels(e[o].KijunSen),n.KijunSen.push([h,c])),e[o].ChinkouSpan&&(c=this.toYPixels(e[o].ChinkouSpan),n.ChinkouSpan.push([h,c])),e[o].SenkouSpanA&&(c=this.toYPixels(e[o].SenkouSpanA),n.SenkouSpanA.push([h,c])),e[o].SenkouSpanB&&(c=this.toYPixels(e[o].SenkouSpanB),n.SenkouSpanB.push([h,c]))}for(var l in n)n.hasOwnProperty(l)&&LibCanvas.drawPolygon(null,a,n[l],null,t.colors[l],!1,t.lineWidth[l],n[l].length);for(var d=[],p=[],u="init",g=0;g<n.SenkouSpanB.length&&n.SenkouSpanA[g];g++)parseFloat(n.SenkouSpanA[g][1])<parseFloat(n.SenkouSpanB[g][1])?"A"===u?(p.push(n.SenkouSpanA[g]),p.unshift(n.SenkouSpanB[g])):("init"!==u&&(i={P1:n.SenkouSpanA[g-1],P2:n.SenkouSpanA[g]},s={P1:n.SenkouSpanB[g-1],P2:n.SenkouSpanB[g]},r=this.getCrossPoint(i,s),p.push(r),d.push({cloud:p,mark:"B"}),(p=[]).push(r)),p.push(n.SenkouSpanA[g]),p.unshift(n.SenkouSpanB[g]),u="A"):parseFloat(n.SenkouSpanA[g][1])>parseFloat(n.SenkouSpanB[g][1])?"B"===u?(p.unshift(n.SenkouSpanB[g]),p.push(n.SenkouSpanA[g])):("init"!==u&&(i={P1:n.SenkouSpanA[g-1],P2:n.SenkouSpanA[g]},s={P1:n.SenkouSpanB[g-1],P2:n.SenkouSpanB[g]},r=this.getCrossPoint(i,s),p.push(r),d.push({cloud:p,mark:"A"}),(p=[]).push(r)),p.push(n.SenkouSpanA[g]),p.unshift(n.SenkouSpanB[g]),u="B"):parseFloat(n.SenkouSpanA[g][1])===parseFloat(n.SenkouSpanB[g][1])&&(p.push(n.SenkouSpanA[g]),p.unshift(n.SenkouSpanB[g]));p.length&&d.push({cloud:p,mark:u});for(var v=0;v<d.length;v++)d[v].cloud&&d[v].cloud.length&&LibCanvas.drawPolygon(null,a,d[v].cloud,this.hexToRgbA(t.colors[d[v].mark],t.opacity[d[v].mark]),null)},u.prototype.getCrossPoint=function(t,e){var a=parseFloat(t.P1[0]),i=parseFloat(t.P2[0]),s=parseFloat(e.P1[0]),r=parseFloat(e.P2[0]),n=parseFloat(t.P1[1]),o=parseFloat(t.P2[1]),h=parseFloat(e.P1[1]),c=parseFloat(e.P2[1]),l=((r-s)*(n-h)-(c-h)*(a-s))/((c-h)*(i-a)-(r-s)*(o-n));return[a+l*(i-a),n+l*(o-n)]},u.prototype.hexToRgbA=function(t,e){if(t.indexOf("rgba")>-1)return t;if(t.indexOf("rgb")>-1)return t.replace(")",","+e+" )").replace("rgb","rgba");var a;if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(t))return 3===(a=t.substring(1).split("")).length&&(a=[a[0],a[0],a[1],a[1],a[2],a[2]]),"rgba("+[(a="0x"+a.join(""))>>16&255,a>>8&255,255&a].join(",")+","+e+")";throw new Error("Bad Hex")},u.prototype.drawFractal=function(t,e,a){for(var i,s,r,n,o,h,c,l,d=this.chartData.candleWidth,p=0;p<e.length;p++)void 0!==e[p]&&(i=!1,e[p].fractalHigh&&(i=this.toXPixels(e[p].T),n=(s=this.getFractalItemY(e[p],"high")-d/2)-d,h=s,l=s,r=i,o=i-d/2,c=i+d/2,LibCanvas.drawPolygon(null,a,[[r,n],[o,h],[c,l]],t.colors.line,null)),e[p].fractalLow&&(i||(i=this.toXPixels(e[p].T)),n=(s=this.getFractalItemY(e[p],"low")+d/2)+d,h=s,l=s,r=i,o=i-d/2,c=i+d/2,LibCanvas.drawPolygon(null,a,[[r,n],[o,h],[c,l]],t.colors.line,null)))},u.prototype.drawSar=function(t,e,a){for(var i,s,r,n,o,h,c,l,d,p,u=this.chartData.candleWidth,g=0;g<e.length;g++)void 0!==e[g]&&(i=this.toXPixels(e[g].T),h=s=this.toYPixels(e[g].P).toFixed(1),l=s,p=(n=s-u)+2*u,r=i,o=i-u/2,c=i+u/2,d=i,LibCanvas.drawPolygon(null,a,[[r,n],[o,h],[d,p],[c,l]],t.colors.line,null))},u.prototype.drawBollingerBandsIndicator=function(t,e,a){if(e&&0!==e.length&&parent){for(var i={L:[],M:[],U:[]},s=0;s<e.length;s++)if(void 0!==e[s]){var r=this.toXPixels(e[s].T);r>=0&&r<=this.w-this.chartData.rightPadding&&(i.L.push([r.toFixed(1),this.toYPixels(e[s].L).toFixed(1)]),i.M.push([r.toFixed(1),this.toYPixels(e[s].M).toFixed(1)]),i.U.push([r.toFixed(1),this.toYPixels(e[s].U).toFixed(1)]))}var n=i.L.concat(i.U.reverse());LibCanvas.drawPolygon(null,a,n,this.hexToRgbA(t.colors.cloud,t.opacity.cloud),null),LibCanvas.drawPolygon(null,a,i.L,null,t.colors.L,!1,t.lineWidth.L,i.L.length),LibCanvas.drawPolygon(null,a,i.M,null,t.colors.M,!1,t.lineWidth.M,i.L.length),LibCanvas.drawPolygon(null,a,i.U,null,t.colors.U,!1,t.lineWidth.U,i.L.length)}},u.prototype.drawLinePT=function(t,e,a){var i=this;if(e[0]){var s=e.map(function(t){return[i.toXPixels(t.T).toFixed(1),i.toYPixels(t.P).toFixed(1)]});LibCanvas.drawPolygon(null,a,s,null,t.colors.line,!1,t.lineWidth.line,s.length)}},u.prototype.updateIndicatorsDataPanel=function(t){this.chartData.techChart.updateIndicatorsDataPanel(t)},u.prototype.createIndicatorsShowData=function(){for(var t=0;t<this.chartData.indicators.length;t++)this.chartData.indicators[t].data&&0!==this.chartData.indicators[t].data.length||this.chartData.indicators[t].createData(this.chartData.data[this.chartData.typeData]),this.chartData.indicators[t].createShowData();this.resizeShowDataByTrendIndicators(),this.getOscillatorsScaleParams()},u.prototype.resizeShowDataByTrendIndicators=function(){var t=!1;if(this.chartData.options.Chart.autoScale&&!this.chartData.options.Chart.scaleSeriesOnly){var e=this.indicatorsGetExtremum(),a=this.chartData.scaleParams.minB,i=this.chartData.scaleParams.maxB;e.min<a&&(a=e.min),e.max>i&&(i=e.max),(i>this.chartData.scaleParams.maxB||a<this.chartData.scaleParams.minB)&&(this.chartData.scaleParams=this.getScaleParamsByExtremum(a,i,this.chartData.marginTop,this.chartData.marginBottom,this.h,this.chartData.precission),this.resizeShowDataValuesY(this.showData,this.h,this.chartData.scaleParams),t=!0)}return t},u.prototype.setScaleSeriesOnly=function(){if(this.chartData.options.Chart.autoScale&&!this.chartData.options.Chart.scaleSeriesOnly){var t=this.indicatorsGetExtremum(),e=this.chartData.scaleParams.minB,a=this.chartData.scaleParams.maxB;t.min<e&&(e=t.min),t.max>a&&(a=t.max),a===this.chartData.scaleParams.maxB&&e===this.chartData.scaleParams.minB||(this.chartData.scaleParams=this.getScaleParamsByExtremum(e,a,this.chartData.marginTop,this.chartData.marginBottom,this.h,this.chartData.precission),this.resizeShowDataValuesY(this.showData,this.h,this.chartData.scaleParams))}},u.prototype.applyChartHight=function(t){this.h=t.chart.height,this.top=t.chart.top,this.chartData.h=this.h,this.chartData.top=this.top},u.prototype.applyIndicatorsHeights=function(t){for(var e=0;e<this.chartData.indicators.length;e++){var a=this.chartData.indicators[e].id;t.oscCharts[a]&&this.chartData.indicators[e].applyIndicatorHeight(t.oscCharts[a],this)}},u.prototype.calculateHeightOnCreate=function(t,e,a){a-=this.offY;var i=t?Object.keys(t).length:0,s=a/(i+3),r=a-s,n={},o=s;if(i>0){var h,c,l=s/a;for(var d in t)t.hasOwnProperty(d)&&(n[(h=t[d]).id]={},n[h.id].height=h.h-h.h*l,c=n[h.id].height/h.h,n[h.id].top=h.top*c,o+=n[h.id].height);e=a-o}else e=a-s;return{newElement:{height:parseInt(s),top:parseInt(r)},chart:{height:parseInt(e),top:0},oscCharts:n}},u.prototype.calculateHeightOnDelete=function(t,e,a){a-=this.offY;var i=t?Object.keys(t).length:0,s=this.h,r=this.top,n={},o=a/(a-e.h);if(i>1){var h;for(var c in t)t.hasOwnProperty(c)&&(n[(h=t[c]).id]={},n[h.id].top=h.top>e.top?h.top-e.h:h.top,n[h.id].top=parseInt(o*n[h.id].top),n[h.id].height=parseInt(h.h*o));r>e.top&&(r-=e.h),r*=o,s=this.h*o}else s=a;return{chart:{height:parseInt(s),top:parseInt(r)},oscCharts:n}},u.prototype.removeIndicator=function(t){var e=this.chartData.getIndicatorIndex(this.chartData.indicators,t);if("trend"===t.type)this.chartData.indicators.splice(e,1),this.draw(this.showData,this.h);else if("oscillator"===t.type){var a=parseInt(this.parent.style.height),i=this.calculateHeightOnDelete(this.oscillatorCharts,this.chartData.indicators[e],a);this.chartData.indicators.splice(e,1),delete this.oscillatorCharts[t.id],this.applyChartHight(i),this.applyIndicatorsHeights(i),this.init()}},u.prototype.redrawOscillators=function(){for(var t=0;t<this.chartData.indicators.length;t++)if("oscillator"===this.chartData.indicators[t].type){var e=this.chartData.indicators[t];this.chartData.indicators[t].isChanged&&(this.oscillatorCharts[e.id].clear(),this.oscillatorCharts[e.id].redrawOnResize(),e.draw())}},u.prototype.indicatorsGetExtremum=function(){for(var t=this.chartData.indicators,e=Number.MAX_VALUE,a=Number.MIN_VALUE,i=0;i<t.length;i++)if("trend"===t[i].type&&!t[i].hidden&&t[i].showData&&t[i].showData.length){var s=this.indicatorGetExtremum(t[i]);s.min<e&&(e=s.min),s.max>a&&(a=s.max)}return{min:e,max:a}},u.prototype.indicatorGetExtremum=function(t){var e={};switch(t.name.toLowerCase()){case"sma":case"ema":e=this.getExtremumPT(t.showData);break;case"bb":e=this.getExtremumBollingerBands(t.showData);break;case"fractal":e=this.getExtremumFractal(t.showData);break;case"ichimoku":e=this.getExtremumIchimoku(t.showData);break;case"macd":e=this.getExtremumMACD(t.showData);break;case"env":case"keltner":case"donchian":e=this.getExtremumBollingerBands(t.showData);break;case"dema":e=this.getExtremumPT(t.showData)}return e},u.prototype.getExtremumMACD=function(t){for(var e={min:Number.MAX_VALUE,max:Number.MIN_VALUE},a=0;a<t.length;a++){var i=t[a].macdHistogram;i&&this.checkExtremum(e,i),(i=t[a].macdLine)&&this.checkExtremum(e,i),(i=t[a].signalLine)&&this.checkExtremum(e,i)}return e},u.prototype.getExtremumPT=function(t){for(var e={min:Number.MAX_VALUE,max:Number.MIN_VALUE},a=0;a<t.length;a++)this.checkExtremum(e,t[a].P);return e},u.prototype.getExtremumBollingerBands=function(t){for(var e={min:Number.MAX_VALUE,max:Number.MIN_VALUE},a=0;a<t.length;a++)this.checkExtremum(e,t[a].L),this.checkExtremum(e,t[a].U);return e},u.prototype.getExtremumFractal=function(t){for(var e={min:Number.MAX_VALUE,max:Number.MIN_VALUE},a=0;a<t.length;a++)t[a].fractalHigh&&this.checkExtremum(e,t[a].fractalHigh),t[a].fractalLow&&this.checkExtremum(e,t[a].fractalLow);return e},u.prototype.getExtremumIchimoku=function(t){for(var e={min:Number.MAX_VALUE,max:Number.MIN_VALUE},a=0;a<t.length;a++){var i=t[a].TenkanSen;i&&this.checkExtremum(e,i),(i=t[a].KijunSen)&&this.checkExtremum(e,i),(i=t[a].ChinkouSpan)&&this.checkExtremum(e,i),(i=t[a].SenkouSpanA)&&this.checkExtremum(e,i),i=t[a].SenkouSpanB,t[a].SenkouSpanB&&this.checkExtremum(e,i)}return e},u.prototype.toXPixels=function(t){if(isNaN(t)||!this.showData||this.showData.length<=0)return!1;var e=this.getNearestCandleIndex(t),a=this.showData[e].date,i=a-t,s=this.chartData.getCurrentTimeStep();if(i>s&&this.showData[e+1])return parseFloat(this.showData[e+1].x);0===e&&this.showData[e+1]?(e++,i=(a=this.showData[e].date)-t):e===this.showData.length-1&&this.showData[e-1]&&(e--,i=(a=this.showData[e].date)-t);var r=this.chartData.spacing,n=Math.abs(s/r);return parseFloat(this.showData[e].x)-i/n},u.prototype.toXValue=function(t){if(isNaN(t)||!this.showData||0===this.showData.length)return!1;var e=this.showData,a=this.getElementIndexByPositionX(e,t);-1===a&&(a=0);var i=e[a].x,s=this.chartData.spacing,r=this.chartData.getCurrentTimeStep(),n=Math.abs(r/s),o=i-t;return e[a].date-o*n},u.prototype.toYValue=function(t,e){if(isNaN(t))return!1;var a=this.h,i=parseFloat(this.chartData.scaleParams.minB)+this.chartData.scaleParams.deltaY*(a-t),s=e||this.chartData.precission;return i.toFixed(s)},u.prototype.toYPixels=function(t){return!isNaN(t)&&this.h-(t-this.chartData.scaleParams.minB)/this.chartData.scaleParams.deltaY},u.prototype.getDrawingObjectIndexByType=function(t){for(var e=0;e<this.chartData.drawingObjects.length;e++)if(this.chartData.drawingObjects[e].constructor.name===t)return e;return-1},u.prototype.moveDrawingObjects=function(t,e){for(var a=0;a<this.chartData.drawingObjects.length;a++)this.chartData.options.Chart.autoScale?(this.chartData.drawingObjects[a].shiftTo(t,0),this.chartData.drawingObjects[a].updateYPixels()):this.chartData.drawingObjects[a].shiftTo(t,e)},u.prototype.moveDrawingObjectsX=function(t){this.moveDrawingObjects(t,0)},u.prototype.moveDrawingObjectsY=function(t){this.moveDrawingObjects(0,t)},u.prototype.clearDrawingCanvas=function(){var t=this.canvasDrawingContext,e=t.canvas;LibCanvas.clearRect(null,t,0,0,e.width,e.height)},u.prototype.clearDrawingActiveCanvas=function(){var t=this.canvasDrawingActiveContext,e=t.canvas;LibCanvas.clearRect(null,t,0,0,e.width,e.height)},u.prototype.redrawDrawingObjects=function(){if(this.clearDrawingCanvas(),this.chartData.isShowDrawingObjects){this.drawingTextContainer.classList.toggle("tch-hidden",!1);for(var t=0;t<this.chartData.drawingObjects.length;t++)if("normal"===this.chartData.drawingObjects[t].state||"active"===this.chartData.drawingObjects[t].state){if(this.chartData.drawingObjects[t].periods.length&&!this.chartData.drawingObjects[t].periods.indexOf(this.chartData.period))continue;this.chartData.drawingObjects[t].draw(this.canvasDrawingContext)}}else this.drawingTextContainer.classList.toggle("tch-hidden",!0)},u.prototype.getDrawingObjectDTOsOtherCharts=function(){for(var t=[],e=this.chartData.techChart.charts,a=0;a<e.length;a++)a!==this.chartData.techChart.activeChartIndex&&e[a].chartData.pair.ID===this.chartData.pair.ID&&e[a].chartData.drawingObjects.length&&(t=e[a].chartData.convertDrawingObjectsToDTO());return t},u.prototype.removeAllDrawingObjectsOtherCharts=function(){for(var t=this.chartData.techChart.charts,e=0;e<t.length;e++)e!==this.chartData.techChart.activeChartIndex&&t[e].chartData.pair.ID===this.chartData.pair.ID&&t[e].removeAllDrawingObjects()},u.prototype.redrawAllDrawingObjectsOtherCharts=function(){for(var t=this.chartData.techChart.charts,e=0;e<t.length;e++)e!==this.chartData.techChart.activeChartIndex&&t[e].chartData.pair.ID===this.chartData.pair.ID&&t[e].redrawDrawingObjects()},u.prototype.removeEditDrawingObject=function(){var t=this.chartData.editDrawingObject;t&&(this.removeDrawingObjectsOtherCharts(t),this.chartData.editDrawingObject.remove(),this.redrawInfo(),this.redrawAllDrawingObjectsOtherCharts(),this.chartData.techChart.autoSaveParams())},u.prototype.drawActiveDrawingObjects=function(t){(t||this.chartData.editDrawingObject&&this.chartData.editDrawingObject.isObjectEdit)&&(this.chartData.editDrawingObject||this.chartData.activeDrawingObject)&&this.chartData.isShowDrawingObjects&&(LibCanvas.clearRect(null,this.canvasDrawingActiveContext,0,0,this.canvasDrawingActive.width,this.canvasDrawingActive.height),this.chartData.editDrawingObject&&this.chartData.editDrawingObject.draw(this.canvasDrawingActiveContext),this.chartData.activeDrawingObject&&this.chartData.activeDrawingObject.draw(this.canvasDrawingActiveContext)),this.chartData.activeDrawingObject||this.chartData.editDrawingObject||LibCanvas.clearRect(null,this.canvasDrawingActiveContext,0,0,this.canvasDrawingActive.width,this.canvasDrawingActive.height)},u.prototype.redrawDrawingObjectsOtherCharts=function(){for(var t=this.chartData.techChart.charts,e=0;e<t.length;e++)e!==this.chartData.techChart.activeChartIndex&&t[e].chartData.pair.ID===this.chartData.pair.ID&&(t[e].redrawDrawingObjects(),t[e].drawActiveDrawingObjects())},u.prototype.drawActiveDrawingObjectsOtherCharts=function(t){for(var e=this.chartData.techChart.charts,a=0;a<e.length;a++)if(a!==this.chartData.techChart.activeChartIndex&&e[a].chartData.pair.ID===this.chartData.pair.ID)for(var i=e[a].chartData.drawingObjects,s=0;s<i.length;s++)if(i[s].id===t){if("normal"===i[s].state)e[a].redrawDrawingObjects();else{var r=e[a].clearInfo();e[a].drawCrosshair(r,r.canvas.height,!1),e[a].drawActiveDrawingObjects()}break}},u.prototype.completeFigureOtherCharts=function(t){for(var e=this.chartData.techChart.charts,a=0;a<e.length;a++)if(a!==this.chartData.techChart.activeChartIndex&&e[a].chartData.pair.ID===this.chartData.pair.ID)for(var i=e[a].chartData.drawingObjects,s=0;s<i.length;s++)i[s].id===t&&i[s].completeFigure()},u.prototype.removeDrawingObjectsOtherCharts=function(t){for(var e=this.chartData.techChart.charts,a=0;a<e.length;a++)if(a!==this.chartData.techChart.activeChartIndex&&e[a].chartData.pair.ID===this.chartData.pair.ID)for(var i=e[a].chartData.drawingObjects,s=0;s<i.length;s++)if(i[s].id===t.id){i[s].remove();break}},u.prototype.createDrawingObjectOtherCharts=function(t,e,a){for(var i=this.chartData.techChart.charts,s=0;s<i.length;s++)if(s!==this.chartData.techChart.activeChartIndex&&i[s].chartData.pair.ID===this.chartData.pair.ID){var r=LibDrawing_LibDrawing.createDrawingObjectByType(t,[i[s].chartData,a]);if(r instanceof Roulete)continue;i[s].chartData.drawingObjects.push(r),r.id=e,r.state="normal"}},u.prototype.updateDrawingObjectsOtherChart=function(t){for(var e=this.chartData.techChart.charts,a=0;a<e.length;a++)if(a!==this.chartData.techChart.activeChartIndex&&e[a].chartData.pair.ID===this.chartData.pair.ID)for(var i=e[a].chartData.drawingObjects,s=0;s<i.length;s++)if(i[s].id===t.id){i[s].updateByObject(t);break}},u.prototype.getFocusedDrawingObject=function(t,e){for(var a=0;a<this.chartData.drawingObjects.length;a++)if(this.chartData.drawingObjects[a].isFocused(t,e))return this.chartData.drawingObjects[a];return!1},u.prototype.getDrawingObjectById=function(t){for(var e=0;e<this.chartData.drawingObjects.length;e++)if(this.chartData.drawingObjects[e].id===t)return this.chartData.drawingObjects[e];return null},u.prototype.updateDrawingObjectsPixels=function(){this.chartData.activeDrawingObject&&this.chartData.activeDrawingObject.updatePixels(),this.chartData.editDrawingObject&&this.chartData.editDrawingObject.updatePixels();for(var t=0;t<this.chartData.drawingObjects.length;t++)this.chartData.drawingObjects[t].updatePixels()},u.prototype.removeAllDrawingObjects=function(){for(this.chartData.editDrawingObject&&(this.chartData.editDrawingObject.remove(),this.chartData.editDrawingObject=null),this.chartData.activeDrawingObject&&(this.chartData.activeDrawingObject.remove(),this.chartData.activeDrawingObject=null);this.chartData.drawingObjects.length;)this.chartData.drawingObjects[0].remove();this.chartData.drawingObjects=[],this.redrawDrawingObjects(),this.redrawInfo()},u.prototype.redrawOnResize=function(){this.resizeChartHeight()},u.prototype.redrawGrid=function(){this.chartData.chart.getOscillatorChartsAxis(),this.clearGrid(),this.drawTimeAxis(this.timeAxis),this.drawValueAxis(this.valueAxis),this.drawOscillatorChartsAxis(),this.drawChartBorder()},u.prototype.redrawOnMove=function(){},u.prototype.resizeOscillatorOnMouseMove=function(){var t={};t.topParams=this.getTopResizedObjectsParams(),t.bottomParams=this.getBottomResizedObjectsParams(),this.isValidResizeObjectParmas(t)&&this.applyResizedObjectsParams(t)},u.prototype.applyResizedObjectsParams=function(t){if("oscillatorChart"===t.topParams.type){t.topParams.chart.h=t.topParams.newHeight,t.topParams.chart.top=t.topParams.newTop;var e=this.chartData.getIndicatorIndex(this.chartData.indicators,t.topParams.chart);this.chartData.indicators[e].h=t.topParams.chart.h,this.chartData.indicators[e].top=t.topParams.chart.top,t.topParams.chart.redrawOnResize()}else"chart"===t.topParams.type&&(this.h=t.topParams.chart.h,this.top=t.topParams.chart.top,this.chartData.h=t.topParams.chart.h,this.chartData.top=t.topParams.chart.top,this.redrawOnResize());if("oscillatorChart"===t.bottomParams.type){t.bottomParams.chart.h=t.bottomParams.newHeight;var a=this.chartData.getIndicatorIndex(this.chartData.indicators,t.bottomParams.chart);this.chartData.indicators[a].h=t.bottomParams.chart.h,t.bottomParams.chart.redrawOnResize()}else"chart"===t.bottomParams.type&&(this.h=t.bottomParams.newHeight,this.chartData.h=t.bottomParams.newHeight,this.redrawOnResize())},u.prototype.getTopResizedObjectsParams=function(){var t,e={},a=this.parent.querySelector(".tch-chart-resized-top");return a?(e.type="oscillatorChart",e.chart=a.chart,e.oldTop=parseFloat(a.style.top),e.newTop=this.curY+0,t=e.oldTop-e.newTop,e.oldHeight=a.chart.h,e.newHeight=e.oldHeight+t):this.parent.classList.contains("tch-chart-resized-top")&&(e.type="chart",e.chart=this,e.oldTop=this.top,e.newTop=this.curY,t=e.oldTop-e.newTop,e.oldHeight=this.h,e.newHeight=e.oldHeight+t),e},u.prototype.getBottomResizedObjectsParams=function(){var t,e={},a=this.parent.querySelector(".tch-chart-resized-bottom");return a?(e.type="oscillatorChart",e.chart=a.chart,e.oldBottom=a.chart.top+a.chart.h,e.newBottom=this.curY,t=e.oldBottom-e.newBottom,e.oldHeight=a.chart.h,e.newHeight=e.oldHeight-t):this.parent.classList.contains("tch-chart-resized-bottom")&&(e.type="chart",e.chart=this,e.oldBottom=this.top+this.h,e.newBottom=this.curY,t=e.oldBottom-e.newBottom,e.oldHeight=this.h,e.newHeight=e.oldHeight-t),e},u.prototype.isValidResizeObjectParmas=function(t){return!(!t.topParams.chart||!t.bottomParams.chart)&&!(t.topParams.newHeight<2*this.resizeEdgeHeight||t.bottomParams.newHeight<2*this.resizeEdgeHeight)},u.prototype.getSettingsPanelContainer=function(){var t=this.parent.querySelector(".tch-line-settings-container");return t.style.left=this.curX+"px",t.style.top=this.curY+"px",t},u.prototype.zoomArea=function(t){parseFloat(t.minValue)!==parseFloat(t.maxValue)&&(this.chartData.options.Chart.autoScale=!1,this.chartData.scaleParams.maxB=t.maxValue,this.chartData.scaleParams.minB=t.minValue,this.chartData.scaleParams.deltaY=(this.chartData.scaleParams.maxB-this.chartData.scaleParams.minB)/this.h,this.chartData.startDateSeconds=t.startDate,this.chartData.candleWidth=t.candleWidth,this.chartData.spacing=1.5*this.chartData.candleWidth,this.selectedData=this.selectDataToShow(this.chartData.data[this.chartData.typeData],this.chartData.startDateSeconds,this.chartData.spacing,this.w),this.showData=this.processDataToShow(this.selectedData,this.chartData.rightPadding+t.startX,this.chartData.spacing,this.w,this.h,this.chartData.precission),this.valueAxis=this.getValueAxis(this.chartData.scaleParams.minB,this.chartData.scaleParams.maxB,this.valueAxisCount,this.w,this.h,this.chartData.options.Chart.scalesFontSize,this.chartData.precission),this.timeAxis=this.getTimeAxis(this.showData,this.w,this.parentRect.height-this.offY,this.chartData.period,this.chartData.timeMode,this.chartData.localization),this.updateDrawingObjectsPixels(),this.resizeNewsBubbles(),this.resizeEventsBubbles(),this.draw(this.showData,this.h),this.clearGrid(),this.drawValueAxis(this.valueAxis),this.drawTimeAxis(this.timeAxis),this.getOscillatorChartsAxis(),this.drawChartBorder(),this.drawCurrentValue(),this.moveCrosshairXY(this.showData,this.curX,this.curY,this.w,this.h),this.redrawInfo())},u.prototype.zoomOut=function(){if(void 0!==this.chartData.zoomSteps&&0!==this.chartData.zoomSteps.length){var t=this.chartData.zoomSteps.pop();this.chartData.zoomData=t,this.zoomArea(this.chartData.zoomData),0===this.chartData.zoomSteps.length&&(this.chartData.options.Chart.autoScale=!0,this.chartData.techChart.parent.querySelector(".tch-zoomout-btn").disabled=!0)}},u.prototype.dropZoomSteps=function(){this.techChart.configuration.modules.sideBarButtons.zoomButton&&(this.chartData.zoomSteps=[],this.chartData.techChart.parent.querySelector(".tch-zoomout-btn").disabled=!0)},u.prototype.scaleZoomData=function(t){var e=Math.abs(t.startX-t.endX),a=Math.abs(t.startY-t.endY),i=Math.min(t.startY,t.endY),s=Math.min(t.startX,t.endX)+e,r=i+a,n=i;t.maxValue=this.toYValue(n),t.minValue=this.toYValue(r),t.startDate=this.toXValue(s),t.candleWidth=this.chartData.candleWidth*(this.w/e),t.startX=this.w-parseFloat(this.showData[0].x),t.click=e<50},u.prototype.zoomX=function(t,e,a){this.setChartZoomedSize(this.chartData.zoomView,e,-1*t),a=(a=isNaN(a)?this.getElementIndexByPositionX(this.showData,this.curX):a)>=0?a:0;var i=this.showData[a];if(i=this.correctionZoomX(i,a,t,this),this.showData=[],this.showData.push(i),this.selectedData=this.getSelectedDataByShowData(this.showData),this.needsElementToLeft(this.showData,this.chartData.spacing)){var s=this.getDataToLeft(this.chartData.data[this.chartData.typeData],this.showData,this.chartData.spacing);this.addElementsToLeft(this.showData,s,this.chartData.spacing)}if(this.needsElementToRight(this.showData,this.w,this.chartData.rightPadding,this.chartData.spacing)){var r=this.getDataToRight(this.chartData.data[this.chartData.typeData],this.showData,this.w,this.chartData.rightPadding,this.chartData.spacing);this.addElementsToRight(this.showData,r,this.chartData.spacing,this.w,this.chartData.rightPadding)}if(this.deleteRedundantElements(this.showData,0,this.w,this.chartData.rightPadding,this.chartData.spacing),this.chartData.startDateSeconds=this.showData[0].date,this.selectedData=this.getSelectedDataByShowData(this.showData),this.chartData.scaleParams=this.getScaleParams(this.selectedData,this.h,this.chartData.precission),this.resizeShowDataValuesY(this.showData,this.h,this.chartData.scaleParams),!this.chartData.data[this.chartData.typeData][0].isCurrentData&&!this.chartData.isExpired){var n=this.createCurrentDataItem(this.chartData.data[this.chartData.typeData][0],this.chartData.currentValue[this.chartData.typeData]);this.chartData.data[this.chartData.typeData].unshift(n),this.chartData.startDateSeconds=this.chartData.data[this.chartData.typeData][0].date}this.chartData.indicators&&this.chartData.indicators.length&&this.createIndicatorsShowData(),this.updateDrawingObjectsPixels(),this.removeNewsTooltip(),this.removeEventsTooltip(),this.resizeNewsBubbles(),this.resizeEventsBubbles(),this.draw(this.showData,this.h),this.valueAxis=this.getValueAxis(this.chartData.scaleParams.minB,this.chartData.scaleParams.maxB,this.valueAxisCount,this.w,this.h,this.chartData.options.Chart.scalesFontSize,this.chartData.precission),this.getOscillatorChartsAxis(),this.timeAxis=this.getTimeAxis(this.showData,this.w,this.parentRect.height-this.offY,this.chartData.period,this.chartData.timeMode,this.chartData.localization),this.clearGrid(),this.drawValueAxis(this.valueAxis),this.drawTimeAxis(this.timeAxis),this.drawOscillatorChartsAxis(),this.drawChartBorder(),this.drawCurrentValue(),this.moveCrosshairXY(this.showData,this.curX,this.curY,this.w,this.h),this.redrawInfo(),this.chartData.startX=0,this.showData[0].isCurrentData&&(this.chartData.startX=this.w-this.chartData.rightPadding-parseFloat(this.showData[0].x))},u.prototype.correctionZoomX=function(t,e,a,i){if(t&&void 0!==e&&null!==e&&void 0!==a&&null!==a){i||(i=this);var s=i.chartData.data[i.chartData.typeData],r=i.chartData.spacing,n=i.w-i.chartData.rightPadding;return s.length===i.showData.length?function correctionWhereAllDataOnChart(){if(a<0){var s=parseFloat(t.x),o=s-(i.showData.length-e)*r<=r,h=s+r*e>=n-r;o&&!h?(t=i.showData[i.showData.length-1]).x=""+r:h&&!o&&((t=i.showData[0]).x=""+(n-r))}}():function correctionWithoutAllDataOnChart(){if(a>0)if(parseFloat(i.showData[0].x)-r<n/2)(t=i.showData[0]).x=""+n/2;else if(!i.chartData.hasPrevData){var o=i.showData[i.showData.length-1],h=parseFloat(o.x);if(s[s.length-1].date==o.date&&h+r>r)parseInt(n/r)<=s.length?(t=i.showData[i.showData.length-1]).x=""+r:t=i.showData[i.showData.length-1];else{var c=i.binarySearhElementWithField(s,t.date,"date"),l=s.length;if(parseInt(parseFloat(t.x)/r)>l-c){t=i.showData[i.showData.length-1];var d=(l-c-(i.showData.length-e))*r+r;t.x=""+d.toFixed(1)}}}}(),t}},u.prototype.scaleZoomDataQuantCandles=function(t,e){var a=Math.abs(t.startX-t.endX),i=1.5*this.chartData.candleWidth*(this.w/a);if((this.w-this.chartData.rightPadding)/i<e&&i!==1/0){var s=(this.w-this.chartData.rightPadding)/e/i;t.startX<t.endX?(t.startX=t.startX*s,t.endX=t.endX/s>this.w?this.w:t.endX/s):(t.startX=t.endX/s>this.w?this.w:t.endX/s,t.endX=t.endX*s),a=Math.abs(t.startX-t.endX)}var r=Math.abs(t.startY-t.endY),n=Math.min(t.startY,t.endY),o=Math.min(t.startX,t.endX)+a,h=n+r,c=n;t.maxValue=this.toYValue(c),t.minValue=this.toYValue(h),t.startDate=this.toXValue(o),t.candleWidth=this.chartData.candleWidth*(this.w/a),t.startX=this.w-parseFloat(this.showData[0].x),t.click=a<40},u.prototype.addNavBtnsEvents=function(){var t=this.parent.querySelector(".tch-nav-buttons.tch-nav-many"),e=this.parent.querySelector(".tch-nav-buttons.tch-nav-one"),a=t.querySelector(".tch-nav-left"),i=t.querySelector(".tch-nav-out"),s=t.querySelector(".tch-nav-ref"),r=t.querySelector(".tch-nav-in"),n=t.querySelector(".tch-nav-right"),o=this,h=.8*parseInt(t.style.left.replace(/px/,"")),c=1.2*t.getBoundingClientRect().width+h/.8,l=.85*t.offsetTop;t.onmousemove=function(){var a=parseInt(o.crosshair.params.x);o.crosshair.params.y>=l&&a>=h&&a<=c?t.classList.toggle("tch-active",!0):t.classList.toggle("tch-active",!1),o.chartData.data.bid&&o.chartData.data.bid[0]&&o.showData&&o.showData[0]&&o.chartData.data.bid[0].date!==o.showData[0].date?e.classList.toggle("tch-active",!0):e.classList.toggle("tch-active",!1)},t.onmousedown=function(){o.setActiveChart()},e.onmousedown=function(){for(var t=o.toXPixels(o.chartData.data.bid[0].date),a=parseFloat(o.showData[0].x),i=t-a,s=100,r=i/(600/s);r>100&&s>=10;)r=i/(600/(s-=5));e.intervalId||(e.intervalId=setInterval(function(){o.moveRightChart(o,r),o.chartData.data.bid[0].date===o.showData[0].date&&(t=o.toXPixels(o.chartData.data.bid[0].date),i=t-o.w+o.w/20,o.moveRightChart(o,i),clearInterval(e.intervalId),e.intervalId=null)},s),o.setActiveChart())},this.navButtonStartContainer.onmouseup=function(){o.chartData.data.bid[0].date!==o.showData[0].date?e.classList.toggle("tch-active",!0):e.classList.toggle("tch-active",!1)},a.addEventListener("mousedown",function(){o.moveLeftChart(o,10),a.interval=setInterval(function(){o.moveLeftChart(o,10)},100)}),a.addEventListener("mouseleave",function(){clearInterval(a.interval)}),a.addEventListener("mouseup",function(){clearInterval(a.interval)}),i.addEventListener("click",function(){o.zoomX(100,1.2,0)}),s.addEventListener("click",function(){var t=!1;for(o.chartData.candleWidth=6,o.chartData.spacing=1.5*o.chartData.candleWidth;!o.showData[0].isCurrentData;)o.moveRightChart(o,10),t=!0;t&&o.moveRightChart(o,o.w*o.techChart.configuration.offsetChart),o.zoomX(0,1,0)}),r.addEventListener("click",function(){o.zoomX(-100,1.2,0)}),n.addEventListener("mousedown",function(){o.moveRightChart(o,10),n.interval=setInterval(function(){o.moveRightChart(o,10)},100)}),n.addEventListener("mouseleave",function(){clearInterval(n.interval)}),n.addEventListener("mouseup",function(){clearInterval(n.interval)})},u.prototype.moveLeftChart=function(t,e){this.moveChartX(this,-e)&&(this.showData[0].date===this.selectedData[0].date&&this.showData[this.showData.length-1].date===this.selectedData[this.selectedData.length-1].date||(this.selectedData=this.getSelectedDataByShowData(this.showData),this.chartData.scaleParams=this.getScaleParams(this.selectedData,this.h,this.chartData.precission),this.resizeShowDataValuesY(this.showData,this.h,this.chartData.scaleParams)),t.chartData.indicators&&t.chartData.indicators.length&&t.createIndicatorsShowData(),this.updateNavPanelAction())},u.prototype.moveRightChart=function(t,e){this.moveChartX(this,e)&&(this.showData[0].date===this.selectedData[0].date&&this.showData[this.showData.length-1].date===this.selectedData[this.selectedData.length-1].date||(this.selectedData=this.getSelectedDataByShowData(this.showData),this.chartData.scaleParams=this.getScaleParams(this.selectedData,this.h,this.chartData.precission),this.resizeShowDataValuesY(this.showData,this.h,this.chartData.scaleParams)),t.chartData.indicators&&t.chartData.indicators.length&&t.createIndicatorsShowData(),this.updateNavPanelAction())},u.prototype.zoomChartNavBtnClick=function(t){t.zoomX(-100,1.2,0)},u.prototype.moveRightChartStart=function(t,e){this.moveChartX(this,e)&&(this.showData[0].date===this.selectedData[0].date&&this.showData[this.showData.length-1].date===this.selectedData[this.selectedData.length-1].date||(this.selectedData=this.getSelectedDataByShowData(this.showData),this.chartData.scaleParams=this.getScaleParams(this.selectedData,this.h,this.chartData.precission),this.resizeShowDataValuesY(this.showData,this.h,this.chartData.scaleParams)),t.chartData.indicators&&t.chartData.indicators.length&&t.createIndicatorsShowData(),this.updateNavPanelAction())},u.prototype.updateNavPanelAction=function(){this.updateDrawingObjectsPixels(),this.draw(this.showData,this.h),this.valueAxis=this.getValueAxis(this.chartData.scaleParams.minB,this.chartData.scaleParams.maxB,this.valueAxisCount,this.w,this.h,this.chartData.options.Chart.scalesFontSize,this.chartData.precission),this.getOscillatorChartsAxis(),this.clearGrid(),this.drawValueAxis(this.valueAxis),this.drawTimeAxis(this.timeAxis),this.drawOscillatorChartsAxis(),this.drawChartBorder(),this.drawCurrentValue(),this.redrawInfo()},u.prototype.convertToDTO=function(){var t={};return t.chartDataDTO=this.chartData.convertToDTO(),t.w=this.w,t.h=this.h,t.offX=this.offX,t.offY=this.offY,t},u.convertFromDTO=function(t,e){t&&e&&(this.chartData.convertFromDTO(e.chartDataDTO),t.w=e.w,t.h=e.h,t.offX=e.offX,t.offY=e.offY)},u.prototype.setGetNewsTimeout=function(){var t=this,e=setTimeout(function(){t.processGetNews(t,e)},500);this.getNewsTimeout=e},u.prototype.processGetNews=function(t,e){t.getNewsTimeout===e&&(t.getNews(t.showData)||t.updateNewsBubbles(),t.getNewsTimeout=null,t=null)},u.prototype.getNews=function(t){if(!t||0===t.length)return!1;var e=t[t.length-1].date,a=t[0].date;return this.chartData.getNews(e,a)},u.prototype.setGetEventsTimeout=function(){var t=this,e=setTimeout(function(){t.processGetEvents(t,e)},500);this.getEventsTimeout=e},u.prototype.processGetEvents=function(t,e){t.getEventsTimeout===e&&(t.getEvents(t.showData)||t.updateEventsBubbles(),t.getEventsTimeout=null,t=null)},u.prototype.getEvents=function(t){if(!t||0===t.length)return!1;var e=t[t.length-1].date,a=t[0].date;return this.chartData.getEvents(e,a)},u.prototype.moveNewsBubblesY=function(t){this.moveBubblesY(t,this.newsBubbles)},u.prototype.moveNewsBubblesX=function(t){this.moveBubblesX(t,this.newsBubbles)},u.prototype.showNewsBubbles=function(){this.showBubbles(this.newsBubbles,this.newsBubblesContainer)},u.prototype.resizeNewsBubbles=function(){this.resizeBubbles(this.newsBubbles,this.chartData.candleWidth),this.setRecreateNewsBubblesTimeout()},u.prototype.removeNewsTooltip=function(){this.removeBubblesTooltip(this.newsBubbles)},u.prototype.focusNewsBubbles=function(t,e){for(var a=0;a<this.newsBubbles.length;a++){if(this.newsBubbles[a].isFocused(t,e)){setTimeout(this.processNewsBubbleFocus.bind(this,this.newsBubbles[a]),400),this.newsBubbles[a].isBubbleFocused=!0;break}if(this.newsBubbles[a].isBubbleFocused){this.newsBubbles[a].isBubbleFocused=!1;break}this.newsBubbles[a].newsTooltip&&(this.newsBubbles[a].isBubbleFocused=!1,this.newsBubbles[a].hideTooltip("newsTooltip"))}},u.prototype.processNewsBubbleFocus=function(t){if(this.eventsTooltipContainer.classList.contains("tch-hidden")&&t.isBubbleFocused)if(t.newsTooltip)""===t.newsTooltip.parentDiv.innerHTML?t.newsTooltip.refresh():t.newsTooltip&&t.newsTooltip.leaveTimeout&&(clearTimeout(t.newsTooltip.leaveTimeout),t.newsTooltip.leaveTimeout=null);else{var e={bubble:t};t.newsTooltip=new TooltipNews(this.chartData,e),t.newsTooltip.init()}},u.prototype.updateNewsBubbles=function(){var t=this.chartData.getServerPeriod();this.techChart.configuration.timeframesForNews.indexOf(t)>=0&&this.updateBubbles(this.newsBubbles,0,this.w-this.clipPathOffset,this.chartData.newsData.news,this.newsBubblesContainer,"NewsBubble")},u.prototype.removeAllNewsBubbles=function(){for(var t=0;t<this.newsBubbles.length;t++)this.newsBubbles[t].remove();this.newsBubbles=[]},u.prototype.createNewsBubbles=function(t){this.newsBubbles=Bubble.getBubbles(this.chartData,t,"NewsBubble")},u.prototype.setRecreateNewsBubblesTimeout=function(){var t=this,e=setTimeout(function(){t.processRecreateNewsBubbles(t,e)},250);this.recreateNewsBubblesTimeout=e},u.prototype.processRecreateNewsBubbles=function(t,e){t.recreateNewsBubblesTimeout===e&&(t.removeAllNewsBubbles(),t.setGetNewsTimeout(),t.updateNewsBubbles(),t.resizeBubbles(t.newsBubbles,t.chartData.candleWidth),t.recreateNewsBubblesTimeout=null,t=null)},u.prototype.moveEventsBubblesY=function(t){this.moveBubblesY(t,this.eventsBubbles)},u.prototype.moveEventsBubblesX=function(t){this.moveBubblesX(t,this.eventsBubbles)},u.prototype.showEventsBubbles=function(){this.showBubbles(this.eventsBubbles,this.eventsBubblesContainer)},u.prototype.resizeEventsBubbles=function(){this.resizeBubbles(this.eventsBubbles,this.chartData.candleWidth),this.setRecreateEventsBubblesTimeout()},u.prototype.removeEventsTooltip=function(){this.removeBubblesTooltip(this.eventsBubbles)},u.prototype.focusEventsBubbles=function(t,e){for(var a=0;a<this.eventsBubbles.length;a++){if(this.eventsBubbles[a].isFocused(t,e)){setTimeout(this.processEventsBubbleFocus.bind(this,this.eventsBubbles[a]),400),this.eventsBubbles[a].isBubbleFocused=!0;break}if(this.eventsBubbles[a].isBubbleFocused){this.eventsBubbles[a].isBubbleFocused=!1;break}this.eventsBubbles[a].tooltip&&(this.eventsBubbles[a].isBubbleFocused=!1,this.eventsBubbles[a].hideTooltip("eventsTooltip"))}},u.prototype.processEventsBubbleFocus=function(t){if(this.newsTooltipContainer.classList.contains("tch-hidden")&&t.isBubbleFocused)if(t.tooltip)""===t.tooltip.parentDiv.innerHTML?t.tooltip.refresh():t.tooltip&&t.tooltip.leaveTimeout&&(clearTimeout(t.tooltip.leaveTimeout),t.tooltip.leaveTimeout=null);else{var e={bubble:t};t.tooltip=new TooltipEvents(this.chartData,e),t.tooltip.init()}},u.prototype.updateEventsBubbles=function(){var t=this.chartData.getServerPeriod();this.techChart.configuration.timeframesForEvents.indexOf(t)>=0&&this.updateBubbles(this.eventsBubbles,0,this.w-this.clipPathOffset,this.chartData.eventsData.events,this.eventsBubblesContainer,"EventsBubble")},u.prototype.removeAllEventsBubbles=function(){for(var t=0;t<this.eventsBubbles.length;t++)this.eventsBubbles[t].remove();this.eventsBubbles=[]},u.prototype.createEventsBubbles=function(t){this.eventsBubbles=Bubble.getBubbles(this.chartData,t,"EventsBubble")},u.prototype.setRecreateEventsBubblesTimeout=function(){var t=this,e=setTimeout(function(){t.processRecreateEventsBubbles(t,e)},250);this.recreateEventsBubblesTimeout=e},u.prototype.processRecreateEventsBubbles=function(t,e){t.recreateEventsBubblesTimeout===e&&(t.removeAllEventsBubbles(),t.setGetEventsTimeout(),t.updateEventsBubbles(),t.resizeBubbles(t.eventsBubbles,t.chartData.candleWidth),t.recreateEventsBubblesTimeout=null,t=null)},u.prototype.moveBubblesX=function(t,e){if(e.length)for(var a=0;a<e.length;a++)e[a].moveBubbleX(t)},u.prototype.moveBubblesY=function(t,e){if(e.length)for(var a=0;a<e.length;a++)e[a].moveBubbleY(t)},u.prototype.resizeBubbles=function(t,e){for(var a=0;a<t.length;a++)t[a].updatePixels(),t[a].resize(e)},u.prototype.showBubbles=function(t,e){for(var a=0;a<t.length;a++)t[a].parent||t[a].show(e)},u.prototype.removeBubblesTooltip=function(t){for(var e=0;e<t.length;e++)t[e].removeTooltip()},u.prototype.getExtraIntervalToRight=function(t){if(0===this.showData.length)return[];var e=this.showData[0].date,a=this.showData[this.showData.length-1].date;return t.length&&(a=t[0].getMaxItemsDate()),{from:a,to:e}},u.prototype.getExtraIntervalToLeft=function(t){if(0===this.showData.length)return[];var e=this.showData[0].date;return t.length&&(e=t[t.length-1].getMinItemsDate()),{from:this.showData[this.showData.length-1].date,to:e}},u.prototype.deleteRedundantBubblesLeftRight=function(t,e,a){Bubble.deleteRedundantBubblesLeftRight(t,e,a)},u.prototype.needsBubblesToLeft=function(t,e){return 0===t.length||parseFloat(t[t.length-1].point.x)>e},u.prototype.needsBubblesToRight=function(t,e){return 0===t.length||parseFloat(t[0].point.x)<e},u.prototype.updateBubbles=function(t,e,a,i,s,r){t.length?(this.needsBubblesToLeft(t,e)&&this.addBubblesToLeft(t,s,i,r),this.needsBubblesToRight(t,a)&&this.addBubblesToRight(t,s,i,r)):(this.createBubblesByType(i,r),this.showBubblesByType(r)),this.deleteRedundantBubblesLeftRight(t,e,a)},u.prototype.addBubblesToRight=function(t,e,a,i){var s=this.getExtraIntervalToRight(t),r=Bubble.getBubbles(this.chartData,a,i,s.from,s.to);this.addExtraBubblesToRight(t,r,e)},u.prototype.addBubblesToLeft=function(t,e,a,i){var s=this.getExtraIntervalToLeft(t),r=Bubble.getBubbles(this.chartData,a,i,s.from,s.to);this.addExtraBubblesToLeft(t,r,e)},u.prototype.addExtraBubblesToRight=function(t,e,a){if(e.length)for(var i=0;i<e.length;i++)Bubble.isTouch(t[0],e[i])?t[0].items=e[i].items.concat(t[0].items):(e[i].show(a),t.unshift(e[i]))},u.prototype.addExtraBubblesToLeft=function(t,e,a){if(e.length)for(var i=0;i<e.length;i++)Bubble.isTouch(t[t.length-1],e[i])?t[t.length-1].items=t[t.length-1].items.concat(e[i].items):(e[i].show(a),t.push(e[i]))},u.prototype.createBubblesByType=function(t,e){this["create"+e+"s"](t)},u.prototype.showBubblesByType=function(t){this["show"+t+"s"]()},u.prototype.updateSignals=function(){this.techChart.configuration.modules.signals&&(this.signalsPanel||this.createSignalsPanel(),this.signals=Object.keys(this.chartData.signalsData),this.signalsPanel.spanNumber.textContent=this.signals.length,this.fillSignalsPanelBody(),this.checkActiveSignalRelevance())},u.prototype.getSignalsPanelHtml=function(){var t=this.chartData.isShowSignalsBody?"tch-up":"tch-down",e=this.chartData.isShowAllSignals?"tch-eye-active":"",a=this.chartData.isShowSignalsBody?"":"tch-hidden";return"<div class='tch-signals-panel-header'><span>"+this.techChart.translation.signals+"</span><span class='tch-signals-number'></span><span class='tch-signals-eye "+e+"'></span><span class='tch-signals-arrow "+t+"'></span></div></div><div class='tch-signals-panel-body "+a+"'><ul></ul></div>"},u.prototype.getSignalsBodyRow=function(t){var e=this.chartData.signalsData[t],a=e.isVisible?"tch-eye-active":"";return"<li id='"+e.id+"'><span class='tch-signals-period'>"+e.period+"</span><span>"+e.forecast+"</span><span>"+e.strength+"</span><span class='tch-signals-eye "+a+"'></span></li>"},u.prototype.fillSignalsPanelBody=function(){this.signalsPanel.body.list.innerHTML=this.getSignalsBodyRows(this.signals),this.addSignalsPanelBodyEvents()},u.prototype.addSignalsPanelBodyEvents=function(){for(var t=this.signalsPanel.body.querySelectorAll(".tch-signals-eye"),e=this,a=0;a<t.length;a++)t[a].onclick=function(t){e.signalsPanelBodyEyeClick(t)};for(var i=this.signalsPanel.body.querySelectorAll(".tch-signals-period"),s=0;s<i.length;s++)i[s].onclick=function(t){e.signalsPanelBodyPeriodClick(t)}},u.prototype.signalsPanelBodyPeriodClick=function(t){var e=t.target.parentNode.getAttribute("id"),a=this.chartData.signalsData[e].period;this.chartData.isShowAllSignals=!0,this.hideSignals(a),this.chartData.signalsData[e].isVisible=!0,this.chartData.techChart.changePeriod(a),this.chartData.techChart.changeTypeData("mid",this.chartData.techChart),this.chartData.techChart.autoSaveParams()},u.prototype.signalsPanelBodyEyeClick=function(t){var e=t.target.classList.toggle("tch-eye-active"),a=t.target.parentNode.getAttribute("id");if(e)if(this.activeSignal){var i=this.chartData.signalsData[a].period;this.hideSignals(i),this.chartData.signalsData[a].isVisible=!0,this.closeOtherEyes(a,i),this.signalsPanel.spanEye.classList.toggle("tch-eye-active",!0),this.chartData.isShowAllSignals=!0,this.drawActiveSignal()}else this.signalsPanelBodyPeriodClick(t);else this.activeSignal&&this.activeSignal.id===parseInt(a)&&(this.chartData.signalsData[a].isVisible=!1,this.clearSignals());this.chartData.techChart.autoSaveParams()},u.prototype.closeOtherEyes=function(t,e){for(var a=this.signalsPanel.getElementsByTagName("li"),i=0;i<a.length;i++)a[i].id!==t&&a[i].children[0].textContent===e&&a[i].children[3].classList.toggle("tch-eye-active",!1)},u.prototype.getSignalsBodyRows=function(t){for(var e="",a=0;a<t.length;a++)t[a].isVisible&&this.signalsPanel.spanEye.classList.toggle("tch-eye-active",!0),e+=this.getSignalsBodyRow(t[a]);return e},u.prototype.createSignalsPanel=function(){this.techChart.configuration.modules.signals&&!this.signalsPanel&&(this.signalsPanel=this.chartData.techChart.createSignalsPanel(),this.addSignalsPanelEvents())},u.prototype.addSignalsPanelEvents=function(){var t=this;this.signalsPanel.spanArrow.onclick=function(e){t.signalsPanelSpanArrowClick(e,t)},this.signalsPanel.spanEye.onclick=function(e){t.signalsPanelSpanEyeClick(e)}},u.prototype.signalsPanelSpanArrowClick=function(t){var e=t.target.classList.contains("tch-up");t.target.classList.toggle("tch-up",!e),t.target.classList.toggle("tch-down",e),this.signalsPanel.body.classList.toggle("tch-hidden",e),this.chartData.isShowSignalsBody=!e,this.chartData.techChart.autoSaveParams()},u.prototype.signalsPanelSpanEyeClick=function(t){if(this.chartData.isShowAllSignals=!this.chartData.isShowAllSignals,t.target.classList.toggle("tch-eye-active",this.chartData.isShowAllSignals),this.chartData.isShowAllSignals)this.drawActiveSignal();else{for(var e=this.signalsPanel.body.querySelectorAll(".tch-signals-eye"),a=0;a<e.length;a++)e[a].classList.toggle("tch-eye-active",!1);for(var i in this.chartData.signalsData)this.chartData.signalsData.hasOwnProperty(i)&&(this.chartData.signalsData[i].isVisible=!1);this.clearSignals()}this.chartData.techChart.autoSaveParams()},u.prototype.drawActiveSignal=function(){var t=this.getActiveSignalData();this.activeSignal&&this.clearSignals(),t&&(this.activeSignal=new Signal(this.chartData,{signal:t}),this.redrawActiveSignal())},u.prototype.getActiveSignalData=function(){var t=null,e=this.techChart.store.getChartData().convertValueToServerPeriod(this.chartData.period);for(var a in this.chartData.signalsData)if(this.chartData.signalsData.hasOwnProperty(a)&&this.chartData.signalsData[a].isVisible&&this.chartData.signalsData[a].period===e){t=this.chartData.signalsData[a];break}return t},u.prototype.hideSignals=function(t){for(var e in this.chartData.signalsData)this.chartData.signalsData.hasOwnProperty(e)&&this.chartData.signalsData[e].period===t&&(this.chartData.signalsData[e].isVisible=!1)},u.prototype.redrawActiveSignal=function(){this.chartData.isShowAllSignals&&"mid"===this.chartData.typeData?(this.clearSignals(),this.activeSignal.calcPoints(),this.activeSignal.draw(this.canvasSignalsContext)):this.clearSignals()},u.prototype.checkActiveSignalRelevance=function(){this.activeSignal&&-1===this.signals.indexOf(this.activeSignal.id.toString())&&(this.activeSignal=null,this.clearSignals())},Roulete.prototype=Object.create(Rectangle.prototype),Roulete.prototype.constructor=Roulete,Ellipse.prototype=Object.create(TrendLine.prototype),Ellipse.prototype.constructor=Ellipse,Ellipse.convertFromDTO=function(t,e){var a=TrendLine.convertFromDTO(t,e);return a.updateCustomPropsByObj(a,e),a},Ellipse.prototype.getTopData=function(t,e,a,i){var s=e||0===e?e:LibDrawing_LibDrawing.distanceToLine(t,a),r={};r.x=(parseFloat(t.x1)+parseFloat(t.x2))/2,r.y=(parseFloat(t.y1)+parseFloat(t.y2))/2;var n=LibDrawing_LibDrawing.findLineAngleDeg({x1:this.points[0].x,y1:this.points[0].y,x2:this.points[1].x,y2:this.points[1].y}),o=s*Math.cos(LibDrawing_LibDrawing.degToRad(90-n)),h=s*Math.sin(LibDrawing_LibDrawing.degToRad(90-n)),c={};return i?(c.x=r.x+o,c.y=r.y+h,c.h=s):(c.x=r.x-o,c.y=r.y-h,c.h=s),c},Ellipse.prototype.getMiddleData=function(t,e){var a={};return a.v=(parseFloat(t.v)+parseFloat(e.v))/2,a.d=parseInt((t.d+e.d)/2),a},Ellipse.prototype.getMiddlePoint=function(t,e){var a={};return a.x=(parseFloat(t.x)+parseFloat(e.x))/2,a.y=(parseFloat(t.y)+parseFloat(e.y))/2,a},Ellipse.prototype.getPositions=function(){var t=LibCanvas.getPosition(this.points[0].x,this.width),e=LibCanvas.getPosition(this.points[0].y,this.width),a=LibCanvas.getPosition(this.points[1].x,this.width),i=LibCanvas.getPosition(this.points[1].y,this.width);if(this.points[2]&&this.points[3])var s=LibCanvas.getPosition(this.points[2].x,this.width),r=LibCanvas.getPosition(this.points[2].y,this.width),n=LibCanvas.getPosition(this.points[3].x,this.width),o=LibCanvas.getPosition(this.points[3].y,this.width);return{x0:t,y0:e,x1:a,y1:i,x2:s,y2:r,x3:n,y3:o}},Ellipse.prototype.getPoints=function(){var t=this.getPositions();return{p0:{x:t.x0,y:t.y0},middlePoint1:{x:t.x2,y:t.y2},middlePoint2:{x:t.x3,y:t.y3},p2:{x:t.x1,y:t.y1},p4:{x:t.x2-(t.x1-t.x0)/2,y:t.y2-(t.y1-t.y0)/2},p5:{x:t.x2+(t.x1-t.x0)/2,y:t.y2+(t.y1-t.y0)/2}}},Note.prototype=Object.create(Text.prototype),Note.prototype.constructor=Note,Note.convertFromDTO=function(t,e){var a=DrawingObject.convertFromDTO(t,e);return a.updateCustomPropsByObj(a,e),a},Note.prototype.getPathString=function(t){return"<path d='M512 0c-176.732 0-320 143.268-320 320 0 320 320 704 320 704s320-384 320-704c0-176.732-143.27-320-320-320zM512 512c-106.040 0-192-85.96-192-192s85.96-192 192-192 192 85.96 192 192-85.96 192-192 192z' fill="+t+"></path>"},Note.prototype.applyPosition=function(){if(this.divText){var t=this.divText.getBoundingClientRect();this.divText.style.top=parseFloat(this.points[0].y)-t.height+"px",this.divText.style.left=parseFloat(this.points[0].x)-t.width/2+"px"}},Note.prototype.applyNoteParams=function(){this.note.style.color=this.colorLabel,this.textSpanBackground.style.fill=this.fill?this.fillColor:"",this.textSpanBackground.style.stroke=this.colorLabel;for(var t=[{x:0,y:0},{x:this.textSpanBackgroundWidth/2-10,y:0},{x:this.textSpanBackgroundWidth/2,y:this.textSpanBackgroundHeight},{x:this.textSpanBackgroundWidth/2+10,y:0},{x:this.textSpanBackgroundWidth,y:0}],e="",a=0;a<t.length;a++)e=e+(t[a].x+",")+t[a].y+" ";this.textSpanBackground.getElementsByTagName("polyline")[0].setAttribute("points",e)},Note.prototype.applyTextParams=function(){this.pText.textContent=this.textArea,this.pText.style.fontSize=this.fontSize+"px",this.pText.style.fontFamily=this.fontFamily,this.pText.style.color=this.color,this.pText.style.backgroundColor=this.fill?this.fillColor:"",this.pText.style.fontWeight="on"===this.bold?"bolder":"normal",this.pText.style.fontStyle="on"===this.italic?"italic":"normal"},Note.prototype.getStylePropsNames=function(){return["color","fontFamily","fontSize","textArea","fill","fillColor","label","colorLabel","bold","italic"]},Note.prototype.getLabelRow=function(){return[{className:"tch-ss-backgroundRow"},{text:this.chartData.techChart.translation.notecolor,options:{line:this,id:"tch-settingsStyle-input-colorLabel",forId:"tch-settingsStyle-input-label",labelClassName:"label-note",name:"colorLabel",type:"colorpicker",value:this.colorLabel,onchange:this.changeValueInput}},{text:"",options:{line:this,id:"tch-settingsStyle-input-label",afterLabelClassName:"after-label-note",name:"label",type:"checkbox",checked:this.label,onchange:this.changeCheckboxInput}}]},AnchoredNote.prototype=Object.create(Note.prototype),AnchoredNote.prototype.constructor=AnchoredNote,AnchoredNote.convertFromDTO=function(t,e){var a=DrawingObject.convertFromDTO(t,e);return a.updateCustomPropsByObj(a,e),a},AnchoredText.prototype=Object.create(Text.prototype),AnchoredText.prototype.constructor=AnchoredText,AnchoredText.convertFromDTO=function(t,e){return Text.convertFromDTO(t,e)},Flag.prototype=Object.create(Line_Line.prototype),Flag.prototype.constructor=Flag,Flag.prototype.isPointOnFlag=function(t,e){this.points[0].x=parseFloat(this.points[0].x),this.points[0].y=parseFloat(this.points[0].y);var a={x1:this.points[0].x,x2:this.points[0].x+this.size,y1:this.points[0].y-this.size,y2:this.points[0].y};return LibDrawing_LibDrawing.isPointInRect(a,{x:t,y:e},5)},Flag.convertFromDTO=function(t,e){var a=DrawingObject.convertFromDTO(t,e);return a.updateCustomPropsByObj(a,e),a},Flag.prototype.createFlagIcon=function(t){t.setAttribute("viewBox","0 0 17 17"),t.innerHTML="<rect style='fill:"+this.flagColor+";stroke:#000000;stroke-width:0.3;' width='5.3' height='6' x='6.5' y='3' /><rect style='fill:"+this.flagColor+";stroke:#000000;stroke-width:0.3;'width='5.3'height='6'x='1.2'y='1.5' /><line style='stroke-width:0.8;stroke:#000000' x1='0.4' y1='1.4' x2='0.4' y2='15' ></line>",t.style.width=this.size+"px",t.style.width=this.size+"px",t.style.position="absolute",t.style.display="block",t.style.left=this.points[0].x-this.centring.x+"px",t.style.top=this.points[0].y-this.size+"px"},Flag.prototype.applyFlagParams=function(){this.icon.style.left=this.points[0].x-this.centring.x+"px",this.icon.style.top=this.points[0].y-this.size+"px",this.circles[0].points[0].x=this.points[0].x,this.circles[0].points[0].y=this.points[0].y,null===this.barNumber&&(this.barNumber=this.getBarNumber())},Flag.prototype.getBarNumber=function(){var t=u.binaryIndexOfCandleByTime(this.data[0].d,this.chartData.data[this.chartData.techChart.configuration.typeData]);return t>=0?t:0},LibDrawing_LibDrawing.isPointOnLine=function(t,e){var a={x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2};if(LibDrawing_LibDrawing.isPointInRect(a,e,5)){var i=t.x1*t.y2-t.x2*t.y1,s=t.y1-t.y2,r=t.x2-t.x1;return Math.abs(s*e.x+r*e.y+i)/Math.sqrt(s*s+r*r)<5}return!1},LibDrawing_LibDrawing.isPointInRect=function(t,e,a){var i=Math.min(t.x1,t.x2)-a,s=Math.max(t.x1,t.x2)+a,r=Math.min(t.y1,t.y2)-a,n=Math.max(t.y1,t.y2)+a;return e.x>=i&&e.x<=s&&e.y>=r&&e.y<=n},LibDrawing_LibDrawing.isPointOnCircle=function(t,e){return Math.abs(t.points[0].x-e.x)<=t.radius&&Math.abs(t.points[0].y-e.y)<=t.radius},LibDrawing_LibDrawing.isPointOnEllipse=function(t,e,a,i){var s=((e.x-t.h)*Math.cos(a)+(e.y-t.k)*Math.sin(a))*((e.x-t.h)*Math.cos(a)+(e.y-t.k)*Math.sin(a)),r=((e.x-t.h)*Math.sin(a)-(e.y-t.k)*Math.cos(a))*((e.x-t.h)*Math.sin(a)-(e.y-t.k)*Math.cos(a)),n=s/(t.rx*t.rx)+r/(t.ry*t.ry);return Math.abs(n-1)<=i},LibDrawing_LibDrawing.isPointInPolygon=function(t,e,a){for(var i=!1,s=a.x,r=a.y,n=s.length,o=n-1,h=0;h<n;o=h++){var c=(s[o]-s[h])*(e-r[h])/(r[o]-r[h])+s[h];(r[h]<=e&&e<r[o]||r[o]<=e&&e<r[h])&&t>c&&(i=!i)}return i},LibDrawing_LibDrawing.arePointsOnBezier=function(t,e,a,i,s,r){var n=!1,o=[],h=0;(i>.9||i<=0)&&(i=.1);for(var c=0;c<1+i;c+=i)if(c>1&&(c=1),0===c?(o.push(LibDrawing_LibDrawing.getPeekOnCurve(c,t,e,a)),n=LibDrawing_LibDrawing.isPointOnLine({x1:t.x,x2:a.x,y1:t.y,y2:a.y},{x:s,y:r})):(h++,o.push(LibDrawing_LibDrawing.getPeekOnCurve(c,t,e,a)),n=LibDrawing_LibDrawing.isPointOnLine({x1:o[h-1].x,x2:o[h].x,y1:o[h-1].y,y2:o[h].y},{x:s,y:r})),n)return!0;return!1},LibDrawing_LibDrawing.getPeekOnCurve=function(t,e,a,i){var s={},r=(1-t)*(1-t),n=2*t*(1-t),o=t*t;return s.x=r*e.x+n*a.x+o*i.x,s.y=r*e.y+n*a.y+o*i.y,s},LibDrawing_LibDrawing.getControlPoint=function(t,e,a,i){var s={},r=(1-t)*(1-t),n=2*t*(1-t),o=t*t;return s.x=(a.x-r*e.x-o*i.x)/n,s.y=(a.y-r*e.y-o*i.y)/n,s},LibDrawing_LibDrawing.createDrawingObjectByType=function(t,e){switch(t){case"ArrowMarkLeft":return new ArrowMarkLeft(e[0],e[1]);case"ArrowMarkRight":return new ArrowMarkRight(e[0],e[1]);case"ArrowMarkUp":return new ArrowMarkUp(e[0],e[1]);case"ArrowMarkDown":return new ArrowMarkDown(e[0],e[1]);case"Circle":return new Circle(e[0],e[1]);case"TrendLine":return new TrendLine(e[0],e[1]);case"HorizontalLine":return new HorizontalLine(e[0],e[1]);case"VerticalLine":return new VerticalLine(e[0],e[1]);case"Arrow":return new Arrow(e[0],e[1]);case"Ray":return new Ray(e[0],e[1]);case"HorizontalRay":return new HorizontalRay(e[0],e[1]);case"TrendAngle":return new TrendAngle(e[0],e[1]);case"ParallelChannel":return new ParallelChannel(e[0],e[1]);case"DisjointAngle":return new DisjointAngle(e[0],e[1]);case"FlatTopBottom":return new FlatTopBottom(e[0],e[1]);case"Polyline":return new Polyline(e[0],e[1]);case"Rectangle":return new Rectangle(e[0],e[1]);case"Curve":return new Curve(e[0],e[1]);case"Triangle":return new Triangle(e[0],e[1]);case"RotatedRect":return new RotatedRect(e[0],e[1]);case"Arc":return new Arc(e[0],e[1]);case"Roulete":return new Roulete(e[0],e[1]);case"Ellipse":return new Ellipse(e[0],e[1]);case"Text":return new Text(e[0],e[1]);case"Note":return new Note(e[0],e[1]);case"AnchoredNote":return new AnchoredNote(e[0],e[1]);case"Brush":return new Brush(e[0],e[1]);case"AnchoredText":return new AnchoredText(e[0],e[1]);case"Flag":return new Flag(e[0],e[1]);default:return new DrawingObject(e)}},LibDrawing_LibDrawing.convertFromDTO=function(t,e){switch(e.type){case"ArrowMarkLeft":return ArrowMarkLeft.convertFromDTO(t,e);case"ArrowMarkRight":return ArrowMarkRight.convertFromDTO(t,e);case"ArrowMarkUp":return ArrowMarkUp.convertFromDTO(t,e);case"ArrowMarkDown":return ArrowMarkDown.convertFromDTO(t,e);case"Circle":return Circle.convertFromDTO(t,e);case"TrendLine":return TrendLine.convertFromDTO(t,e);case"HorizontalLine":return HorizontalLine.convertFromDTO(t,e);case"VerticalLine":return VerticalLine.convertFromDTO(t,e);case"Arrow":return Arrow.convertFromDTO(t,e);case"Ray":return Ray.convertFromDTO(t,e);case"HorizontalRay":return HorizontalRay.convertFromDTO(t,e);case"TrendAngle":return TrendAngle.convertFromDTO(t,e);case"ParallelChannel":return ParallelChannel.convertFromDTO(t,e);case"DisjointAngle":return DisjointAngle.convertFromDTO(t,e);case"FlatTopBottom":return FlatTopBottom.convertFromDTO(t,e);case"Arc":return Arc.convertFromDTO(t,e);case"Ellipse":return Ellipse.convertFromDTO(t,e);case"RotatedRect":return RotatedRect.convertFromDTO(t,e);case"Text":return Text.convertFromDTO(t,e);case"Note":return Note.convertFromDTO(t,e);case"AnchoredNote":return AnchoredNote.convertFromDTO(t,e);case"Brush":return Brush.convertFromDTO(t,e);case"Flag":return Flag.convertFromDTO(t,e);default:return DrawingObject.convertFromDTO(t,e)}},LibDrawing_LibDrawing.distanceToLine=function(t,e){var a=t.x1*t.y2-t.x2*t.y1,i=t.y1-t.y2,s=t.x2-t.x1;return(i*e.x+s*e.y+a)/Math.sqrt(i*i+s*s)},LibDrawing_LibDrawing.findPointOnLineByX=function(t,e){var a=parseFloat(t.x1),i=parseFloat(t.x2),s=parseFloat(t.y1),r=parseFloat(t.y2),n=i-a;return 0===n?{x:0,y:s}:{x:e,y:(r-s)*(e-a)/n+s}},LibDrawing_LibDrawing.findPointOnLineByY=function(t,e){var a=parseFloat(t.x1),i=parseFloat(t.x2),s=parseFloat(t.y1),r=parseFloat(t.y2)-s;return 0===r?{x:a,y:0}:{x:(i-a)/r*(e-s)+a,y:e}},LibDrawing_LibDrawing.findLineAngleDeg=function(t){var e=parseFloat(t.x1),a=parseFloat(t.x2),i=parseFloat(t.y1),s=-1*(parseFloat(t.y2)-i),r=a-e;if(0===s)return r<0?180:0;if(0===r&&s>0)return 90;if(0===r&&s<0)return-90;var n=s/r,o=LibDrawing_LibDrawing.radToDeg(Math.atan(n));return r<0&&(o>0?o-=180:o+=180),o},LibDrawing_LibDrawing.radToDeg=function(t){return 180*t/Math.PI},LibDrawing_LibDrawing.degToRad=function(t){return t*Math.PI/180},LibDrawing_LibDrawing.getTanDeg=function(t){var e=t*Math.PI/180;return Math.tan(e)},DrawingObject.precission=7,DrawingObject.nextId=1,DrawingObject.prototype.getNextId=function(){return"tch-drw-"+DrawingObject.nextId++},DrawingObject.prototype.remove=function(){this.chartData.editDrawingObject&&this.chartData.editDrawingObject.id===this.id&&(this.chartData.editDrawingObject=null),this.chartData.activeDrawingObject&&this.chartData.activeDrawingObject.id===this.id&&(this.chartData.activeDrawingObject=null);var t=this.getIndex();t>-1&&this.chartData.drawingObjects.splice(t,1)},DrawingObject.prototype.getIndex=function(){for(var t=0;t<this.chartData.drawingObjects.length;t++)if(this.chartData.drawingObjects[t].id===this.id)return t;return-1},DrawingObject.prototype.shiftTo=function(){},DrawingObject.prototype.moveTo=function(){},DrawingObject.prototype.updateValues=function(){},DrawingObject.prototype.updatePixels=function(){for(var t=0;t<this.points.length;t++)this.points[t].x=this.chartData.chart.toXPixels(this.data[t].d),this.points[t].y=this.chartData.chart.toYPixels(this.data[t].v)},DrawingObject.prototype.updateYPixels=function(){},DrawingObject.prototype.updateXPixels=function(){},DrawingObject.prototype.fillSettingsPanel=function(){},DrawingObject.prototype.getFunctionName=function(t,e){var a=t,i=e.split("-");for(var s in i)i.hasOwnProperty(s)&&(a+=i[s][0].toUpperCase()+i[s].slice(1));return a},DrawingObject.prototype.removeStyleMenuElementByNames=function(t,e){for(var a=[],i=0;i<t.length;i++){a[a.length]=[];for(var s=0;s<t[i].length;s++)t[i][s].options&&-1===e.indexOf(t[i][s].options.name)&&a[a.length-1].push(t[i][s]);0===a[a.length-1].length&&a.pop()}return a},DrawingObject.prototype.applyRestoredParams=function(t){this.data=t.data,this.points=t.points,this.drawingStage=t.drawingStage,this.state=t.state,this.id=t.id},DrawingObject.prototype.convertToDTO=function(){var t={};return t.type=this.constructor.name,t.id=this.id,t.data=DrawingObject.cloneObject(this.data),t.points=DrawingObject.cloneObject(this.points),t.drawingStage=DrawingObject.cloneObject(this.drawingStage),t.state="normal",t},DrawingObject.convertFromDTO=function(t,e){e.type||(e.type=e.constructor.name);var a=LibDrawing_LibDrawing.createDrawingObjectByType(e.type,[t,e]);return a.applyRestoredParams(e),a},DrawingObject.prototype.updateByObject=function(t){var e=t.convertToDTO(),a=LibDrawing_LibDrawing.convertFromDTO(this.chartData,e);this.applyRestoredParams(a),this.chartData.chart&&this.updatePixels()},DrawingObject.prototype.draw=function(){},DrawingObject.prototype.isFocused=function(){},DrawingObject.cloneObject=function(t){return JSON.parse(JSON.stringify(t))};var g=function(){function ChartData(t){!function ChartData_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,ChartData),t.store.setChartData(ChartData),this.techChart=t,this.defParams={pair:t.configuration.pair,period:t.configuration.period,timeMode:t.configuration.timeMode,chartType:t.configuration.chartType,indicators:t.configuration.indicators,currentValue:t.configuration.currentValue,drawingObjects:[],typeData:t.configuration.typeData,currentOptions:{},isMagnetMode:t.configuration.isMagnetMode,isStayDrawingMode:t.configuration.isStayDrawingMode,isShowDrawingObjects:t.configuration.isShowDrawingObjects,isDrawingObjectsLocked:t.configuration.isDrawingObjectsLocked,isPipsShow:t.configuration.isPipsShow,cursorType:t.configuration.defaultParams.cursorType},ChartData.defaultParams=this.defParams,this.options=Object(o.b)(t.styles.options),t.styles.themes?(this.options.Chart.typeThemes=t.configuration.typeThemes,this.themes=Object(o.b)(t.styles.themes),this.colors=Object(o.b)(this.themes[this.options.Chart.typeThemes])):this.colors=Object(o.b)(t.styles.colors),this.id=t.configuration.pair.ID,this.chartType=t.configuration.chartType,this.period=t.configuration.period,this.timeMode=t.configuration.timeMode,this.indicators=Object(o.b)(t.configuration.indicators),this.currentValue={ask:"0.00000",bid:"0.00000",mid:"0.00000"},this.pair=Object(o.b)(t.configuration.pair),this.localization=navigator.language,this.quotationName=t.configuration.quotationName,this.data={ask:[],bid:[],mid:[]},this.images=Object(o.b)(t.configuration.images),this.hasPrevData=!0,this.hasNextData=t.configuration.hasNextData,this.rightPadding=t.configuration.rightPadding,this.startDateSeconds,this.spacing,this.candleWidth=t.configuration.candleWidth,this.dataOffset=t.configuration.dataOffset,this.precission=t.configuration.precission,this.session,this.isWaitForData=!1,this.isWaitFallBackData=!1,this.chart,this.marginTop=t.configuration.marginTop,this.marginBottom=t.configuration.marginBottom,this.scaleParams=Object(o.b)(t.configuration.scaleParams),this.numb=t.configuration.numb,this.fallBack=t.configuration.fallBack,this.zoomView=t.configuration.zoomView,this.startX=this.candleWidth,this.startY=t.configuration.startY,this.state=t.configuration.state,this.drawingObjects=Object(o.b)(t.configuration.drawingObjects),this.editDrawingObject,this.activeDrawingObject,this.isDrawingObjectsLocked=t.configuration.isDrawingObjectsLocked,this.isStayDrawingMode=t.configuration.isStayDrawingMode,this.isShowNews=t.configuration.modules.isShowNews,this.isShowEvents=t.configuration.modules.isShowEvents,this.isShowDrawingObjects=!0,this.isMagnetMode=!1,this.isPipsShow=t.configuration.isPipsShow,this.cursorType="arrow",this.getDataOtherChartTimeOut=null,this.zoomData={},this.zoomSteps=[],this.newsData={currentFrom:null,currentTo:null,news:[]},this.eventsData={apiFrom:null,apiTo:null,currentFrom:null,currentTo:null,events:[]},this.typeData=t.configuration.typeData,this.signalsData={},this.isShowAllSignals=!1,this.isShowSignalsBody=!1,this.isShowPriceLineOfLastBar=t.configuration.modules.chartElements.isShowPriceLineOfLastBar,this.closedOption=null,this.currentTabId=null}return function _createClass(t,e,a){e&&_defineProperties(t.prototype,e),a&&_defineProperties(t,a)}(ChartData,[{key:"defaultParams",get:function get(){return this.defParams}}]),ChartData}();g.prototype.setDefaultParams=function(){this.id!==g.defaultParams.pair.ID&&(this.data={ask:[],bid:[],mid:[]}),this.id=this.defaultParams.pair.ID,this.period=this.defaultParams.period,this.chartType=this.defaultParams.chartType,this.pair=Object(o.b)(this.defaultParams.pair),this.colors=Object(o.b)(g.colors),this.options=Object(o.b)(g.options),this.indicators=[],this.currentValue=this.defaultParams.currentValue,this.state="default",this.drawingObjects=[],this.scaleParams={minB:"0.00000",maxB:"0.00000",deltaY:0,minV:0,maxV:0},this.candleWidth=6,this.zoomView=1,this.typeData=this.defaultParams.typeData,this.currentOptions=this.defaultParams.currentOptions},g.prototype.setDefaultParamsOnUpdate=function(){return{timeMode:this.defaultParams.timeMode,currentValue:this.defaultParams.currentValue,typeData:this.defaultParams.typeData,currentOptions:this.defaultParams.currentOptions}},g.prototype.init=function(){this.techChart.connector.addListener(this),this.techChart.connector&&this.techChart.connector.client&&this.techChart.connector.client.connected&&this.techChart&&this.techChart.connector.updateSubscription()},g.prototype.onConnectorMessage=function(t,e,a){a&&a.callBack?a.callBack(t,e,a):e.onMessage(t,e)},g.prototype.onMessage=function(t,e){t.rates?e.processRates(t,e):e.processSignals(t,e)},g.prototype.onConnect=function(){this.isWaitForData=!1,this.getFirstData(),this.techChart.configuration.modules.signals&&this.setSignalsInterval()},g.prototype.getMiddlePrice=function(t){return((parseFloat(t.ask)+parseFloat(t.bid))/2).toFixed(this.precission)},g.prototype.processRates=function(t,e){if(t.rates)for(var a=0;a<t.rates.length;a++)if(t.rates[a].security===e.pair.Name){var i={};i.ask=t.rates[a].ask,i.bid=t.rates[a].bid,i.mid=this.getMiddlePrice(t.rates[a]),this.currentValue.ask===i.ask&&this.currentValue.bid===i.bid||(this.chart?this.chart.drawCurrent(i):this.updateCurrentData(i));break}if(this.chart&&t.investarenaTime&&e.data[1]&&parseInt(t.rates[0].timestamp)-parseInt(e.data[1].date)>this.getCurrentTimeStepByServerPeriod(e.period)&&this.chart.updateChart(Object.assign({},e.data[0]),this,{}),this.chart&&t.bars&&e.data&&e.data.bid.length&&t.bars.length&&t.bars[0].name===e.pair.Name)if(t.bars[0].prevBar.bid.date>=e.data.bid[0].date){var s={bid:e.data.bid[0],ask:e.data.ask[0],mid:e.data.mid[0]};this.chart.updateChart(Object.assign({},s),this,{});var r=this.chart.clearInfo();this.chart.drawCrosshair(r,r.canvas.height,!1),this.chart.activeSignal&&this.chart.redrawActiveSignal()}else this.chart.getCurrentDataComplete(this.chart,[t.bars[0].currentBar,t.bars[0].prevBar]);if(t.mdata){if(t.mdata.args.id!==this.pair.ID||t.mdata.args.period!==this.getServerPeriod())return;"update"===t.mdata.cmd&&this.data&&this.data.bid&&this.data.bid.length&&t.mdata.args.bar.bid.date>=this.data.bid[0].date&&this.addDataOnUpdate(Object.assign({},t.mdata.args.bar))}},g.prototype.getFirstData=function(){if(this.techChart.connector&&this.techChart.connector.client&&this.techChart.connector.client.connected&&this.techChart&&!this.isWaitForData){var t={pair:this.pair,period:this.period.charAt(0).toUpperCase()+this.period.slice(1),startSeconds:this.startDateSeconds,numb:this.numb+this.fallBack,listener:this,callBack:this.getFirstDataComplete,cmd:"getFirstData",fromServer:!0,typeData:this.typeData};this.getDataOtherChart(t)||(this.isWaitForData=!0,this.techChart.connector.getBars(t),this.techChart.configuration.modules.signals&&(this.techChart.connector.getAutoChartistSignals(),"widgets"===this.techChart.connector.type&&this.techChart.connector.getAutoChartistSignalsList()))}},g.prototype.getDataOtherChart=function(t){for(var e=t.listener,a=0;a<e.techChart.charts.length;a++)if(e.techChart.charts[a].chartData.pair.ID===e.pair.ID&&e.techChart.charts[a].chartData.period===e.period){if(e.techChart.charts[a].chartData.isWaitForData)return clearTimeout(e.getDataOtherChartTimeOut),e.getDataOtherChartTimeOut=setTimeout(function(){e.getDataOtherChart(t),e=null},500),!0;if(this.techChart.charts[a].chartData.data.bid.length>this.data.bid.length){var i=this.createResultFromOtherChartData(this.techChart.charts[a].chartData);return t.fromServer=!1,this.onConnectorMessage(i,this,t),!0}}return!1},g.prototype.createResultFromOtherChartData=function(t){var e=JSON.parse(JSON.stringify(t.data)),a={};return a.bars=e,a.precission=t.precission,a.currentValue={},a.currentValue.ask=t.currentValue.ask,a.currentValue.bid=t.currentValue.bid,a.currentValue.mid=t.currentValue.mid,a.quotation=t.quotationName,a.session=t.session,a},g.prototype.getFirstDataComplete=function(t,e,a){var i=t.bars;e.isWaitForData=!1,i&&0!==i.bid.length&&(e.precission=t.precission,e.data=i,0===parseFloat(e.currentValue.bid)&&(e.currentValue.ask=e.data.ask[0].close,e.currentValue.bid=e.data.bid[0].close,e.currentValue.mid=e.data.mid[0].close),e.startDateSeconds=e.data.bid[0].date,e.setHasData(e,i,a.numb),e.updateChartDataOnComplete(t,e),e.chart&&e.chart.init())},g.prototype.getDataOnUpdate=function(t,e){var a={pair:t.pair,period:t.period,startSeconds:t.startDateSeconds,numb:1,callBack:e,cmd:"getDataOnUpdate"};this.techChart.connector.getBars(a)},g.prototype.getExtraData=function(t,e,a,i){if(!this.isWaitForData){var s=this,r={pair:s.pair,period:s.period,startSeconds:e,numb:a>0?a+s.fallBack:a-s.fallBack,callBack:i,listener:s,cmd:"getDataFromSeconds"};this.getDataOtherChart(r)?s=null:this.techChart.connector.getBars(r)}},g.prototype.getExtraDataOnInitComplete=function(t,e,a){if(t){var i=t.bars;i&&0!==i.bid.length&&(e.setHasData(e,i,a.numb),e.precission=t.precission,e.addBarsToEnd(e,i),e.updateChartDataOnComplete(t,e),e.chart.init())}},g.prototype.getFallBackDataOnMoveToRightComplete=function(t,e,a){if(e.isWaitForData=!1,t){var i=t.bars;i&&0!==i.length&&(e.setHasData(e,i,a.numb),e.precission=t.precission,e.addBarsToEnd(e,i),e.updateChartDataOnComplete(t,e),e.chart.getFallBackDataOnMoveToRightComplete(e.chart,i))}},g.prototype.getExtraDataOnMoveToRightComplete=function(t,e,a){if(e.newsDataMoving=1,e.isWaitForData=!1,t){var i=t.bars;i&&0!==i.length&&(e.setHasData(e,i,a.numb),e.precission=t.precission,e.addBarsToEnd(e,i),e.updateChartDataOnComplete(t,e),e.chart.getDataOnMoveToRightComplete(e.chart,i))}},g.prototype.getFallBackDataOnMoveToLeftComplete=function(t,e,a){e.isWaitForData=!1;var i=[];if(t){if(i=t.bars,e.setHasData(e,i,a.numb),!i||0===i.length)return;e.precission=t.precission,e.addBarsToStart(e,i),e.updateChartDataOnComplete(t,e)}e.chart.getFallBackDataOnMoveToLeftComplete(e.chart,i)},g.prototype.getExtraDataOnMoveToLeftComplete=function(t,e,a){if(this.newsDataMoving=-1,e.isWaitForData=!1,!t){var i=t.bars;i&&0!==i.length&&(e.setHasData(e,i,a.numb),e.precission=t.precission,e.addBarsToStart(e,i),e.updateChartDataOnComplete(t,e),e.chart.getDataOnMoveToLeftComplete(e.chart,i))}},g.prototype.addBarsToEnd=function(t,e){for(var a=0;a<e.bid.length;a++)t.data.bid&&0!==t.data.bid.length||(t.data={bid:[],ask:[],mid:[]},t.data.bid.push(e.bid[a]),t.data.ask.push(e.ask[a]),t.data.mid.push(e.mid[a])),e.bid[a].date<t.data.bid[t.data.bid.length-1].date&&(t.data.bid.push(e.bid[a]),t.data.ask.push(e.ask[a]),t.data.mid.push(e.mid[a]))},g.prototype.addBarsToStart=function(t,e){for(var a=e.bid.length-1;a>=0;a--)t.data.bid&&0!==t.data.bid.length||(t.data={bid:[],ask:[],mid:[]},t.data.bid.unshift(e.bid[a]),t.data.ask.unshift(e.ask[a]),t.data.mid.unshift(e.mid[a])),e.bid[a].date>t.data.bid[t.data.bid.length-1].date&&(t.data.bid.unshift(e.bid[a]),t.data.ask.unshift(e.ask[a]),t.data.mid.unshift(e.mid[a]))},g.prototype.updateChartDataOnComplete=function(t,e){t.quotation&&(e.quotationName=t.quotation),t.session&&(e.session=t.session),this.updateIndicatorsData()},g.prototype.setHasData=function(t,e,a){a>0?t.hasPrevData=e.bid.length>=a:t.hasNextData=e.bid.length>=Math.abs(a)},g.prototype.processData=function(t){for(var e=[],a=0;a<t.length;a++)if(!(t[a-1]&&t[a]&&t[a].T>=t[a-1].T)){var i=parseFloat(t[a].LB).toFixed(this.precission),s=parseFloat(t[a].HB).toFixed(this.precission),r=parseFloat(t[a].OB).toFixed(this.precission),n=parseFloat(t[a].CB).toFixed(this.precission),o=t[a].T,h={lowBid:i,highBid:s,openBid:r,closeBid:n,lowAsk:parseFloat(t[a].LA).toFixed(this.precission),highAsk:parseFloat(t[a].HA).toFixed(this.precission),openAsk:parseFloat(t[a].OA).toFixed(this.precission),closeAsk:parseFloat(t[a].CA).toFixed(this.precission),date:o};e.push(h)}return e},g.prototype.addDataOnUpdate=function(t){var e=this.data;if(e.bid[0]||e.bid[0].isCurrentData){e.ask[0]=t.ask,e.bid[0]=t.bid,e.mid[0]=t.mid;var a={};a.bid=this.createCurrentDataItem(e.bid[0],this.currentValue.bid),a.ask=this.createCurrentDataItem(e.ask[0],this.currentValue.ask),a.mid=this.createCurrentDataItem(e.mid[0],this.currentValue.mid),e.bid.unshift(a.bid),e.ask.unshift(a.ask),e.mid.unshift(a.mid),this.startDateSeconds=a.bid.date,this.chart&&(this.chart.updateChart(null,this,{}),this.chart.getStepedCursorParamsX(this.chart.crosshair.params.x,this.chart.showData[0],this.chart.showData[this.chart.showData.length-1],this.chart.showData[1]))}},g.prototype.updateCurrentData=function(t){if(t.bid=t.bid.replace(",","."),t.ask=t.ask.replace(",","."),t.mid=t.mid.replace(",","."),this.currentValue=t,this.data&&this.data.bid&&0!==this.data.bid.length){if(this.data.bid[0].isCurrentData)this.updateBarHighLow(t,this.data,this.typeData,0);else{var e=this.createCurrentDataItem(this.data.bid[0],t.bid);this.data.bid.unshift(e),e=this.createCurrentDataItem(this.data.ask[0],t.ask),this.data.ask.unshift(e),e=this.createCurrentDataItem(this.data.mid[0],t.mid),this.data.mid.unshift(e)}this.startDateSeconds=this.data.bid[0].date}},g.prototype.updateBarHighLow=function(t,e,a,i){var s=parseFloat(t[a]);s>parseFloat(e[a][i].high)?e[a][i].high=t[a]:s<parseFloat(e[a][i].low)&&(e[a][i].low=t[a]),e[a][i].close=t[a]},g.prototype.createCurrentDataItem=function(t,e){var a=parseFloat(t.close),i=parseFloat(e),s=a<i?t.close:e,r=a>i?t.close:e;return{open:t.close,close:e,low:s,high:r,date:t.date+this.getCurrentTimeStep(),isCurrentData:!0}},g.prototype.processRates_WebApp=function(t){var e=this.data,a=this.chart;if(this.currentValue.ask=t.ask.close,this.currentValue.bid=t.bid.close,this.currentValue.mid=t.mid.close,e.ask[0].close=t.ask.close,e.ask[0].open=t.ask.open,e.ask[0].low=t.ask.low,e.ask[0].high=t.ask.high,e.bid[0].close=t.bid.close,e.bid[0].open=t.bid.open,e.bid[0].low=t.bid.low,e.bid[0].high=t.bid.high,e.mid[0].close=t.mid.close,e.mid[0].open=t.mid.open,e.mid[0].low=t.mid.low,e.mid[0].high=t.mid.high,a){var i={ask:t.ask.close,bid:t.bid.close,mid:t.mid.close};if(a.isDrawCurrentShowData(this,a.showData)){if(a.updateCurrentData(i),this.options.Chart.autoScale&&(parseFloat(i[this.typeData])>this.scaleParams.maxV||parseFloat(i[this.typeData])<this.scaleParams.minV)){var s=a.getScaleParams(a.selectedData,a.h,this.precission);if(isNaN(parseFloat(s.minB))&&isNaN(parseFloat(s.maxB))&&isNaN(parseFloat(s.deltaY)))return;this.options.Chart.scaleSeriesOnly||a.resizeShowDataByTrendIndicators(),(s.minB<this.scaleParams.minB||s.maxB>this.scaleParams.maxB)&&(this.scaleParams=s,a.resizeShowDataValuesY(a.showData,a.h,this.scaleParams),a.draw(a.showData,a.h),a.valueAxis=a.getValueAxis(this.scaleParams.minB,this.scaleParams.maxB,a.valueAxisCount,a.w,a.h,this.options.Chart.scalesFontSize,this.precission,a.offY),a.getOscillatorChartsAxis(),a.clearGrid(),a.drawValueAxis(a.valueAxis),a.drawOscillatorChartsAxis(),a.drawTimeAxis(a.timeAxis),a.drawChartBorder())}var r=a.canvasRateNormalContext,n=a.canvasRatePixelatedContext;LibCanvas.clearRect(null,r,0,0,r.canvas.width,r.canvas.height),LibCanvas.clearRect(null,n,0,0,n.canvas.width,n.canvas.height),a.drawCurrentShowData(i,t),this.updateCurrentIndicatorsData(),a.redrawOscillators();var o,h=a.constructor.name;switch(h){case"BarChart":case"HollowChart":case"CandleChart":o=this.colors[h].candleBear;break;case"LineChart":case"AreaChart":o=this.colors[h].priceLine}a.drawCurrentLabel(i,o,!0,!1,this.colors[h])}else a.redrawCurrentPriceLine(this.currentValue)}},g.prototype.getIndicatorIndex=function(t,e){for(var a=0;a<t.length;a++)if(t[a].id===e.id)return a;return-1},g.prototype.clearIndicatorsData=function(){for(var t=0;t<this.indicators.length;t++)this.indicators[t].data={},this.indicators[t].showData=[]},g.prototype.updateIndicatorsData=function(){for(var t=0;t<this.indicators.length;t++)if(this.indicators[t].createData(this.data[this.typeData]),this.indicators[t].createShowData(),"oscillator"===this.indicators[t].type){if(!(Object.keys(this.indicators[t].data).length>1))return;this.chart.getOscillatorsScaleParams()}this.chart&&this.chart.draw(this.chart.showData,this.chart.h)},g.prototype.updateCurrentIndicatorsData=function(){for(var t=0;t<this.indicators.length;t++)this.indicators[t].createCurrentValue(this.data[this.typeData]),this.indicators[t].createShowData()},g.prototype.getOscillatorChartsPrecission=function(){for(var t=0,e=0;e<this.indicators.length;e++)"oscillator"===this.indicators[e].type&&t<this.indicators[e].oscillatorPrecission&&(t=this.indicators[e].oscillatorPrecission);return t},g.prototype.getCurrentTimeStep=function(){switch(this.period.toString()){case"1":return 60;case"5":return 300;case"15":return 900;case"30":return 1800;case"60":return 3600;case"hour4":return 14400;case"hour8":return 28800;case"day":return 86400;case"week":return 604800;case"month":return 24*this.getDaysInMonth((new Date).getMonth(),(new Date).getFullYear())*60*60;default:return 60}},g.prototype.getServerPeriod=function(){return g.convertValueToServerPeriod(this.period.toString())},g.prototype.getDaysInMonth=function(t,e){return new Date(e,t,0).getDate()},g.prototype.waitForData=function(t,e){!function run(){t.isWaitForData?(clearTimeout(t.waitForDataTimer),t.waitForDataTimer=setTimeout(run,1)):(clearTimeout(t.waitForDataTimer),e(t))}()},g.cloneCircle=function(t){for(var e=[],a=0;a<t.length;a++)e.push(t[a].convertToDTOCircle());return e},g.convertDrawingObjects=function(t,e){for(var a=[],i=0;i<t.length;i++){var s=LibDrawing.createDrawingObjectByType(t[i].type,[e,t[i]]);for(var r in t[i])s[r]=t[i][r];s.state="normal",a.push(s)}return a},g.convertValueToPeriod=function(t){switch(t){case"1":return"1";case"5":return"5";case"15":return"15";case"30":return"30";case"60":return"60";case"hour4":return"hour4";case"hour8":return"hour8";case"day":return"day";case"week":return"week";case"month":return"month";case"minute":return"1";case"minute5":return"5";case"minute15":return"15";case"minute30":return"30";case"hour":default:return"60"}},g.convertValueToServerPeriod=function(t){switch(t){case"1":return"minute";case"5":return"minute5";case"15":return"minute15";case"30":return"minute30";case"60":return"hour";case"hour4":return"hour4";case"hour8":return"hour8";case"day":return"day";case"week":return"week";case"month":return"month";case"minute":return"minute";case"minute5":return"minute5";case"minute15":return"minute15";case"minute30":return"minute30";case"hour":return"hour";default:return"minute"}},g.prototype.getCurrentTimeStepByServerPeriod=function(){switch(this.period.toString()){case"1":return 60;case"5":return 300;case"15":return 900;case"30":return 1800;case"60":return 3600;case"minute":return 60;case"minute5":return 300;case"minute15":return 900;case"minute30":return 1800;case"hour":return 3600;case"hour4":return 14400;case"hour8":return 28800;case"day":return 86400;case"week":return 604800;case"month":return 24*this.getDaysInMonth((new Date).getMonth(),(new Date).getFullYear())*60*60;default:return 60}},g.uniqueElementsByFieldName=function(t,e){for(var a=[],i=[],s=0;s<t.length;s++)a.indexOf(t[s][e])>-1||(a.push(t[s][e]),i.push(t[s]));return a=null,i},g.getNamePeriod=function(t){var e=t;for(var a in this.techChart.periods())this.techChart.periods()[a].value===t&&(e=this.techChart.translation[this.techChart.periods()[a].key]);return e},g.convertDataToMs=function(t){return new Date(t).getTime()/1e3},g.prototype.formatFloat=function(t){if(0==t)return 0;if(t&&isFinite(t)){var e="";t<0&&(e="-",t=-t);var a=""+t,i=a.indexOf(".");if(-1===i&&(i=a.length),i<=3)return e+a;for(var s="",r=0,n=i%3;n<i;n+=3)0!=n&&(s+=a.slice(r,n)+",",r=n);return e+(s+a.slice(r))}},g.prototype.formatPayout=function(t,e,a){var i=parseFloat(t);return e=e||1e8,a=a||0,i>=1e10||i<=-1e10?(i/=1e6,t=this.formatFloat(i.toFixed(a))+"M"):i>=e||i<=-1*e?(i/=1e3,t=this.formatFloat(i.toFixed(a))+"K"):t=this.formatFloat(i.toFixed(a)),t},g.prototype.convertToDTO=function(){var t={};t.id=this.id,t.chartType=this.chartType,t.cursorType=this.cursorType,t.period=this.period,t.timeMode=this.timeMode,t.source=this.source,t.options=Object(o.b)(this.options),t.colors=Object(o.b)(this.colors),t.pair=Object(o.b)(this.pair),t.candleWidth=this.candleWidth,t.scaleParams=Object(o.b)(this.scaleParams),t.startX=this.startX,t.startY=this.startY,t.isDrawingObjectsLocked=this.isDrawingObjectsLocked,t.connectorOptions=this.connectorOptions,t.indicators=this.convertIndicatorsToDTO(),t.drawingObjects=this.convertDrawingObjectsToDTO(),t.zoomData=Object(o.b)(this.zoomData),t.zoomSteps=Object(o.b)(this.zoomSteps),t.isShowDrawingObjects=this.isShowDrawingObjects,t.isStayDrawingMode=this.isStayDrawingMode,t.isMagnetMode=this.isMagnetMode,t.isPipsShow=this.isPipsShow,t.state="drawingRoulete"===t.state?"default":this.state,t.startDateSeconds=this.startDateSeconds,t.h=this.h,t.top=this.top,t.typeData=this.typeData;var e=this.parentRect,a={bottom:e.bottom,height:e.height,left:e.left,right:e.right,top:e.top,width:e.width};return t.parentRect=Object(o.b)(a),t.isShowSignalsBody=this.isShowSignalsBody,t.isShowAllSignals=this.isShowAllSignals,t.signalsData=Object(o.b)(this.signalsData),t.newsData=Object(o.b)(this.newsData),t.precission=this.precission,t.isExpired=this.isExpired,t.currentTabId=this.currentTabId,t.payout=Object(o.b)(this.payout),t.closedOption=Object(o.b)(this.closedOption),t},g.prototype.convertDrawingObjectsToDTO=function(){for(var t=[],e=0;e<this.drawingObjects.length;e++)t.push(this.drawingObjects[e].convertToDTO());return t},g.prototype.convertIndicatorsToDTO=function(){for(var t=[],e=0;e<this.indicators.length;e++)t.push(this.indicators[e].convertToDTO());return t},g.prototype.convertFromDTO=function(t){this.id=t.id,this.chartType=t.chartType,this.cursorType=t.cursorType,this.period=t.period,this.timeMode=t.timeMode,this.source=t.source,this.options=Object(o.b)(t.options),this.colors=Object(o.b)(t.colors),this.pair=Object(o.b)(t.pair),this.data={ask:[],bid:[],mid:[]},this.candleWidth=t.candleWidth,this.scaleParams=Object(o.b)(t.scaleParams),this.startX=t.startX,this.startY=t.startY,this.isDrawingObjectsLocked=t.isDrawingObjectsLocked,this.currentValue={bid:"0.00000",ask:"0.00000",mid:"0.00000"},this.connectorOptions=t.connectorOptions,this.indicators=this.convertIndicatorsFromDTO(t.indicators),this.drawingObjects=[],this.drawingObjects=this.convertDrawingObjectsFromDTO(t.drawingObjects),this.zoomData=Object(o.b)(t.zoomData),this.zoomSteps=Object(o.b)(t.zoomSteps),this.isShowDrawingObjects=t.isShowDrawingObjects,this.isStayDrawingMode=t.isStayDrawingMode,this.isMagnetMode=t.isMagnetMode,this.isPipsShow=t.isPipsShow,this.state=t.state,this.startDateSeconds=t.startDateSeconds,this.h=t.h,this.top=t.top,this.parentRect=Object(o.b)(t.parentRect),this.typeData=t.typeData,this.isShowSignalsBody=t.isShowSignalsBody,this.isShowAllSignals=t.isShowAllSignals,this.signalsData=Object(o.b)(t.signalsData),this.newsData=Object(o.b)(t.newsData),this.precission=t.precission,this.currentTabId=t.currentTabId,this.payout=Object(o.b)(t.payout),this.isExpired=!!t.isExpired&&t.isExpired,this.closedOption=t.closedOption?t.closedOption:null,this.isFreeze=!!t.isFreeze&&t.isFreeze},g.prototype.convertIndicatorsFromDTO=function(t){this.indicators=[];for(var e=[],a=0;a<t.length;a++)e.push(Indicator.convertFromDTO(this,t[a]));return e},g.prototype.convertDrawingObjectsFromDTO=function(t){for(var e=[],a=0;a<t.length;a++)e.push(DrawingObject.convertFromDTO(this,t[a]));return e},g.prototype.setSignalsInterval=function(){var t=this;this.getSignalsInterval=setInterval(function(){t.getSignals()},12e4)},g.prototype.getSignals=function(){this.techChart.connector.getAutoChartistSignals(),"widgets"===this.techChart.connector.type&&this.techChart.connector.getAutoChartistSignalsList()},g.prototype.processSignals=function(t,e){e.updateData(t,e)},g.prototype.updateData=function(t,e){var a=!1,i=Object.keys(t);if(0===Object.keys(e.signalsData).length&&i.length)e.signalsData=t,a=!0;else{for(var s=0;s<i.length;s++)e.signalsData[i[s]]?t[i[s]].isVisible=e.signalsData[i[s]].isVisible:a=!0;e.signalsData=t}!e.chart||!a&&e.chart.signalsPanel||e.chart.updateSignals()},g.prototype.getNews=function(t,e){if(!this.isShowNews||isNaN(t)||isNaN(e))return!1;var a=!1;if(null===this.newsData.currentFrom)this.newsData.currentFrom=t,this.newsData.currentTo=e,this.getNewsData(this.newsData.currentFrom,this.newsData.currentTo),a=!0;else{var i=this.newsData.currentFrom-t,s=e-this.newsData.currentTo;i>0?(this.getNewsData(t,this.newsData.currentFrom),this.newsData.currentFrom=t,a=!0):s>0&&(this.getNewsData(this.newsData.currentTo,e),this.newsData.currentTo=e,a=!0)}return a},g.prototype.getNewsData=function(t,e){var a={listener:this,callBack:this.getNewsDataComplete,interval:{from:t,to:e},cmd:"getNewsData"};this.techChart.connector.getNews(a)},g.prototype.getNewsDataComplete=function(t,e){t.length&&(e.updateNews(t),e.chart.updateNewsBubbles())},g.prototype.updateNews=function(t){var e=t.reduce(function(t,e){return e&&e.Image&&(e.Image=e.Image.replace(/@/gi,"")),function _toConsumableArray(t){return function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var e=0,a=new Array(t.length);e<t.length;e++)a[e]=t[e];return a}}(t)||function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}(t).concat([e])},[]),a=this.newsData.news.concat(e),i=g.uniqueElementsByFieldName(a,"ID");this.newsData.news=i.sort(function(t,e){var a=e.PublishDate-t.PublishDate;return 0===a?t.ID-e.ID:a})},g.prototype.getEvents=function(t,e){if(!this.isShowEvents||isNaN(t)||isNaN(e))return!1;if(!this.techChart.configuration.quotationCountries)return!1;var a=!1;if(null===this.eventsData.currentFrom)this.eventsData.currentFrom=t,this.eventsData.currentTo=e,this.eventsData.apiFrom=this.techChart.connector.convertUnixToEventsAPIDate(this.eventsData.currentFrom),this.eventsData.apiTo=this.techChart.connector.convertUnixToEventsAPIDate(this.eventsData.currentTo),this.getEventsData(this.eventsData.currentFrom,this.eventsData.currentTo),a=!0;else{var i=this.eventsData.currentFrom-t,s=e-this.eventsData.currentTo;if(i>0){var r=this.techChart.connector.convertUnixToEventsAPIDate(t);this.eventsData.apiFrom!==r&&(this.eventsData.apiFrom=r,this.getEventsData(t,this.eventsData.currentFrom),this.eventsData.currentFrom=t,a=!0)}if(s>0){var n=this.techChart.connector.convertUnixToEventsAPIDate(e);this.eventsData.apiTo!==n&&(this.eventsData.apiTo=n,this.getEventsData(this.eventsData.currentTo,e),this.eventsData.currentTo=e,a=!0)}}return a},g.prototype.getEventsData=function(t,e){var a={listener:this,callBack:this.getEventsDataComplete,interval:{from:t,to:e},lang:this.techChart.configuration.lang,cmd:"getEventsData",countries:this.techChart.configuration.quotationCountries[this.pair.Name]};this.techChart.connector.getEvents(a)},g.prototype.getEventsDataComplete=function(t,e){t.length&&(e.updateEvents(t),e.chart.updateEventsBubbles())},g.prototype.updateEvents=function(t){var e=this.eventsData.events.concat(t),a=g.uniqueElementsByFieldName(e,"IdEcoCalendarDate");this.eventsData.events=a.sort(function(t,e){return Bubble.getDateEventsBubble(e)-Bubble.getDateEventsBubble(t)})},Helper.detectBrowser=function(t,e){var a,i;if(-1!==t.navigator.userAgent.indexOf("Opera")||-1!==t.navigator.userAgent.indexOf("OPR")){try{a=t.navigator.userAgent.split("OPR/")[1].split(" ")[0]}catch(s){a="0"}i={bro:"opera",ver:a}}else if(-1!==t.navigator.userAgent.indexOf("MSIE")||e.documentMode){try{a=t.navigator.userAgent.split("rv:")[1].split(")")[0]}catch(s){a="0"}i={bro:"ie",ver:a}}else if(t.StyleMedia){try{a=t.navigator.userAgent.split("Edge/")[1].split(" ")[0]}catch(s){a="0"}i={bro:"edge",ver:a}}else if(-1!==t.navigator.userAgent.indexOf("Chrome")){try{a=t.navigator.userAgent.split("Chrome/")[1].split(" ")[0]}catch(s){a="0"}i={bro:"chrome",ver:a}}else if(-1!==t.navigator.userAgent.indexOf("Safari")){try{a=t.navigator.userAgent.split("Safari/")[1].split(" ")[0]}catch(s){a="0"}i={bro:"safari",ver:a}}else if(-1!==t.navigator.userAgent.indexOf("Firefox")){try{a=t.navigator.userAgent.split("Firefox/")[1].split(" ")[0]}catch(s){a="0"}i={bro:"firefox",ver:a}}else i={bro:"unknown",ver:"unknown"};return i},Helper.isBrowOk=function(t,e){var a=Object.keys(t).indexOf(e.bro);if(a>-1){var i=t[Object.keys(t)[a]];i=i.split(".");for(var s=e.ver.split("."),r=0;r<s.length;r++){if(parseInt(i[r])<parseInt(s[r]))return!0;if(parseInt(i[r])>parseInt(s[r]))return!1}return!0}return!1},Helper.warningBrowser=function(){var t=Helper.detectBrowser(window,document);return Helper.isBrowOk(Helper.validBrowsers,t)},Helper.showWarningBrowser=function(t,e){var a=void 0===t?Helper.alertMag:t,i=void 0===e?document.body:e,s=document.createElement("div");s.parent=i,s.classList.toggle("tch-divAlert",!0);var r=document.createElement("span");r.classList.toggle("tch-spanAlert",!0),r.innerHTML=a,s.appendChild(r),s.addEventListener("click",function(t){Helper.removeAlert(t.target)}),i.appendChild(s)},Helper.removeAlert=function(t){(t=t||this).parent.removeChild(t)},Helper.validBrowsers={opera:"43.0",edge:"14.14393",chrome:"56.0.2924.87",safari:"9.1.3",firefox:"51.0.1"},Helper.alertMag="<p>Отображение и работа графика могут быть не верными в текущей версии браузера.</p><span>Кликните, чтобы продолжить.</span>",Candle.prototype.show=function(t,e,a,i){if(t||!this.useCanvas){var s,r,n,o,h=t.getContext("2d"),c=parseFloat(this.high),l=parseFloat(this.low),d=parseFloat(this.open),p=parseFloat(this.close),u=parseFloat(this.y),g=parseFloat(this.y)-(c-l)/this.scale,v=Math.abs(d-p)/this.scale,f=v>0?v:1,y=parseFloat(this.y)+parseFloat(l-Math.max(d,p))/this.scale,D=a.CandleChart.candleBool,w=a.CandleChart.candleBear,m=a.CandleChart.candleLineBool,b=a.CandleChart.candleLineBear,C=a.CandleChart.candleBoolBorder,x=a.CandleChart.candleBearBorder;d>p?(r=w,n=b,o=x):(r=D,n=m,o=C);var L=i.widthWickLine;s=LibCanvas.getPosition(parseFloat(this.x),L);var P=Math.round(u),S=Math.round(g);this.posWick={x:s,y1:P,y2:S,width:L},i.needWick&&LibCanvas.drawLine(null,h,s,P,s,S,n,[],L);var T,O,B,A,F,k=e,j=2*i.widthBorderLine,E=i.widthBorderLine;k=2*((s=LibCanvas.getPosition(parseFloat(this.x),k))-Math.round(s-k/2)),T=Math.round(y),O=Math.round(y+f),B=Math.round(y+E),A=Math.round(y+f-E),F=k-j,i.needBorder?(LibCanvas.drawLine(null,h,s,T,s,O,o,[],k),LibCanvas.drawLine(null,h,s,B,s,A,a.Chart.backgroundColor,[],F),LibCanvas.drawLine(null,h,s,B,s,A,r,[],F)):(LibCanvas.drawLine(null,h,s,T,s,O,a.Chart.backgroundColor,[],k),LibCanvas.drawLine(null,h,s,T,s,O,r,[],k)),this.posCandle={x:s,y1:T,y2:O,width:k},this.posBorderCandle={x:s,y1:B,y2:A,width:F}}};var v=function(){function CandleChart(t,e,a){var i;return function CandleChart_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,CandleChart),(i=function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!==typeof e?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,_getPrototypeOf(CandleChart).call(this,t,e,a))).constructor.name||(i.constructor.name="CandleChart"),i.getFractalItemY=function(t,e){return"low"===e?i.toYPixels(t.fractalLow):"high"===e?i.toYPixels(t.fractalHigh):void 0},i.drawCrosshair=function(t,e,a){var s=i.drawCrosshairChart(t);if(s&&i.isShowCrosshair&&(!i.chartData.editDrawingObject||!i.chartData.editDrawingObject.isFocused)&&(!i.chartData.activeDrawingObject||!i.chartData.activeDrawingObject.isFocused)){var r=i.chartData.colors.Chart.crosshair,n=(Math.round(i.chartData.candleWidth),parseFloat(s.low),parseFloat(s.open)),o=parseFloat(s.close),h=(parseFloat(s.x),parseFloat(s.y),"transparent");if(i.chartData.options[i.constructor.name].widthBorderLine,i.curX<i.w-8){var c;if(i.canvasInfoContext.save(),i.canvasInfoContext.beginPath(),i.canvasInfoContext.rect(0,0,i.w-8,i.h),i.canvasInfoContext.closePath(),i.canvasInfoContext.clip(),h=n>o?i.chartData.colors[i.constructor.name].candleBear:i.chartData.colors[i.constructor.name].candleBool,s.posWick&&s.posWick.x)c=s.posWick.x;else{if(!s.posCandle||!s.posCandle.x)return;c=s.posCandle.x}var l=s.posWick.y1,d=s.posWick.y2,p=s.posWick.width;i.chartData.options[i.constructor.name].needWick&&LibCanvas.drawLine(null,t,c,l,c,d,r,[],p),c=s.posCandle.x;var u=s.posCandle.y1,g=s.posCandle.y2,v=s.posCandle.width;LibCanvas.drawLine(null,t,c,u,c,g,r,[],v),c=s.posBorderCandle.x;var f=s.posBorderCandle.y1,y=s.posBorderCandle.y2,D=s.posBorderCandle.width;LibCanvas.drawLine(null,t,c,f,c,y,i.chartData.colors.Chart.backgroundColor,[],D),LibCanvas.drawLine(null,t,c,f,c,y,h,[],D),a&&i.chartData.isPipsShow&&i.chartData.currentValue&&i.drawPips(t),i.canvasInfoContext.restore()}}},i.getElementIndexByPositionX=function(t,e){if(0!==t.length){var a=0,s=.5*i.chartData.candleWidth;if(e>=t[0].x-s)a=0;else if(t[t.length-2]&&e<t[t.length-2].x-s)a=t.length-1;else for(var r=0;r<t.length;r++)if(t[r+1]&&e<t[r].x-s&&e>=t[r+1].x-s){a=r+1;break}return a}},i.isPositionValid=function(){return parseFloat(i.showData[0].x)<i.w-i.chartData.rightPadding+i.chartData.spacing},i.resizeShowDataValuesY=function(t,e,a){for(var s=0;s<t.length;s++)i.resizeShowItemValuesY(t[s],e,a)},i.resizeShowItemValuesY=function(t,e,a){var s=i.getCoordinateY(t.low,e,a.minB,a.deltaY);t.y=s,t.scale=a.deltaY},i.getNumberOfDataToRight=function(t,e,a,i){return parseInt((e-a-t)/i)},i.moveElementsX=function(t,e){for(var a=0;a<t.length;a++){var s=parseFloat(t[a].x)-e;t[a-1]&&parseFloat(t[a-1].x)-s<i.chartData.spacing&&(s=parseFloat(t[a-1].x)-i.chartData.spacing),t[a].x=s.toFixed(1)}},i.moveElementsY=function(t,e){for(var a=0;a<t.length;a++){var i=parseFloat(t[a].y)-e;t[a].y=i.toFixed(1)}},i.needsElementToRight=function(t,e,a,i){return parseFloat(t[0].x)+i<e-a},i.needsElementToLeft=function(t,e){return parseFloat(t[t.length-1].x)>e},i.drawCurrentShowData=function(t,e){var a=t[i.chartData.typeData],s=parseFloat(a),r=parseFloat(i.showData[0].low),n=parseFloat(i.showData[0].high);r>s?i.showData[0].low=a:n<s&&(i.showData[0].high=a),e&&(i.showData[0].open=e[i.chartData.typeData].open,i.showData[0].close=e[i.chartData.typeData].close,i.showData[0].low=e[i.chartData.typeData].low,i.showData[0].high=e[i.chartData.typeData].high);var o=i.getCoordinateY(i.showData[0].low,i.h,i.chartData.scaleParams.minB,i.chartData.scaleParams.deltaY),h=i.getCoordinateY(i.showData[0].high,i.h,i.chartData.scaleParams.minB,i.chartData.scaleParams.deltaY);i.chartData.options.Chart.autoScale&&(parseFloat(h)-i.chartData.marginTop<0||parseFloat(o)+i.chartData.marginBottom>i.h)&&(i.chartData.scaleParams=i.getScaleParams(i.selectedData,i.h,i.chartData.precission),i.resizeShowDataValuesY(i.showData,i.h,i.chartData.scaleParams),i.chartData.options.Chart.scaleSeriesOnly||i.resizeShowDataByTrendIndicators(),i.draw(i.showData,i.h),i.valueAxis=i.getValueAxis(i.chartData.scaleParams.minB,i.chartData.scaleParams.maxB,5,i.w,i.h,i.chartData.options.Chart.scalesFontSize,i.chartData.precission),i.clearGrid(),i.drawValueAxis(i.valueAxis),i.drawOscillatorChartsAxis(),i.drawTimeAxis(i.timeAxis),i.drawChartBorder()),i.showData[0].close=a,i.showData[0].y=o,i.showData[0].isCurrentData=!0;var c=i.canvasRatePixelatedContext.canvas;i.canvasRatePixelatedContext.save(),i.canvasRatePixelatedContext.beginPath(),i.canvasRatePixelatedContext.rect(0,0,i.w-8,i.h),i.canvasRatePixelatedContext.closePath(),i.canvasRatePixelatedContext.clip();var l=i.showData[1]?i.showData[1].close:i.showData[0].open;i.showData[0].show(c,i.chartData.candleWidth,i.chartData.colors,i.chartData.options[i.constructor.name],l),i.canvasRatePixelatedContext.restore(),i.curX&&i.curY&&(i.clearInfo(),i.drawActiveDrawingObjects(),i.drawCrosshair(i.canvasInfoContext,null,i.techChart.configuration.modules.headerButtons.createPipsButton))},i.getCoordinateX=function(t,e,a,i,s){if(t=parseFloat(t),e=parseFloat(e),a=parseFloat(a),i=parseFloat(i),!(isNaN(t)||isNaN(e)||isNaN(a)||isNaN(i))){var r=parseFloat(t-e-i*a);return r=r>0?r:0,(r-=s).toFixed(1)}},i.processDataToShow=function(t,e,a,s,r,n,o,h){o=void 0===o?0:o,o=i.chartData.techChart.isFullScreen?1.6*o:.5*o,i.chartData.scaleParams=h||i.getScaleParams(t,r,n);for(var c=[],l=0;l<t.length;l++){var d=t[l];n||(n=u.countDigits(d.high));var p=i.getCoordinateX(s,e,a,l,o);if(p<=0)break;var g=i.getCoordinateY(d.low,r,i.chartData.scaleParams.minB,i.chartData.scaleParams.deltaY),v=new Candle(parseFloat(d.low).toFixed(n),parseFloat(d.high).toFixed(n),parseFloat(d.open).toFixed(n),parseFloat(d.close).toFixed(n),parseFloat(d.date),p,g,i.chartData.scaleParams.deltaY,i.useCanvas);d.isCurrentData&&(v.isCurrentData=!0),c.push(v)}return c},i.createShowDataItem=function(t,e){var a=new Candle(parseFloat(t.low).toFixed(e),parseFloat(t.high).toFixed(e),parseFloat(t.open).toFixed(e),parseFloat(t.close).toFixed(e),t.date,"0.0","0.0",1,i.useCanvas);return t.isCurrentData&&(a.isCurrentData=!0),a},i.setChartElementsSize=function(t){var e=i.getChartElementsSize();e.candleWidth&&(t.candleWidth=e.candleWidth),t.spacing=1.5*t.candleWidth},i.getMaxValue=function(t){for(var e=Number.MIN_VALUE,a=0;a<t.length;a++){var i=parseFloat(t[a].high);e<i&&(e=i)}return e},i.getMinValue=function(t){for(var e=Number.MAX_VALUE,a=0;a<t.length;a++){var i=parseFloat(t[a].low);e>i&&(e=i)}return e},i.deleteRedundantElements=function(t,e,a,i){for(var s=t.length-1;s>=0;s--)parseFloat(t[s].x)>a-i?t.length>1?t.splice(s,1):t[s].x=a-i:parseFloat(t[s].x)<=0&&t.length>1&&t.splice(s,1)},i.draw=function(t,e){if(i.chartData.drawingObjects.length)for(var a=0;a<i.chartData.drawingObjects.length;a++)"active"===i.chartData.drawingObjects[a].state&&LibCanvas.clearRect(null,i.canvasDrawingActiveContext,0,0,i.canvasDrawingActive.width,i.canvasDrawingActive.height),i.redrawActiveDrawingObjects(!0);if(i.drawChart(t,e))for(var s=i.canvasDataPixelatedContext.canvas,r=0;r<t.length;r++)t[r].isCurrentData||t[r].show(s,i.chartData.candleWidth,i.chartData.colors,i.chartData.options[i.constructor.name])},i}return function _inherits(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}(CandleChart,u),CandleChart}(),f=function(){function LineChart(t,e,a){var i;return function LineChart_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,LineChart),i=function LineChart_possibleConstructorReturn(t,e){return!e||"object"!==LineChart_typeof(e)&&"function"!==typeof e?LineChart_assertThisInitialized(t):e}(this,LineChart_getPrototypeOf(LineChart).call(this,t,e,a)),function LineChart_defineProperty(t,e,a){e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a}(LineChart_assertThisInitialized(LineChart_assertThisInitialized(i)),"draw",function(){i.draw()}),i.getFractalItemY=function(t){for(var e=0,a=i.selectedData,s=0;s<a.length;s++)if(a[s].date===t.T){var r=parseFloat(a[s].high),n=parseFloat(a[s].low);parseFloat(a[s].open),parseFloat(a[s].close),e=parseFloat(((r+n)/2).toFixed(i.chartData.precission));break}return i.toYPixels(e)},i.isPositionValid=function(){return parseFloat(i.showData[0].x)<i.w-i.chartData.rightPadding+i.chartData.spacing},i.resizeShowDataValuesY=function(t,e,a){for(var s=0;s<t.length;s++)i.resizeShowItemValuesY(t[s],e,a)},i.resizeShowItemValuesY=function(t,e,a){var s=i.getCoordinateY(t.value,e,a.minB,a.deltaY);t.y=s,t.scale=a.deltaY},i.getNumberOfDataToRight=function(t,e,a,i){return Math.ceil((e-a-t)/i)},i.moveElementsX=function(t,e,a,i){for(var s,r=t.length-1;r>=0;r--)(s=parseFloat(t[r].x)-e)<0&&(s=0),s>a-i&&(s=a-i),t[r].x=s.toFixed(1)},i.moveElementsY=function(t,e){for(var a=0;a<t.length;a++){var i=parseFloat(t[a].y)-e;t[a].y=i.toFixed(1)}},i.needsElementToRight=function(t,e,a){return parseFloat(t[0].x)<e-a},i.needsElementToLeft=function(t){return parseFloat(t[t.length-1].x)>0},i.getCoordinateX=function(t,e,a,i,s){if(t=parseFloat(t),e=parseFloat(e),a=parseFloat(a),i=parseFloat(i),!(isNaN(t)||isNaN(e)||isNaN(a)||isNaN(i))){var r=parseFloat(t-e-i*a);return r=r>0?r:0,(r-=s).toFixed(1)}},i.setChartElementsSize=function(t){var e=i.getChartElementsSize();e.lineSpacing&&(t.spacing=e.lineSpacing)},i.getMinValue=function(t,e){if(t&&0!==t.length)return void 0===t[0].high&&void 0===t[0].low?i.getMinShowDataValue(t,e):i.getMinSelectedDataValue(t,e)},i.getMaxValue=function(t,e){if(t&&0!==t.length)return void 0===t[0].high&&void 0===t[0].low?i.getMaxShowDataValue(t,e):i.getMaxSelectedDataValue(t,e)},i.getMaxShowDataValue=function(t){for(var e=0,a=0;a<t.length;a++){var i=parseFloat(t[a].value);e<i&&(e=i)}return e},i.getMaxSelectedDataValue=function(t){for(var e=0,a=0;a<t.length;a++){var i=parseFloat(t[a].high),s=(parseFloat(t[a].low),parseFloat(i));e<s&&(e=s)}return e},i.getMinShowDataValue=function(t){for(var e=Number.MAX_VALUE,a=0;a<t.length;a++){var i=parseFloat(t[a].value);e>i&&(e=i)}return e},i.getMinSelectedDataValue=function(t){for(var e=Number.MAX_VALUE,a=0;a<t.length;a++){parseFloat(t[a].high);var i=parseFloat(t[a].low),s=parseFloat(i);e>s&&(e=s)}return e},i.createShowDataItem=function(t,a){var s=e.options.LineChart.priceSource,r=new Point(i.getValueFromTypePrice(t,s,a),t.date,"0.0","0.0",t);return t.isCurrentData&&(r.isCurrentData=!0),r},i.processDataToShow=function(t,a,s,r,n,o,h,c){h=void 0===h?0:h,h=i.chartData.techChart.isFullScreen?1.6*h:.5*h,i.chartData.scaleParams=c||i.getScaleParams(t,n,o);for(var l=[],d=i.chartData.chart.constructor.name,p=e.options[d].priceSource,u=0;u<t.length;u++){var g=t[u],v=i.getValueFromTypePrice(g,p,o),f=i.getCoordinateX(r,a,s,u,h),y=i.getCoordinateY(parseFloat(v),n,i.chartData.scaleParams.minB,i.chartData.scaleParams.deltaY),D=i.createShowDataItem(g,o);if(D.x=f,D.y=y,g.isCurrentData&&(D.isCurrentData=!0),l.push(D),f<=0)break}return l},i.getValueFromTypePrice=function(t,e,a){var i;switch(e){case"Open":i=parseFloat(t.open).toFixed(a);break;case"High":i=parseFloat(t.high).toFixed(a);break;case"Low":i=parseFloat(t.low).toFixed(a);break;case"Close":i=parseFloat(t.close).toFixed(a);break;case"(H+L)/2":i=((parseFloat(t.high)+parseFloat(t.low))/2).toFixed(a);break;case"(H+L+C)/3":i=((parseFloat(t.high)+parseFloat(t.low)+parseFloat(t.close))/3).toFixed(a);break;case"(O+H+L+C)/4":i=((parseFloat(t.open)+parseFloat(t.high)+parseFloat(t.low)+parseFloat(t.close))/4).toFixed(a);break;default:return((parseFloat(t.high)+parseFloat(t.low))/2).toFixed(a)}return i},i.drawLastBarPrice=function(t){if(t){var e,a,s=i.chartData.chart.constructor.name;e=i.parent.querySelector(".tch-rate-value"),a=i.chartData.colors[s].priceLine;var r=i.toYPixels(t.value);r>0&&r<i.h?i.drawPrice(parseFloat(t.value).toFixed(i.chartData.precission),r,"tch-price-bear",!0,a):e.parentNode.style.display="none"}},i.drawCrosshair=function(t,e,a){i.drawCrosshairChart(t)&&a&&i.chartData.isPipsShow&&i.chartData.currentValue&&i.drawPips(t)},i.calculateDelta=function(){var t=i.showData[1].date-i.showData[2].date,e=i.techChart.connector.getCurrentTime()/1e3-i.showData[1].date,a=null,s=null;return e<t?(s=100*e/t,a=(i.chartData.spacing*s/100).toFixed(0)):a=i.chartData.spacing,a},i.drawCurrentShowData=function(t){if(i.showData[0].isCurrentData){var e=i.showData[0].x,a=i.getCoordinateY(parseFloat(t[i.chartData.typeData]),i.h,i.chartData.scaleParams.minB,i.chartData.scaleParams.deltaY);i.chartData.options.Chart.autoScale&&(parseFloat(a)-i.chartData.marginTop<0||parseFloat(a)+i.chartData.marginBottom>i.h)&&(i.chartData.scaleParams=i.getScaleParams(i.selectedData,i.h,i.chartData.precission),i.resizeShowDataValuesY(i.showData,i.h,i.chartData.scaleParams),i.chartData.options.Chart.scaleSeriesOnly||i.resizeShowDataByTrendIndicators(),i.draw(i.showData,i.h),i.valueAxis=i.getValueAxis(i.chartData.scaleParams.minB,i.chartData.scaleParams.maxB,5,i.w,i.h,i.chartData.options.Chart.scalesFontSize,i.chartData.precission),i.clearGrid(),i.drawValueAxis(i.valueAxis),i.drawOscillatorChartsAxis(),i.drawTimeAxis(i.timeAxis),i.drawChartBorder()),i.curX&&i.curY&&(i.clearInfo(),i.drawActiveDrawingObjects(),i.drawCrosshair(i.canvasInfoContext,null,i.techChart.configuration.modules.headerButtons.createPipsButton)),i.showData[0]=new Point(t[i.chartData.typeData],i.showData[0].date,e,a),i.showData[0].isCurrentData=!0;var s=[];"Step"===i.chartData.options.LineChart.typeLine?(s.push([i.showData[0].x,i.showData[0].y]),i.showData[1]?(s.push([i.showData[1].x,i.showData[0].y]),s.push([i.showData[1].x,i.showData[1].y]),s.push([i.showData[1].x,i.h])):(s.push([i.showData[0].x,i.showData[0].y]),s.push([i.showData[0].x,i.showData[0].y]),s.push([i.showData[0].x,i.h])),s.push([i.showData[0].x,i.h])):(s.push([i.showData[0].x,i.showData[0].y]),i.showData[1]?(s.push([i.showData[1].x,i.showData[1].y]),s.push([i.showData[1].x,i.h])):(s.push([i.showData[0].x,i.showData[0].y]),s.push([i.showData[0].x,i.h])),s.push([i.showData[0].x,i.h]));var r=i.canvasRateNormalContext,n=i.chartData.colors.LineChart.colorLine,o=i.chartData.options.LineChart.widthLine;if("WithMarkers"===i.chartData.options.LineChart.typeLine){var h=parseFloat(o)+2.5/parseFloat(o);LibCanvas.drawCircle(null,r,i.showData[0].x,i.showData[0].y,h,null,n,n,1)}LibCanvas.drawPolygon(null,r,s,null,n,!1,o,s.length-2)}},i.draw=function(t,e){if(i.chartData.drawingObjects.length)for(var a=0;a<i.chartData.drawingObjects.length;a++)"active"===i.chartData.drawingObjects[a].state&&LibCanvas.clearRect(null,i.canvasDrawingActiveContext,0,0,i.canvasDrawingActive.width,i.canvasDrawingActive.height),i.redrawActiveDrawingObjects(!0);if(i.drawChart(t,e)){for(var s=[],r=t[0].isCurrentData?1:0,n=i.canvasDataNormalContext,o=i.chartData.colors.LineChart.colorLine,h=i.chartData.options.LineChart.widthLine,c=parseFloat(h)+2.5/parseFloat(h),l=0;l<t.length;l++){if(isNaN(parseFloat(t[l].x))||isNaN(parseFloat(t[l].y)))return;t[l-1]||(t[l-1]=t[l]),t[l].isCurrentData||("Step"===i.chartData.options.LineChart.typeLine?(s.push([t[l].x,t[l-1].y]),s.push([t[l].x,t[l].y])):s.push([t[l].x,t[l].y]),"WithMarkers"===i.chartData.options.LineChart.typeLine&&LibCanvas.drawCircle(null,n,t[l].x,t[l].y,c,null,o,o,1))}s.push([t[t.length-1].x,i.h]),t[r]?s.push([t[r].x,i.h]):s.push([t[0].x,i.h]),LibCanvas.drawPolygon(null,n,s,null,o,!1,h,s.length-2)}},i.deleteRedundantElements=function(t,e,a,s,r){for(var n=t.length-1;n>=0;n--)t[n+1]&&(e>0&&parseFloat(t[n].x)<=parseFloat(t[n+1].x)?t.splice(n+1,1):e<0&&parseFloat(t[n].x)<=parseFloat(t[n+1].x)&&t.splice(n,1));i.fixFirstAndLastElementsX(t,a,s,r)},i.fixFirstAndLastElementsX=function(t,e,a,s){var r;i.showData[0]&&i.showData[1]&&parseFloat(i.showData[0].x)-parseFloat(i.showData[1].x)<s&&((r=parseFloat(i.showData[1].x)+s)>e-a&&(r=e-a),i.showData[0].x=r.toFixed(1)),i.showData[i.showData.length-1]&&i.showData[i.showData.length-2]&&parseFloat(i.showData[i.showData.length-1].x)-parseFloat(i.showData[i.showData.length-2].x)<s&&((r=parseFloat(i.showData[i.showData.length-2].x)-s)<0&&(r=0),i.showData[i.showData.length-1].x=r.toFixed(1))},i}return function LineChart_inherits(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&LineChart_setPrototypeOf(t,e)}(LineChart,u),LineChart}(),y=function(){function AreaChart(t,e,a){var i;return function AreaChart_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,AreaChart),(i=function AreaChart_possibleConstructorReturn(t,e){return!e||"object"!==AreaChart_typeof(e)&&"function"!==typeof e?function AreaChart_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,AreaChart_getPrototypeOf(AreaChart).call(this,t,e,a))).isFill=!0,i.calculateDelta=function(){var t=i.showData[1].date-i.showData[2].date,e=i.techChart.connector.getCurrentTime()/1e3-i.showData[1].date,a=null,s=null;return e<t?(s=100*e/t,a=(i.chartData.spacing*s/100).toFixed(0)):a=i.chartData.spacing,a},i.drawCurrentShowData=function(t){if(i.showData[0].isCurrentData){var e=t[i.chartData.typeData],a=i.showData[0].x,s=i.getCoordinateY(parseFloat(e),i.h,i.chartData.scaleParams.minB,i.chartData.scaleParams.deltaY);i.chartData.options.Chart.autoScale&&(parseFloat(s)-i.chartData.marginTop<0||parseFloat(s)+i.chartData.marginBottom>i.h)&&(i.chartData.scaleParams=i.getScaleParams(i.selectedData,i.h,i.chartData.precission),i.resizeShowDataValuesY(i.showData,i.h,i.chartData.scaleParams),i.chartData.options.Chart.scaleSeriesOnly||i.resizeShowDataByTrendIndicators(),i.draw(i.showData,i.h),i.valueAxis=i.getValueAxis(i.chartData.scaleParams.minB,i.chartData.scaleParams.maxB,5,i.w,i.h,i.chartData.options.Chart.scalesFontSize,i.chartData.precission),i.clearGrid(),i.drawValueAxis(i.valueAxis),i.drawOscillatorChartsAxis(),i.drawTimeAxis(i.timeAxis),i.drawChartBorder()),i.curX&&i.curY&&(i.clearInfo(),i.drawActiveDrawingObjects(),i.drawCrosshair(i.canvasInfoContext,null,i.techChart.configuration.modules.headerButtons.createPipsButton)),i.showData[0]=new Point(e,i.showData[0].date,a,s),i.showData[0].isCurrentData=!0;var r=[];r.push([i.showData[0].x,i.showData[0].y]),i.showData[1]?(r.push([i.showData[1].x,i.showData[1].y]),r.push([i.showData[1].x,i.h])):(r.push([i.showData[0].x,i.showData[0].y]),r.push([i.showData[0].x,i.h])),r.push([i.showData[0].x,i.h]);var n=i.canvasRateNormalContext;if(i.isFill){var o=n.createLinearGradient(0,i.h/7,0,i.h);o.addColorStop(0,i.chartData.colors.AreaChart.colorStop),o.addColorStop(1,i.chartData.colors.AreaChart.colorStopEnd),LibCanvas.drawPolygon(null,n,r,o,null,null,null,null,.5)}LibCanvas.drawPolygon(null,n,r,null,i.chartData.colors.AreaChart.colorLine,!1,i.chartData.options.AreaChart.widthLine,r.length-2)}},i.draw=function(t,e){if(i.chartData.drawingObjects.length)for(var a=0;a<i.chartData.drawingObjects.length;a++)"active"===i.chartData.drawingObjects[a].state&&LibCanvas.clearRect(null,i.canvasDrawingActiveContext,0,0,i.canvasDrawingActive.width,i.canvasDrawingActive.height),i.redrawActiveDrawingObjects(!0);if(i.drawChart(t,e)){for(var s=[],r=t[0].isCurrentData?1:0,n=0;n<t.length;n++){if(isNaN(parseFloat(t[n].x))||isNaN(parseFloat(t[n].y)))return;t[n].isCurrentData||s.push([t[n].x,t[n].y])}s.push([t[t.length-1].x,i.h]),t[r]?s.push([t[r].x,i.h]):s.push([t[0].x,i.h]);var o=i.canvasDataNormalContext;if(i.isFill){var h=o.createLinearGradient(0,i.h/7,0,i.h);h.addColorStop(0,i.chartData.colors.AreaChart.colorStop),h.addColorStop(1,i.chartData.colors.AreaChart.colorStopEnd),LibCanvas.drawPolygon(null,o,s,h,null,null,null,null,.5)}LibCanvas.drawPolygon(null,o,s,null,i.chartData.colors.AreaChart.colorLine,!1,i.chartData.options.AreaChart.widthLine,s.length-2)}},i}return function AreaChart_inherits(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&AreaChart_setPrototypeOf(t,e)}(AreaChart,f),AreaChart}();Bar.prototype.show=function(t,e,a,i){if(t||!this.useCanvas){var s,r,n=a.BarChart.candleBool,o=a.BarChart.candleBear,h=parseFloat(this.high),c=parseFloat(this.low),l=parseFloat(this.open),d=parseFloat(this.close),p=parseFloat(this.x),u=parseFloat(this.y),g=p,v=u,f=u-Math.abs(c-h)/this.scale,y=e,D=t.getContext("2d");r=l>d?o:n;var w=this.lineWidth,m=LibCanvas.getPosition(g,w);LibCanvas.drawLine(null,D,m,Math.round(v),m,Math.round(f),a.Chart.backgroundColor,[],w),LibCanvas.drawLine(null,D,m,Math.round(v),m,Math.round(f),r,[],w),g=Math.round(m),s=Math.round(g-parseFloat(y)/2),v=u-Math.abs(c-l)/this.scale;var b=LibCanvas.getPosition(v,w);i.needOpen||(LibCanvas.drawLine(null,D,g,b,s,b,a.Chart.backgroundColor,[],w),LibCanvas.drawLine(null,D,g,b,s,b,r,[],w)),s=Math.round(g+parseFloat(y)/2),b=LibCanvas.getPosition(u-Math.abs(c-d)/this.scale,w),LibCanvas.drawLine(null,D,g,b,s,b,a.Chart.backgroundColor,[],w),LibCanvas.drawLine(null,D,g,b,s,b,r,[],w)}};var D=function(){function BarChart(t,e,a){var i;return function BarChart_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,BarChart),(i=function BarChart_possibleConstructorReturn(t,e){return!e||"object"!==BarChart_typeof(e)&&"function"!==typeof e?function BarChart_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,BarChart_getPrototypeOf(BarChart).call(this,t,e,a))).getFractalItemY=function(t,e){return"low"===e?i.toYPixels(t.fractalLow):"high"===e?i.toYPixels(t.fractalHigh):void 0},i.drawCrosshair=function(t,e,a){var s=i.drawCrosshairChart(t);if(s){var r=i.chartData.colors.Chart.colorCrossHair,n=i.curX,o=(i.curY,i.chartData.candleWidth),h=parseFloat(s.high),c=parseFloat(s.low),l=parseFloat(s.open),d=parseFloat(s.close),p=s.lineWidth+2,u=LibCanvas.getPosition(parseFloat(s.x),s.lineWidth),g=LibCanvas.getPosition(parseFloat(s.y),s.lineWidth),v=LibCanvas.getPosition(parseFloat(u),p),f=LibCanvas.getPosition(parseFloat(g),p),y=v,D=LibCanvas.getPosition(LibCanvas.getPosition(f-(h-c)/s.scale,s.lineWidth),p);n<i.w-8&&(i.canvasInfoContext.save(),i.canvasInfoContext.beginPath(),i.canvasInfoContext.rect(0,0,i.w-8,i.h),i.canvasInfoContext.closePath(),i.canvasInfoContext.clip(),LibCanvas.drawLine(null,t,v,f,y,D,r,[],p),y=LibCanvas.getPosition(v-parseFloat(o)/2,p),D=f=LibCanvas.getPosition(f-Math.abs(c-l)/s.scale,p),i.chartData.options.BarChart.needOpen||LibCanvas.drawLine(null,t,v+1,f,y,D,r,[],p),v=LibCanvas.getPosition(parseFloat(s.x),p),f=LibCanvas.getPosition(parseFloat(s.y),p),y=LibCanvas.getPosition(v+parseFloat(o)/2,p),D=f=LibCanvas.getPosition(f-Math.abs(c-d)/s.scale,p),LibCanvas.drawLine(null,t,v,f,y,D,r,[],p),s.show(t.canvas,i.chartData.candleWidth,i.chartData.colors,i.chartData.options.BarChart),s.show(t.canvas,i.chartData.candleWidth,i.chartData.colors,i.chartData.options.BarChart),a&&i.chartData.isPipsShow&&i.chartData.currentValue&&i.drawPips(t),i.canvasInfoContext.restore())}},i.getElementIndexByPositionX=function(t,e){if(t.length){var a=0,s=.5*i.chartData.candleWidth;if(e>=t[0].x-s)a=0;else if(t[t.length-2]&&e<t[t.length-2].x-s)a=t.length-1;else for(var r=0;r<t.length;r++)if(t[r+1]&&e<t[r].x-s&&e>=t[r+1].x-s){e=t[r+1].x,a=r+1;break}return a}},i.isPositionValid=function(){return parseFloat(i.showData[0].x)<i.w-i.chartData.rightPadding+i.chartData.spacing},i.resizeShowDataValuesY=function(t,e,a){for(var s=0;s<t.length;s++)i.resizeShowItemValuesY(t[s],e,a)},i.resizeShowItemValuesY=function(t,e,a){var s=i.getCoordinateY(t.low,e,a.minB,a.deltaY);t.y=s,t.scale=a.deltaY},i.getNumberOfDataToRight=function(t,e,a,i){return parseInt((e-a-t)/i)},i.moveElementsX=function(t,e){for(var a=0;a<t.length;a++){var s=parseFloat(t[a].x)-e;t[a-1]&&parseFloat(t[a-1].x)-s<i.chartData.spacing&&(s=parseFloat(t[a-1].x)-i.chartData.spacing),t[a].x=s.toFixed(1)}},i.moveElementsY=function(t,e){for(var a=0;a<t.length;a++){var i=parseFloat(t[a].y)-e;t[a].y=i.toFixed(1)}},i.needsElementToRight=function(t,e,a,i){return parseFloat(t[0].x)+i<e-a},i.needsElementToLeft=function(t,e){return parseFloat(t[t.length-1].x)>e},i.drawCurrentShowData=function(t,e){var a=t[i.chartData.typeData],s=parseFloat(a),r=parseFloat(i.showData[0].low),n=parseFloat(i.showData[0].high);r>s?i.showData[0].low=a:n<s&&(i.showData[0].high=a),e&&(i.showData[0].open=e[i.chartData.typeData].open,i.showData[0].close=e[i.chartData.typeData].close,i.showData[0].low=e[i.chartData.typeData].low,i.showData[0].high=e[i.chartData.typeData].high);var o=i.getCoordinateY(i.showData[0].low,i.h,i.chartData.scaleParams.minB,i.chartData.scaleParams.deltaY),h=i.getCoordinateY(i.showData[0].high,i.h,i.chartData.scaleParams.minB,i.chartData.scaleParams.deltaY);i.chartData.options.Chart.autoScale&&(parseFloat(h)-i.chartData.marginTop<0||parseFloat(o)+i.chartData.marginBottom>i.h)&&(i.chartData.scaleParams=i.getScaleParams(i.selectedData,i.h,i.chartData.precission),i.resizeShowDataValuesY(i.showData,i.h,i.chartData.scaleParams),i.chartData.options.Chart.scaleSeriesOnly||i.resizeShowDataByTrendIndicators(),i.draw(i.showData,i.h),i.valueAxis=i.getValueAxis(i.chartData.scaleParams.minB,i.chartData.scaleParams.maxB,5,i.w,i.h,i.chartData.options.Chart.scalesFontSize,i.chartData.precission),i.clearGrid(),i.drawValueAxis(i.valueAxis),i.drawOscillatorChartsAxis(),i.drawTimeAxis(i.timeAxis),i.drawChartBorder()),i.showData[0]=new Bar(i.showData[0].low,i.showData[0].high,i.showData[0].open,a,i.showData[0].date,i.showData[0].x,o,i.chartData.scaleParams.deltaY,!0),i.showData[0].isCurrentData=!0;var c=i.canvasRatePixelatedContext.canvas;i.canvasRatePixelatedContext.save(),i.canvasRatePixelatedContext.beginPath(),i.canvasRatePixelatedContext.rect(0,0,i.w-8,i.h),i.canvasRatePixelatedContext.closePath(),i.canvasRatePixelatedContext.clip(),i.showData[0].show(c,i.chartData.candleWidth,i.chartData.colors,i.chartData.options),i.canvasRatePixelatedContext.restore(),i.curX&&i.curY&&(i.clearInfo(),i.drawActiveDrawingObjects(),i.drawCrosshair(i.canvasInfoContext,null,i.techChart.configuration.modules.headerButtons.createPipsButton))},i.getCoordinateX=function(t,e,a,i,s){if(t=parseFloat(t),e=parseFloat(e),a=parseFloat(a),i=parseFloat(i),!(isNaN(t)||isNaN(e)||isNaN(a)||isNaN(i))){var r=parseFloat(t-e-i*a);return r=r>0?r:0,(r-=s).toFixed(1)}},i.processDataToShow=function(t,e,a,s,r,n,o,h){o=void 0===o?0:o,o=i.chartData.techChart.isFullScreen?1.6*o:.5*o,i.chartData.scaleParams=h||i.getScaleParams(t,r,n);for(var c=[],l=0;l<t.length;l++){var d=t[l];n||(n=u.countDigits(d.high));var p=i.getCoordinateX(s,e,a,l,o);if(p<=0)break;var g=i.getCoordinateY(d.low,r,i.chartData.scaleParams.minB,i.chartData.scaleParams.deltaY),v=new Bar(parseFloat(d.low).toFixed(n),parseFloat(d.high).toFixed(n),parseFloat(d.open).toFixed(n),parseFloat(d.close).toFixed(n),parseFloat(d.date),p,g,i.chartData.scaleParams.deltaY,i.useCanvas);d.isCurrentData&&(v.isCurrentData=!0),c.push(v)}return c},i.createShowDataItem=function(t,e){var a=new Bar(parseFloat(t.low).toFixed(e),parseFloat(t.high).toFixed(e),parseFloat(t.open).toFixed(e),parseFloat(t.close).toFixed(e),t.date,"0.0","0.0",1,i.useCanvas);return t.isCurrentData&&(a.isCurrentData=!0),a},i.setChartElementsSize=function(t){var e=i.getChartElementsSize();e.candleWidth&&(t.candleWidth=e.candleWidth),t.spacing=1.5*t.candleWidth},i.getMaxValue=function(t){for(var e=0,a=0;a<t.length;a++){var i=parseFloat(t[a].high);e<i&&(e=i)}return e},i.getMinValue=function(t){for(var e=Number.MAX_VALUE,a=0;a<t.length;a++){var i=parseFloat(t[a].low);e>i&&(e=i)}return e},i.deleteRedundantElements=function(t,e,a,i){for(var s=t.length-1;s>=0;s--)parseFloat(t[s].x)>a-i?t.length>1?t.splice(s,1):t[s].x=a-i:parseFloat(t[s].x)<=0&&t.length>1&&t.splice(s,1)},i.draw=function(t,e){if(i.chartData.drawingObjects.length)for(var a=0;a<i.chartData.drawingObjects.length;a++)"active"===i.chartData.drawingObjects[a].state&&LibCanvas.clearRect(null,i.canvasDrawingActiveContext,0,0,i.canvasDrawingActive.width,i.canvasDrawingActive.height),i.redrawActiveDrawingObjects(!0);if(i.drawChart(t,e))for(var s=i.canvasDataPixelatedContext.canvas,r=0;r<t.length;r++)t[r].isCurrentData||t[r].show(s,i.chartData.candleWidth,i.chartData.colors,i.chartData.options.BarChart)},i}return function BarChart_inherits(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&BarChart_setPrototypeOf(t,e)}(BarChart,u),BarChart}();HollowCandle.prototype.show=function(t,e,a,i,s){if(t||!this.useCanvas){var r,n,o,h,c=a.HollowChart.candleBool,l=a.HollowChart.candleBear,d=a.HollowChart.candleLineBool,p=a.HollowChart.candleLineBear,u=a.HollowChart.candleBoolBorder,g=a.HollowChart.candleBearBorder,v=parseFloat(this.high),f=parseFloat(this.low),y=parseFloat(this.open),D=parseFloat(this.close),w=parseFloat(this.y),m=parseFloat(this.y)-(v-f)/this.scale,b=Math.abs(y-D)/this.scale,C=b>0?b:1,x=parseFloat(this.y)+parseFloat(f-Math.max(y,D))/this.scale,L=t.getContext("2d");D>=s&&D>=y?(n="transparent",o=d,h=c):D<s&&D>=y?(n="transparent",o=p,h=l):D>=s&&D<y?(n=c,o=d,h=i.needBorder?u:n):D<s&&D<y&&(n=l,o=p,h=i.needBorder?g:n);var P=e;r=LibCanvas.getPosition(parseFloat(this.x),P);var S=Math.round(r-P/2),T=LibCanvas.getPosition(parseFloat(r-P/2),1),O=LibCanvas.getPosition(parseFloat(r+P/2),1),B=LibCanvas.getPosition(x,1),A=LibCanvas.getPosition(x+C,1);C=Math.round(C),i.needBorder&&"transparent"!==n?(LibCanvas.drawLine(null,L,r,Math.round(B),r,Math.round(A),n,[],P),LibCanvas.drawLine(null,L,T,B,T,A,h,[],1),LibCanvas.drawLine(null,L,T,A,O,A,h,[],1),LibCanvas.drawLine(null,L,O,B,O,A,h,[],1),LibCanvas.drawLine(null,L,T,B,O,B,h,[],1),this.hollowCandlePriceLine=n):"transparent"===n?(LibCanvas.drawLine(null,L,T,B,T,A,h,[],1),LibCanvas.drawLine(null,L,T,A,O,A,h,[],1),LibCanvas.drawLine(null,L,O,B,O,A,h,[],1),LibCanvas.drawLine(null,L,T,B,O,B,h,[],1),this.hollowCandlePriceLine=h):(LibCanvas.drawLine(null,L,r,Math.round(B),r,Math.round(A),n,[],P),this.hollowCandlePriceLine=n),this.posCandle={x:S,y1:B,y2:A,width:P,height:C};var F=i.widthWickLine;if(i.needWick){r=LibCanvas.getPosition(parseFloat(this.x),F);var k=Math.round(w),j=Math.round(m);LibCanvas.drawLine(null,L,r,k,r,A,o,[],F),LibCanvas.drawLine(null,L,r,B,r,j,o,[],F),this.posWick={x:r,y1:k,y2:j,width:F}}}};var w=function(){function HollowChart(t,e,a){var i;return function HollowCandleChart_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,HollowChart),(i=function HollowCandleChart_possibleConstructorReturn(t,e){return!e||"object"!==HollowCandleChart_typeof(e)&&"function"!==typeof e?function HollowCandleChart_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,HollowCandleChart_getPrototypeOf(HollowChart).call(this,t,e,a))).drawCrosshair=function(t,e,a){var s=i.drawCrosshairChart(t);if(s.posWick&&s){var r=i.chartData.colors.Chart.crosshair,n=Math.round(i.chartData.candleWidth),o=parseFloat(s.low),h=parseFloat(s.open),c=parseFloat(s.close),l=parseFloat(s.x),d=parseFloat(s.y);if(i.chartData.options[i.constructor.name].widthBorderLine,i.curX<i.w-8){i.canvasInfoContext.save(),i.canvasInfoContext.beginPath(),i.canvasInfoContext.rect(0,0,i.w-8,i.h),i.canvasInfoContext.closePath(),i.canvasInfoContext.clip();var p=Math.round(l-parseFloat(n/2)),u=Math.round(d+parseFloat(o-Math.max(h,c))/s.scale);p=LibCanvas.getPosition(p,2),u=LibCanvas.getPosition(u,2);var g=i.chartData.options[i.constructor.name].widthBorderLine;h>c?i.chartData.colors[i.constructor.name].candleBear:i.chartData.colors[i.constructor.name].candleBool;var v=s.posWick.x,f=s.posWick.y1,y=s.posWick.y2,D=s.posWick.width;i.chartData.options[i.constructor.name].needWick&&LibCanvas.drawLine(null,t,v,f,v,y,r,[],D);var w=s.posCandle.x,m=s.posCandle.y1,b=s.posCandle.width,C=s.posCandle.height;LibCanvas.drawRectangle(null,t,w,m,b,C,"transparent",r,g),a&&i.chartData.isPipsShow&&i.chartData.currentValue&&i.drawPips(t),i.canvasInfoContext.restore()}}},i.processDataToShow=function(t,e,a,s,r,n,o,h){o=void 0===o?0:o,o=i.chartData.techChart.isFullScreen?1.6*o:.5*o,i.chartData.scaleParams=h||i.getScaleParams(t,r,n);for(var c=[],l=0;l<t.length;l++){var d=t[l];n||(n=u.countDigits(d.high));var p=i.getCoordinateX(s,e,a,l,o);if(p<=0)break;var g=i.getCoordinateY(d.low,r,i.chartData.scaleParams.minB,i.chartData.scaleParams.deltaY),v=new HollowCandle(parseFloat(d.low).toFixed(n),parseFloat(d.high).toFixed(n),parseFloat(d.open).toFixed(n),parseFloat(d.close).toFixed(n),parseFloat(d.date),p,g,i.chartData.scaleParams.deltaY,i.useCanvas);d.isCurrentData&&(v.isCurrentData=!0),c.push(v)}return c},i.draw=function(t,e){if(i.chartData.drawingObjects.length)for(var a=0;a<i.chartData.drawingObjects.length;a++)"active"===i.chartData.drawingObjects[a].state&&LibCanvas.clearRect(null,i.canvasDrawingActiveContext,0,0,i.canvasDrawingActive.width,i.canvasDrawingActive.height),i.redrawActiveDrawingObjects(!0);if(i.drawChart(t,e))for(var s=i.canvasDataPixelatedContext.canvas,r=t.length,n=0;n<r;n++)if(t[n].isCurrentData&&i.chartData.isExpired||!t[n].isCurrentData){var o=t[n].close;if(n===r-1&&(o=i.getPrevClose(t[n])),n===r-1){var h=i.getIndexByDate(i.chartData.data,t[r-1].date);h>-1&&h<i.chartData.data.length-1&&(o=i.chartData.data[h+1].close)}else o=t[n+1].close;t[n].show(s,i.chartData.candleWidth,i.chartData.colors,i.chartData.options.HollowChart,o)}},i.getPrevClose=function(t){var e=t.close,a=i.chartData.data[i.techChart.configuration.typeData],s=t.date,r=u.binaryIndexOfCandleByTime(s,a);return a[r+1]&&(e=a[r+1].close),e},i.createShowDataItem=function(t,e){var a=new HollowCandle(parseFloat(t.low).toFixed(e),parseFloat(t.high).toFixed(e),parseFloat(t.open).toFixed(e),parseFloat(t.close).toFixed(e),t.date,"0.0","0.0",1,i.useCanvas);return t.isCurrentData&&(a.isCurrentData=!0),a},i}return function HollowCandleChart_inherits(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&HollowCandleChart_setPrototypeOf(t,e)}(HollowChart,v),HollowChart}();i("./src/styles/common.less"),i.d(e,"a",function(){return m});var m=function(){function TechnicalChart(t,e){!function TechnicalChart_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,TechnicalChart),t.container&&(this.store=this.getStore(),this.defaultAllConfiguration=this.getDefaultAllConfiguration(),this.config={},this.allStyles={},this.currentLanguage={},this.mappingConfiguration(t),e&&Object.keys(e).length?this.connectorInstance=e:this.connectorInstance=this.createConnector(this.configuration.connectorOptions.type,this.configuration),this.parent=this.createParent(t.container,t.id),this.chartTypes=Object(o.c)(this.configuration.dropDown.chartTypes,{candle:"Candles",area:"Area",line:"Line",bar:"Bars",hollow:"Hollow Candles"}),this.typeData={ask:"Ask",bid:"Bid",mid:"Middle"},this.tChartDefaultParams={activeSpliter:this.config.defaultParams.activeSpliter,activeChartIndex:this.config.defaultParams.activeChartIndex,cursorType:this.config.defaultParams.cursorType,setTimeoutforSave:this.config.defaultParams.setTimeoutforSave,paramsPanels:this.config.defaultParams.paramsPanels,version:this.config.defaultParams.version},this.dropForHidden=[],this.activeMenuContainer=[],this.arrowForHidden=[],this.changedGlobalSettings={},this.settings={},this.chartsContainerRect={},this.chartsOff=6,this.charts=[],this.activeSpliter=this.tChartDefaultParams.activeSpliter,this.cursorType=this.tChartDefaultParams.cursorType,this.activeChartIndex=this.tChartDefaultParams.activeChartIndex,this.autoSaveTimeout=null,this.chartsArray=[],this.groupCharts={},this.activeTab="",this.canAddTab=!0,this.maxTabsQuantity=this.config.tabsQuantity,this.priceOffset=6,this.signalsList=[],this.defaultTopDataPanel=this.config.defaultTopPositionDataWindowOnChart,this.defaultLeftDataPanel=10,this.isNoOptions=!1,this.sideBarListItemps=[])}return function TechnicalChart_createClass(t,e,a){e&&TechnicalChart_defineProperties(t.prototype,e),a&&TechnicalChart_defineProperties(t,a)}(TechnicalChart,[{key:"translation",get:function get(){return this.currentLanguage}},{key:"configuration",get:function get(){return this.config}},{key:"connector",get:function get(){return this.connectorInstance}},{key:"defaultParams",get:function get(){return this.tChartDefaultParams}},{key:"styles",get:function get(){return this.allStyles}}]),TechnicalChart}();m.prototype.createParent=function(t,e){var a=t.firstElementChild,i=document.createElement("div");return i.setAttribute("class","widget-container tch-technical-chart-container-".concat(e)),t.insertBefore(i,a),i},m.prototype.mappingConfiguration=function(t){t.id&&this.store.setID(t.id);var e,a=JSON.parse(localStorage.getItem(this.getKeyForLocalStorage())),i=a?a.params:this.defaultAllConfiguration.config,s=t.config?t.config:{},r=Object(o.d)(i,s);if(this.config=this.setParamsConverter(Object(o.a)(r)),t&&t.styles&&Object.keys(t.styles).length){var n=Object(o.d)(this.defaultAllConfiguration.styles,t.styles);this.store.setIsExternalStyle(!0),this.allStyles.colors=n.colors,this.allStyles.optios=n.options}else this.store.setIsExternalStyle(!1),this.allStyles=this.defaultAllConfiguration.styles;e=t&&t.translate&&Object.keys(t.translate).length?t.translate:this.defaultAllConfiguration.translate,this.currentLanguage=e[this.config.lang]},m.prototype.chartHeaderMenus=function(){var t={candle:this.translation.candle,area:this.translation.area,line:this.translation.line,bar:this.translation.bar,hollow:this.translation.hollow};return Object(o.c)(this.configuration.dropDown.chartTypes,t)},m.prototype.sideBarMenus=function(){return{cursorType:this.configuration.modules.sideBarButtons.cursorTypeButton?{arrow:this.translation.arrow,dot:this.translation.dot,cross:this.translation.cross}:null,lineType:this.configuration.modules.sideBarButtons.drawingObjectsButton?{drawingVerticalLine:this.translation["vertical-line"],drawingHorizontalLine:this.translation["horizontal-line"],drawingTrendLine:this.translation["trend-line"],drawingTrendAngle:this.translation["trend-angle"],drawingHorizontalRay:this.translation["horizontal-ray"],drawingArrow:this.translation.arrow,drawingRay:this.translation.ray,drawingParallelChannel:this.translation["parallel-channel"],drawingDisjointAngle:this.translation["disjoint-angle"],drawingFlatTopBottom:this.translation["flat-top/bottom"]}:null,brushType:this.configuration.modules.sideBarButtons.brushTypeButton?{drawingBrush:this.translation.brush,drawingRectangle:this.translation.rectangle,drawingRotatedRect:this.translation["rotated-rectangle"],drawingEllipse:this.translation.ellipse,drawingTriangle:this.translation.triangle,drawingPolyline:this.translation.polyline,drawingCurve:this.translation.curve,drawingArc:this.translation.arc}:null,textType:this.configuration.modules.sideBarButtons.textTypeButton?{drawingText:this.translation.text,drawingAnchoredText:this.translation["anchored-text"],drawingArrowMarkLeft:this.translation["arrow-mark-left"],drawingArrowMarkRight:this.translation["arrow-mark-right"],drawingArrowMarkUp:this.translation["arrow-mark-up"],drawingArrowMarkDown:this.translation["arrow-mark-down"],drawingFlag:this.translation.flag,drawingNote:this.translation.note,drawingAnchoredNote:this.translation["anchored-note"]}:null}},m.prototype.typeDatas=function(){var t={bid:{key:"bid",value:"bid",text:this.translation.bid},ask:{key:"ask",value:"ask",text:this.translation.ask},mid:{key:"mid",value:"mid",text:this.translation.mid}};return Object(o.c)(this.config.dropDown.typeDatas,t)},m.prototype.periods=function(){var t={minute:{key:"1-minute",value:"1",text:this.translation["1m"]},minute5:{key:"5-minutes",value:"5",text:this.translation["5m"]},minute15:{key:"15-minutes",value:"15",text:this.translation["15m"]},minute30:{key:"30-minutes",value:"30",text:this.translation["30m"]},hour:{key:"1-hour",value:"60",text:this.translation["1h"]},hour4:{key:"4-hours",value:"hour4",text:this.translation["4h"]},hour8:{key:"8-hours",value:"hour8",text:this.translation["8h"]},day:{key:"1-day",value:"day",text:this.translation["1D"]},week:{key:"1-week",value:"week",text:this.translation["1W"]},month:{key:"1-month",value:"month",text:this.translation["1M"]}};return Object(o.c)(this.config.dropDown.periods,t)},m.prototype.getPeriods=function(){return{1:{key:"1-minute",name:"1",value:"minute",text:"1m"},5:{key:"5-minutes",name:"5",value:"minute5",text:"5m"},15:{key:"15-minutes",name:"15",value:"minute15",text:"15m"},30:{key:"30-minutes",name:"30",value:"minute30",text:"30m"},60:{key:"1-hour",name:"60",value:"hour",text:"1h"},hour4:{key:"4-hours",name:"hour4",value:"hour4",text:"4h"},hour8:{key:"8-hours",name:"hour8",value:"hour8",text:"8h"},day:{key:"1-day",name:"day",value:"day",text:"1D"},week:{key:"1-week",name:"week",value:"week",text:"1W"},month:{key:"1-month",name:"month",value:"month",text:"1M"}}},m.prototype.spliterTemplates=function(){return[{count:1,template:[!1]},{count:2,template:[[!1,!1]]},{count:2,template:[!1,!1]},{count:3,template:[[!1,!1,!1]]},{count:3,template:[!1,!1,!1]},{count:3,template:[[[!1,!1],!1]]},{count:3,template:[!1,[!1,!1]]},{count:6,template:[[[!1,!1,!1],[!1,!1,!1]]]},{count:8,template:[[[!1,!1,!1,!1],[!1,!1,!1,!1]]]}]},m.prototype.createConnector=function(t,e){return new l(e)},m.prototype.getDefaultAllConfiguration=function(){return{config:_objectSpread({},Object(o.b)(Object(s.a)())),styles:_objectSpread({},Object(o.b)(r)),translate:_objectSpread({},Object(o.b)(n))}},m.prototype.getStore=function(){var t=null,e=null,a=null,i="",s=null;return{getChart:function getChart(){return t},getChartData:function getChartData(){return e},getChartDataInstance:function getChartDataInstance(){return a},getID:function getID(){return i},isExternalStyleState:function isExternalStyleState(){return s},setChart:function setChart(e){t=e},setChartData:function setChartData(t){e=t},setChartDataInstance:function setChartDataInstance(t){a=t},setIsExternalStyle:function setIsExternalStyle(t){s=t},setID:function setID(t){return i=t}}},m.prototype.setParamsConverter=function(t){return t.isConfigPage&&(t.isAutoRestore=!1),t.typeThemes&&(t.typeThemes=this.convertTheme(t.typeThemes)),t.lang&&(t.lang=t.lang.toLowerCase()),t.chartType&&(t.chartType=this.convertChartType(t.chartType)),t.modules&&t.modules.signals&&(t.modules.signals=!0),t.isHeaderHidden&&(t.isHeaderHidden=!("false"===t.isHeaderHidden&&!0!==t.isHeaderHidden&&"true"!==t.isHeaderHidden)),t.isSidebarHidden&&(t.isSidebarHidden=!("false"===t.isSidebarHidden&&!0!==t.isSidebarHidden&&"true"!==t.isSidebarHidden)),t.isFullScreen&&(t.isFullScreen=void 0===t.isFullScreen||"true"===t.isFullScreen||!0===t.isFullScreen),t.isFullScreenButton&&(t.isFullScreenButton=!("false"===t.isFullScreenButton&&!0!==t.isFullScreenButton&&"true"!==t.isFullScreenButton)),t.isDataPanel&&(t.isDataPanel=!("false"===t.isDataPanel&&!0!==t.isDataPanel&&"true"!==t.isDataPanel)),t.isAutoRestore&&(t.isAutoRestore=!("false"===t.isAutoRestore&&!0!==t.isAutoRestore&&"true"!==t.isAutoRestore)),t.isConfigpage&&(t.isConfigpage=!("true"!==t.isConfigpage||!t.isConfigpage)),t},m.prototype.convertChartType=function(t){switch(t){case"candles":return"candle";case"area":return"area";case"line":return"line";case"bars":return"bar";case"hollowcandles":return"hollow";default:return t}},m.prototype.convertTheme=function(t){switch(t){case"default":return"defaultthema";case"grey":return"greythema";case"black":return"blackthema";case"blue":return"bluethema";default:return"defaultthema"}},m.prototype.htmlSettingsStyleCandles=function(){return"<div class='tch-layout-style-candle tch-style-layouts'>\n            <div>\n                <input name='options-CandleChart-colorPrevious' type='checkbox' />\n                <label class='tch-color-bar-based' tch-text='color-bars-based'>".concat(this.translation.borders,"</label>\n            </div>\n            <table>\n                <tr>\n                    <td>\n                        <label tch-text='candle'>").concat(this.translation.candle,"</label>\n                    </td>\n                    <td>\n                        <div class='tch-color-picker-container'>\n                            <div class='tch-color-picker' name='colors-CandleChart-candleBool'></div>\n                        </div>\n                        <div class='tch-color-picker-container'>\n                            <div class='tch-color-picker' name='colors-CandleChart-candleBear'></div>\n                        </div>\n                    </td>\n                </tr>\n                <tr>\n                    <td>\n                        <input name='options-CandleChart-needBorder' type='checkbox' />\n                        <label tch-text='borders'>").concat(this.translation.borders,"</label>\n                    </td>\n                    <td>\n                        <div class='tch-color-picker-container'>\n                            <div class='tch-color-picker' name='colors-CandleChart-candleBoolBorder'></div>\n                        </div>\n                        <div class='tch-color-picker-container'>\n                            <div class='tch-color-picker' name='colors-CandleChart-candleBearBorder'></div>\n                        </div>\n                    </td>\n                </tr>\n                <tr>\n                    <td>\n                        <input name='options-CandleChart-needWick' type='checkbox' />\n                        <label tch-text='wick'>").concat(this.translation.wick,"</label>\n                    </td>\n                    <td>\n                        <div class='tch-color-picker-container'>\n                            <div class='tch-color-picker' name='colors-CandleChart-candleLineBool'></div>\n                        </div>\n                        <div class='tch-color-picker-container'>\n                            <div class='tch-color-picker' name='colors-CandleChart-candleLineBear'></div>\n                        </div>\n                    </td>\n                </tr>\n            </table>\n            <table>\n                <tr>\n                    <td>\n                        <input name='options-Chart-needPriceLine' type='checkbox'  checked/>\n                        <label tch-text='price-line'>").concat(this.translation["price-line"],"</label>\n                    </td>\n                    <td>\n                        <input name='options-Chart-widthPriceLine' type='range' min='1' max='10' value='1'/>\n                    </td>\n                </tr>\n                <tr class='scale-hidden'>\n                    <td>\n                        <label tch-text='scale'>Scale</label>\n                    </td>\n                    <td>\n                        <select>\n                            <option value='Right' tch-text='right'>Right</option>\n                            <option value ='Left' tch-text='left'>Left</option>\n                        </select>\n                    </td>\n                </tr>\n                <tr>\n                    <td>\n                        <label tch-text='override-min'>").concat(this.translation["override-min"],"</label>\n                    </td>\n                    <td>\n                        <select name ='options-Chart-typeTick'>\n                            <option value ='Default' tch-text='default' >").concat(this.translation.default,"</option>\n                            <option value ='1'>1/1</option>\n                            <option value ='10'>1/10</option>\n                            <option value ='100'>1/100</option>\n                            <option value ='1000'>1/1000</option>\n                            <option value ='10000'>1/10000</option>\n                            <option value ='100000'>1/100000</option>\n                            <option value ='1000000'>1/1000000</option>\n                        </select>\n                    </td>\n                </tr>\n            </table>\n        </div>")},m.prototype.htmlSettingsStyleArea=function(){return"<div class='tch-layout-style-area tch-style-layouts tch-hidden'>\n             <table>\n                <tr>\n                    <td>\n                        <label for='tch-priceSource' tch-text='price-source'>".concat(this.translation["price-source"],"</label>\n                    </td>\n                    <td>\n                        <select name ='options-AreaChart-priceSource' class='tch-style-price-source' id='tch-priceSource'>\n                            <option value ='Open'>Open</option>\n                            <option value ='Low'>Low</option>\n                            <option value ='Close'>Close</option>\n                            <option value ='(H+L)/2'>&lrm;(H+L)/2</option>\n                            <option value ='(H+L+C)/3'>&lrm;(H+L+C)/3</option>\n                            <option value ='(O+H+L+C)/4'>&lrm;(O+H+L+C)/4</option>\n                        </select>\n                    </td>\n                </tr>\n                <tr>\n                    <td>\n                        <label for='tch-settingsStyle-area-line' tch-text='line'>").concat(this.translation.line,"</label>\n                    </td>\n                    <td>\n                        <div class='tch-color-picker-container'>\n                            <div class='tch-color-picker' name='colors-AreaChart-colorLine'></div>\n                        </div>\n                        <input name='options-AreaChart-widthLine' class='tch-settings-area-range' type='range' min='1' max='10' value= '1'/>\n                    </td>\n                </tr>\n                <tr>\n                    <td>\n                        <label for='tch-settingsStyle-area-fill' tch-text='fill'>").concat(this.translation.fill,"</label>\n                    </td>\n                    <td>\n                        <div class='tch-color-picker-container'>\n                            <div class='tch-color-picker' name='colors-AreaChart-colorStop'></div>\n                        </div>\n                        <div class='tch-color-picker-container'>\n                            <div class='tch-color-picker' name='colors-AreaChart-colorStopEnd'></div>\n                        </div>\n                    </td>\n                </tr>\n            </table>\n            <table>\n                <tr>\n                    <td>\n                        <input name='options-Chart-needPriceLine' type='checkbox' checked/>\n                        <label tch-text='price-line'>").concat(this.translation["price-line"],"</label>\n                    </td>\n                    <td>\n                        <input name='options-Chart-widthPriceLine' type='range' min='1' max='10' value='1'/>\n                    </td>\n                </tr>\n                <tr class='scale-hidden'>\n                    <td>\n                        <label tch-text='scale'>Scale</label>\n                    </td>\n                    <td>\n                        <select>\n                            <option value ='Left' tch-text='left'>").concat(this.translation.left,"</option>\n                            <option value ='Right' tch-text='right'>").concat(this.translation.right,"</option>\n                        </select>\n                    </td>\n                </tr>\n                <tr>\n                    <td>\n                        <label tch-text='override-min'>").concat(this.translation["override-min"],"</label>\n                    </td>\n                    <td>\n                        <select name ='options-Chart-typeTick'>\n                            <option value ='Default' tch-text='default'>").concat(this.translation.default,"</option>\n                            <option value ='1'>1/1</option>\n                            <option value ='10'>1/10</option>\n                            <option value ='100'>1/100</option>\n                            <option value ='1000'>1/1000</option>\n                            <option value ='10000'>1/10000</option>\n                            <option value ='100000'>1/100000</option>\n                            <option value ='1000000'>1/1000000</option>\n                        </select>\n                    </td>\n                </tr>\n            </table>\n         </div>")},m.prototype.htmlSettingsStyleLine=function(){return"<div class='tch-layout-style-line tch-style-layouts tch-hidden'>\n                <table>\n                    <tr>\n                        <td>\n                            <label tch-text='price-source'>".concat(this.translation["price-source"],"</label>\n                        </td>\n                        <td>\n                            <select name ='options-LineChart-priceSource' class='tch-style-price-source'>\n                                <option value ='Open'>Open</option>\n                                <option value ='High'>High</option><option value ='Low'>Low</option>\n                                <option value ='Close'>Close</option>\n                                <option value ='(H+L)/2'>&lrm;(H+L)/2</option>\n                                <option value ='(H+L+C)/3'>&lrm;(H+L+C)/3</option>\n                                <option value ='(O+H+L+C)/4'>&lrm;(O+H+L+C)/4</option>\n                            </select>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <label tch-text='type'>").concat(this.translation.type,"</label>\n                        </td>\n                        <td>\n                            <select name ='options-LineChart-typeLine'>\n                                <option value ='Simple'>").concat(this.translation.simple,"</option>\n                                <option value ='WithMarkers'>").concat(this.translation["with-markers"],"</option>\n                                <option value ='Step'>").concat(this.translation.step,"</option>\n                            </select>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <label tch-text='line'>").concat(this.translation.line,"</label>\n                        </td>\n                        <td>\n                            <div class='tch-color-picker-container'>\n                                <div class='tch-color-picker' name='colors-LineChart-colorLine'></div>\n                            </div>\n                            <input name='options-LineChart-widthLine' class='tch-lineChart-widthLine-range' type='range' min='1' max='10' value= '1'/>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <input name='options-Chart-needPriceLine' type='checkbox' checked/>\n                            <label tch-text='price-line'>").concat(this.translation["price-line"],"</label>\n                        </td>\n                        <td>\n                            <input name='options-Chart-widthPriceLine' type='range' min='1' max='10' value='1'/>\n                        </td>\n                    </tr>\n                    <tr class='scale-hidden'>\n                        <td>\n                            <label tch-text='scale'>").concat(this.translation.scale,"</label>\n                        </td>\n                        <td>\n                            <select>\n                                <option value ='Left' tch-text='left'>").concat(this.translation.left,"</option>\n                                <option value ='Right' tch-text='right'>").concat(this.translation.right,"</option>\n                            </select>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <label tch-text='override-min'>").concat(this.translation["override-min"],"</label>\n                        </td>\n                        <td>\n                            <select name ='options-Chart-typeTick'>\n                                <option value ='Default' tch-text='default' >").concat(this.translation.default,"</option>\n                                <option value ='1'>1/1</option>\n                                <option value ='10'>1/10</option>\n                                <option value ='100'>1/100</option>\n                                <option value ='1000'>1/1000</option>\n                                <option value ='10000'>1/10000</option>\n                                <option value ='100000'>1/100000</option>\n                                <option value ='1000000'>1/1000000</option>\n                            </select>\n                        </td>\n                    </tr>\n                </table>\n          </div>")},m.prototype.htmlSettingsStyleBar=function(){return"<div class='tch-layout-style-bar tch-style-layouts tch-hidden'>\n            <div>\n                <input name='options-BarChart-colorPrevious' type='checkbox' />\n                <label class='tch-color-bar-based' tch-text='color-bars-based'>".concat(this.translation["color-bars-based"],"</label>\n            </div>\n            <table>\n                <tr>\n                    <td>\n                        <input name='options-BarChart-needOpen' type='checkbox' />\n                        <label class='tch-color-bar-based' tch-text='hlc-bars'>").concat(this.translation["hlc-bars"],"</label>\n                    </td>\n                </tr>\n                <tr>\n                    <td>\n                        <label tch-text='up-color'>").concat(this.translation["up-color"],"</label>\n                    </td>\n                    <td>\n                        <div class='tch-color-picker-container'>\n                            <div class='tch-color-picker' name='colors-BarChart-candleBool'></div>\n                        </div>\n                    </td>\n                </tr>\n                <tr>\n                    <td>\n                        <label tch-text='down-color'>").concat(this.translation["down-color"],"</label>\n                    </td>\n                    <td>\n                        <div class='tch-color-picker-container'>\n                            <div class='tch-color-picker' name='colors-BarChart-candleBear'></div>\n                        </div>\n                    </td>\n                </tr>\n                <tr>\n                    <td>\n                        <input name='options-Chart-needPriceLine' type='checkbox' checked/>\n                        <label tch-text='price-line'>").concat(this.translation["price-line"],"</label>\n                    </td>\n                    <td>\n                        <input name='options-Chart-widthPriceLine' type='range' min='1' max='10' value='1'/>\n                    </td>\n                </tr>\n                <tr class='scale-hidden'>\n                    <td>\n                        <label tch-text='scale'>Scale</label>\n                    </td>\n                    <td>\n                        <select>\n                            <option value ='Left' tch-text='left'>Left</option>\n                            <option value ='Right' tch-text='right'>Right</option>\n                        </select>\n                    </td>\n                </tr>\n                <tr>\n                    <td>\n                        <label tch-text='override-min'>").concat(this.translation["override-min"],"</label>\n                    </td>\n                    <td>\n                        <select name ='options-Chart-typeTick'>\n                            <option value ='Default' tch-text='default'>").concat(this.translation.default,"</option>\n                            <option value ='1'>1/1</option>\n                            <option value ='10'>1/10</option>\n                            <option value ='100'>1/100</option>\n                            <option value ='1000'>1/1000</option>\n                            <option value ='10000'>1/10000</option>\n                            <option value ='100000'>1/100000</option>\n                            <option value ='1000000'>1/1000000</option>\n                        </select>\n                    </td>\n                </tr>\n            </table>\n        </div>")},m.prototype.htmlSettingsStyleHollowCandles=function(){return"<div class='tch-layout-style-hollow tch-style-layouts tch-hidden'>\n            <table>\n                <tr>\n                    <td>\n                        <label tch-text='hollow'>".concat(this.translation.hollow,"</label>\n                    </td>\n                    <td>\n                        <div class='tch-color-picker-container'>\n                            <div class='tch-color-picker' name='colors-HollowChart-candleBool'></div>\n                        </div>\n                        <div class='tch-color-picker-container'>\n                            <div class='tch-color-picker' name='colors-HollowChart-candleBear'></div>\n                        </div>\n                    </td>\n                </tr>\n                <tr>\n                    <td>\n                        <input name='options-HollowChart-needBorder' type='checkbox'/>\n                        <label tch-text='borders'>").concat(this.translation.borders,"</label>\n                    </td>\n                    <td>\n                        <div class='tch-color-picker-container'>\n                            <div class='tch-color-picker' name='colors-HollowChart-candleBoolBorder'></div>\n                        </div>\n                        <div class='tch-color-picker-container'>\n                            <div class='tch-color-picker' name='colors-HollowChart-candleBearBorder'></div>\n                        </div>\n                    </td>\n                </tr>\n                <tr>\n                    <td>\n                        <input name='options-HollowChart-needWick' type='checkbox'/>\n                        <label tch-text='wick'>").concat(this.translation.wick,"</label>\n                    </td>\n                    <td>\n                        <div class='tch-color-picker-container'>\n                                <div class='tch-color-picker' name='colors-HollowChart-candleLineBool'></div>\n                        </div>\n                        <div class='tch-color-picker-container'>\n                            <div class='tch-color-picker' name='colors-HollowChart-candleLineBear'></div>\n                        </div>\n                    </td>\n                </tr>\n            </table>\n            <table>\n                <tr>\n                    <td>\n                        <input name='options-Chart-needPriceLine' type='checkbox' checked/>\n                        <label tch-text='price-line'>").concat(this.translation["price-line"],"</label>\n                    </td>\n                    <td>\n                        <input  name='options-Chart-widthPriceLine' type='range' min='1' max='10' value='1'/>\n                    </td>\n                </tr>\n                <tr class='scale-hidden'>\n                    <td>\n                        <label tch-text='scale'>").concat(this.translation.scale,"</label>\n                    </td>\n                    <td>\n                        <select>\n                            <option value ='Left' tch-text='left'>").concat(this.translation.left,"</option>\n                            <option value ='Right' tch-text='right'>").concat(this.translation.right,"</option>\n                        </select>\n                    </td>\n                </tr>\n                <tr>\n                    <td>\n                        <label tch-text='override-min'>").concat(this.translation["override-min"],"</label>\n                    </td>\n                    <td>\n                        <select name ='options-Chart-typeTick'>\n                            <option value ='Default' tch-text='default'>").concat(this.translation.default,"</option>\n                            <option value ='1'>1/1</option>\n                            <option value ='10'>1/10</option>\n                            <option value ='100'>1/100</option>\n                            <option value ='1000'>1/1000</option>\n                            <option value ='10000'>1/10000</option>\n                            <option value ='100000'>1/100000</option>\n                            <option value ='1000000'>1/1000000</option>\n                        </select>\n                    </td>\n                </tr>\n            </table>\n        </div>")},m.prototype.htmlSettingsStyleChartType=function(){return"<select name = options-Chart-typeChart class='tch-style-select-chart-type'>\n            ".concat(this.filterChartType(this.config.dropDown.chartTypes),"\n        </select>")},m.prototype.htmlSettingsStyle=function(){return"<div class='tch-settings-style'>"+this.htmlSettingsStyleChartType()+this.htmlSettingsStyleCandles()+this.htmlSettingsStyleArea()+this.htmlSettingsStyleLine()+this.htmlSettingsStyleBar()+this.htmlSettingsStyleHollowCandles()+"</div>"},m.prototype.filterChartType=function(t){var e=this;return Object.keys(t).reduce(function(a,i){return"".concat(a,"\n             <option value=").concat(t[i]," tch-text=").concat(t[i],">\n                ").concat(e.translation[t[i]],"\n             </option>")},"")},m.prototype.htmlSettingsScales=function(){return"<div class='tch-settings-scales tch-hidden'>\n            <div>\n                <div>\n                    <input type='checkbox' name='options-Chart-autoScale'/>\n                    <label tch-text='auto-scale'>".concat(this.translation["auto-scale"],"</label>\n                </div>\n                <div>\n                    <input type='checkbox'/>\n                    <label tch-text='percentage'>").concat(this.translation.percentage,"</label>\n                </div>\n                <div>\n                    <input type='checkbox'/>\n                    <label tch-text='log-scale'>").concat(this.translation["log-scale"],"</label>\n                </div>\n                <div>\n                    <input type='checkbox' name='options-Chart-scaleSeriesOnly'/>\n                    <label tch-text='scale-series'>").concat(this.translation["scale-series"],"</label>\n                </div>\n                <div>\n                    <input type='checkbox'/>\n                    <label tch-text='lock-scale'>").concat(this.translation["lock-scale"],"</label>\n                </div>\n                <div>\n                    <input type='checkbox'/>\n                    <label tch-text='track-time'>").concat(this.translation["track-time"],"</label>\n                </div>\n                <div>\n                    <input type='number' min='1' max='10' step='1'/>\n                    <label tch-text='top-margin'>").concat(this.translation["top-margin"],"</label>\n                </div>\n                <div>\n                    <input type='number' min='1' max='10' step='1'/>\n                    <label tch-text='bottom-margin'>").concat(this.translation["bottom-margin"],"</label>\n                </div>\n                <div>\n                    <input type='number' min='1' max='10' step='1'/>\n                    <label tch-text='right-margin'>").concat(this.translation["right-margin"],"</label>\n                </div>\n            </div>\n            <ul>\n                <li>\n                    <input type='checkbox'/>\n                    <label tch-text='left-axis'>").concat(this.translation["left-axis"],"</label>\n                </li>\n                <li>\n                    <input type='checkbox'/>\n                    <label tch-text='right-axis'>").concat(this.translation["right-axis"],"</label>\n                </li>\n                <li>\n                    <input type='checkbox'/>\n                    <label tch-text='countdown'>").concat(this.translation.countdown,"</label>\n                </li>\n                <li>\n                    <input type='checkbox'/>\n                    <label tch-text='symbol-last'>").concat(this.translation["symbol-last"],"</label>\n                </li>\n                <li>\n                    <input type='checkbox'/>\n                    <label tch-text='indicator-last'>").concat(this.translation["indicator-last"],"</label>\n                </li>\n                <li>\n                    <input type='checkbox'/>\n                    <label tch-text='symbol-labels'>").concat(this.translation["symbol-labels"],"</label>\n                </li>\n                <li>\n                    <input type='checkbox'/>\n                    <label tch-text='indicator-labels'>").concat(this.translation["indicator-labels"],"</label>\n                </li>\n                <li>\n                    <input type='checkbox'/>\n                    <label tch-text='precise-labels'>").concat(this.translation["precise-labels"],"</label>\n                </li>\n            </ul>\n        </div>")},m.prototype.htmlSettingsBackground=function(){return"<div class='tch-settings-background tch-hidden'>\n            <table>\n                <tbody>\n                    <tr>\n                        <td>\n                            <label tch-text='background'>".concat(this.translation.background,"</label>\n                            <div class='tch-color-picker-container'>\n                                <div class='tch-color-picker' name='colors-Chart-backgroundColor'></div>\n                            </div>\n                        </td>\n                        <td>\n                            <input name ='options-Chart-symbolDescription' type='checkbox' />\n                            <label tch-text='symbol-description'>").concat(this.translation["symbol-description"],"</label>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <label tch-text='vert-grid-lines'>").concat(this.translation["vert-grid-lines"],"</label>\n                            <div class='tch-color-picker-container'>\n                                <div class='tch-color-picker' name = 'colors-Chart-vertGridLines'></div>\n                            </div>\n                        </td>\n                        <td>\n                            <select name ='options-Chart-typeVertGridLines'>\n                                <option value ='normal'>________</option>\n                                <option value ='dash'>--------</option>\n                                <option value ='points'>-.-.-.-.</option>\n                            </select>\n                        </td>\n                        <td>\n                            <input name ='options-Chart-ohlcValues' type='checkbox' />\n                            <label tch-text='ohlc-values'>").concat(this.translation["ohlc-values"],"</label>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <label tch-text='horz-grid-lines'>").concat(this.translation["horz-grid-lines"],"</label>\n                            <div class='tch-color-picker-container'>\n                                <div class='tch-color-picker'name='colors-Chart-horzGridLines'></div>\n                            </div>\n                        </td>\n                        <td>\n                            <select name ='options-Chart-typeHorzGridLines'>\n                                <option value ='normal'>________</option>\n                                <option value ='dash'>--------</option>\n                                <option value ='points'>-.-.-.-.</option>\n                            </select>\n                        </td>\n                        <td>\n                            <input name ='options-Chart-indicatorTitles' type='checkbox' />\n                            <label tch-text='indicator-titles'>").concat(this.translation["indicator-titles"],"</label>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <label tch-text='scales-text'>").concat(this.translation["scales-text"],"</label>\n                            <div class='tch-color-picker-container'>\n                                <div class='tch-color-picker' name='colors-Chart-scalesText'></div>\n                            </div>\n                        </td>\n                        <td>\n                            <select name ='options-Chart-scalesFontSize'>\n                                <option value = '10'>10</option>\n                                <option value = '11'>11</option>\n                                <option value = '12'>12</option>\n                                <option value = '14'>14</option><option value = '16'>16</option>\n                                <option value = '20'>20</option><option value = '24'>24</option>\n                                <option value = '28'>28</option><option value = '32'>32</option>\n                            </select>\n                        </td>\n                        <td>\n                            <input name ='options-Chart-indicatorArguments' type='checkbox' />\n                            <label tch-text='indicator-arguments'>").concat(this.translation["indicator-arguments"],"</label>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <label tch-text='scales-lines'>").concat(this.translation["scales-lines"],"</label>\n                            <div class='tch-color-picker-container'>\n                                <div class='tch-color-picker' name='colors-Chart-colorScalesLines'></div>\n                            </div>\n                        </td>\n                        <td></td>\n                        <td>\n                            <input name ='options-Chart-indicatorValues' type='checkbox' />\n                            <label tch-text='indicator-values'>").concat(this.translation["indicator-values"],"</label>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <label tch-text='watermark'>").concat(this.translation.watermark,"</label>\n                            <div class='tch-color-picker-container'>\n                                <div class='tch-color-picker' name='colors-Chart-watermarkColor'></div>\n                            </div>\n                        </td>\n                        <td></td>\n                        <td></td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <label tch-text='crosshair'>").concat(this.translation.crosshair,"</label>\n                            <div class='tch-color-picker-container'>\n                                <div class='tch-color-picker' name='colors-Chart-colorCrossHair'></div>\n                            </div>\n                        </td>\n                        <td>\n                            <select name ='options-Chart-typeCrossHair'>\n                                <option value ='normal'>________</option>\n                                <option value ='dash'>--------</option>\n                                <option value ='points'>-.-.-.-.</option>\n                            </select>\n                        </td>\n                        <td>\n                            <input name ='options-Chart-widthCrossHair' type='range' min='1' max='4' value='1'/>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td colspan='3'>\n                            <label tch-text='navigation-buttons'>").concat(this.translation["navigation-buttons"],"</label>\n                            <select>\n                                <option tch-text='visible-onmouse'>").concat(this.translation["visible-onmouse"],"</option>\n                                <option tch-text='always-visible'>").concat(this.translation["always-visible"],"</option>\n                                <option tch-text='always-invisible'>").concat(this.translation["always-infisible"],"</option>\n                            </select>\n                        </td>\n                    </tr>\n                    <tr>\n                        ").concat(this.createThemeDropDown(),"\n                    </tr>\n                </tbody>\n            </table>\n        </div>")},m.prototype.createThemeDropDown=function(){return this.store.isExternalStyleState()?"":"<td>\n                <label tch-text='themes'>".concat(this.translation.themes,"</label>\n            </td>\n            <td colspan='2'>\n                <select  name ='options-Chart-typeThemes' >\n                    <option value='blackThema' tch-text='black' >").concat(this.translation.black,"</option>\n                    <option value='blueThema' tch-text='blue' >").concat(this.translation.blue,"</option>\n                    <option value='greyThema' tch-text='grey' >").concat(this.translation.grey,"</option>\n                    <option value='defaultThema' tch-text='default' >").concat(this.translation.default,"</option>\n                </select>\n            </td>")},m.prototype.htmlSettingsTimeZone=function(){return"<div class='tch-settings-timezone tch-hidden'>\n            <label tch-text='timezone'>Time Zone</label>\n            <select>\n                <option>(UTC+2)</option>\n                <option>(UTC+3)</option>\n                <option>(UTC+4)</option>\n            </select>\n        </div>\n        <ul class='tch-settings-dropdown-footer tch-dropdown-footer tch-clearfix'>\n            <li>\n                <input type='button' class='tch-btn tch-btn-default' value='Defaults' tch-text='default'/>\n            </li>\n            <li>\n                <input type='button' class='tch-btn tch-btn-submit' tch-text='ok' value='".concat(this.translation.ok,"'/>\n                <input type='button' class='tch-btn tch-btn-cancel' tch-text='cancel' value='").concat(this.translation.cancel,"'/>\n            </li>\n        </ul>")},m.prototype.htmlSettings=function(){return"".concat(this.htmlSettingsStyle(),"\n        ").concat(this.htmlSettingsScales(),"\n        ").concat(this.htmlSettingsBackground(),"\n        ").concat(this.htmlSettingsTimeZone())},m.prototype.htmlSearchQuotationButton=function(){return this.configuration.modules.headerButtons.searchQuotationButton?"<div class='tch-search-container tch-dropdown-container'>\n                <input class='tch-search' type='text' spellcheck='false'>\n                <div class='tch-search-dropdown tch-dropdown-list'>\n                    <div class='tch-tabs'>\n                        <ul class='tch-tabs-list tch-dropdown-header'></ul>\n                    </div>\n                    <div class='tch-filtered-quatation'>\n                        <table>\n                            <tbody></tbody>\n                        </table>\n                    </div>\n                </div>\n            </div>\n            <div class='tch-divide-horizontal'></div>":""},m.prototype.htmlPeriodsButton=function(){return this.configuration.modules.headerButtons.periodsButton?"<div class='tch-periods-container'>\n                <div class='tch-dropdown-container-periods tch-dropdown-container'>\n                    <div class='tch-period-btn tch-dropdown-btn'></div>\n                    <div class='tch-period-select tch-pointer'></div>\n                    <ul class='tch-periods-dropdown tch-dropdown-list'></ul>\n                </div>\n            </div>\n            <div class='tch-divide-horizontal'></div>":""},m.prototype.createPipsButton=function(){return this.configuration.modules.headerButtons.createPipsButton?"<input type='button' class='tch-pips-btn'/>":""},m.prototype.htmlTypeDataButton=function(){return this.configuration.modules.headerButtons.createTypeDataButton?"<div class='tch-typedata-container'>\n                <div class='tch-dropdown-container-typedata tch-dropdown-container'>\n                    <div class='tch-typedata-button tch-dropdown-btn'></div>\n                    <div class='tch-typedata-select tch-pointer'></div>\n                    <ul class='tch-typedata-dropdown tch-dropdown-list'></ul>\n                </div>\n            </div>\n            <div class='tch-divide-horizontal'></div>":""},m.prototype.htmlChartTypeButton=function(){return this.configuration.modules.headerButtons.chartTypeButton?"<div class='tch-chart-type-container tch-dropdown-container'>\n                <div class='tch-chart-type-button tch-dropdown-btn'></div>\n                <div class='tch-chart-type-select tch-pointer'></div>\n                <ul class='tch-chart-type-dropdown tch-dropdown-list'></ul>\n            </div>\n            <div class='tch-divide-horizontal'></div>":""},m.prototype.htmlIndicatorButton=function(){return this.configuration.modules.headerButtons.indicatorButton?"<div class='tch-indicator-container tch-dropdown-container'>\n                <div class='tch-indicator-button tch-dropdown-btn'></div>\n                <div class='tch-pointer'></div>\n                <div class='tch-indicator-dropdown tch-dropdown-list'>\n                    <ul class='tch-dropdown-header'>\n                        <li tch-text='indicators'>".concat(this.translation.indicators,"</li>\n                    </ul>\n                    <input class='tch-indicator-search' type='text' tch-text='type-indicator' placeholder='").concat(this.translation["type-indicator"],"'/>\n                    <ul class='tch-indicators-list'></ul>\n                </div>\n            </div>\n            <div class='tch-divide-horizontal'></div>"):""},m.prototype.htmlSettingsButton=function(){return this.configuration.modules.headerButtons.settingsButton?"<div class='tch-settings-button tch-dropdown-btn tch-dropdown-container' data-at='at-chart-settingsbtn'>\n                <div class='tch-settings-dropdown tch-dropdown-list'>\n                    <div class='tch-tabs'>\n                        <ul class='tch-tabs-list tch-dropdown-header'>\n                            <li class='tch-tab-selected' tch-text='style'>".concat(this.translation.style,"</li>\n                            <li tch-text='scales'>").concat(this.translation.scales,"</li>\n                            <li tch-text='background'>").concat(this.translation.background,"</li>\n                            <li tch-text='timezone'>").concat(this.translation.timezone,"</li>\n                        </ul>\n                    </div>\n                    ").concat(this.htmlSettings(),"\n                </div>\n            </div>\n            <div class='tch-divide-horizontal'></div>"):""},m.prototype.htmlSplitterButton=function(){return this.configuration.modules.headerButtons.splitterButton?"<div class='tch-chart-layouts-container tch-dropdown-container'>\n                <div class='tch-chart-type-button tch-layout-button tch-dropdown-btn' tch-spliter-template='1'></div>\n                <div class='tch-chart-type-select tch-pointer'></div>\n                <div class='tch-chart-layouts-dropdown'>\n                    <ul class='tch-layout-header'>\n                        <li class='tch-selected' tch-spliter-template='1'></li>\n                        <li tch-spliter-template='2'></li>\n                        <li tch-spliter-template='3'></li>\n                        <li tch-spliter-template='4'></li>\n                        <li tch-spliter-template='5'></li>\n                        <li tch-spliter-template='6'></li>\n                        <li tch-spliter-template='7'></li>\n                        <li tch-spliter-template='8'></li>\n                        <li tch-spliter-template='9'></li>\n                    </ul>\n                    <ul>\n                        <li>\n                            <input type='checkbox' disabled />\n                            <label tch-text='link-symbol-to'>".concat(this.translation["link-symbol-to"],"</label>\n                        </li>\n                        <li>\n                            <input type='checkbox' disabled />\n                            <label tch-text='link-interval-to'>").concat(this.translation["link-interval-to"],"</label>\n                        </li>\n                        <li>\n                            <input type='checkbox' disabled />\n                            <label tch-text='link-crosshair-on'>").concat(this.translation["link-crosshair-on"],"</label>\n                        </li>\n                        <li>\n                            <input type='checkbox' disabled />\n                            <label tch-text='track-time-on'>").concat(this.translation["track-time-on"],"</label>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n            <div class='tch-divide-horizontal'></div>"):""},m.prototype.fullScreenButton=function(){return this.configuration.modules.headerButtons.fullScreenButton?"<div class='tch-fullscreen-btn' data-at='at-chart-fullscrbtn'></div>":""},m.prototype.createTabButton=function(){return this.configuration.modules.headerButtons.createTabButton?"<div class='tch-tab-btn'  data-at='at-chart-newtabbtn'>\n                <span></span>\n            </div>\n            <div class='tch-divide-horizontal'></div>":""},m.prototype.htmlHeader=function(){var t=this.configuration.modules.headerButtons;if(!this.configuration.modules.isHeaderCreate){for(var e in t)t[e]=!1;return"<div class='tch-header'></div>"}return"<div class='tch-header'>\n            <div class='tch-header-container'>\n               <div class='tch-top-buttons'>\n                   ".concat(this.htmlSearchQuotationButton(),"\n                   ").concat(this.htmlPeriodsButton(),"\n                   ").concat(this.htmlChartTypeButton(),"\n                   ").concat(this.htmlIndicatorButton(),"\n                   ").concat(this.htmlSettingsButton(),"\n                   ").concat(this.createTabButton(),"\n                   ").concat(this.htmlTypeDataButton(),"\n                   ").concat(this.createPipsButton(),"\n                   <div class='tch-header-right-side tch-clearfix'>\n                       ").concat(this.htmlSplitterButton(),"\n                       ").concat(this.fullScreenButton(),"\n                   </div>\n               </div>\n            </div>\n            <div class='tch-header-close-panel'>\n                <span class='tch-header-close-panel'></span>\n            </div>\n       </div>")},m.prototype.htmlMoreButton=function(){return"<div class='tch-more-container'>\n            <div class='tch-tooltip tch-icon-container'>\n            <input type='button' class='tch-more-btn tch-icon tch-icon-sidebar'/>\n            <span class='tch-tooltiptext' tch-text='more'>".concat(this.translation.more,"</span>\n            </div> \n        </div>")},m.prototype.cursorTypeButton=function(){return this.configuration.modules.sideBarButtons.cursorTypeButton?"<div class='tch-cursorType-container tch-dropdown-container'>\n                <div class='tch-cursorType-button tch-dropdown-btn tch-icon-container'></div>\n                <div class='tch-pointer tch-dropdown-pointer'></div>\n                <ul class='tch-cursorType-dropdown tch-dropdown-list'></ul>\n            </div>\n            <div class='tch-divide-vertical'></div>":""},m.prototype.drawingObjectsButton=function(){return this.configuration.modules.sideBarButtons.drawingObjectsButton?"<div class='tch-lineType-container tch-dropdown-container'>\n                <div class='tch-lineType-button tch-dropdown-btn tch-icon-container' actualtype='trend'></div>\n                <div class='tch-pointer tch-dropdown-pointer'></div>\n                <ul class='tch-lineType-dropdown tch-dropdown-list'></ul>\n            </div>\n            <div class='tch-divide-vertical'></div>":""},m.prototype.brushTypeButton=function(){return this.configuration.modules.sideBarButtons.brushTypeButton?"<div class='tch-brushType-container tch-dropdown-container'>\n                <div class='tch-brushType-button tch-dropdown-btn tch-icon-container' actualtype='brush'></div>\n                <div class='tch-pointer tch-dropdown-pointer'></div>\n                <ul class='tch-brushType-dropdown tch-dropdown-list'></ul>\n            </div>\n            <div class='tch-divide-vertical'></div>":""},m.prototype.textTypeButton=function(){return this.configuration.modules.sideBarButtons.textTypeButton?"<div class='tch-textType-container tch-dropdown-container'>\n                <div class='tch-textType-button tch-dropdown-btn tch-icon-container' actualtype='text'></div>\n                <div class='tch-pointer tch-dropdown-pointer'></div>\n                <ul class='tch-textType-dropdown tch-dropdown-list'></ul>\n            </div>\n            <div class='tch-divide-vertical'></div>":""},m.prototype.zoomButton=function(){return this.configuration.modules.sideBarButtons.zoomButton?"<div class='tch-zoom-container'>\n                <div class='tch-tooltip tch-icon-container tch-zoomin'>\n                    <input type='button' class='tch-zoomin-btn tch-icon tch-icon-sidebar'/>\n                    <span class='tch-tooltiptext' tch-text='zoom-in'>".concat(this.translation["zoom-in"],"</span>\n                </div>\n                <div class='tch-tooltip tch-icon-container tch-zoomout'>\n                    <input type='button' class='tch-zoomout-btn tch-icon tch-icon-sidebar' disabled/>\n                    <span class='tch-tooltiptext' tch-text='zoom-out'>").concat(this.translation["zoom-out"],"</span>\n                </div>\n            </div>\n            <div class='tch-divide-vertical'></div>"):""},m.prototype.lockButton=function(){return this.configuration.modules.sideBarButtons.lockButton?"<div class='tch-lock-container'>\n                <div class='tch-tooltip tch-icon-container'>\n                    <input type='button' class='tch-lock-btn tch-icon tch-icon-sidebar'/>\n                    <span class='tch-tooltiptext' tch-text='lock'>".concat(this.translation.lock,"</span>\n                </div>\n            </div>\n            <div class='tch-divide-vertical'></div>"):""},m.prototype.basketButton=function(){return this.configuration.modules.sideBarButtons.basketButton?"<div class='tch-basket-container'>\n                <div class='tch-tooltip tch-icon-container'>\n                    <input type='button' class='tch-basket-btn tch-icon tch-icon-sidebar'/>\n                    <span class='tch-tooltiptext' tch-text='clear'>".concat(this.translation.clear,"</span>\n                </div>\n            </div>\n            <div class='tch-divide-vertical'></div>"):""},m.prototype.saveRestoreButtons=function(){return this.configuration.modules.sideBarButtons.saveRestoreButtons?"<div class='tch-settings-container'>\n                <div class='tch-tooltip tch-icon-container tch-link-container tch-save-btn-wrap'>\n                    <a id='tch-save-btn' class='tch-save-btn tch-icon tch-icon-sidebar' href='#' download=''></a>\n                    <span class='tch-tooltiptext' tch-text='save'>".concat(this.translation.save,"</span>\n                </div>\n                <div class='tch-tooltip tch-icon-container tch-restore-btn-wrap'>\n                    <label class='tch-restore-btn tch-icon tch-icon-sidebar'>\n                        <input id='tch-restore-btn' type='file' class='tch-restore-file tch-icon tch-icon-sidebar'/>\n                    </label>\n                    <span class='tch-tooltiptext' tch-text='restore'>").concat(this.translation.restore,"</span>\n                </div>\n                <div class='tch-tooltip tch-icon-container tch-default-btn-wrap'>\n                    <input type='button' class='tch-default-btn tch-icon tch-icon-sidebar'/>\n                    <span class='tch-tooltiptext' tch-text='default'>").concat(this.translation.default,"</span>\n                </div>\n            </div>\n            <div class='tch-divide-vertical'></div>"):""},m.prototype.stayDrawingModeButton=function(){return this.configuration.modules.sideBarButtons.stayDrawingModeButton?"<div class='tch-stay-drawing-mode tch-tooltip tch-icon-container'>\n                <input type='button' class='tch-stay-drawing-mode-btn tch-icon tch-icon-sidebar'/>\n                <span class='tch-tooltiptext' tch-text='stay-in-drawing'>".concat(this.translation["stay-in-drawing"],"</span>\n            </div>\n            <div class='tch-divide-vertical'></div>"):""},m.prototype.hideDrowingObjectButton=function(){return this.configuration.modules.sideBarButtons.hideDrowingObjectButton?"<div class='tch-show-hide-drawing tch-tooltip tch-icon-container'>\n                <input type='button' class='tch-show-hide-drawing-btn tch-icon tch-icon-sidebar'/>\n                <span class='tch-tooltiptext' tch-text='show-hide' >".concat(this.translation["show-hide"],"</span>\n            </div>\n            <div class='tch-divide-vertical'></div>"):""},m.prototype.magnetModeButton=function(){return this.configuration.modules.sideBarButtons.magnetModeButton?"<div class='tch-magnet-mode tch-tooltip tch-icon-container'>\n                <input type='button' class='tch-magnet-mode-btn tch-icon tch-icon-sidebar'/>\n                <span class='tch-tooltiptext' tch-text='magnet-mode'>".concat(this.translation["magnet-mode"],"</span>\n            </div>\n            <div class='tch-divide-vertical'></div>"):""},m.prototype.rouleteButton=function(){return this.configuration.modules.sideBarButtons.rouleteButton?"<div class='tch-roulete-drawing tch-tooltip tch-icon-container'>\n                <input type='button' class='tch-roulete-drawing-btn tch-icon tch-icon-sidebar'/>\n                <span class='tch-tooltiptext' tch-text='roulette-mode'>".concat(this.translation["roulette-mode"],"</span>\n            </div>"):""},m.prototype.sidebarCloseButton=function(){return this.configuration.modules.isSideBarCreate?"<div class='tch-sidebar-close-panel'>\n                <span class='tch-sidebar-close-panel'></span>\n            </div>":""},m.prototype.htmlSideBarContainer=function(){return"<div class='tch-sidebar-container'>\n                <div class='tch-logo'></div>\n                <div class='tch-divide-vertical'></div>\n                <div class='tch-sidebar-buttons'>\n                    ".concat(this.cursorTypeButton(),"\n                    ").concat(this.drawingObjectsButton(),"\n                    ").concat(this.brushTypeButton(),"\n                    ").concat(this.textTypeButton(),"\n                    ").concat(this.zoomButton(),"\n                    ").concat(this.lockButton(),"\n                    ").concat(this.basketButton(),"\n                    ").concat(this.saveRestoreButtons(),"\n                    ").concat(this.stayDrawingModeButton(),"\n                    ").concat(this.hideDrowingObjectButton(),"\n                    ").concat(this.magnetModeButton(),"\n                    ").concat(this.rouleteButton(),"\n                </div>\n            </div>\n             ").concat(this.sidebarCloseButton())},m.prototype.htmlSidebar=function(){if(!this.configuration.modules.isSideBarCreate){for(var t in this.configuration.modules.sideBarButtons)this.configuration.modules.sideBarButtons[t]=!1;return"<div class='tch-sidebar'></div>"}return"<div class='tch-sidebar'>\n            ".concat(this.htmlSideBarContainer(),"\n        </div>")},m.prototype.htmlDataPanel=function(){return this.configuration.modules.chartElements.isDataPanelCreate?"<div class = 'tch-data-panel tch-move tch-small'>\n                <div class='tch-data-panel-header tch-data-panel-row'>\n                    <span id='name'></span>\n                    <span id='period'></span>\n                    <span id='date'></span>\n                    <span id='value'></span>\n                    <span class='tch-up'></span>\n                </div>\n                <div class='tch-data-panel-body tch-hidden'>\n                    <ul class='tch-data-candle tch-data-panel-row'></ul>\n                <div class ='tch-data-indicators tch-data-panel-row'>\n            </div>\n            ".concat(this.configuration.modules.signals?"<div class ='tch-data-signals tch-data-panel-row'></div>":""):""},m.prototype.htmlIndicatorSettingPanel=function(){return"<div class='tch-indicator-form tch-indicator-panel tch-hidden tch-move'>\n            <ul class='tch-indicator-panel-header tch-dropdown-header'>\n                <li class='tch-tab-selected'>".concat(this.translation.inputs,"</li>\n                <li>").concat(this.translation.style,"</li>\n            </ul>\n            <div class='tch-indicator-panel-main'>\n                <div class='tch-indicator-inputs'>\n                    <table>\n                        <tbody>\n                        </tbody>\n                    </table>\n                </div>\n                <div class='tch-indicator-style tch-hidden'>\n                    <table>\n                        <tbody>\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n            <ul class='tch-dropdown-footer tch-clearfix'>\n                <li>\n                    <input type='button' class='tch-btn tch-btn-default'  tch-text='default' value='Default'/>\n                </li>\n                <li>\n                    <input type='button' class='tch-btn tch-btn-submit' tch-text='ok' value='").concat(this.translation.ok,"'>\n                    <input type='button' class='tch-btn tch-btn-cancel' tch-text='cancel' value='").concat(this.translation.cancel,"'>\n                </li>\n            </ul>\n        </div>")},m.prototype.htmlContainer=function(){return"<div class='tch-container'>\n            ".concat(this.htmlHeader(),"\n            <div class='tch-chart-alert'></div>\n            <div class='tch-tabs-container'></div>\n            <div class='tch-charts-container'></div>\n            ").concat(this.htmlIndicatorSettingPanel(),"\n            ").concat(this.htmlDataPanel(),"\n        </div>")},m.prototype.htmlTrading=function(){return this.configuration.modules.trading?"<div class='trading-module-container' id='tradingModule'></div>":""},m.prototype.html=function(){return"".concat(this.htmlSidebar(),"\n        ").concat(this.htmlContainer(),"\n        ").concat(this.htmlTrading())},m.prototype.createSideBarMenu=function(t,e){switch(t){case"cursorType":this.cursorChangeImage(e),this.getActiveChartData().state&&"drawingRoulete"!==this.getActiveChartData().state||this.setState("default");break;case"lineType":case"brushType":case"textType":return this.setState(e)}},m.prototype.createSideBarMenuType=function(){if(this.configuration.modules.isSideBarCreate){var t=this,e=this.sideBarMenus();for(var a in this.sideBarListItemps=[],e)if(e.hasOwnProperty(a)&&e[a]){var i=t.parent.querySelector(".tch-"+a+"-container");this.activeMenuContainer.push(i);var s=i.querySelector(".tch-dropdown-btn"),r=i.querySelector(".tch-dropdown-list");for(var n in e[a])if(e[a].hasOwnProperty(n)){var o=document.createElement("li"),h=e[a][n];o.container=i,o.btn=s,o.key=n,o.itemM=a,o.classList.toggle(n,!0),o.innerHTML=e[a][n],o.setAttribute("tch-text",h),this.sideBarListItemps.push(o),o.onclick=function(){t.createSideBarMenu(this.itemM,this.key)&&(t.deactivateMenuTypeAll(),"default"!==t.getActiveChart().chartData.state&&(this.container.setAttribute("actualtype",this.key),this.container.classList.toggle("active",!0)))},r.appendChild(o)}}this.createSubMenu()}},m.prototype.getOutsideElementIndex=function(t,e,a){for(var i=t.getBoundingClientRect(),s=0;s<e.length;s++)if(e[s].getBoundingClientRect()[a]>i[a])return s-1;return-1},m.prototype.createSubMenu=function(){var t=this.parent.querySelector(".tch-sidebar-container"),e=t.querySelectorAll(".tch-sidebar-buttons .tch-icon-container"),a=this.getOutsideElementIndex(t,e,"bottom");if(!(a<0)){var i=this.hideOutsideElementsSubMenu(e[a],t),s=t.querySelector(".tch-sidebar-buttons");this.addMoreButton(s,i),i.style.boxSizing="content-box",this.setWidthMoreMenu(i)}},m.prototype.setWidthMoreMenu=function(t){t.classList.toggle("divMoreMenuForSize",!0);var e=parseFloat(getComputedStyle(t.firstChild).width),a=parseFloat(getComputedStyle(t.lastChild).width),i=0;e%a!==0&&(i=1),t.style.width=(Math.floor(e/a)+i)*a+"px",t.classList.toggle("divMoreMenuForSize",!1)},m.prototype.getOutsideElementIndex=function(t,e,a){for(var i=t.getBoundingClientRect(),s=0;s<e.length;s++)if(e[s].getBoundingClientRect()[a]>i[a])return s-1;return-1},m.prototype.addMoreButton=function(t,e){var a=document.createElement("div");a.classList.toggle("tch-more-btn",!0),a.innerHTML=this.htmlMoreButton(),a.appendChild(e),a.oncloseall=function(){this.classList.toggle("tch-more-active",!1)},this.dropForHidden.push(a),t.appendChild(a);var i=this;if(a.onclick=function(t){i.dropDownClickMore(a,t)},a.getBoundingClientRect().bottom>=t.getBoundingClientRect().bottom){var s=t.querySelectorAll(".tch-divide-vertical");s&&s.length&&t.removeChild(s[s.length-1],s[s.length-2])}},m.prototype.hideOutsideElementsSubMenu=function(t,e){for(var a,i=e.querySelectorAll(".tch-sidebar-buttons>div"),s=t.getBoundingClientRect().bottom,r=-1,n=i.length-1;i[n]&&Math.ceil(i[n].getBoundingClientRect().bottom)>=s;n--)if(-1===r&&(r=0,a=this.createMoreMenu("divMoreMenu")),i[n].classList.contains("tch-divide-vertical"))i[n].parentElement.removeChild(i[n]);else{var o=document.createElement("li");if(o.addEventListener("click",function(t){t.stopPropagation()}),o.appendChild(i[n]),i[n].classList.contains("tch-settings-container")){r++,o.classList.toggle("tch-more-order-0",!0);for(var h=i[n].querySelectorAll(".tch-icon-container"),c=0;c<h.length;c++){var l=document.createElement("label");l.appendChild(h[c]),i[n].appendChild(l)}a.insertBefore(o,a.firstChild)}else a.insertBefore(o,a.childNodes[r])}return a},m.prototype.createMoreMenu=function(t){var e=document.createElement("ul");return e.classList.toggle(t,!0),e},m.prototype.createChartTypesMenu=function(){if(this.configuration.modules.headerButtons.chartTypeButton){var t=this,e=this.parent.querySelector(".tch-chart-type-dropdown"),a=this.parent.querySelector(".tch-chart-type-button"),i=this.parent.querySelector(".tch-chart-type-container"),s=this.parent.querySelector(".tch-style-select-chart-type"),r=this.chartHeaderMenus();for(var n in r)if(r.hasOwnProperty(n)){var o=document.createElement("li");o.textContent=r[n],o.className="tch-"+n,o.setAttribute("tch-text",r[n]),n===t.configuration.chartType&&(a.setAttribute("actualtype",this.configuration.chartType),o.classList.toggle("tch-chart-type-selected",!0)),o.addEventListener("click",function(i){for(var r=e.querySelectorAll("li"),n=0;n<r.length;++n)r[n].classList.toggle("tch-chart-type-selected",!1);if(t.configuration.modules.headerButtons.settingsButton)for(var o in r)if(r.hasOwnProperty(o)&&r[o]===i.target){s.selectedIndex=o,s.dispatchEvent(new Event("change"));break}this.classList.add("tch-chart-type-selected");var h=i.target.classList[0].replace("tch-","");a.setAttribute("actualtype",h),t.getActiveChartData().options.Chart.typeChart=h,t.setChartType(h);var c=t.getActiveChartData(),l=c.chart.parent;t.charts[t.activeChartIndex]=t.createChart(l,c),t.charts[t.activeChartIndex].init(!0),t.autoSaveParams()}),e.appendChild(o)}this.dropForHidden.push(i)}},m.prototype.createTypeDataMenu=function(){if(this.configuration.modules.headerButtons.createTypeDataButton){var t,e,a=this.parent.querySelector(".tch-typedata-container").querySelector(".tch-dropdown-container-typedata");this.dropForHidden.push(a);var i=a.querySelector(".tch-dropdown-list"),s=a.querySelector(".tch-typedata-button"),r=this,n=this.translation,o=this.typeDatas();for(var h in o)if(o.hasOwnProperty(h)){if(t=document.createElement("li"),e=document.createElement("span"),t.appendChild(e),e.innerText=n[h],i.appendChild(t),o[h].name=h,o[h].btn=t,t.item=o[h],t.setAttribute("name",h),o[h].value===this.configuration.typeData){t.classList.toggle("tch-selected",!0);var c=document.createElement("span");c.innerText=o[h].text,s.appendChild(c)}o[h].btn.addEventListener("click",function(t){r.closeAll(),t.stopPropagation();var e=t.target.item;e||(e=t.target.parentNode.item),this.classList.contains("tch-selected")||r.changeTypeData(e.name,r)})}}},m.prototype.changeTypeData=function(t,e){e.setTypeDataBtn(t),e.setTypeData(t),e.autoSaveParams()},m.prototype.setTypeData=function(t){var e=this.getActiveChart();e.chartData.typeData=t,e.redraw()},m.prototype.setTypeDataBtn=function(t){if(this.configuration.modules.headerButtons.createTypeDataButton){var e=this.parent.querySelector(".tch-dropdown-container-typedata"),a=e.querySelector("li[name='"+t+"']").item;this.removeRoulete();for(var i=e.querySelectorAll("li"),s=0;s<i.length;s++)i[s].classList.toggle("tch-selected",!1);a.btn.parentElement.lastChild.childNodes[0].classList.toggle("tch-selected",!1),a.btn.classList.toggle("tch-selected",!0),e.querySelector("div.tch-typedata-button>span").innerText=a.text}},m.prototype.createPeriodsMenu=function(){if(this.configuration.modules.headerButtons.periodsButton){var t,e,a=this.parent.querySelector(".tch-periods-container").querySelector(".tch-dropdown-container-periods");this.dropForHidden.push(a);var i=a.querySelector(".tch-dropdown-list"),s=a.querySelector(".tch-period-btn"),r=this,n=this.periods();for(var o in n)if(n.hasOwnProperty(o)){var h=r.makeTchTextValue(this.translation[n[o].key]);if(t=document.createElement("li"),e=document.createElement("span"),t.appendChild(e),e.innerText=this.translation[n[o].key],e.setAttribute("tch-text",h),i.appendChild(t),n[o].name=o,n[o].btn=t,t.item=n[o],t.setAttribute("name",o),n[o].value===this.configuration.period){t.classList.toggle("tch-selected",!0);var c=document.createElement("span");c.innerText=n[o].text,s.appendChild(c)}n[o].btn.addEventListener("click",function(t){r.closeAll(),t.stopPropagation();var e=t.target.item;e||(e=t.target.parentNode.item),this.classList.contains("tch-selected")||r.changePeriod(e.name)})}}},m.prototype.changePeriod=function(t){this.initializationDone=!1,this.setPeriodBtn(t),this.setPeriod(t),this.autoSaveParams()},m.prototype.setPeriodBtn=function(t){if(this.configuration.modules.headerButtons.periodsButton){var e=this.parent.querySelector(".tch-dropdown-container-periods"),a=e.querySelector("li[name='"+t+"']").item;this.removeRoulete();for(var i=e.querySelectorAll("li"),s=0;s<i.length;s++)i[s].classList.toggle("tch-selected",!1);a.btn.parentElement.lastChild.childNodes[0].classList.toggle("tch-selected",!1),a.btn.classList.toggle("tch-selected",!0),e.querySelector("div.tch-period-btn>span").innerText=a.text}},m.prototype.setPeriodSelectBtnClick=function(){if(this.configuration.modules.headerButtons.periodsButton){var t=this.parent.querySelector(".tch-dropdown-container-periods"),e=this;t.addEventListener("click",function(a){e.continueDrawing(a)||(e.dropDownClick(t,void 0,a),e.lostFocusDrawingObject())})}},m.prototype.setTypeDataSelectBtnClick=function(){if(this.configuration.modules.headerButtons.createTypeDataButton){var t=this.parent.querySelector(".tch-dropdown-container-typedata"),e=this;t.addEventListener("click",function(a){e.dropDownClick(t,void 0,a),e.lostFocusDrawingObject()})}},m.prototype.setChartTypeSelectBtnClick=function(){if(this.configuration.modules.headerButtons.chartTypeButton){var t=this.parent.querySelector(".tch-chart-type-container"),e=this;t.addEventListener("click",function(a){e.continueDrawing(a)||(e.dropDownClick(t,void 0,a),e.fillChartSettingsPanel(),e.lostFocusDrawingObject())})}},m.prototype.recreateSideBarMenu=function(){this.parent.querySelector(".tch-sidebar").innerHTML=this.htmlSideBarContainer(),this.removeSideBarMenuEvents(),this.createSideBarMenuType(),this.addSideBarMenuEvents(),this.addSidebarClosePanelEvents(),this.createSubMenu(),this.setActiveIcon()},m.prototype.setActiveIcon=function(){var t=this.getActiveChartData();t&&(t.isDrawingObjectsLocked&&this.parent.querySelector(".tch-lock-btn").classList.add("tch-active"),t.isStayDrawingMode&&(this.parent.querySelector(".tch-stay-drawing-mode-btn").classList.add("tch-active"),this.setActiveDrawingModeStateIcon()),t.isShowDrawingObjects||this.parent.querySelector(".tch-show-hide-drawing-btn").classList.add("tch-active"),t.isMagnetMode&&this.parent.querySelector(".tch-magnet-mode-btn").classList.add("tch-active"),"default"!==t.state&&this.setActiveDrawingModeStateIcon())},m.prototype.addTabsBtnEvent=function(){if(this.configuration.modules.headerButtons.createTabButton){var t=this.parent.querySelector(".tch-tab-btn"),e=this;t.addEventListener("click",function(){e.lostFocusDrawingObject(),e.createTab(),e.lostFocusDrawingObject()})}},m.prototype.createTab=function(t){this.canAddTab=!1,this.setCanAddTab(),this.canAddTab&&Object.keys(this.groupCharts).length<this.maxTabsQuantity&&(this.createTabs(t),this.setTabsContainerHeight(),this.deactivateTab(),this.activateTabContent())},m.prototype.focusOnQuotationButton=function(){this.parent.querySelector(".tch-search").click(),this.parent.querySelector(".tch-search").focus()},m.prototype.setCanAddTab=function(){var t=!0,e=Object.keys(this.groupCharts);this.connector.chartQuantity&&(this.connector.chartQuantity=e.length),e.length===this.maxTabsQuantity&&(t=!1),this.canAddTab=t,this.activateAddTabBtn()},m.prototype.activateAddTabBtn=function(){if(this.configuration.modules.headerButtons.createTabButton){var t=this.parent.querySelector(".tch-tab-btn");t||(t=this.createAddTabsBtn()),t.classList.toggle("tch-tab-btn-disable",!this.canAddTab)}},m.tabsId=1,m.getTabName=function(){return"tab-"+m.tabsId++},m.prototype.setActiveDrawingModeStateIcon=function(){var t=this.getActiveChartData().state;if("default"!==t&&"drawingRoulete"!==t){var e=this.parent.querySelector(".".concat(t)).parentNode.parentNode;e.setAttribute("actualtype",t),e.classList.toggle("active",!0)}},m.prototype.setActiveDrawingObjectsLockedStateIcon=function(){this.getActiveChartData().isDrawingObjectsLocked&&this.parent.querySelector(".".concat("tch-lock-btn")).classList.toggle("tch-active",!0)},m.prototype.createNewTabContainer=function(t){var e=this.parent.querySelector(".tch-tabs-container"),a=document.createElement("div");a.id=t,a.classList.toggle("tch-chart-tab",!0);var i=document.createElement("div");i.id=t,i.classList.toggle("tch-chart-divName",!0);var s=document.createElement("span");s.id="nameChart_"+t,s.classList.toggle("tch-chart-spanName",!0),s.innerText=this.getPairSettings(this.settings.quotations,this.configuration.pair.ID).Name;var r=document.createElement("span");r.classList.toggle("tch-chart-spanPayout",!0);var n=this;a.onclick=function(t){n.continueDrawing(t)||(n.lostFocusDrawingObject(),n.selectTab(t.target),t.stopPropagation(),n.setShowHideDrawing(),n.setMagnetModeBtn(),n.getActiveChartData().isStayDrawingMode&&(n.setActiveDrawingModeStateIcon(),n.setStayDrawingModeBtn()),n.setActiveDrawingObjectsLockedStateIcon())},a.onmousedown=function(t){2===t.which&&(n.closeTab(t.target),t.stopPropagation())},i.appendChild(s),i.appendChild(r);var o=document.createElement("div");o.id=t,o.classList.toggle("tch-chart-divClose",!0);var h=document.createElement("span");h.innerText="",h.addEventListener("click",function(t){n.closeTab(t.target),t.stopPropagation()}),o.appendChild(h),a.appendChild(i),a.appendChild(o),e.appendChild(a),this.setTabActive(t)},m.prototype.setTabsContainerHeight=function(){var t=this.parent.querySelector(".tch-container");Object.keys(this.groupCharts).length>1?t.classList.contains("tch-tabs-hidden")&&t.classList.toggle("tch-tabs-hidden",!1):t.classList.contains("tch-tabs-hidden")||t.classList.toggle("tch-tabs-hidden",!0),this.resize(),this.autoSaveParams()},m.prototype.closeTab=function(t){var e;if(e=this.parent.querySelector("#".concat(t.parentNode.id)),delete this.groupCharts[e.id],e.parentNode.removeChild(e),this.setTabsContainerHeight(),this.activeTab===e.id){var a=Object.keys(this.groupCharts);this.setTabActive(a[a.length-1]),this.activateTabContent()}this.setCanAddTab(),this.getActiveChart().updateSignals()},m.prototype.setTabActive=function(t){this.activeTab=t;for(var e=this.parent.querySelectorAll(".tch-chart-tab"),a=0;a<e.length;a++)e[a].getAttribute("id")===t?e[a].classList.toggle("tch-tab-active",!0):e[a].classList.toggle("tch-tab-active",!1)},m.prototype.deactivateTab=function(){for(var t=this.groupCharts[this.activeTab].chartData,e=0;e<t.length;e++)t[e].chart=null},m.prototype.selectTab=function(t){"span"===t.tagName.toLowerCase()&&(t=t.parentNode);var e=t.id;this.activeTab!==e&&(this.deactivateTab(),this.setTabActive(e),this.activeTab=e,this.activateTabContent(),this.getActiveChart().updateSignals())},m.prototype.clearTabContainer=function(){this.parent.querySelector(".tch-tabs-container").innerHTML=""},m.prototype.setTabName=function(t){var e=this.parent.querySelector("#".concat("nameChart_"+t));null!==e&&(e.innerText=this.groupCharts[t].name)},m.prototype.createTabObject=function(t,e){return{name:t,activeIndex:0,activeTabSpliter:0,chartData:null===e?[]:e}},m.prototype.setTabObjectName=function(){for(var t in this.groupCharts)if(this.groupCharts.hasOwnProperty(t)){var e=this.groupCharts[t],a=e.chartData[e.activeIndex],i=this.getPairSettings(this.settings.quotations,a.pair.ID).FullName;e.name=i,this.setTabNameById(t,i)}},m.prototype.setActiveChartProps=function(t){this.activeChartIndex=t.index,this.groupCharts[this.activeTab].activeIndex=t.index,this.groupCharts[this.activeTab].name=t.pair.FullName,this.setTabName(this.activeTab)},m.prototype.setTabNameById=function(t,e){this.groupCharts[t].name=e,this.setTabName(t)},m.prototype.window_keyDown=function(t,e){switch(t.which){case 46:case 8:e.removeEditDrawingObject();break;case 13:if("Enter"===t.key&&"tch-stay-drawing-mode-btn tch-icon tch-icon-sidebar tch-active"===t.target.className||"tch-show-hide-drawing-btn tch-icon tch-icon-sidebar tch-active"===t.target.className||"tch-magnet-mode-btn tch-icon tch-icon-sidebar tch-active"===t.target.className||"tch-lock-btn tch-icon tch-icon-sidebar tch-active"===t.target.className){t.preventDefault(),t.stopPropagation();break}e.chartData.session="open",e.updateChart();break;case 90:t.ctrlKey&&(t.preventDefault(),t.stopPropagation())}},m.prototype.init=function(t){t&&this.mappingConfiguration(t),this.parent.classList.toggle("tch-arabic","ar"===this.configuration.lang),this.parent.classList.toggle("tch-opera",-1!==navigator.userAgent.indexOf("OPR/")),this.parent.innerHTML=this.html(),this.alertBrowse(),this.getSettings(this.connector),this.getNewsSource(),this.getEventsSource(),this.getQuotationCountries(),this.colorPickerInit(),this.fullscreenModeInit(),this.createMenu(),this.addEvents(),this.dataPanelInit(),this.postInit()},m.prototype.postInit=function(){this.setDefaultParamsPanel(this.configuration),this.applySettingsHeaderHidden(),this.applySettingsSidebarHidden(),this.applySettingsFullscreenBtn(),this.applySettingsDataPanelHidden(),this.chartsLoad(this.configuration);var t=this.getActiveChartData();t.isStayDrawingMode=!1!==t.isStayDrawingMode},m.prototype.chartsLoad=function(t){var e=this.getKeyForLocalStorage(),a=JSON.parse(localStorage.getItem(e));(!t.isAutoRestore||a&&a.version!==this.getVersion())&&(a=null),a?this.restoreParams(a):(this.createTabs(),this.resize(),this.setTabsContainerHeight(),this.activateTabContent(),localStorage.removeItem(e))},m.prototype.getChartDatas=function(t){return t.map(function(t){return t.chartData})},m.prototype.createAddTabsBtn=function(){var t=this.parent.querySelector(".tch-tabs-container"),e=document.createElement("div"),a=this.parent.querySelectorAll(".tch-tab-btn");if(a)for(var i=0;i<a.length;i++)a[i].remove();e.classList.toggle("tch-tab-btn",!0);var s=document.createElement("span"),r=this;return e.onclick=function(t){r.continueDrawing(t)||(r.createTab(),t.stopPropagation())},e.appendChild(s),t&&t.appendChild(e),e},m.prototype.createTabs=function(t){t&&(this.configuration.pair=t);var e,a,i=this.configuration.pair;this.activeSpliter=0,this.activeChatIndex=0,e=this.createChartsArray([]),a=this.getChartDatas(e);var s=this.createTabObject(a[0].pair.FullName,a),r=m.getTabName();s.chartData[0].currentTabId=r,this.groupCharts[r]=s,this.updateConnectorListeners(this.groupCharts),this.createNewTabContainer(r),t&&(this.configuration.pair=i)},m.prototype.updateConnectorListeners=function(t){for(var e in this.connector.listeners=[],t)if(t.hasOwnProperty(e))for(var a=0;a<t[e].chartData.length;a++)this.connector.listeners.push(t[e].chartData[a])},m.prototype.activateTabContent=function(){var t=this.groupCharts[this.activeTab];this.activeChartIndex=t.activeIndex;var e=[];this.activeSpliter=t.activeTabSpliter;for(var a=this.createChartContainers(),i=0;i<t.chartData.length;i++)e.push(this.createChart(null,t.chartData[i]));this.configuration.modules.headerButtons.createPipsButton&&this.parent.querySelector(".tch-pips-btn").classList.toggle("tch-pips-btn-active",t.chartData[0].isPipsShow),this.charts=e,this.createCharts(a),this.setActiveChartParams(),this.setActiveSpliterButton()},m.prototype.createChartsArray=function(t){var e,a,i=[],s=this.spliterTemplates()[this.activeSpliter].count;if(t.length>s){for(var r=0;r<s;r++)i.push(t[r]);this.activeChartIndex>=s&&(e=t[this.activeChartIndex].chartData,i[s-1]=this.createChart(null,e),this.activeChartIndex=s-1)}else for(var n=0;n<s;n++)if(n<t.length)i.push(t[n]);else if(t[this.activeChartIndex]){var h=Object(o.b)(t[this.activeChartIndex].chartData.data);(e=this.cloneChartData(t[this.activeChartIndex].chartData)).data=h,a=this.createChart(null,e),i.push(a)}else e=new g(this),a=this.createChart(null,e),i.push(a),this.activeChartIndex=0;for(var c=0;c<i.length;c++)i[c].chartData.techChart=this,i[c].chartData.init();return i},m.prototype.colorPickerInit=function(){new Picker(this.parent,this)},m.prototype.createChart=function(t,e){switch(e.chartType){case"area":return new y(t,e,this);case"line":return new f(t,e,this);case"candle":return new v(t,e,this);case"bar":return new D(t,e,this);case"hollow":return new w(t,e,this)}},m.prototype.createCharts=function(t){for(var e=0;e<t.length;e++)this.charts[e].parent=t[e],this.charts[e].chartData.index=e,this.charts[e].init();this.charts[this.activeChartIndex].setActiveChart(!0)},m.prototype.createChartContainers=function(){var t=this.parent.querySelector(".tch-charts-container");t.innerHTML="",this.chartsContainerRect=t.getBoundingClientRect();var e=this.chartsContainerRect.width-this.chartsOff,a=this.chartsContainerRect.height-this.chartsOff;return this.activeSpliter>0?this.splitCharts(t,this.spliterTemplates()[this.activeSpliter].template,e,a,0,0,!0):this.createChartContainer(t,this.chartsContainerRect.width,this.chartsContainerRect.height,0,0,0),t.querySelectorAll(".tch-chart-content")},m.prototype.setActiveSpliterButton=function(){if(this.configuration.modules.headerButtons.splitterButton){this.parent.querySelector(".tch-layout-button").setAttribute("tch-spliter-template",this.activeSpliter+1);for(var t=this.parent.querySelectorAll(".tch-layout-header li"),e=0;e<t.length;e++)t[e].classList.toggle("tch-selected",!1);this.parent.querySelector(".tch-layout-header li[tch-spliter-template='"+(this.activeSpliter+1)+"']").classList.toggle("tch-selected",!0)}},m.prototype.cloneChartData=function(t){var e=t.convertToDTO();return(t=new g(this)).convertFromDTO(e),t},m.prototype.resizeChartsContainers=function(t){var e=this.parent.querySelector(".tch-charts-container"),a=e.cloneNode(!0),i=e.getBoundingClientRect();a.innerHTML="";var s=i.width-this.chartsOff,r=i.height-this.chartsOff;this.activeSpliter>0?this.splitCharts(a,this.spliterTemplates()[this.activeSpliter].template,s,r,0,0,!0):this.createChartContainer(a,i.width,i.height,0,0,0);var n=a.querySelectorAll(".tch-chart-content"),o=e.querySelectorAll(".tch-chart-content");if(0!==o.length)for(var h=0;h<n.length;h++)o[h].style.width=n[h].style.width,o[h].style.height=n[h].style.height,o[h].style.top=n[h].style.top,o[h].style.left=n[h].style.left,this.charts[h]&&this.charts[h].init(!0,t)},m.prototype.splitCharts=function(t,e,a,i,s,r,n){if(e.length)for(var o,h,c=0;c<e.length;c++)n?(o=a/e.length,h=i,this.splitCharts(t,e[c],o,h,s+c*o,r,!1)):(o=a,h=i/e.length,this.splitCharts(t,e[c],o,h,s,r+c*h,!0));else this.createChartContainer(t,a,i,s,r,this.chartsOff)},m.prototype.createChartContainer=function(t,e,a,i,s,r){var n=document.createElement("div");n.classList.add("tch-chart-content"),e-=r+2,a-=r+2,i+=r,s+=r,n.style.width=e.toFixed(0)+"px",n.style.height=a.toFixed(0)+"px",n.style.left=i.toFixed(0)+"px",n.style.top=s.toFixed(0)+"px",t.appendChild(n)},m.prototype.getKeyForLocalStorage=function(){return"tchAuto".concat(this.store.getID())},m.prototype.fullscreenModeInit=function(){var t=this.getKeyForLocalStorage(),e=localStorage.getItem(t);e&&!0===this.configuration.isAutoRestore?this.parent.classList.toggle("tch-fullscreen-mode-on",JSON.parse(e).isFullScreen):this.parent.classList.toggle("tch-fullscreen-mode-on",this.configuration.isFullScreen)},m.prototype.createMenu=function(){this.createSideBarMenuType(),this.createPeriodsMenu(),this.createChartTypesMenu(),this.setActiveSpliterButton(),this.createTypeDataMenu()},m.prototype.applySettingsHeaderHidden=function(){this.parent.querySelector(".tch-container").classList.toggle("tch-header-hidden",!this.configuration.modules.isHeaderCreate||this.configuration.isHeaderHidden)},m.prototype.applySettingsSidebarHidden=function(){this.parent.querySelector(".tch-sidebar").classList.toggle("tch-sidebar-hidden",!this.configuration.modules.isSideBarCreate||this.configuration.isSidebarHidden)},m.prototype.applySettingsFullscreenBtn=function(){var t=this.parent.querySelector(".tch-fullscreen-btn");!1!==this.configuration.isFullScreenButton&&"false"!==this.configuration.isFullScreenButton||(t.style.display="none")},m.prototype.applySettingsDataPanelHidden=function(){var t=this.parent.querySelector(".tch-data-panel-body");if(t){var e=this.parent.querySelector(".tch-data-panel");t.classList.toggle("tch-hidden",this.configuration.isDataPanel),e.classList.toggle("tch-small",this.configuration.isDataPanel)}},m.prototype.alertBrowse=function(){Helper.warningBrowser()||Helper.showWarningBrowser(void 0,this.parent.querySelector(".tch-chart-alert"))},m.prototype.getSettings=function(){var t=this;if(this.settings.quotations&&this.settings.quotations.length)this.onGetSettingsComplete(JSON.stringify(this.settings.quotations),this);else{var e=this.configuration.links.settingsUrl;this.getDataFromNetwork(e,this,function(e){t.onGetSettingsComplete(e,t)}),this.fillIndicatorsDropdown(Object(o.c)(this.configuration.dropDown.indicators,this.indicators))}},m.prototype.onGetSettingsComplete=function(t,e){var a=t=JSON.parse(t);if(a.sort(function(t,e){return t.FullName>e.FullName?1:t.FullName<e.FullName?-1:0}),e.configuration.rowsid.length?e.settings.quotations=e.setQuotationsfromParams(a,e.configuration.rowsid):e.settings.quotations=a,e.configuration.defaultId){var i=e.getPairSettings(e.settings.quotations,e.configuration.defaultId);e.configuration.pair=i,e.setDefaultPair(i),e.setTabObjectName()}e.fillQuotationsSettings()},m.prototype.setDefaultPair=function(t){for(var e=0;e<this.charts.length;e++)parseInt(this.charts[e].chartData.pair.ID)===t.ID&&(this.charts[e].chartData.pair=t)},m.prototype.getNewsSource=function(){var t=this;if(this.configuration.modules.isShowNews){var e=this.configuration.links.newsSourceUrl;this.getDataFromNetwork(e,this,function(e){t.connector.options.newsUrl=e})}},m.prototype.getEventsSource=function(){var t=this;if(this.configuration.modules.isShowEvents){var e=this.configuration.links.eventsSourceUrl;this.getDataFromNetwork(e,this,function(e){t.connector.options.eventsUrl=e})}},m.prototype.getQuotationCountries=function(){var t=this;if(this.configuration.modules.isShowEvents){var e=this.configuration.links.quotationCountriesUrl;this.getDataFromNetwork(e,this,function(e){for(var a={},i=0;i<e.length;i++)a[e[i].Name]=e[i].Countries;t.configuration.quotationCountries=a})}},m.prototype.getDataFromNetwork=function(t,e,a){c.a.get(t).then(function(t){if(200!==t.status){var i=new Error(t.statusText);throw i.res=t,i}a(t.data,e)}).catch(function(t){console.warn(t)})},m.prototype.setQuotationDropDownValue=function(t){if(this.configuration.modules.headerButtons.searchQuotationButton)if(t.length>=14){var e=t.substring(0,13).concat("...");this.parent.querySelector(".tch-search").value=e}else this.parent.querySelector(".tch-search").value=t},m.prototype.setActiveStatePipsCalc=function(){if(this.configuration.modules.headerButtons.createPipsButton){var t=this.parent.querySelector(".tch-pips-btn"),e=this.charts[this.activeChartIndex].chartData.isPipsShow;t.classList.toggle("tch-pips-btn-active",e)}},m.prototype.dataPanelInit=function(){this.moveElements=new p;for(var t=this.parent.querySelectorAll(".tch-move"),e=0;e<t.length;e++)this.moveElements.addDragObject(t[e]);this.setDropTargetContainer()},m.prototype.getPairSettings=function(t,e){if(!t)return{ID:e,Name:"",FullName:""};e=parseInt(e);for(var a={},i=0;i<t.length;i++)t[i].ID===e&&(a={ID:t[i].ID,Name:t[i].Name,FullName:t[i].FullName,Category:t[i].Category});return 0===Object.keys(a).length&&(a={ID:t[0].ID,Name:t[0].Name,FullName:t[0].FullName,Category:t[0].Category}),a},m.prototype.setQuotationsfromParams=function(t,e){for(var a=[],i=0;i<t.length;i++)-1!==e.indexOf(t[i].ID.toString())&&a.push(t[i]);return a},m.prototype.setDropTargetContainer=function(){var t=getComputedStyle(this.parent.querySelector(".tch-charts-container")),e=this.parent.parentNode.querySelector(".tch-header").getBoundingClientRect(),a={left:(isNaN(parseFloat(t.left))?0:parseFloat(t.left))+parseFloat(t.marginLeft)+parseFloat(t.borderLeftWidth)+5,top:(isNaN(parseFloat(t.top))?0:parseFloat(t.top))+e.height+parseFloat(t.marginTop)+parseFloat(t.borderTopWidth)+5,right:(isNaN(parseFloat(t.left))?0:parseFloat(t.left))+parseFloat(t.marginLeft)+parseFloat(t.width)-5,bottom:e.height+(isNaN(parseFloat(t.left))?0:parseFloat(t.left))+parseFloat(t.height)-2*parseFloat(t.marginTop)-10+2};this.moveElements.setContainer(a)},m.prototype.addEvents=function(){var t=this;window.onkeydown=null,window.onkeydown=function(e){t.window_keyDown(e,t.charts[t.activeChartIndex])},this.addResizeEvent(),this.addFullscreenEvent(),this.addHeaderClosePanelEvents(),this.addSidebarClosePanelEvents(),this.setPeriodSelectBtnClick(),this.setTypeDataSelectBtnClick(),this.setChartTypeSelectBtnClick(),this.addClickTabQuatation(),this.addSearchQuatationEvents(),this.addChartSettingBtnEvent(),this.addSearchIndicatorEvents(),this.addIndicatorBtn(),this.addLayoutBtnEvents(),this.addSideBarMenuEvents(),this.addPanelIndicatorEvent(),this.addHiddenDataPanelEvent(),this.addHiddenIndicatorPanelInputStyleEvent(),this.addHiddenStyle(),this.addChartSettingsEvent(),this.addTabsBtnEvent(),this.addPipsEvent()},m.prototype.addSideBarMenuEvents=function(){this.addCursorTypeEvent(),this.addLineTypeEvent(),this.addBrushTypeEvent(),this.addTextTypeEvent(),this.addSaveBtnEvent(),this.addRestoreBtnEvent(),this.addDefaultBtnEvent(),this.addStayDrawingModeBtn(),this.addShowHideDrawing(),this.addZoomInBtnEvent(),this.addZoomOutBtnEvent(),this.addBasketBtnEvent(),this.addLockBtnEvent(),this.addMagnetModeEvent(),this.AddRouleteEvent()},m.prototype.removeSideBarMenuEvents=function(){this.configuration.modules.sideBarButtons.cursorTypeButton&&(this.parent.querySelector(".tch-cursorType-container").onclick=null),this.configuration.modules.sideBarButtons.drawingObjectsButton&&(this.parent.querySelector(".tch-lineType-container").onclick=null),this.configuration.modules.sideBarButtons.brushTypeButton&&(this.parent.querySelector(".tch-brushType-container").onclick=null),this.configuration.modules.sideBarButtons.textTypeButton&&(this.parent.querySelector(".tch-textType-container").onclick=null),this.configuration.modules.sideBarButtons.saveRestoreButtons&&(this.parent.querySelector(".tch-save-btn").onclick=null),this.configuration.modules.sideBarButtons.saveRestoreButtons&&(this.parent.querySelector(".tch-restore-btn").onchange=null),this.configuration.modules.sideBarButtons.saveRestoreButtons&&(this.parent.querySelector(".tch-default-btn").onclick=null),this.configuration.modules.sideBarButtons.stayDrawingModeButton&&(this.parent.querySelector(".tch-stay-drawing-mode-btn").onclick=null),this.configuration.modules.sideBarButtons.hideDrowingObjectButton&&(this.parent.querySelector(".tch-show-hide-drawing-btn").onclick=null),this.configuration.modules.sideBarButtons.zoomButton&&(this.parent.querySelector(".tch-zoomin-btn").onclick=null),this.configuration.modules.sideBarButtons.zoomButton&&(this.parent.querySelector(".tch-zoomout-btn").onclick=null),this.configuration.modules.sideBarButtons.basketButton&&(this.parent.querySelector(".tch-basket-btn").onclick=null),this.configuration.modules.sideBarButtons.lockButton&&(this.parent.querySelector(".tch-lock-btn").onclick=null),this.configuration.modules.sideBarButtons.magnetModeButton&&(this.parent.querySelector(".tch-magnet-mode-btn").onclick=null),this.configuration.modules.sideBarButtons.rouleteButton&&(this.parent.querySelector(".tch-roulete-drawing-btn").onclick=null),this.configuration.modules.isSideBarCreate&&(this.parent.querySelector(".tch-sidebar-close-panel").onclick=null),this.configuration.modules.isSideBarCreate&&this.sideBarListItemps.forEach(function(t){return t.onclick=null,!0})},m.prototype.backDrawingObjectsToNormalState=function(){if(this.charts.length){for(var t=this.getActiveChartData(),e=this.getActiveChart(),a=0;a<t.drawingObjects.length;a++)t.drawingObjects[a].state="edit",t.editDrawingObject&&(t.editDrawingObject.state="normal"),t.editDrawingObject=t.drawingObjects[a],t.activeDrawingObject&&(t.activeDrawingObject.state="normal",t.activeDrawingObject=null),e.drawActiveDrawingObjects(),e.redrawDrawingObjects();t.editDrawingObject&&(t.editDrawingObject.isPressed?(t.editDrawingObject.isPressed=!1,t.editDrawingObject.updateValues()):(t.editDrawingObject.state="normal",t.isShowDrawingObjects&&t.editDrawingObject.draw(e.canvasDrawingContext),t.editDrawingObject=null),this.charts[this.activeChartIndex].drawActiveDrawingObjects()),!1===t.isStayDrawingMode&&(t.state="default")}},m.prototype.resizeFunction=function(){this.resize(),this.lostFocusDrawingObject(),this.backDrawingObjectsToNormalState(),this.recreateSideBarMenu()},m.prototype.addResizeEvent=function(){var t=this;window.addEventListener("resize",function(){t.resizeFunction()})},m.prototype.resize=function(t,e){var a=this.parent.querySelector(".tch-charts-container");a=a?a.getBoundingClientRect():a,(t||a.width!==this.chartsContainerRect.width||a.height!==this.chartsContainerRect.height)&&(this.chartsContainerRect=a,this.resizeChartsContainers(e),this.setDropTargetContainer(),this.moveElements.moveResize())},m.prototype.close=function(){var t=this;this.connector.close(),window.removeEventListener("resize",function(){t.resizeFunction()})},m.prototype.fillChartSettingsPanel=function(){if(this.config.modules.headerButtons.settingsButton){var t,e,a=this.parent.querySelector(".tch-settings-dropdown"),i=a.querySelectorAll("input"),s=a.querySelectorAll("select"),r=a.querySelectorAll(".tch-color-picker"),n=this;this.parent.querySelector(".tch-settings-button").oncloseall=function(){delete this.oncloseall,n.autoSaveParams()};var o=this.getActiveChartData();if(o){for(var h=0;h<i.length;h++)i[h].name?(e=o[(t=i[h].name.split("-"))[0]][t[1]][t[2]],m.setInputValue(e,i[h]),i[h].oldValue=m.getInputValue(i[h]),i[h].onchange=function(t){var e=m.getFunctionName("set",t.target.name),a=m.getInputValue(t.target);n[e](a)}):i[h].classList.contains("tch-btn-submit")||i[h].classList.contains("tch-btn-cancel")||(i[h].disabled="disabled");for(var c=0;c<s.length;c++)s[c].name?("options-Chart-typeChart"===s[c].name&&this.setOptionsChartTypeChart(o.chartType),e=o[(t=s[c].name.split("-"))[0]][t[1]][t[2]],m.setSelectValue(e,s[c]),s[c].oldValue=o[t[0]][t[1]][t[2]],s[c].onchange=function(t){var e=m.getFunctionName("set",t.target.name),a=t.target.selectedOptions[0].value;n[e](a)}):s[c].disabled="disabled";for(var l=0;l<r.length;l++){var d=r[l].getAttribute("name");d&&(e=o[(t=d.split("-"))[0]][t[1]][t[2]],e=m.getColor(e),r[l].style.backgroundColor=e,r[l].oldValue=r[l].style.backgroundColor,r[l].onchange=function(t){var e=this.getAttribute("name"),a=m.getFunctionName("set",e);n[a](t)})}}}},m.getInputValue=function(t){var e;return"checkbox"==t.type&&(e=t.checked),"color"==t.type&&(e=t.value.toLowerCase()),"range"==t.type&&(e=t.value),e},m.getColor=function(t){return 0!==t.indexOf("#")?0===t.indexOf("rgba")?t:0===t.indexOf("rgb")?t.replace(")",", 1)").replace("rgb","rgba"):t:/^#([A-Fa-f0-9]{3}){1,2}$/.test(t)?(3==(e=t.substring(1).split("")).length&&(e=[e[0],e[0],e[1],e[1],e[2],e[2]]),"rgba("+[(e="0x"+e.join(""))>>16&255,e>>8&255,255&e].join(",")+",1)"):void 0;var e},m.setInputValue=function(t,e){"checkbox"===e.type&&(e.checked=t,t&&(e.disabled=!1)),"color"===e.type&&(e.value=t),"range"===e.type&&(e.value=t)},m.setSelectValue=function(t,e){for(var a=0;a<e.length;a++)e[a].value.toLowerCase()!==t.toString().toLowerCase()||(e[a].selected=!0)},m.getSelectValue=function(t){return t.value},m.getFunctionName=function(t,e){var a=t,i=e.split("-");for(var s in i)i.hasOwnProperty(s)&&(a+=i[s][0].toUpperCase()+i[s].slice(1));return a},m.prototype.setOptionsChartAutoScale=function(t){var e=this.getActiveChartData();e.options.Chart.autoScale=t,t&&(e.chart.createShowData(),e.chart.draw(e.chart.showData,e.chart.h))},m.prototype.setColorsChartBackgroundColor=function(t){this.getActiveChart().setBackgroundColor(t)},m.prototype.setOptionsChartTypeThemes=function(t){var e=this.getActiveChartData();e.options.Chart.typeThemes=t,e.chart.setChartThemes(t)},m.prototype.setColorsChartScalesText=function(t){var e=this.getActiveChartData();e.colors.Chart.scalesText=t,e.chart.drawValueAxis(e.chart.valueAxis),e.chart.drawTimeAxis(e.chart.timeAxis)},m.prototype.setOptionsChartScalesFontSize=function(t){var e=this.getActiveChartData();e.options.Chart.oldScalesFontSize=e.options.Chart.scalesFontSize,e.options.Chart.scalesFontSize=t,e.chart.init(!0),delete e.options.Chart.oldScalesFontSize},m.prototype.setColorsChartColorScalesLines=function(t){var e=this.getActiveChartData();e.colors.Chart.colorScalesLines=t,e.chart.clearGrid(),e.chart.drawValueAxis(e.chart.valueAxis),e.chart.drawTimeAxis(e.chart.timeAxis),e.chart.drawChartBorder()},m.prototype.setColorsChartWatermarkColor=function(t){var e=this.getActiveChartData();e.colors.Chart.watermarkColor=t,e.chart.waterMarkContainer.style.color=t},m.prototype.setOptionsChartSymbolDescription=function(t){this.hiddenSymbolDescription(t),this.getActiveChartData().options.Chart.symbolDescription=t},m.prototype.setOptionsChartOhlcValues=function(t){this.hiddenOhlcValue(t),this.getActiveChartData().options.Chart.ohlcValues=t},m.prototype.setOptionsChartIndicatorTitles=function(t){this.hiddenIndicatorTitles(t);var e=this.getActiveChartData();e.options.Chart.indicatorTitles=t,t||(e.options.Chart.indicatorArguments=t)},m.prototype.setOptionsChartIndicatorArguments=function(t){this.hiddenIndicatorArguments(t),this.getActiveChartData().options.Chart.indicatorArguments=t},m.prototype.setOptionsChartIndicatorValues=function(t){this.hiddenIndicatorValues(t),this.getActiveChartData().options.Chart.indicatorValues=t},m.prototype.setColorsChartColorCrossHair=function(t){var e=this.getActiveChartData();e.colors.Chart.colorCrossHair=t,e.colors.Chart.crosshair=t,e.chart.crosshair.text.spanValue.style.backgroundColor=t,e.chart.crosshair.text.spanValue.parentNode.style.backgroundColor=t,e.chart.crosshair.text.spanDate.style.backgroundColor=t,e.chart.crosshair.text.spanDate.parentNode.style.backgroundColor=t,e.chart.redrawInfo()},m.prototype.setOptionsChartTypeCrossHair=function(t){var e=this.getActiveChartData();e.options.Chart.typeCrossHair=t,e.chart.redrawInfo()},m.prototype.setOptionsChartWidthCrossHair=function(t){var e=this.getActiveChartData();e.options.Chart.widthCrossHair=t,e.chart.redrawInfo()},m.prototype.setOptionsChartTypeVertGridLines=function(t){var e=this.getActiveChartData();e.options.Chart.typeVertGridLines=t,e.chart.clearGrid(),e.chart.drawValueAxis(e.chart.valueAxis),e.chart.drawTimeAxis(e.chart.timeAxis),e.chart.drawChartBorder()},m.prototype.setOptionsChartTypeHorzGridLines=function(t){var e=this.getActiveChartData();e.options.Chart.typeHorzGridLines=t,e.chart.clearGrid(),e.chart.drawValueAxis(e.chart.valueAxis),e.chart.drawTimeAxis(e.chart.timeAxis),e.chart.drawChartBorder()},m.prototype.setColorsChartVertGridLines=function(t){var e=this.getActiveChartData(),a=this.getActiveChart();e.colors.Chart.vertGridLines=t,a.clearGrid(),a.drawValueAxis(a.valueAxis),a.drawTimeAxis(a.timeAxis),e.chart.drawChartBorder()},m.prototype.setColorsChartHorzGridLines=function(t){var e=this.getActiveChartData(),a=this.getActiveChart();e.colors.Chart.horzGridLines=t,a.clearGrid(),a.drawValueAxis(a.valueAxis),a.drawTimeAxis(a.timeAxis),e.chart.drawChartBorder()},m.prototype.setOptionsChartScaleSeriesOnly=function(t){var e=this.getActiveChartData(),a=this.getActiveChart();e.options.Chart.scaleSeriesOnly=t,t?(a.createShowData(),a.draw(a.showData,a.h)):a.resizeShowDataByTrendIndicators()&&a.draw(a.showData,a.h)},m.prototype.setOptionsChartTypeChart=function(t){var e=this.getActiveChart();e.chartData.options.Chart.typeChart=t;var a=this.parent.querySelector(".tch-settings-dropdown");[].slice.call(a.querySelectorAll(".tch-style-layouts")).forEach(function(e){e.classList.toggle("tch-hidden",!0),e.classList.contains("tch-layout-style-"+t)&&e.classList.toggle("tch-hidden",!1)});var i=this.parent.querySelector(".tch-chart-type-button");i&&i.setAttribute("actualtype",e.chartData.chartType);var s=e.parent;e.chartData.chartType!==t&&(this.setChartType(t),this.charts[this.activeChartIndex]=this.createChart(s,e.chartData),this.charts[this.activeChartIndex].init())},m.prototype.setOptionsChartNeedPriceLine=function(t){this.getActiveChartData().options.Chart.needPriceLine=t,this.getActiveChart().drawCurrentValue()},m.prototype.setOptionsChartWidthPriceLine=function(t){var e=this.getActiveChartData();e.options.Chart.widthPriceLine=t,e.chart.drawCurrentValue(),e.chart.draw(e.chart.showData,e.chart.h)},m.prototype.setOptionsChartTypeTick=function(t){var e=this.getActiveChartData();e.options.Chart.typeTick=t,e.chart.init(!0)},m.prototype.setColorsCandleChartCandleBear=function(t){var e=this.getActiveChartData();e.colors.CandleChart.candleBear=t,e.chart.drawCurrentValue(),e.chart.draw(this.getActiveChart().showData,this.getActiveChart().h)},m.prototype.setColorsCandleChartCandleBool=function(t){var e=this.getActiveChartData();e.colors.CandleChart.candleBool=t,e.chart.drawCurrentValue(),e.chart.draw(e.chart.showData,e.chart.h)},m.prototype.setColorsCandleChartCandleBearBorder=function(t){var e=this.getActiveChartData();e.colors.CandleChart.candleBearBorder=t,e.chart.draw(e.chart.showData,e.chart.h)},m.prototype.setColorsCandleChartCandleBoolBorder=function(t){var e=this.getActiveChartData();e.colors.CandleChart.candleBoolBorder=t,e.chart.drawCurrentValue(),e.chart.draw(this.getActiveChart().showData,this.getActiveChart().h)},m.prototype.setOptionsCandleChartNeedBorder=function(t){var e=this.getActiveChartData();e.options.CandleChart.needBorder=t,e.chart.draw(e.chart.showData,e.chart.h)},m.prototype.setOptionsCandleChartNeedWick=function(t){var e=this.getActiveChartData();e.options.CandleChart.needWick=t,e.chart.draw(e.chart.showData,e.chart.h)},m.prototype.setColorsCandleChartCandleLineBear=function(t){var e=this.getActiveChartData();e.colors.CandleChart.candleLineBear=t,e.chart.draw(e.chart.showData,e.chart.h)},m.prototype.setColorsCandleChartCandleLineBool=function(t){var e=this.getActiveChartData();e.colors.CandleChart.candleLineBool=t,e.chart.draw(e.chart.showData,e.chart.h)},m.prototype.setColorsHollowChartCandleBear=function(t){var e=this.getActiveChartData();e.colors.HollowChart.candleBear=t,e.chart.drawCurrentValue(),e.chart.draw(e.chart.showData,e.chart.h)},m.prototype.setColorsHollowChartCandleBool=function(t){var e=this.getActiveChartData();e.colors.HollowChart.candleBool=t,e.chart.drawCurrentValue(),e.chart.draw(e.chart.showData,e.chart.h)},m.prototype.setColorsHollowChartCandleBearBorder=function(t){var e=this.getActiveChartData();e.colors.HollowChart.candleBearBorder=t,e.chart.draw(e.chart.showData,e.chart.h)},m.prototype.setColorsHollowChartCandleBoolBorder=function(t){var e=this.getActiveChartData();e.colors.HollowChart.candleBoolBorder=t,e.chart.draw(e.chart.showData,e.chart.h)},m.prototype.setOptionsHollowChartNeedBorder=function(t){var e=this.getActiveChartData();e.options.HollowChart.needBorder=t,e.chart.draw(e.chart.showData,e.chart.h)},m.prototype.setOptionsHollowChartNeedWick=function(t){var e=this.getActiveChartData();e.options.HollowChart.needWick=t,e.chart.draw(e.chart.showData,e.chart.h)},m.prototype.setColorsHollowChartCandleLineBear=function(t){var e=this.getActiveChartData();e.colors.HollowChart.candleLineBear=t,e.chart.draw(e.chart.showData,e.chart.h)},m.prototype.setColorsHollowChartCandleLineBool=function(t){var e=this.getActiveChartData();e.colors.HollowChart.candleLineBool=t,e.chart.draw(e.chart.showData,e.chart.h)},m.prototype.setOptionsBarChartNeedOpen=function(t){var e=this.getActiveChartData();e.options.BarChart.needOpen=t,e.chart.draw(e.chart.showData,e.chart.h)},m.prototype.setColorsBarChartCandleBear=function(t){var e=this.getActiveChartData();e.colors.BarChart.candleBear=t,e.chart.drawCurrentValue(),e.chart.draw(e.chart.showData,e.chart.h)},m.prototype.setColorsBarChartCandleBool=function(t){var e=this.getActiveChartData();e.colors.BarChart.candleBool=t,e.chart.drawCurrentValue(),e.chart.draw(e.chart.showData,e.chart.h)},m.prototype.setColorsAreaChartColorLine=function(t){var e=this.getActiveChartData();e.colors.AreaChart.colorLine=t,e.chart.drawCurrentValue(),e.chart.draw(e.chart.showData,e.chart.h)},m.prototype.setColorsAreaChartColorStop=function(t){var e=this.getActiveChartData();e.colors.AreaChart.colorStop=t,e.chart.draw(e.chart.showData,e.chart.h)},m.prototype.setColorsAreaChartColorStopEnd=function(t){var e=this.getActiveChartData();e.colors.AreaChart.colorStopEnd=t,e.chart.draw(e.chart.showData,e.chart.h)},m.prototype.setOptionsAreaChartWidthLine=function(t){var e=this.getActiveChartData();e.options.AreaChart.widthLine=t,e.chart.draw(e.chart.showData,e.chart.h),e.chart.drawCurrentValue()},m.prototype.setOptionsAreaChartPriceSource=function(t){var e=this.getActiveChartData();e.options.AreaChart.priceSource=t,e.chart.showData=e.chart.processDataToShow(e.chart.selectedData,e.rightPadding,e.spacing,e.chart.w,e.chart.h,e.precission,e.startX,e.scaleParams),e.chart.draw(e.chart.showData,e.chart.h),e.chart.drawCurrentValue()},m.prototype.setOptionsLineChartWidthLine=function(t){var e=this.getActiveChartData();e.options.LineChart.widthLine=t,e.chart.draw(e.chart.showData,e.chart.h),e.chart.drawCurrentValue(),e.chart.draw(e.chart.showData,e.chart.h)},m.prototype.setColorsLineChartColorLine=function(t){var e=this.getActiveChartData();e.colors.LineChart.colorLine=t,e.chart.drawCurrentValue(),e.chart.draw(e.chart.showData,e.chart.h)},m.prototype.setOptionsLineChartPriceSource=function(t){var e=this.getActiveChartData();e.options.LineChart.priceSource=t,e.chart.showData=e.chart.processDataToShow(e.chart.selectedData,e.rightPadding,e.spacing,e.chart.w,e.chart.h,e.precission,e.startX,e.scaleParams),e.chart.draw(e.chart.showData,e.chart.h),e.chart.drawCurrentValue()},m.prototype.setOptionsLineChartTypeLine=function(t){var e=this.getActiveChartData();e.options.LineChart.typeLine=t,e.chart.showData=e.chart.processDataToShow(e.chart.selectedData,e.rightPadding,e.spacing,e.chart.w,e.chart.h,e.precission,e.startX,e.scaleParams),e.chart.draw(e.chart.showData,e.chart.h),e.chart.drawCurrentValue()},m.prototype.addChartSettingBtnEvent=function(){if(this.configuration.modules.headerButtons.settingsButton){var t=this.parent.querySelector(".tch-settings-button");this.dropForHidden.push(t);var e=this;t.addEventListener("click",function(a){e.continueDrawing(a)||(e.dropDownClick(t,void 0,a),e.fillChartSettingsPanel(),e.lostFocusDrawingObject())});var a=this.parent.querySelector(".tch-settings-dropdown");a.addEventListener("click",function(t){t.stopPropagation()});var i=this.parent.querySelectorAll(".tch-settings-dropdown .tch-tabs-list li"),s=[];s.push(a.querySelector(".tch-settings-style")),s.push(a.querySelector(".tch-settings-scales")),s.push(a.querySelector(".tch-settings-background")),s.push(a.querySelector(".tch-settings-timezone"));for(var r=0;r<i.length;r++)i[r].addEventListener("click",function(t){for(var e=0;e<i.length;e++)i[e].classList.toggle("tch-tab-selected",!1),s[e].classList.toggle("tch-hidden",!0);t.target.classList.toggle("tch-tab-selected",!0);var a=Array.prototype.indexOf.call(i,t.target);s[a].classList.toggle("tch-hidden",!1)})}},m.prototype.addChartSettingsEvent=function(){if(this.configuration.modules.headerButtons.settingsButton){var t=this;this.parent.querySelector(".tch-settings-dropdown .tch-btn-default").onclick=function(){t.setDefaultChartSettings()};var e=this.parent.querySelector(".tch-settings-dropdown  .tch-btn-submit"),a=this.parent.querySelector(".tch-settings-dropdown .tch-btn-cancel");e.onclick=function(){t.submitChangedChartSettings(),t.closeAll(),t.autoSaveParams()},a.onclick=function(){t.cancelChangedChartSettings(),t.closeAll()}}},m.prototype.submitChangedChartSettings=function(){for(var t,e=this.parent.querySelector(".tch-settings-dropdown"),a=e.querySelectorAll("input"),i=e.querySelectorAll("select"),s=e.querySelectorAll(".tch-color-picker"),r=0;r<a.length;r++)a[r].name&&(t=m.getInputValue(a[r]),a[r].oldValue=t);for(r=0;r<i.length;r++)i[r].name&&(t=m.getSelectValue(a[r]),i[r].oldValue=t);for(r=0;r<s.length;r++)s[r].getAttribute("name")&&(t=s[r].style.backgroundColor,s[r].oldValue=t)},m.prototype.cancelChangedChartSettings=function(){for(var t,e=this.parent.querySelector(".tch-settings-dropdown"),a=e.querySelectorAll("input"),i=e.querySelectorAll("select"),s=e.querySelectorAll(".tch-color-picker"),r=0;r<a.length;r++)a[r].name&&(t=m.getInputValue(a[r]),a[r].oldValue!==t&&(m.setInputValue(a[r].oldValue,a[r]),this[m.getFunctionName("set",a[r].name)](a[r].oldValue)));for(r=0;r<i.length;r++)i[r].name&&(t=m.getSelectValue(i[r]),i[r].oldValue.toString().toLowerCase()!==t.toString().toLowerCase()&&(m.setSelectValue(i[r].oldValue,i[r]),this[m.getFunctionName("set",i[r].name)](i[r].oldValue)));for(r=0;r<s.length;r++){var n=s[r].getAttribute("name");n&&(t=s[r].style.backgroundColor,s[r].oldValue!==t&&(s[r].style.backgroundColor=s[r].oldValue,this[m.getFunctionName("set",n)](s[r].oldValue)))}},m.prototype.setDefaultChartSettings=function(){var t=this.parent.querySelector(".tch-settings-dropdown"),e=t.querySelectorAll("input"),a=t.querySelectorAll("select"),i=t.querySelectorAll(".tch-color-picker");this.setDefaultParamsOptions(e),this.setDefaultParamsOptions(a);for(var s=0;s<i.length;s++){var r=i[s].getAttribute("name"),n=r.split("-");r&&(i[s].oldValue=this.store.getStyles()[n[0]][n[1]][n[2]],this[m.getFunctionName("set",r)](i[s].oldValue))}},m.prototype.setDefaultParamsOptions=function(t){for(var e,a,i=0;i<t.length;i++)if(t[i].name){var s=t[i].name.split("-");a=this.store.getStyles()[s[0]][s[1]][s[2]],t[i].oldValue!==a&&("select"===t[i].tagName.toLocaleLowerCase()?m.setSelectValue(a,t[i]):"input"===t[i].tagName.toLocaleLowerCase()&&m.setInputValue(a,t[i]),this[e=m.getFunctionName("set",t[i].name)]&&this[e](t[i].value))}},m.prototype.indicators={Bears:{name:"Bears",fullName:"Bears Power",params:{period:14},colors:{line:"#F54337"},lineWidth:{line:1},type:"oscillator"},Bulls:{name:"Bulls",fullName:"Bulls Power",params:{period:14},colors:{line:"#66CC69"},lineWidth:{line:1},type:"oscillator"},SO:{name:"SO",fullName:"Stochastic",params:{K:14,D:3},colors:{KLine:"#0000CD",DLine:"#CD0000"},lineWidth:{KLine:1,DLine:1},type:"oscillator"},ATR:{name:"ATR",fullName:"ATR",params:{period:14},colors:{line:"#FF0000"},lineWidth:{line:1},type:"oscillator"},RSI:{name:"RSI",fullName:"RSI",params:{period:14},colors:{line:"#820582"},lineWidth:{line:1},type:"oscillator"},WILLIAMSR:{name:"WILLIAMSR",fullName:"Williams %R",params:{period:14},colors:{line:"#0D0D86"},lineWidth:{line:1},type:"oscillator"},ADX:{name:"ADX",fullName:"ADX",params:{period:14},colors:{ADX:"#00FF00",DIM:"#0000FF",DIP:"#FF0000"},lineWidth:{ADX:1,DIM:1,DIP:1},type:"oscillator"},MACD:{name:"MACD",fullName:"MACD",params:{fastLength:12,slowLength:26,signalLength:9},colors:{histogram:"#ff0000",macd:"#0000ff",signal:"#00ff00"},lineWidth:{histogram:1,macd:1,signal:1},type:"oscillator"},SMA:{name:"SMA",fullName:"Simple Moving Average",params:{period:5},colors:{line:"#ff3333"},lineWidth:{line:1},type:"trend"},EMA:{name:"EMA",fullName:"Exponential Moving Average",params:{period:5},colors:{line:"#0000FF"},lineWidth:{line:1},type:"trend"},BB:{name:"BB",fullName:"Bollinger Bands",params:{period:5},colors:{U:"rgba(0, 0, 255,1)",M:"rgba(0, 0, 255,1)",L:"rgba(0, 0, 255,1)",cloud:"rgba(153,153,255,0.3)"},opacity:{cloud:.3},lineWidth:{U:1,M:1,L:1},type:"trend"},Fractal:{name:"Fractal",fullName:"Williams Fractal",params:{period:5},colors:{line:"#0000FF"},type:"trend"},Ichimoku:{name:"Ichimoku",fullName:"Ichimoku Cloud",params:{smallPeriod:12,middlePeriod:26,largePeriod:52},colors:{TenkanSen:"rgba(165, 42, 42, 1)",KijunSen:"rgba(0, 0, 255, 1)",ChinkouSpan:"rgba(255, 165, 0, 1)",SenkouSpanA:"rgba(255, 0, 0, 1)",SenkouSpanB:"rgba(0, 128, 0, 1)",A:"rgba(255, 153, 153, 0.3)",B:"rgba(153, 255, 153, 0.3)"},opacity:{A:.3,B:.3},lineWidth:{TenkanSen:1,KijunSen:1,ChinkouSpan:1,SenkouSpanA:1,SenkouSpanB:1},type:"trend"},Env:{name:"Env",fullName:"Envelope",params:{lenght:20,percent:25,avarage:"SMA"},colors:{U:"rgba(0, 0, 205, 1)",M:"rgba(205, 77, 0, 1)",L:"rgba(0, 0, 205, 1)",cloud:"rgba(153, 153, 255, 0.3)"},opacity:{cloud:.3},lineWidth:{U:1,M:1,L:1},type:"trend"},DEMA:{name:"DEMA",fullName:"Double Exponential Moving Average",params:{period:5},colors:{line:"#B83116"},lineWidth:{line:1},type:"trend"},Sar:{name:"Sar",fullName:"Parabolic Sar",params:{startAf:2,stepAf:2,maxAf:20},colors:{line:"#00FF00"},type:"trend"},STD:{name:"STD",fullName:"Standard Deviation",params:{period:14},colors:{line:"#0000FF"},lineWidth:{line:1},type:"oscillator"},Keltner:{name:"Keltner",fullName:"Keltner Channels",params:{period:20,multi:1},colors:{U:"rgba(0, 0, 255,1)",M:"rgba(0, 0, 255,1)",L:"rgba(0, 0, 255,1)",cloud:"rgba(153,153,255,0.3)"},opacity:{cloud:.3},lineWidth:{U:1,M:1,L:1},type:"trend"},Donchian:{name:"Donchian",fullName:"Donchian Channel",params:{period:20},colors:{U:"rgba(0, 0, 255,1)",M:"rgba(0, 0, 255,1)",L:"rgba(0, 0, 255,1)",cloud:"rgba(153,153,255,0.3)"},opacity:{cloud:.3},lineWidth:{U:1,M:1,L:1},type:"trend"},AO:{name:"AO",fullName:"Awesome Oscillator",params:{},colors:{lineUp:"#66CC69",lineDown:"#F54337"},lineWidth:{line:1},type:"oscillator"},AC:{name:"AC",fullName:"Acceleration/Deceleration",params:{},colors:{lineUp:"#66CC69",lineDown:"#F54337"},lineWidth:{line:1},type:"oscillator"}},m.id=0,m.prototype.getColorForIndicatorLine=function(t){return t?"#66CC69":"#F54337"},m.prototype.createIndicator=function(t,e){var a=e.getActiveChart(),i=new Indicator(a.chartData,t);if("oscillator"===i.type&&a){var s=parseInt(a.parent.style.height),r=a.calculateHeightOnCreate(a.oscillatorCharts,a.h,s);a.applyChartHight(r),(i=new Indicator(a.chartData,t)).applyIndicatorHeight(r.newElement,a),e.addIndicator(i),a.applyIndicatorsHeights(r);var n=a.chartData.indicators.length-1;a.chartData.indicators.length>1&&Math.abs(a.chartData.indicators[n].top-a.chartData.indicators[n-1].top+a.chartData.indicators[n-1].h)>0&&e.refreshIndicatorsTopValues(a),a.init()}else{e.addIndicator(i),i.createData(a.chartData.data[a.chartData.typeData]),i.createShowData(),i.draw();var o=a.chartData;e.updateIndicatorsDataPanel(o.data[this.configuration.typeData][0].date)}},m.prototype.refreshIndicatorsTopValues=function(t){for(var e=t.chartData.indicators,a=0;a<e.length-1;a++)"oscillator"===e[a].type&&(e[a+1].top=e[a].top+e[a].h)},m.prototype.createIndicatorsDataPanel=function(t,e){var a=document.createElement("ul");a.className="tch-indicator-id"+t.id+" tch-indicator-row tch-data-panel-row",e.appendChild(a);for(var i=this.getActiveChartData(),s=Object.values(t.params).join(" "),r=[t.name,s,"","","",""],n=0;n<r.length;n++){var o=document.createElement("li");o.textContent=r[n],i.options.Chart.indicatorTitles||n<2&&(o.style.display="none"),i.options.Chart.indicatorArguments||1===n&&(o.style.display="none"),i.options.Chart.indicatorValues||5===n&&(o.style.display="none"),a.appendChild(o)}var h=a.querySelector("li:nth-last-child(2)"),c=a.querySelector("li:nth-last-child(3)"),l=a.querySelector("li:nth-last-child(4)"),d=!t.hidden;a.classList.toggle("tch-indicator-hidden",!d),l.indicator=t,h.indicator=t,c.indicator=t;var p=this;return l.onclick=function(t){p.hideIndicator(t),p.closePanelSettingIndicator(t)},h.onclick=function(t){p.closePanelIndicator(t,p)},c.onclick=function(t){p.createIndicatorSettingsPanel(t,p)},a},m.prototype.updateIndicatorsDataPanel=function(t){var e=this.getActiveChartData();if(e&&this.config.modules.chartElements.isDataPanelCreate){this.clearIndicatorsDataPanel();for(var a=0;a<e.indicators.length;a++){var i=e.indicators[a],s=this.parent.querySelector(".tch-indicator-id"+i.id);if(!s){var r;if("trend"===i.type?r=this.parent.querySelector(".tch-data-indicators"):e.chart.oscillatorCharts&&e.chart.oscillatorCharts[i.id]&&e.chart.oscillatorCharts[i.id].dataPanelContainer&&(r=e.chart.oscillatorCharts[i.id].dataPanelContainer),!r)return;s=this.createIndicatorsDataPanel(i,r)}if(s.querySelector("li:nth-child(2)").textContent=Object.values(i.params).join(" "),i.data&&i.data[t]){var n=s.querySelector("li:nth-last-child(1)");n.innerHTML="";var o=i.data[t],h=i.colors;for(var c in o)if(o.hasOwnProperty(c)&&"T"!==c){var l=document.createElement("span"),d="oscillator"===i.type?parseInt(e.precission)+1:parseInt(e.precission);l.textContent=o[c].toFixed(d);var p=h[c];p||(p=h.line),p||(p=h[c.replace("Line","")]),p||(p=h[c+"Line"]),l.style.color=p,n.appendChild(l)}}}}},m.prototype.createIndicatorButton=function(t,e,a,i){var s=document.createElement("div");return s.className=e,s.innerText=a,s.addEventListener("click",i),t.appendChild(s),s},m.prototype.createIndicatorSettingsPanel=function(t,e){var a=e.parent.querySelector(".tch-indicator-inputs"),i=e.parent.querySelector(".tch-indicator-style");a.classList.toggle("tch-hidden",!1),i.classList.toggle("tch-hidden",!0);var s=e.parent.querySelector(".tch-indicator-panel");s.indicator=t.target.indicator,s.indicator.oldParams.period=JSON.parse(JSON.stringify(t.target.indicator.params)),s.indicator.oldParams.lineWidth=JSON.parse(JSON.stringify(t.target.indicator.lineWidth)),e.fillIndicatorSettingsPanel(t.target.indicator),s.classList.toggle("tch-hidden",!1)},m.prototype.fillIndicatorSettingsPanel=function(t,e){var a,i,s,r,n,o=this,h=this.parent.querySelector(".tch-indicator-inputs table tbody"),c=this.parent.querySelector(".tch-indicator-style table tbody"),l=this.parent.querySelector(".tch-indicator-panel-header");e=e||l.children[0].textContent;for(var d=0;d<l.children.length;d++)l.children[d].classList.toggle("tch-tab-selected",!1),l.children[d].textContent===e&&l.children[d].classList.toggle("tch-tab-selected",!0);h.innerHTML="",c.innerHTML="";var p=t.params;for(var u in p)if(p.hasOwnProperty(u)){if(a=document.createElement("tr"),(i=document.createElement("td")).innerText=this.translation[u],a.appendChild(i),s=document.createElement("td"),"avarage"===u)!function(){var t=document.createElement("select");t.setAttribute("name",u),t.setAttribute("id","tch-indicator-inputs-avarage");var e=document.createElement("option");e.setAttribute("value","SMA"),e.innerHTML="SMA";var a=document.createElement("option");a.setAttribute("value","EMA"),a.innerHTML="EMA",t.appendChild(e),t.appendChild(a),"SMA"===p[u]?t.options.selectedIndex=0:t.options.selectedIndex=1,s.appendChild(t),t.onchange=function(){1===t.options.selectedIndex?(p.avarage="EMA",o.setPeriodIndicator(p)):(p.avarage="SMA",o.setPeriodIndicator(p))},t.onmousedown=function(t){t.stopPropagation()}}();else{var g=document.createElement("input");g.setAttribute("type","number"),g.setAttribute("required","true"),g.setAttribute("name",u),g.setAttribute("min",1),g.setAttribute("max",100),g.setAttribute("step",1),g.setAttribute("value",p[u]),g.setAttribute("currVal",p[u]),g.oninput=function(t){!isNaN(t.target.value)&&t.target.value>=1&&t.target.value<=100?t.target.setAttribute("currVal",parseInt(t.target.value)):t.target.value=t.target.getAttribute("currVal"),p[t.target.name]=parseInt(t.target.value),o.setPeriodIndicator(p)},g.onmousedown=function(t){t.stopPropagation()},s.appendChild(g)}a.appendChild(s),h.appendChild(a)}var v=t.colors;for(var f in v)v.hasOwnProperty(f)&&(a=document.createElement("tr"),(i=document.createElement("td")).innerText=this.translation[f],a.appendChild(i),(r=document.createElement("td")).innerHTML="<div class='tch-color-picker-container'><div class='tch-color-picker' name='"+f+"'></div></div>",a.appendChild(r),c.appendChild(a));var y=t.opacity;for(var D in y)if(y.hasOwnProperty(D)){a=document.createElement("tr"),(i=document.createElement("td")).innerText=this.translation[D],a.appendChild(i),n=document.createElement("td");var w=o.getOpacityFromColor(D);n.innerHTML="<input type='range' required  name='"+D+"' min='0.1' max='1' step='0.1'  value="+w+">",n.onmousedown=function(t){t.stopPropagation()},n.oninput=function(t){y[t.target.name]=t.target.value,this.querySelector("input").value=t.target.value,o.setLineOpacity("1",t.target.name,t.target.value),o.setOpacity(t.target.name,t.target.value)},a.appendChild(n),c.appendChild(a)}var b=t.lineWidth;for(var C in b)b.hasOwnProperty(C)&&(a=document.createElement("tr"),(i=document.createElement("td")).innerText=this.translation[C],a.appendChild(i),(n=document.createElement("td")).innerHTML="<input type='range' required  name='"+C+"' min='1' max='10' value="+b[C]+">",n.onmousedown=function(t){t.stopPropagation()},n.oninput=function(t){b[t.target.name]=t.target.value,o.setWidthLineIndicator(b)},a.appendChild(n),c.appendChild(a));for(var x,L=c.querySelectorAll(".tch-color-picker"),P=0;P<L.length;P++){var S=L[P].getAttribute("name");S&&(S.split("-"),x=v[S],x=m.getColor(x),L[P].style.backgroundColor=x,L[P].oldValue=L[P].style.backgroundColor,L[P].indicator=t,L[P].onchange=function(t){var e=this.getAttribute("name");o.setLine(this.indicator.id,e,t),"A"!==e&&"B"!==e&&"cloud"!==e||o.setOpacity(e)})}this.colorPickerInit();var T=this.parent.querySelector(".tch-indicator-inputs"),O=this.parent.querySelector(".tch-indicator-style"),B=this.parent.querySelector(".tch-indicator-panel-header li:first-child "),A=this.parent.querySelector(".tch-indicator-panel-header li:last-child ");0===Object.keys(p).length?(T.classList.add("tch-hidden"),O.classList.remove("tch-hidden"),B.classList.toggle("tch-tab-selected",!1),B.classList.toggle("tch-hidden",!0),A.classList.toggle("tch-tab-selected",!0)):B.classList.toggle("tch-hidden",!1)},m.prototype.setLineOpacity=function(t,e,a){var i=this.parent.querySelector(".tch-indicator-panel"),s=i.indicator.colors[e],r=s.substring(4,s.length-1).replace(/ /g,"").split(",");r[3]=a;var n="rgba"+r[0]+","+r[1]+","+r[2]+","+r[3]+")";i.indicator.colors[e]=n;var o=this.getActiveChart();o.draw(o.showData,o.h),o.drawCurrent(o.chartData.currentValue)},m.prototype.setOpacity=function(t){var e=this.parent.querySelector(".tch-indicator-panel"),a=this.convertRGBtoRGBA(e.indicator.colors[t]),i=a.substring(4,a.length-1).replace(/ /g,"").split(",");e.querySelector("input[name="+t+"]").value=i[3],e.querySelector(".tch-color-picker[name="+t+"]").style.backgroundColor=a},m.prototype.convertRGBtoRGBA=function(t){return t.indexOf("rgba")>-1?t:t.indexOf("rgb")>-1?t.replace(")",","+a+" )").replace("rgb","rgba"):void 0},m.prototype.getOpacityFromColor=function(t){var e=this.parent.querySelector(".tch-indicator-panel").indicator.colors[t];return e.substring(4,e.length-1).replace(/ /g,"").split(",")[3]},m.prototype.setLine=function(t,e,a){this.parent.querySelector(".tch-indicator-panel").indicator.colors[e]=a;var i=this.getActiveChart();i.draw(i.showData,i.h),i.drawCurrent(i.chartData.currentValue)},m.prototype.setPeriodIndicator=function(t){var e=this.parent.querySelector(".tch-indicator-panel"),a=this.getActiveChart();for(var i in t)t.hasOwnProperty(i)&&(e.indicator.params[i]=t[i]);this.addIndicator(e.indicator),a.chartData.updateIndicatorsData(),a.chartData.updateCurrentIndicatorsData(),this.updateIndicatorsDataPanel(),a.redrawOscillators()},m.prototype.setWidthLineIndicator=function(t){var e=this.getActiveChart(),a=this.parent.querySelector(".tch-indicator-panel");for(var i in t)t.hasOwnProperty(i)&&(a.indicator.lineWidth[i]=t[i]);e.draw(e.showData,e.h),e.drawCurrent(e.chartData.currentValue)},m.prototype.closePanelIndicator=function(t,e){t.target.indicator.chartData.chart.setActiveChart();var a=e.getActiveChart();a.removeIndicator(t.target.indicator),t.target.parentElement.parentElement.removeChild(t.target.parentElement),e.closePanelSettingIndicator(t,e),a.init(!0),e.autoSaveParams()},m.prototype.hideIndicator=function(t){t.target.indicator.chartData.chart.setActiveChart();var e=this.getActiveChart(),a=e.chartData.getIndicatorIndex(e.chartData.indicators,t.target.indicator);e.chartData.indicators[a].hidden=!e.chartData.indicators[a].hidden,t.target.parentNode.classList.toggle("tch-indicator-hidden",e.chartData.indicators[a].hidden),e.init(!0),this.autoSaveParams()},m.prototype.addPanelIndicatorEvent=function(){var t=this.parent.querySelector(".tch-indicator-panel"),e=t.querySelector(".tch-btn-cancel"),a=t.querySelector(".tch-btn-submit"),i=t.querySelector(".tch-btn-default"),s=this;e.addEventListener("click",function(e){s.cancelChangedIndicatorSettings(),s.closePanelSettingIndicator(e,t)}),a.addEventListener("click",function(e){s.submitIndicator(e,t),s.autoSaveParams()}),i.addEventListener("click",function(e){s.setDefaultIndicatorSettings(e,t),e.preventDefault(),e.stopPropagation()})},m.prototype.cancelChangedIndicatorSettings=function(){for(var t,e=this.parent.querySelector(".tch-indicator-panel"),a=e.querySelectorAll(".tch-color-picker"),i=0;i<a.length;i++){var s=a[i].getAttribute("name");s&&(t=a[i].style.backgroundColor,t=m.getColor(t),a[i].oldValue!==t&&(a[i].style.backgroundColor=a[i].oldValue,this.setLine(e.indicator.id,s,a[i].oldValue)))}var r=this.getActiveChart();this.setPeriodIndicator(e.indicator.oldParams.period),this.setWidthLineIndicator(e.indicator.oldParams.lineWidth),r.redrawOscillators()},m.prototype.setDefaultIndicatorSettings=function(t,e){var a=e.querySelector(".tch-indicator-panel-header").querySelector(".tch-tab-selected").textContent,i=this.indicators[e.indicator.name];this.fillIndicatorSettingsPanel(i,a)},m.prototype.closePanelSettingIndicator=function(t){var e=this.parent.querySelector(".tch-indicator-panel"),a=this.parent.querySelector(".tch-indicator-inputs"),i=this.parent.querySelector(".tch-indicator-style");e.classList.toggle("tch-hidden",!0),a.classList.toggle("tch-hidden",!1),i.classList.toggle("tch-hidden",!0),t.preventDefault(),t.stopPropagation()},m.prototype.getInputByName=function(t,e,a){var i=t.querySelectorAll("input[name='"+e+"']");return i[a]?i[a]:i[i.length-1]},m.prototype.getInputByNameColor=function(t,e){for(var a=t.querySelectorAll(".tch-color-picker","[name='"+e+"']"),i=0;i<a.length;i++)if(a[i].getAttribute("name")===e)return a[i].style.backgroundColor},m.prototype.getSelectByName=function(t,e,a){return t.querySelectorAll("select[name='"+e+"']")[a]},m.prototype.submitIndicator=function(t,e){var a=e.indicator.params,i=!1;for(var s in a){var r;a.hasOwnProperty(s)&&(r="avarage"===s?this.getSelectByName(e,s,0).selectedOptions[0].value:parseInt(this.getInputByName(e,s,0).value),e.indicator.params[s]!==r&&(i=!0),e.indicator.params[s]=r)}var n=e.indicator.colors;for(var o in n)if(n.hasOwnProperty(o)){var h=this.getInputByNameColor(e,o,0);e.indicator.colors[o]=h}var c=e.indicator.opacity;for(var l in c){var d=this.getInputByName(e,l,0).value;e.indicator.opacity[l]=d}var p=e.indicator.lineWidth;for(var u in p)if(p.hasOwnProperty(u)){var g=this.getInputByName(e,u,1).value;e.indicator.lineWidth[u]=g}this.addIndicator(e.indicator);var v=this.getActiveChart();i?v.chartData.updateIndicatorsData():(v.draw(v.showData,v.h),v.drawCurrent(v.chartData.currentValue)),this.updateIndicatorsDataPanel(),e.classList.toggle("tch-hidden",!0)},m.prototype.addIndicator=function(t){var e=this.getActiveChartData(),a=e.getIndicatorIndex(e.indicators,t);a>-1?(e.indicators[a].params=t.params,e.indicators[a].lineWidth=t.lineWidth,e.indicators[a].colors=t.colors,e.indicators[a].opacity&&(e.indicators[a].opacity=t.opacity)):e.indicators.push(t)},m.prototype.addHiddenIndicatorPanelInputStyleEvent=function(){var t=this.parent.querySelector(".tch-indicator-inputs"),e=this.parent.querySelector(".tch-indicator-style"),a=this.parent.querySelector(".tch-indicator-panel-header li:first-child "),i=this.parent.querySelector(".tch-indicator-panel-header li:last-child ");t.classList.remove("tch-hidden"),e.classList.add("tch-hidden"),a.classList.toggle("tch-tab-selected",!0),i.classList.toggle("tch-tab-selected",!1),a.addEventListener("click",function(){t.classList.remove("tch-hidden"),e.classList.add("tch-hidden"),a.classList.toggle("tch-tab-selected",!0),i.classList.toggle("tch-tab-selected",!1)}),i.addEventListener("click",function(){t.classList.add("tch-hidden"),e.classList.remove("tch-hidden"),a.classList.toggle("tch-tab-selected",!1),i.classList.toggle("tch-tab-selected",!0)})},m.prototype.convertToDTO=function(){var t={};return t.version=this.defaultParams.version,t.isSidebarHidden=this.isSidebarHidden,t.isHeaderHidden=this.isHeaderHidden,t.isFullScreen=this.isFullScreen,t.isDataPanel=this.isDataPanel,t.lang=this.configuration.lang,t.activeSpliter=this.activeSpliter,t.activeChartIndex=this.activeChartIndex,t.params=Object(o.b)(this.configuration),t.settings=Object(o.b)(this.settings),t.activeTab=this.activeTab,t.groupCharts=this.convertGroupChartsToDTO(),t.initializationDone=this.initializationDone,t},m.prototype.convertGroupChartsToDTO=function(){var t={};for(var e in this.groupCharts)if(this.groupCharts.hasOwnProperty(e)){var a=this.groupCharts[e];t[e]={},t[e].activeIndex=a.activeIndex,t[e].activeTabSpliter=a.activeTabSpliter,t[e].name=a.name,t[e].chartData=[];for(var i=0;i<a.chartData.length;i++){var s=a.chartData[i].convertToDTO();t[e].chartData.push(s)}}return t},m.prototype.setChartDatasState=function(t,e){for(var a in this.groupCharts)if(this.groupCharts.hasOwnProperty(a))for(var i=this.groupCharts[a],s=0;s<i.chartData.length;s++)i.chartData[s].state=e},m.prototype.saveParams=function(){var t=this.convertToDTO();this.setChartDatasState(t,"default"),this.saveToFile(t)},m.prototype.saveParamsToFile=function(){var t=this.convertToDTO();return this.setChartDatasState(t,"default"),JSON.stringify(t)},m.prototype.restoreParams=function(t){this.charts=[],this.convertFromDTO(this,t),this.initializationDone=!1,this.setTabsContainerHeight(),this.applyRestoredParams(this.groupCharts[this.activeTab].chartData[0])},m.prototype.autoSaveParams=function(){this.autoSaveTimeout&&clearTimeout(this.autoSaveTimeout);var t=this;this.autoSaveTimeout=setTimeout(function(){t.autoSave()},this.defaultParams.setTimeoutforSave)},m.prototype.autoSave=function(){if(this.configuration.isAutoRestore){var t=this.convertToDTO(),e=this.getKeyForLocalStorage();localStorage.setItem(e,JSON.stringify(t))}Object.keys(this.groupCharts).length<5&&this.activateAddTabBtn(!0)},m.prototype.applyDefaultParams=function(){if(this.initializationDone){this.initializationDone=!1;var t=this.getKeyForLocalStorage();this.setDefaultParamsPanel(),this.closeSettingsPanel(),localStorage.removeItem(t),this.charts=[],this.groupCharts={},this.activeSpliter=this.defaultParams.activeSpliter,m.tabsId=1,this.clearTabContainer(),this.createTabs(),this.setTabsContainerHeight(),this.setDefaultSideBar();var e=this.setDefaultParamsChart(this.groupCharts[this.activeTab].chartData[0]);this.activateTabContent(),this.applyRestoredParams(e),this.autoSaveTimeout=setTimeout(function(){localStorage.removeItem(t)},this.defaultParams.setTimeoutforSave)}},m.prototype.setDefaultSideBar=function(){if(this.config.modules.isSideBarCreate){for(var t=this.parent.querySelector(".tch-sidebar-container"),e=t.querySelectorAll(".tch-dropdown-container.active"),a=0;a<e.length;a++)e[a].classList.toggle("active",!1);for(var i=t.querySelectorAll(".tch-active"),s=0;s<i.length;s++)i[s].classList.toggle("tch-active",!1);var r=this.getActiveChartData();!r&&null===r||r.isStayDrawingMode||(r.state="default")}},m.prototype.setDefaultParamsChart=function(t,e){var a,i=t;for(var s in a=e?t.setDefaultParamsOnUpdate():g.defaultParams)a.hasOwnProperty(s)&&(i[s]=JSON.parse(JSON.stringify(a[s])));return i},m.prototype.setDefaultParamsPanel=function(t){t?(this.isHeaderHidden=t.isHeaderHidden?t.isHeaderHidden:this.defaultParams.paramsPanels.isHeaderHidden,this.isSidebarHidden=t.isSidebarHidden?t.isSidebarHidden:this.defaultParams.paramsPanels.isSidebarHidden,this.isFullScreen=void 0!==t.isFullScreen?t.isFullScreen:this.defaultParams.paramsPanels.isFullScreen,this.isDataPanel=t.isDataPanel?t.isDataPanel:this.defaultParams.paramsPanels.isDataPanel):(this.isSidebarHidden=this.defaultParams.paramsPanels.isSidebarHidden,this.isHeaderHidden=this.defaultParams.paramsPanels.isHeaderHidden,this.isFullScreen=this.defaultParams.paramsPanels.isFullScreen,this.isDataPanel=this.defaultParams.paramsPanels.isDataPanel)},m.prototype.closeSettingsPanel=function(){var t=this.parent.querySelector(".tch-line-settings-container"),e=this.parent.querySelector(".tch-indicator-panel");t&&t.classList.toggle("tch-hidden",!0),e&&e.classList.toggle("tch-hidden",!0)},m.prototype.fillQuotationsSettings=function(){var t=this.settings.quotations;this.createQuotationsTabs(t),this.fillquotationsDropdown(t);var e=this.getActiveChartData();null!==e&&this.setQuotationDropDownValue(e.pair.FullName)},m.prototype.fillQuotationsFavDropdown=function(t){t?self.fillquotationsDropdown(t):t=this.settings.quotations},m.prototype.convertFromDTO=function(t,e){t.activeSpliter=e.activeSpliter,t.activeChartIndex=e.activeChartIndex,t.settings=e.settings,t.isSidebarHidden=e.isSidebarHidden,t.isHeaderHidden=e.isHeaderHidden,t.isFullScreen=e.isFullScreen,t.isDataPanel=e.isDataPanel,t.groupCharts=e.groupCharts,t.initializationDone=e.initializationDone,t.applyParamsDTO(),this.convertChartsArrayFromDTO(t,e)},m.prototype.applyParamsDTO=function(){this.parent.classList.toggle("tch-fullscreen-mode-on",this.isFullScreen),this.resize(),this.recreateSideBarMenu()},m.prototype.convertChartsArrayFromDTO=function(t,e){this.groupChartsInit(t),this.setListenersOnChartData(t),this.refreshTabContainer(t,e),this.setTabsContainerHeight(),this.activateTabContent(),5===Object.keys(t.groupCharts).length&&t.activateAddTabBtn(!1)},m.prototype.groupChartsInit=function(t){for(var e in t.groupCharts)if(t.groupCharts.hasOwnProperty(e)){for(var a=[],i=0;i<t.groupCharts[e].chartData.length;i++){var s=new g(this);s.convertFromDTO(t.groupCharts[e].chartData[i]),a.push(s)}t.groupCharts[e].chartData=a}},m.prototype.setListenersOnChartData=function(t){for(var e in this.connector.listeners=[],t.groupCharts)if(t.groupCharts.hasOwnProperty(e))for(var a=0;a<t.groupCharts[e].chartData.length;a++)t.groupCharts[e].chartData[a].techChart=t,t.groupCharts[e].chartData[a].init()},m.prototype.refreshTabContainer=function(t,e){t.clearTabContainer();var a=Object.keys(t.groupCharts),i=a[a.length-1].split("-");for(var s in m.tabsId=parseInt(i[1])+1,t.groupCharts)t.groupCharts.hasOwnProperty(s)&&(t.createNewTabContainer(s),t.setTabName(s));t.setTabActive(e.activeTab)},m.prototype.applyRestoredParams=function(t){this.setQuotationDropDownValue(t.pair.FullName),this.setCursorType(t.cursorType),this.setChartType(t.chartType),this.setPeriod(t.period),this.setActiveChartPeriod(t.period),this.setPeriodBtn(this.setActiveChartPeriod(t.period)),this.setActiveDrawingObjectsLockedStateIcon(),this.setMagnetModeBtn(),this.setRouleteBtn(this.charts[0].chartData.state),this.setStayDrawingModeBtn(),this.setShowHideDrawing(),this.setActiveSpliterButton(),this.clearIndicatorsDataPanel(),this.applySettingsDataPanelHidden(),this.applySettingsSidebarHidden(),this.applySettingsHeaderHidden(),this.applySettingsFullscreenBtn(),this.moveElements.moveResize()},m.prototype.clearIndicatorsDataPanel=function(){this.config.modules.chartElements.isDataPanelCreate&&(this.parent.querySelector(".tch-data-indicators").innerHTML="")},m.prototype.applyPeriodParams=function(t,e){for(var a in e)if(e.hasOwnProperty(a)&&(e[a].value===t||e[a].name===t)){var i=e[a].name;this.setPeriodBtn(i,e),this.setPeriod(i);break}},m.prototype.setActiveChartPeriod=function(t){var e,a=this.getPeriods();for(var i in a)if(a.hasOwnProperty(i)&&(a[i].value===t||a[i].name===t)){e=a[i].value;break}return e},m.prototype.setActiveChartParams=function(){var t=this.getActiveChartData();this.setTypeDataBtn(t.typeData),this.setPeriodBtn(this.setActiveChartPeriod(t.period)),this.setActiveCursorType(t.cursorType),this.setActiveChartType(t.chartType),this.setQuotationDropDownValue(t.pair.FullName),this.setActiveStatePipsCalc(),this.hiddenSymbolDescription(t.options.Chart.symbolDescription),this.hiddenOhlcValue(t.options.Chart.ohlcValues),this.setActiveChartZoomBtn(t.zoomSteps),this.hideElementDataPanel(),this.setDefaultSideBar()},m.prototype.setActiveChartZoomBtn=function(t){this.configuration.modules.sideBarButtons.zoomButton&&(this.parent.querySelector(".tch-zoomout-btn").disabled=!t.length)},m.prototype.setActiveChartIndicatorsDataPanel=function(t){if(this.configuration.modules.chartElements.isDataPanelCreate){this.clearIndicatorsDataPanel();for(var e=!1,a=0;a<t.indicators.length;a++)if("trend"===t.indicators[a].type){e=!0;break}if(e&&t.chart&&t.chart.crosshair.params&&t.chart.crosshair.params.dateSeconds){var i=t.chart.crosshair.params.dateSeconds;this.updateIndicatorsDataPanel(i)}}},m.prototype.setState=function(t){var e=this.getActiveChartData();if(this.removeRoulete(t),"default"!==e.state&&e.editDrawingObject&&!e.isStayDrawingMode)return!1;if(e.editDrawingObject&&e.isStayDrawingMode&&e.editDrawingObject.drawingStage.max>=e.editDrawingObject.drawingStage.current)return!1;if(e.state=e.state===t?"default":t,e.state.indexOf("drawing")>-1){if(!e.chart)return!1;var a=!1;e.editDrawingObject&&(e.editDrawingObject.state="normal",e.editDrawingObject=null,a=!0),e.activeDrawingObject&&(e.activeDrawingObject.state="normal",e.activeDrawingObject=null,a=!0),a&&(e.chart.redrawInfo(),e.chart.redrawDrawingObjects())}return!0},m.prototype.getActiveChartData=function(){return this.charts.length>this.activeChartIndex?this.charts[this.activeChartIndex].chartData:null},m.prototype.getActiveChart=function(){return this.charts.length>this.activeChartIndex?this.charts[this.activeChartIndex]:null},m.prototype.getVersion=function(){return this.defaultParams.version},m.prototype.cursorChangeImage=function(t){this.configuration.modules.sideBarButtons.cursorTypeButton&&this.parent.querySelector(".tch-cursorType-container").setAttribute("actualtype",t)},m.prototype.deactivateMenuTypeAll=function(){this.activeMenuContainer.forEach(function(t){t.classList.toggle("active",!1)})},m.prototype.makeTchTextValue=function(t){return t.toLowerCase().replace(/\s/,"-").replace(/\s.+/,"")},m.prototype.sortIndicatorsfromName=function(t){var e=this;return Object.values(t).sort(function(t,a){var i=e.makeTchTextValue(t.fullName);t=e.translation[i];var s=e.makeTchTextValue(a.fullName);return t>(a=e.translation[s])?1:t<a?-1:0})},m.prototype.fillIndicatorsDropdown=function(t){var e=this;if(this.configuration.modules.headerButtons.indicatorButton&&this.configuration.modules.isHeaderCreate){var a=this.parent.querySelector(".tch-indicators-list");a.innerHTML="",t&&0!==Object.keys(t).length?(t=this.sortIndicatorsfromName(t),Object.keys(t).forEach(function(i){var s=t[i],r=document.createElement("li"),n=e.makeTchTextValue(s.fullName);r.innerText=e.translation[n],r.setAttribute("tch-text",n),r.addEventListener("click",function(){e.createIndicator(s,e),e.autoSaveParams()}),a.appendChild(r)})):a.innerHTML="<li style='text-align: center' tch-text='no-indicators-mached' >"+this.translation["indicator-not-found"]+"</li>"}},m.prototype.sortAnyCase=function(t,e){return t.FullName.toLowerCase()>e.FullName.toLowerCase()?1:t.FullName.toLowerCase()<e.FullName.toLowerCase()?-1:0},m.prototype.createQuotationsTabs=function(t){var e=this;if(this.configuration.modules.headerButtons.searchQuotationButton){var a=this.parent.querySelector(".tch-tabs-list"),i=[],s=t.map(function(t){return t.Category}).filter(function(t){return-1===i.indexOf(t)&&i.push(t)}).sort();if(s.length>=1){var r=document.createElement("li");r.textContent=this.translation.all,r.setAttribute("tch-text","all"),r.className="tch-tab-selected",a.appendChild(r),s.forEach(function(t){var i=e.makeTchTextValue(t);(r=document.createElement("li")).textContent=e.translation[i],r.setAttribute("tch-text",i),a.appendChild(r)})}}},m.prototype.fillquotationsDropdown=function(t){var e=this;if(this.configuration.modules.headerButtons.searchQuotationButton){var a=this.parent.querySelector(".tch-filtered-quatation tbody"),i=this.parent.querySelector(".tch-search");if(i.style.direction="ltr",a.innerHTML="",t&&0!==t.length){(t=t.sort(this.sortAnyCase)).forEach(function(s){var r=document.createElement("tr");r.classList.add("tch-row-quatation");var n=r.insertCell(-1);n.innerText=s.ID,n.style.display="none";var o=s.FullName+"&#x200E;",h=r.insertCell(-1);h.innerHTML="<span>".concat(o,"</span>");var c=r.insertCell(-1);c.innerText=e.translation[s.Category.toLocaleLowerCase()],c.setAttribute("tch-text",e.makeTchTextValue(s.Category));var l=r.insertCell(-1);l.innerText="",h.style.width="65%",c.style.width="30%",l.style.width="5%",r.onclick=function(a){return e.onSelectInstrument(a,s,t,e,i)},a.appendChild(r)}),this.configuration.modules.signals&&this.signalsList&&this.updateSignalsDropdown(this.signalsList);var s=this.parent.querySelector(".tch-search-container");s.oncloseall=function(){if(s.classList.contains("tch-dropdown-container-active")){var t=e.getActiveChartData().pair.FullName;t.length>=14?i.value=t.substring(0,13).concat("..."):i.value=t}}}else a.innerHTML="<tr><td tch-text='no-financial' style='text-align: left'>No financial instrument matched your criteria</td></tr>"}},m.prototype.onSelectInstrument=function(t,e,a,i,s){i.charts[i.activeChartIndex].chartData.editDrawingObject=null,i.charts[i.activeChartIndex].chartData.state="default",i.charts[i.activeChartIndex].chartData.isWaitForData=!1,i.deactivateMenuTypeAll(),i.setQuotation(e),s&&(s.value=e.FullName),i.groupCharts[i.activeTab].name=e.FullName,i.setTabName(i.activeTab),i.autoSaveParams()},m.prototype.addBasketBtnEvent=function(){var t=this;this.configuration.modules.sideBarButtons.basketButton&&(this.parent.querySelector(".tch-basket-btn").onclick=function(e){var a=t.getActiveChart();t.continueDrawing(e),a&&(a.removeAllDrawingObjects(),a.chartData.state="default",t.setRouleteBtn("Off"),a.removeAllDrawingObjectsOtherCharts(),t.autoSaveParams()),t.deactivateMenuTypeAll(),t.closeAll(),t.deactivateMenuTypeAll()})},m.prototype.addLockBtnEvent=function(){var t=this;this.configuration.modules.sideBarButtons.lockButton&&(this.parent.querySelector(".tch-lock-btn").onclick=function(e){t.continueDrawing(e),t.switchLockBtn(),t.lostFocusDrawingObject(),t.closeAll(),t.autoSaveParams()})},m.prototype.checkStateLockBtn=function(){var t=this.parent.querySelector(".tch-lock-btn"),e=this.getActiveChartData();t.classList.toggle("tch-active",e.isDrawingObjectsLocked),t.parentElement.classList.toggle("tch-active",e.isDrawingObjectsLocked)},m.prototype.switchLockBtn=function(){this.parent.querySelector(".tch-lock-btn").classList.toggle("tch-active",!this.getActiveChartData().isDrawingObjectsLocked);for(var t=0;t<this.charts.length;t++){var e=this.charts[t].chartData;e.isDrawingObjectsLocked=!e.isDrawingObjectsLocked}},m.prototype.addMagnetModeEvent=function(){var t=this;this.configuration.modules.sideBarButtons.magnetModeButton&&(this.parent.querySelector(".tch-magnet-mode-btn").onclick=function(e){t.continueDrawing(e);for(var a=0;a<t.charts.length;a++)t.charts[a].chartData.isMagnetMode=!t.charts[a].chartData.isMagnetMode;t.setMagnetModeBtn(),t.closeAll(),t.autoSaveParams()})},m.prototype.setMagnetModeBtn=function(){this.configuration.modules.sideBarButtons.magnetModeButton&&this.parent.querySelector(".tch-magnet-mode-btn").classList.toggle("tch-active",this.getActiveChartData().isMagnetMode)},m.prototype.continueDrawing=function(){return!1},m.prototype.finishDrawing=function(){var t=this.getActiveChartData();t.editDrawingObject&&("drawingEllipse"===t.state&&t.editDrawingObject.drawingStage.current<2&&t.editDrawingObject.remove(),"drawingPolyline"===t.state&&t.editDrawingObject.updateLastPointForBreak(),this.lostFocusDrawingObject())},m.prototype.addZoomInBtnEvent=function(){var t=this;if(this.configuration.modules.sideBarButtons.zoomButton){var e=this.parent.querySelector(".tch-zoomin-btn");e.onclick=function(a){t.continueDrawing(a)||(t.finishDrawing(),t.getActiveChartData().state="zoomIn",t.deactivateMenuTypeAll(),e.classList.toggle("tch-active",!0),t.closeAll())}}},m.prototype.addZoomOutBtnEvent=function(){var t=this;if(this.configuration.modules.sideBarButtons.zoomButton){var e=this.parent.querySelector(".tch-zoomout-btn");e.disabled=!0,e.onclick=function(e){t.continueDrawing(e)||(t.getActiveChart().zoomOut(),t.autoSaveParams(),t.closeAll())}}},m.prototype.addSaveBtnEvent=function(){var t=this;this.configuration.modules.sideBarButtons.saveRestoreButtons&&(this.parent.querySelector(".tch-save-btn").onclick=function(e){t.continueDrawing(e);var a=t.saveParamsToFile(),i=new Date,s=i.getDate(),r=i.getMonth()+1,n=i.getFullYear();e.currentTarget.href=window.URL.createObjectURL(new Blob([a],{type:"octet/stream"})),e.currentTarget.download="saveparams"+s+r+n+".json"})},m.prototype.addRestoreBtnEvent=function(){var t=this;this.configuration.modules.sideBarButtons.saveRestoreButtons&&(this.parent.querySelector(".tch-restore-btn").onchange=function(e){t.continueDrawing(e),t.readFile(e.target.files[0]),e.stopPropagation(),e.preventDefault()})},m.prototype.readFile=function(t){var e=this,a=new FileReader;a.onload=function(){e.restoreParams(a.result),e.autoSaveParams()},a.readAsText(t)},m.prototype.addDefaultBtnEvent=function(){var t=this;this.configuration.modules.sideBarButtons.saveRestoreButtons&&(this.parent.querySelector(".tch-default-btn").onclick=function(){t.lostFocusDrawingObject(),t.applyDefaultParams();var e=t.parent.querySelector(".tch-data-panel");e&&(e.style.top=t.defaultTopDataPanel+"px",e.style.left=t.defaultLeftDataPanel+"px"),t.resize()},this.setRouleteBtn("Off"))},m.prototype.addStayDrawingModeBtn=function(){var t=this;this.configuration.modules.sideBarButtons.stayDrawingModeButton&&(this.parent.querySelector(".tch-stay-drawing-mode-btn").onclick=function(e){t.continueDrawing(e);for(var a=0;a<t.charts.length;a++)t.charts[a].chartData.isStayDrawingMode=!t.charts[a].chartData.isStayDrawingMode;t.setStayDrawingModeBtn(),t.closeAll(),t.autoSaveParams()})},m.prototype.setStayDrawingModeBtn=function(){this.configuration.modules.sideBarButtons.stayDrawingModeButton&&this.parent.querySelector(".tch-stay-drawing-mode-btn").classList.toggle("tch-active",this.getActiveChartData().isStayDrawingMode)},m.prototype.addShowHideDrawing=function(){var t=this;if(this.configuration.modules.sideBarButtons.hideDrowingObjectButton){var e=this.parent.querySelector(".tch-show-hide-drawing-btn");e.onclick=function(a){t.continueDrawing(a)||(t.hiddeAllDrawing(e),t.closeAll(),t.autoSaveParams())}}},m.prototype.hiddeAllDrawing=function(){for(var t=0;t<this.charts.length;t++)this.charts[t].chartData.isShowDrawingObjects=!this.charts[t].chartData.isShowDrawingObjects,this.charts[t]&&this.charts[t].chartData.drawingObjects.length&&(this.charts[t].redrawInfo(),this.charts[t].redrawDrawingObjects());this.setShowHideDrawing(),this.autoSaveParams()},m.prototype.setShowHideDrawing=function(){this.configuration.modules.sideBarButtons.hideDrowingObjectButton&&this.parent.querySelector(".tch-show-hide-drawing-btn").classList.toggle("tch-active",!this.getActiveChartData().isShowDrawingObjects)},m.prototype.addClickTabQuatation=function(){var t=this;if(this.configuration.modules.headerButtons.searchQuotationButton){var e=this.parent.querySelector(".tch-search"),a=this.parent.querySelector(".tch-search-dropdown .tch-tabs-list");a.addEventListener("click",function(i){if("li"===i.target.localName){[].slice.call(a.querySelectorAll(".tch-tabs-list li")).forEach(function(t){t.classList.toggle("tch-tab-selected",!1)}),i.target.classList.toggle("tch-tab-selected",!0);var s=i.target.getAttribute("tch-text"),r=e.value.replace(/[^A-Za-zА-Яа-яЁё0-9]/g,""),n=t.filterQuotation(s,r);t.fillquotationsDropdown(n,s)}})}},m.prototype.filterQuotation=function(t,e){var a=t.toLowerCase(),i=this.settings.quotations;"all"!==a&&(i=i.filter(function(t){return t.Category.toLowerCase()===a}));var s=new RegExp(e,"i","g");return""!==e&&(i=i.filter(function(t){return s.test(t.FullName.replace(/[^A-Za-z\d]/g,""))})),i},m.prototype.addIndicatorBtn=function(){var t=this;if(this.configuration.modules.headerButtons.indicatorButton){var e=this.parent.querySelector(".tch-indicator-container"),a=e.querySelector(".tch-indicator-search");this.dropForHidden.push(e),e.addEventListener("click",function(i){t.continueDrawing(i)||(a.value="",t.filtrIndicator(),t.dropDownClick(e,void 0,i),a.focus(),t.lostFocusDrawingObject())})}},m.prototype.addLayoutBtnEvents=function(){var t=this;if(this.configuration.modules.headerButtons.splitterButton){var e=this.parent.querySelector(".tch-chart-layouts-container");this.dropForHidden.push(e),e.addEventListener("click",function(a){t.dropDownClick(e,void 0,a)}),e.querySelector(".tch-chart-layouts-dropdown .tch-layout-header").addEventListener("click",function(t){return t.stopPropagation()}),e.querySelector(".tch-chart-layouts-dropdown .tch-layout-header + ul").addEventListener("click",function(t){return t.stopPropagation()}),e.querySelectorAll(".tch-chart-layouts-dropdown li").forEach(function(a){a.addEventListener("click",function(a){var i=parseInt(a.target.getAttribute("tch-spliter-template"),10);if(t.activeSpliter!==i-1){t.activeSpliter=i-1,t.setActiveSpliterButton(),t.charts=t.createChartsArray(t.charts),t.groupCharts[t.activeTab].chartData=t.getChartDatas(t.charts);for(var s=t.groupCharts[t.activeTab].chartData.length,r=0;r<s;r++)t.groupCharts[t.activeTab].chartData[r].hasPrevData=!1;t.groupCharts[t.activeTab].activeTabSpliter=t.activeSpliter,t.groupCharts[t.activeTab].activeIndex=t.activeChartIndex;var n=t.createChartContainers();t.createCharts(n),t.autoSaveParams()}e.classList.toggle("tch-dropdown-container-active",!1)})})}},m.prototype.addCursorTypeEvent=function(){var t=this;if(this.configuration.modules.sideBarButtons.cursorTypeButton){var e=this.parent.querySelector(".tch-cursorType-container");this.dropForHidden.push(e),e.onclick=function(a){t.continueDrawing(a),t.dropDownClick(e,void 0,a);var i=e.getAttribute("actualtype");t.setCursorType(i)},e.setAttribute("actualType",this.cursorType)}},m.prototype.addLineTypeEvent=function(){var t=this;if(this.configuration.modules.sideBarButtons.drawingObjectsButton){var e=this.parent.querySelector(".tch-lineType-container");this.dropForHidden.push(e),e.onclick=function(a){t.continueDrawing(a),t.dropDownClick(e,void 0,a)}}},m.prototype.addBrushTypeEvent=function(){var t=this;if(this.configuration.modules.sideBarButtons.brushTypeButton){var e=this.parent.querySelector(".tch-brushType-container");this.dropForHidden.push(e),e.onclick=function(a){t.continueDrawing(a),t.dropDownClick(e,void 0,a)}}},m.prototype.addTextTypeEvent=function(){var t=this;if(this.configuration.modules.sideBarButtons.textTypeButton){var e=this.parent.querySelector(".tch-textType-container");this.dropForHidden.push(e),e.onclick=function(a){t.continueDrawing(a),t.dropDownClick(e,void 0,a)}}},m.prototype.dropDownClick=function(t,e,a){a.stopPropagation();var i=t.classList.contains("tch-dropdown-container-active");this.closeAll(),t.classList.toggle("tch-dropdown-container-active",e||!i)},m.prototype.dropDownClickMore=function(t,e){e.stopPropagation();var a=this.parent.querySelector(".tch-more-btn"),i=a.classList.contains("tch-more-active");this.closeAll(),a.classList.toggle("tch-more-active",!i),a.firstElementChild.firstElementChild.classList.toggle("tch-more-active",!i)},m.prototype.addSearchIndicatorEvents=function(){var t=this;if(this.configuration.modules.headerButtons.indicatorButton){var e=this.parent.querySelector(".tch-indicator-search"),a=this.parent.querySelector(".tch-indicator-dropdown .tch-dropdown-header"),i=Object(o.c)(this.configuration.dropDown.indicators,this.indicators),s=Object.keys(i).map(function(t){return i[t]});a.addEventListener("click",function(t){return t.stopPropagation()}),e.addEventListener("click",function(t){return t.stopPropagation()}),e.addEventListener("keyup",function(){var a=e.value.replace(/[^A-Za-zА-Яа-яa-zżźćńółęąśŻŹĆĄŚĘŁÓŃ %\/]/g,"");e.value=a,a=a.replace(/[\s\\\/]/g,"").toLowerCase();var i=new RegExp("^"+a,"i"),r=s.filter(function(e){var i=t.makeTchTextValue(e.fullName),s=t.translation[i];s=s.replace(/[\s\\\/]/g,"").toLowerCase();var r=!1;if(a===s.substring(0,a.length))r=!0;else for(var n=s.split(" "),o=0;o<n.length;o++)a===n[o].substring(0,a.length)&&(r=!0);return r},i);t.fillIndicatorsDropdown(r)})}},m.prototype.filtrIndicator=function(){var t=Object(o.c)(this.configuration.dropDown.indicators,this.indicators),e=Object.keys(t).map(function(e){return t[e]});this.fillIndicatorsDropdown(e)},m.prototype.setPositionOfInstrDropdown=function(){var t=this.parent.querySelector(".tch-search-dropdown");t.offsetLeft<0&&(t.style.right="inherit",t.style.left="0")},m.prototype.addSearchQuatationEvents=function(){var t=this;if(this.configuration.modules.headerButtons.searchQuotationButton){var e=this.parent.querySelector(".tch-search"),a=this.parent.querySelector(".tch-search-container"),i=a.querySelector(".tch-tabs");this.dropForHidden.push(a),e.addEventListener("click",function(e){if(!t.continueDrawing(e)){t.lostFocusDrawingObject();var i=t.parent.querySelector(".tch-tabs-list [tch-text].tch-tab-selected").getAttribute("tch-text"),s=t.filterQuotation(i,"");t.fillquotationsDropdown(s,i),t.dropDownClick(a,!0,e),t.setPositionOfInstrDropdown(),e.currentTarget.value=""}}),i.addEventListener("click",function(t){return t.stopPropagation()}),e.addEventListener("keyup",function(){var a=t.parent.querySelector(".tch-tabs-list [tch-text].tch-tab-selected").getAttribute("tch-text"),i=e.value.replace(/[^A-Za-z\d]/g,"");e.value=i;var s=t.filterQuotation(a,i,!0);t.fillquotationsDropdown(s,a)})}},m.prototype.fullScreenToggle=function(){this.lostFocusDrawingObject(),this.parent.classList.contains("tch-fullscreen-mode-on")?(this.parent.classList.toggle("tch-fullscreen-mode-on",!1),this.isFullScreen=!1):(this.parent.classList.toggle("tch-fullscreen-mode-on",!0),this.isFullScreen=!0)},m.prototype.addFullscreenEvent=function(){var t=this;this.configuration.modules.headerButtons.fullScreenButton&&this.parent.querySelector(".tch-fullscreen-btn").addEventListener("click",function(){var e=t.parent.offsetTop,a=t.parent.offsetLeft,i=t.parent.offsetTop,s={left:t.parent.offsetLeft-a,top:i-e},r=t.parent.querySelector(".tch-cursorType-container"),n=r?r.getAttribute("actualtype"):"arrow";t.fullScreenToggle(),t.resize(!0),t.configuration.modules.isSideBarCreate&&(t.recreateSideBarMenu(),t.createSideBarMenu("cursorType",n)),t.autoSaveParams(),t.moveElements.moveResize(s);var o=t.parent.querySelector(".tch-tabs-container"),h=o?o.scrollHeight:0,c=t.parent.querySelector(".tch-data-panel");c&&(t.isDataPanel&&40===h?(c.style.top=t.defaultTopDataPanel+h+"px",c.style.left=t.defaultLeftDataPanel+"px"):(c.style.top=t.defaultTopDataPanel+"px",c.style.left=t.defaultLeftDataPanel+"px"))})},m.prototype.addPipsEvent=function(){var t=this;this.configuration.modules.headerButtons.createPipsButton&&this.parent.querySelector(".tch-pips-btn").addEventListener("click",function(e){var a=!t.charts[t.activeChartIndex].chartData.isPipsShow;e.currentTarget.classList.toggle("tch-pips-btn-active",a),t.charts[t.activeChartIndex].chartData.isPipsShow=a,t.autoSaveParams()})},m.prototype.addSidebarClosePanelEvents=function(){var t=this;if(this.configuration.modules.isSideBarCreate){var e=this.parent.querySelector(".tch-sidebar-close-panel"),a=e.parentElement;e.addEventListener("click",function(){a.classList.toggle("tch-sidebar-hidden"),t.isSidebarHidden=a.classList.contains("tch-header-hidden"),t.resize(),t.autoSaveParams()})}},m.prototype.addHeaderClosePanelEvents=function(){var t=this;if(this.configuration.modules.isHeaderCreate){var e=this.parent.querySelector(".tch-header-close-panel"),a=this.parent.querySelector(".tch-container");e.addEventListener("click",function(){a.classList.toggle("tch-header-hidden"),t.isHeaderHidden=a.classList.contains("tch-header-hidden"),t.resize(),t.setTabsContainerHeight(),t.autoSaveParams()})}},m.prototype.setCursorType=function(t){for(var e=0;e<this.charts.length;e++)this.charts[e].setCursorType(t);this.charts&&this.getActiveChart()&&this.getActiveChartData()&&(this.setActiveCursorType(t),this.autoSaveParams())},m.prototype.setActiveCursorType=function(t){this.configuration.modules.sideBarButtons.cursorTypeButton&&this.parent.querySelector(".tch-cursorType-container").setAttribute("actualType",t)},m.prototype.setPeriod=function(t){var e=this.getActiveChartData();if(e.period=g.convertValueToPeriod(t),e.data={ask:[],bid:[],mid:[]},e.clearIndicatorsData(),e.hasPrevData=!0,e.startX=e.candleWidth,e.startDateSeconds=!1,e.candleWidth=this.configuration.candleWidth,e.indicators.length){var a=!0,i=!1,s=void 0;try{for(var r,n=e.indicators[Symbol.iterator]();!(a=(r=n.next()).done);a=!0)if("oscillator"===r.value.type&&("5"===e.period||"1"===e.period)){this.charts[this.activeChartIndex]=this.createChart(e.chart.parent,e);break}}catch(o){i=!0,s=o}finally{try{a||null==n.return||n.return()}finally{if(i)throw s}}}this.charts[this.activeChartIndex].init(),this.connector.updateSubscription()},m.prototype.setQuotation=function(t){var e=this.getActiveChartData();e.chart.dropZoomSteps(),e.id=t.ID,e.pair=t,e.data={ask:[],bid:[],mid:[]},e.clearIndicatorsData(),e.hasPrevData=!0,e.currentValue={ask:"",bid:"",mid:""},e.precission="",e.options.Chart.autoScale=!0,e.drawingObjects=e.convertDrawingObjectsFromDTO(e.drawingObjects),this.charts[this.activeChartIndex]=this.createChart(e.chart.parent,e),this.charts[this.activeChartIndex].init(),this.connector.updateSubscription()},m.prototype.setChartType=function(t){this.getActiveChartData().chartType=t,this.setActiveChartType(t)},m.prototype.setActiveChartType=function(t){if(this.configuration.modules.headerButtons.chartTypeButton){for(var e=this.parent.querySelector(".tch-chart-type-button"),a=this.parent.querySelector(".tch-chart-type-dropdown"),i=0;i<a.children.length;i++)a.children[i].classList.toggle("tch-chart-type-selected",!1);for(var s in this.chartTypes)this.chartTypes.hasOwnProperty(s)&&s===t&&(e.setAttribute("actualtype",t),a.querySelector("li.tch-"+s).classList.toggle("tch-chart-type-selected",!0))}},m.prototype.addHiddenDataPanelEvent=function(){var t=this;if(this.configuration.modules.chartElements.isDataPanelCreate){var e=this.parent.querySelector(".tch-data-panel-header span:last-child"),a=this.parent.querySelector(".tch-data-panel-body"),i=this.parent.querySelector(".tch-data-panel");this.configuration.isDataPanel&&(e.classList.toggle("tch-up",!1),e.classList.toggle("tch-down",!0)),e.addEventListener("click",function(e){a.classList.toggle("tch-hidden"),i.classList.toggle("tch-small");var s=e.currentTarget.classList.contains("tch-up");t.closeAll(),e.currentTarget.classList.toggle("tch-up",!s),e.currentTarget.classList.toggle("tch-down",s),t.isDataPanel=a.classList.contains("tch-hidden"),t.autoSaveParams(),t.moveElements.resizeDragObjects()})}},m.prototype.addHiddenStyle=function(){var t=this;this.parent.onclick=null,this.parent.onclick=function(){t.closeAll()}},m.prototype.hideElementDataPanel=function(){var t=this.getActiveChartData();t&&(this.hiddenSymbolDescription(t.options.Chart.symbolDescription),this.hiddenOhlcValue(t.options.Chart.ohlcValues),this.hiddenIndicatorArguments(t.options.Chart.indicatorArguments),this.hiddenIndicatorTitles(t.options.Chart.indicatorTitles),this.hiddenIndicatorValues(t.options.Chart.indicatorValues))},m.prototype.hiddenSymbolDescription=function(t){if(this.configuration.modules.chartElements.isDataPanelCreate){var e=this.parent.querySelector(".tch-data-panel-header span:nth-child(2)"),a=this.parent.querySelector(".tch-data-panel-header span:nth-child(3)");e.classList.toggle("tch-hidden",!t),a.classList.toggle("tch-hidden",!t)}},m.prototype.hiddenOhlcValue=function(t){var e=this.parent.querySelector(".tch-data-candle");e&&e.classList.toggle("tch-hidden",!t)},m.prototype.hiddenIndicatorTitles=function(t){if(this.configuration.modules.headerButtons.settingsButton){this.setDisplayPanelElements(this.collectAllIndicatorsPanels(),[1],t);var e=this.parent.querySelector(".tch-settings-background input[name='options-Chart-indicatorArguments']");this.parent.querySelector(".tch-settings-background input[name='options-Chart-indicatorTitles']").checked=t,t?e.disabled=!1:(this.hiddenIndicatorArguments(t),e.checked=t,e.disabled="disabled")}},m.prototype.hiddenIndicatorArguments=function(t){this.setDisplayPanelElements(this.collectAllIndicatorsPanels(),[2],t)},m.prototype.hiddenIndicatorValues=function(t){this.setDisplayPanelElements(this.collectAllIndicatorsPanels(),[6],t)},m.prototype.setDisplayPanelElements=function(t,e,a){for(var i=0;i<t.length;i++)for(var s=t[i].querySelectorAll("ul"),r=0;r<s.length;r++)for(var n in e)if(e.hasOwnProperty(n)){var o=s[r].querySelector("li:nth-child("+e[n]+")");o&&(o.style.display=a?"inherit":"none")}},m.prototype.collectAllIndicatorsPanels=function(){var t=this.getActiveChart(),e=t.dataPanel?[].slice.call(t.dataPanel.querySelectorAll(".tch-data-indicators")):[],a=[].slice.call(t.chartOscillatorContainer.querySelectorAll(".tch-oscillator-data-panel"));return e.concat(a)},m.prototype.closeAll=function(){this.removeClassInList(this.dropForHidden,"tch-dropdown-container-active"),this.closeDrawingObjectSettings()},m.prototype.removeClassInList=function(t,e){if(t.forEach)t.forEach(function(t){t.oncloseall&&t.oncloseall(),t.classList.toggle(e,!1)});else for(var a in t)t.hasOwnProperty(a)&&(t[a].classList.toggle(e,!1),t[a].oncloseall&&t[a].oncloseall())},m.prototype.alertBrowse=function(){Helper.warningBrowser()||Helper.showWarningBrowser(null,this.parent.querySelector(".tch-chart-alert"))},m.prototype.closeDrawingObjectSettings=function(){var t=this.parent.querySelector(".tch-line-settings-container");t&&("undefined"!==t.closeCounter&&t.closeCounter>0?t.closeCounter--:(t.classList.toggle("tch-hidden",!0),t.oncloseall&&t.oncloseall()))},m.prototype.AddRouleteEvent=function(t){var e=this;this.configuration.modules.sideBarButtons.rouleteButton&&(this.parent.querySelector(".tch-roulete-drawing-btn").onclick=function(a){e.continueDrawing(a)||("start"===t?e.setRouleteBtn("default"):e.setRouleteBtn("button"),e.closeAll(),e.autoSaveParams())})},m.prototype.setRouleteBtn=function(t){if(this.configuration.modules.sideBarButtons.rouleteButton){var e=this.parent.querySelector(".tch-roulete-drawing-btn"),a=this.getActiveChartData();"button"===t&&("drawingRoulete"===a.state&&e.classList.contains("tch-active")?(this.removeRoulete("default"),a.state="default",e.classList.toggle("tch-active",!1)):"drawingRoulete"!==a.state||e.classList.contains("tch-active")?(a.state="drawingRoulete",e.classList.toggle("tch-active",!0)):(this.removeRoulete("default"),a.state="drawingRoulete",e.classList.toggle("tch-active",!0))),"default"===t?(this.removeRoulete("default"),this.setState("default"),e.classList.toggle("tch-active",!1)):"Off"===t&&e.classList.toggle("tch-active",!1)}},m.prototype.removeRoulete=function(t){var e=this.getActiveChartData();if("RouleteButtonOff"===t)this.setRouleteBtn("Off");else for(var a=0;a<e.drawingObjects.length;a++)e.drawingObjects[a]instanceof Roulete&&(e.drawingObjects[a].remove(),this.setRouleteBtn("Off"),e.chart.redrawDrawingObjects(),e.chart.redrawInfo())},m.prototype.lostFocusDrawingObject=function(){this.getActiveChart().deactivateChart()},m.prototype.backDrawingObjectsToNormalState=function(){if(this.charts.length){for(var t=this.getActiveChartData(),e=this.getActiveChart(),a=0;a<t.drawingObjects.length;a++)t.drawingObjects[a].state="edit",t.editDrawingObject&&(t.editDrawingObject.state="normal"),t.editDrawingObject=t.drawingObjects[a],t.activeDrawingObject&&(t.activeDrawingObject.state="normal",t.activeDrawingObject=null),e.drawActiveDrawingObjects(),e.redrawDrawingObjects();t.editDrawingObject&&(t.editDrawingObject.isPressed?(t.editDrawingObject.isPressed=!1,t.editDrawingObject.updateValues()):(t.editDrawingObject.state="normal",t.editDrawingObject.draw(e.canvasDrawingContext),t.editDrawingObject=null),e.drawActiveDrawingObjects()),!1===t.isStayDrawingMode&&(t.state="default")}},m.prototype.toXPixels=function(t){return this.charts[0].toXPixels(t)},m.prototype.createSignalsPanel=function(){if(!this.configuration.modules.signals)return!1;var t=this.parent.querySelector(".tch-data-signals");return t.innerHTML=this.getActiveChart().getSignalsPanelHtml(),t.spanNumber=t.querySelector(".tch-signals-number"),t.spanArrow=t.querySelector(".tch-signals-arrow"),t.spanEye=t.querySelector(".tch-signals-eye"),t.body=t.querySelector(".tch-signals-panel-body"),t.body.list=t.body.querySelector("ul"),t},m.prototype.updateSignalsDropdown=function(t){for(var e=this.parent.querySelector(".tch-filtered-quatation").querySelectorAll(".tch-row-quatation"),a=0;a<e.length;a++){var i=e[a].querySelectorAll("td"),s=i[1].innerText.replace("/","");s=s.replace(/[^\x00-\x7F]/g,""),-1!==t.indexOf(s)?(i[3].innerText="*",i[3].style.color="green"):i[3].innerText=""}}},"./src/scripts/utils/utils.js":function(t,e,a){"use strict";function _defineProperty(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function _typeof(t){return(_typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function isObject(t){return t&&"object"===_typeof(t)&&!Array.isArray(t)}function cloneObject(t){if(t&&"object"===_typeof(t))return JSON.parse(JSON.stringify(t))}function mergeObject(){return function mergeDeep(t){for(var e=arguments.length,a=new Array(e>1?e-1:0),i=1;i<e;i++)a[i-1]=arguments[i];if(!a.length)return t;var s=a.shift();if(isObject(t)&&isObject(s))for(var r in s)isObject(s[r])?(t[r]||Object.assign(t,_defineProperty({},r,{})),mergeDeep(t[r],s[r])):Object.assign(t,_defineProperty({},r,s[r]));return mergeDeep.apply(void 0,[t].concat(a))}(cloneObject(arguments[0]),arguments[1])}function isActiveElements(t){var e=!1;return Object.keys(t).forEach(function(a){t[a]&&(e=!0)}),e}function checkConfigModules(t){return t.modules.isSideBarCreate&&(t.modules.isSideBarCreate=isActiveElements(t.modules.sideBarButtons)),t.modules.isHeaderCreate&&(t.modules.isHeaderCreate=isActiveElements(t.modules.headerButtons)),t}function filterDropdown(t,e){return t.reduce(function(t,a){return function _objectSpread(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},i=Object.keys(a);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(a).filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),i.forEach(function(e){_defineProperty(t,e,a[e])})}return t}({},t,_defineProperty({},a,e[a]))},{})}a.d(e,"b",function(){return cloneObject}),a.d(e,"d",function(){return mergeObject}),a.d(e,"a",function(){return checkConfigModules}),a.d(e,"c",function(){return filterDropdown})},"./src/styles/common.less":function(){},1:function(t,e,a){t.exports=a("./src/scripts/index.js")}});